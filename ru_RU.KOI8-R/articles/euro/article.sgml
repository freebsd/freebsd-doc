<!--
     The FreeBSD Russian Documentation Project

     $FreeBSDru: frdp/doc/ru_RU.KOI8-R/articles/euro/article.sgml,v 1.8 2006/02/09 14:56:27 marck Exp $

     Original revision: 1.11
-->

<!DOCTYPE ARTICLE PUBLIC "-//FreeBSD//DTD DocBook V4.1-Based Extension//EN" [
<!ENTITY % articles.ent PUBLIC "-//FreeBSD//ENTITIES DocBook FreeBSD Articles Entity Set//EN">
%articles.ent;
]>

<article lang="ru">
  <articleinfo>
    <title>Символ евро во <systemitem
      class="osname">FreeBSD</systemitem></title>

    <authorgroup>
      <author>
	<firstname>Aaron</firstname>

	<surname>Kaplan</surname>

	<affiliation>
	  <address>
	    <email>aaron@lo-res.org</email>
	  </address>
	</affiliation>
      </author>
    </authorgroup>

    <copyright>
      <year>2002</year>
      <year>2003</year>
      <holder>The FreeBSD Documentation Project</holder>
    </copyright>

    <pubdate role="rcs">$FreeBSD$</pubdate>

    <legalnotice id="trademarks" role="trademarks">
      &tm-attrib.freebsd;
      &tm-attrib.general;
    </legalnotice>

    <abstract>
      <para>В этом документе будет сделана попытка помочь вам начать работу с
	новым символом <keycap>Euro</keycap> на вашей новой клавиатуре, которую
	вы купили в начале 2002 года для перехода на новую общую валюту.
	Сначала мы сконцентрируемся на более важных вопросах, таких, как
	правильное отображение символа на консоли.  Последующие разделы
	посвящены настройке конкретных программ типа
	<application>X11</application>.</para>

      <para>Много полезной информации было получено от Oliver Fromme, Tom
	Rhodes и многих других.  Спасибо!  Без вас этой статьи бы не
	было!</para>
    </abstract>
  </articleinfo>

  <sect1>
    <title>Об Евро вкратце</title>

    <para>Если вы уже чувствуете себя уверенно при работе с <ulink
      url="&url.books.handbook/l10n.html">локализацией</ulink>, как она
      описана во Руководстве по <systemitem
      class="osname">FreeBSD</systemitem>, то вас могут заинтересовать только
      следующие факты, которые помогут вам быстро вникнуть в суть:</para>

    <variablelist>
      <varlistentry>
	<term>ISO8859-15</term>

	<listitem>
	  <para>Это несколько модифицированная версия широко используемого
	    набора символов ISO8859-1.  В него включен символ Евро.
	    Используется для задания переменных окружения <envar>LANG</envar> и
	    <envar>LC_CTYPE</envar>.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><filename>iso15-8x16.fnt</filename></term>

	<listitem>
	  <para>Шрифт &man.vidcontrol.1; для консоли</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><filename>/usr/share/syscons/keymaps/*.iso.kbd</filename></term>

	<listitem>
	  <para>Клавиатурные раскладки, соответствующие вашему языку.  Укажите
	    одну из них в качестве значения для параметра
	    <literal>keymap</literal> из файла
	    <filename>rc.conf</filename>.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><envar>LC_CTYPE</envar></term>

	<listitem>
	  <para>Используется для указания правильного типа символов при вашей
	    локализации.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><literal>XkbLayout "<replaceable>lang</replaceable>(euro)"</literal></term>

	<listitem>
	  <para>Параметр настройки <application>XFree86</application>.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><filename>/usr/X11R6/lib/X11/fonts/*/fonts.alias</filename></term>
	<listitem>
	  <para>Обязательно приведите ваши шрифты для X11 к виду
	    <literal>-*-..-*-iso8859-15</literal></para>
	</listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 id="general">
    <title>Общее замечание</title>

    <para>В последующих разделах мы будем часто обращаться к термину
      <emphasis>ISO8859-15</emphasis>.  Это стандартное обозначение начиная с
      <systemitem class="osname">FreeBSD</systemitem> 4.5.  В более старых
      версиях стандартным обозначением было <emphasis>ISO_8859-15</emphasis>
      или <emphasis>DIS_8859-15</emphasis>.</para>

    <para>Если вы используете более старую версию <systemitem
      class="osname">FreeBSD</systemitem>, обязательно посмотрите в каталоге
      <filename>/usr/share/locale/</filename>, какое используется соглашение по
      наименованию.</para>
  </sect1>

  <sect1 id="console">
    <title>Консоль</title>

    <sect2>
      <title>Настройка шрифта для консоли</title>

      <para>В зависимости от разрешения вашей консоли и её размера вам нужно
	задать одну из таких строк в <filename>rc.conf</filename>:</para>

      <programlisting>font8x16="iso15-8x16.fnt" # из /usr/share/syscons/fonts/*
font8x14="iso15-8x14.fnt"
font8x8="iso15-8x8.fnt"</programlisting>

      <para>Это приведёт к выбору шрифта ISO8859-15, известному также как
	Latin-9.  ISO8859-15 является вариантом ISO8859-1.  Вы можете увидеть
	разницу между ними, посмотрев на символ Евро: его десятичное значение
	равно 164.  В ISO8859-1 вы увидите кружок с четырьмя полосками по
	углам.  Часто он называется <quote>универсальным символом валюты</quote>.  В
	ISO8859-15 место маленького кружка занимает символ Евро.  Если его нет,
	то шрифты более или менее идентичны.</para>

      <warning>
	<para>На момент написания этого документа единственным пригодным к
	  использованию шрифтом был <literal>iso15-8x16.fnt</literal>.  Другие
	  выдавали ISO8859-1, хотя название говорило о другом.</para>
      </warning>

      <note>
	<para>После задания этого шрифта сообщения некоторых консольных
	  приложений будут выглядеть искажёнными.  Это происходит в силу того,
	  что они предполагают использование другого шрифта/набора символов,
	  такого, как ANSI 850.  Одним из примеров может выступать
	  <application>sysinstall</application>.  Однако в большинстве
	  случаев это не имеет большого значения и сильно не беспокоит.</para>
      </note>

      <para>Следующим шагом вы должны либо перезагрузить вашу систему для того,
	чтобы изменения вступили в силу, либо (вручную) выполнить те действия,
	которые происходят при начале работы системы:</para>

      <screen>&prompt.user; <userinput>vidcontrol -f <replaceable>iso15-8x16.fnt</replaceable></userinput></screen>

      <para>Для проверки того, был ли выбран шрифт, выполните такой короткий
	скрипт на языке <command><anchor id="awk-test">awk</command>:</para>

      <programlisting>#!/usr/bin/awk -f
BEGIN {
        for(i=160;i<180;i++)
                printf"%3d %c\n",i,i
}</programlisting>

      <para>В результате знак Евро должен быть в позиции 164.</para>
    </sect2>

    <sect2>
      <title>Настройка вашей клавиатуры на использование Евро</title>

      <para>Большинство клавиатурных раскладок уже должно быть корректно
	настроено.  Другими словами: Если у вас немецкая клавиатура и ваши
	клавиши с умляутами работают, то вы можете пропустить этот раздел, так
	как клавиатура уже отображает какую-то комбинацию клавиш (к
	примеру: <keycombo action=simul><keycap>Alt Gr</keycap>
	<keycap>e</keycap></keycombo>) в символ с десятичным значением 164.
	Если вы сталкиваетесь с проблемами, лучше всего проверить в каталоге
	<filename>/usr/share/syscons/keymaps/*.kbd</filename>.  Формат файлов
	раскладок клавиатуры описан в &man.keyboard.4;.  Утилита
	&man.kbdcontrol.1; может использоваться для загрузки пользовательских
	клавиатурных раскладок.</para>

      <para>После выбора правильной клавиатурной раскладки она должна быть
	указана в файле	<filename>/etc/rc.conf</filename> такой строкой:</para>

      <programlisting>keymap="<replaceable>german.iso</replaceable>" # or another map</programlisting>

      <para>Как указано выше, этот шаг, скорее всего, был уже вами выполнен во
	время установки (в <application>sysinstall</application>).  Если это не
	так, либо перезагрузитесь, либо загрузите новую клавиатурную раскладку
	посредством &man.kbdcontrol.1;.</para>

      <para>Для проверки раскладки клавиатуры, переключитесь на другую консоль
	и в приглашении на вход в систему <emphasis>вместо имени
	входа</emphasis> попробуйте набрать клавишу <keycap>Euro</keycap>.
	Если она не работает, отправьте сообщение об ошибке через
	&man.send-pr.1; либо проверьте, что вы действительно выбрали правильную
	раскладку клавиатуры.</para>

      <note>
	<para>На этом этапе клавиша Euro ещё не работает в
	  <application>bash</application> или
	  <application>tcsh</application>.</para>
      </note>
    </sect2>

    <sect2>
      <title>Исправление переменных окружения</title>

      <para>Командные процессоры (<application>bash</application>, <application>tcsh</application>) обращаются к библиотеке
	&man.readline.3;, которая, в свою очередь, использует переменную
	окружения <envar>LC_CTYPE</envar>.  <envar>LC_CTYPE</envar> должна быть
	задана до полного запуска оболочки.  К счастью, для этого достаточно
	добавить строку:</para>

      <programlisting>export LC_CTYPE=<replaceable>de_DE</replaceable>.ISO8859-15</programlisting>

      <para>в ваш <filename>.bash_profile</filename> (<application>bash</application>), или:</para>

      <programlisting>setenv LC_CTYPE <replaceable>de_DE</replaceable>.ISO8859-15</programlisting>

      <para>в ваш файл <filename>.login</filename> (tcsh).  Конечно же,
	<replaceable>de_DE</replaceable> должно быть заменено на то, что
	соответствует вашему языку.  Затем завершите работу с системой, войдите
	в систему снова и проверьте, что клавиша Евро работает.  Теперь
	большинство консольных приложений должно воспринимать клавишу Евро.
	Однако для специализированных программ, таких, как, например,
	<application>pine</application>, могут потребоваться дополнительные
	шаги по их настройке.</para>

      <note>
	<para>Альтернативой изменению <filename>.login</filename> и
	  <filename>.bash_profile</filename> является задание переменных
	  окружения через механизм &man.login.conf.5;.  Этот подход имеет
	  преимущество в назначении классов входа в систему определенным
	  пользователям (к примеру, французам, итальянцам, и так далее)
	  <emphasis>в одном месте</emphasis>.</para>
      </note>
    </sect2>
  </sect1>

  <sect1 id="x11">
    <title>Настройка X11</title>

    <para>Измените <filename>/etc/X11/xorg.conf</filename>
      (<filename>/etc/X11/XF86Config</filename> в случае если вы используете
      &xfree86;) следующим образом:</para>

    <programlisting>Option "XkbLayout"  "<replaceable>de</replaceable>(euro)"</programlisting>

    <para>И снова, замените <replaceable>de</replaceable> на то, что
      соответствует вашему языку.  С этого момента клавиатура должна быть
      настроена правильно.  Как и в разделе о консоли, должен быть выбран
      правильный шрифт.  В случае <application>KDE</application> перейдите к
      <application>KDE control center</application> -&gt;
      Personalization -&gt; Country &amp; Language -&gt; Charset и смените его
      на <literal>ISO8859-15</literal>.  Подобные же шаги должны быть выполнены
      для <application>kmail</application> и других приложений.</para>

    <para>Другим хорошим способом является изменение ваших файлов
      <filename>fonts.alias</filename>.  Следует отметить, что шрифт
      <literal>fixed</literal> должен быть изменен на правильный набор
      символов: файл автора
      <filename>/usr/X11R6/lib/X11/fonts/misc/fonts.alias</filename> выглядит
      примерно так:</para>

     <programlisting>! $Xorg: fonts.alias,v 1.3 2000/08/21 16:42:31 coskrey Exp $
fixed   -misc-fixed-medium-r-semicondensed--13-120-75-75-c-60-iso8859-15
variable -*-helvetica-bold-r-normal-*-*-120-*-*-*-*-iso8859-15
(...)</programlisting>

    <para>Как и в разделах о консоли, в специализированных приложениях всё ещё
      могут остаться настроенными шрифты ISO8859-1 в их базах данных &man.xrdb.1;.
      Одним из видимых примеров является <application>xterm</application>.
      Как правило, достаточно изменить соответствующий конфигурационный файл из
      каталога <filename>/usr/X11R6/lib/X11/app-defaults</filename>, добавив
      правильный шрифт.  Продемонстрируем это на примере
      <application>xterm</application>.</para>

   <screen>&prompt.root; cd /usr/X11R6/lib/X11/app-defaults/
&prompt.root; vi XTerm</screen>

    <para>Добавьте такую строку в начало файла:</para>

    <programlisting>*font:     -misc-fixed-medium-r-normal-*-*-120-*-*-c-*-iso8859-15</programlisting>

    <para>И наконец, перезапустите X и проверьте, что шрифты могут выводиться,
      выполнив вышеприведённый <link linkend="awk-test">скрипт на awk</link>.
      Все основные приложения должны воспринять клавиатурную раскладку и
      настройки шрифта.</para>
  </sect1>

  <sect1 id="problems">
    <title>Открытые проблемы</title>

    <para>Конечно, автор будет рад получить отклики.  Кроме того, по крайней
      мере дайте мне знать, если ли у вас решения для следующих открытых
      проблем:</para>

    <itemizedlist>
      <listitem>
	<para>Описание альтернативного способа настройки <application>XFree86</application>:
	  <filename role="package">x11/xkeycaps</filename></para>
      </listitem>

      <listitem>
	<para>Настройки в <application>GNOME</application></para>
      </listitem>

      <listitem>
	<para>Настройки в <application>XFCE</application></para>
      </listitem>

      <listitem>
	<para>Настройки для <application>(X)Emacs</application></para>
      </listitem>

      <listitem>
	<para>Описание UTF-8</para>
      </listitem>

      <listitem>
	<para>Описание <application>libiconv</application> как эффективного
	  способа преобразования между ISO8859-15 и UTF-{8,16} внутри
	  приложений</para>
      </listitem>
    </itemizedlist>
  </sect1>
</article>

<!--
     Local Variables:
     mode: sgml
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     End:
-->
