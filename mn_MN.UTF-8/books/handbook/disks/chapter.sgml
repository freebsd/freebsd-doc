<!--
     The FreeBSD Mongolian Documentation Project

     Original revision 1.309

     $FreeBSD$
-->

<chapter id="disks">
  <chapterinfo>
    <authorgroup>
      <author>
	<firstname>Цагаанхүүгийн</firstname>
	<surname>Ганболд</surname>
	<contrib>Орчуулсан  </contrib>
      </author>
    </authorgroup>
  </chapterinfo>
  <title>Хадгалалт</title>

  <sect1 id="disks-synopsis">
    <title>Ерөнхий агуулга</title>


    <para>Энэ бүлэг нь FreeBSD дээр дискнүүдийг ашиглах талаар тайлбарлах болно. 
	Эдгээрт санах ой дээр тулгуурласан дискнүүд, сүлжээнд залгагдсан дискнүүд, 
	стандарт SCSI/IDE хадгалалтын төхөөрөмжүүд болон USB интерфэйс 
	ашигладаг төхөөрөмжүүд багтах юм.</para>

    <para>Энэ бүлгийг уншсаны дараа, та дараах зүйлсийг мэдэх болно:</para>
    <itemizedlist>
      <listitem><para>Физик диск (хуваалтууд болон зүсмэлүүд) дээрх өгөгдлийн зохион 
	байгуулалтыг тайлбарладаг FreeBSD-ийн ашигладаг ухагдахуун.</para>
      </listitem>
      <listitem><para>Өөрийн систем дээр нэмэлт хатуу дискнүүдийг хэрхэн нэмэх талаар.</para>
      </listitem>
      <listitem>
	<para>USB хадгалалтын төхөөрөмжүүдийг ашиглахын тулд  &os;-г хэрхэн тохируулах талаар.</para>
      </listitem>
      <listitem><para>Санах ойн диск зэрэг виртуал файлын системүүдийг хэрхэн тохируулах талаар.</para></listitem>
      <listitem>
	<para>Дискний зайн хэрэглээг хязгаарлахын тулд ноогдлыг хэрхэн ашиглах талаар.</para>
      </listitem>
      <listitem>
	<para>Дискийг халдагчдаас хамгаалж нууцлахын тулд хэрхэн шифрлэх талаар.</para>
      </listitem>
      <listitem>
	<para>FreeBSD дээр CD болон DVD-г хэрхэн үүсгэж шарах талаар.</para>
      </listitem>
      <listitem>
        <para>Нөөцлөлтөд зориулсан хадгалалтын төрөл бүрийн тохируулгууд.</para>
      </listitem>
      <listitem>
        <para>FreeBSD дээр байдаг нөөцлөлтийн програмуудыг хэрхэн ашиглах талаар.</para>
      </listitem>
      <listitem>
        <para>Уян диск уруу хэрхэн нөөцлөх талаар.</para>
      </listitem>
      <listitem>
        <para>Файлын системийн хормын хувилбар гэж юу болох түүнийг хэрхэн үр дүнтэйгээр ашиглах талаар.</para>
      </listitem>
    </itemizedlist>

    <para>Энэ бүлгийг уншихаасаа өмнө та дараах зүйлсийг гүйцэтгэх хэрэгтэй:</para>

    <itemizedlist>
      <listitem>
        <para>Шинэ FreeBSD цөмийг хэрхэн тохируулж суулгах талаар мэдэх
          (<xref linkend="kernelconfig">).</para>
      </listitem>
    </itemizedlist>

  </sect1>

  <sect1 id="disks-naming">
    <title>Төхөөрөмжийн нэрс</title>

    <para>Дараах нь FreeBSD-д дэмжигдсэн физик хадгалалтын төхөөрөмжүүд болон 
	тэдгээртэй холбоотой төхөөрөмжийн нэрсийн жагсаалт юм.</para>

    <table id="disk-naming-physical-table" frame="none">
      <title>Физик диск нэрлэх заншил</title>

      <tgroup cols="2">
	<thead>
	  <row>
	    <entry>Хөтчийн төрөл</entry>
	    <entry>Хөтчийн төхөөрөмжийн нэр</entry>
	  </row>
	</thead>
	<tbody>
	  <row>
	    <entry>IDE хатуу хөтчүүд</entry>
	    <entry><literal>ad</literal></entry>
	  </row>
	  <row>
	    <entry>IDE CDROM хөтчүүд</entry>
	    <entry><literal>acd</literal></entry>
	  </row>
	  <row>
	    <entry>SCSI хатуу хөтчүүд болон USB Mass хадгалалтын төхөөрөмжүүд</entry>
	    <entry><literal>da</literal></entry>
	  </row>
	  <row>
	    <entry>SCSI CDROM хөтчүүд</entry>
	    <entry><literal>cd</literal></entry>
	  </row>
	  <row>
	    <entry>Төрөлжүүлсэн стандарт бус CDROM хөтчүүд</entry>
	    <entry>Mitsumi CD-ROM-ийн хувьд <literal>mcd</literal> ба 
	      Sony CD-ROM хөтчүүдийн хувьд <literal>scd</literal>
	    </entry>
	  </row>
	  <row>
	    <entry>Уян хөтчүүд</entry>
	    <entry><literal>fd</literal></entry>
	  </row>
	  <row>
	    <entry>SCSI соронзон хальсны хөтчүүд</entry>
	    <entry><literal>sa</literal></entry>
            </row>
	  <row>
	    <entry>IDE соронзон хальсны хөтчүүд</entry>
	    <entry><literal>ast</literal></entry>
	  </row>
	  <row>
	    <entry>Flash хөтчүүд</entry>
	    <entry>&diskonchip; Flash хөтчийн хувьд <literal>fla</literal></entry>
	  </row>
	  <row>
	    <entry>RAID хөтчүүд</entry>
	    <entry>&adaptec; AdvancedRAID-н хувьд <literal>aacd</literal>,
	      &mylex;-ийн хувьд <literal>mlxd</literal> ба <literal>mlyd</literal>,
	      AMI &megaraid;-ийн хувьд <literal>amrd</literal>,
	      Compaq Smart RAID-ийн хувьд <literal>idad</literal>,
	      &tm.3ware; RAID-ийн хувьд <literal>twed</literal>.</entry>
	  </row>
	</tbody>
      </tgroup>
    </table>
  </sect1>

  <sect1 id="disks-adding">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Дэйвид</firstname>
	  <surname>О'Брайн</surname>
	  <contrib>Анхлан хувь нэмэр болгон оруулсан </contrib>
	</author>
      </authorgroup>
      <!-- 26 Apr 1998 -->
    </sect1info>

    <title>Диск нэмэх</title>

    <indexterm>
      <primary>дискнүүд</primary>
      <secondary>нэмэх нь</secondary>
    </indexterm>

    <para>Дараах хэсэг зөвхөн нэг хөтөчтэй машинд шинэ <acronym>SCSI</acronym> диск хэрхэн 
        нэмэх талаар тайлбарлах болно. Эхлээд компьютераа унтраагаад хөтчийг 
	компьютер, хянагч болон хөтчийн үйлдвэрлэгчийн заавруудын дагуу суулгана. 
	Үүнийг хийх маш олон төрлийн процедуруудаас болоод энэ тухай дэлгэрэнгүй 
	мэдээлэл нь энэ баримтын хамрах хүрээнээс гадна юм.</para>

    <para><username>root</username> хэрэглэгчээр нэвтрэх хэрэгтэй. Та хөтчийг 
	суулгасны дараа шинэ диск олдсон эсэхийг <filename>/var/run/dmesg.boot</filename>-с 
	шалгаарай. Шинээр нэмсэн хөтөч нь <devicename>da1</devicename> байх 
	бөгөөд бид үүнийг <filename>/1</filename> дээр холбохыг хүснэ (хэрэв та IDE хөтөч 
	нэмж байгаа бол төхөөрөмжийн нэр нь <devicename>ad1</devicename> болно).</para>

    <indexterm><primary>хуваалтууд</primary></indexterm>
    <indexterm><primary>зүсмэлүүд</primary></indexterm>
    <indexterm>
      <primary><command>fdisk</command></primary>
    </indexterm>

    <para>FreeBSD нь IBM-PC-тэй нийцтэй компьютеруудтай ажилладаг учраас 
	PC BIOS хуваалтуудыг бодолцох ёстой. Эдгээр нь уламжлалт BSD хуваалтуудаас 
	өөр юм. PC диск нь дөрөв хүртэлх тооны BSD хуваалттай байдаг. Хэрэв диск 
	нь жинхэнээрээ FreeBSD-д зориулагдах бол та <emphasis>dedicated буюу 
	зориулагдсан</emphasis> горимыг ашиглаж болно. Үгүй бол FreeBSD нь 
	PC BIOS хуваалтуудын аль нэгэн дээр байрлах болно. FreeBSD нь PC BIOS 
	хуваалтуудыг уламжлалт BSD хуваалтуудтай эндүүрэхгүйн тулд 
	<emphasis>зүсмэлүүд</emphasis> гэж нэрлэдэг. Та бас FreeBSD-д зориулагдсан 
	боловч өөр үйлдлийн систем суулгагдсан компьютер дээр ашигласан диск дээрх 
	зүсмэлүүдийг хэрэглэж болох юм. Энэ нь FreeBSD биш өөр үйлдлийн системийн 
	<command>fdisk</command> хэрэгсэлтэй андуурахаас хамгаалах нэг сайн 
	арга юм.</para>

    <para>Зүсмэлийн хувьд бол хөтөч нь <filename>/dev/da1s1e</filename> 
	гэж нэмэгдэх болно. Үүнийг SCSI диск, нэгжийн дугаар 1 (хоёр дахь SCSI диск),
	зүсмэл 1 (PC BIOS хуваалт 1) болон <filename>e</filename> BSD 
	хуваалт гэж уншина. Зориулагдсан тохиолдолд хөтөч нь ердөө л <filename>/dev/da1e</filename> 
	гэж нэмэгдэнэ.</para>

    <para>Секторуудын тоог хадгалахын тулд 32 битийн бүхэл тоог ашигладгаас болоод 
	&man.bsdlabel.8; нь нэг дискний хувьд 2^32-1 сектор буюу ихэнх тохиолдолд 
	2TB болж хязгаарлагддаг. &man.fdisk.8; хэлбэршүүлэлт нь 2^32-1-с 
	ихгүй эхлэх сектор болон 2^32-1-с ихгүй уртыг зөвшөөрч хуваалтуудыг 2TB,  
	дискнүүдийг ихэнх тохиолдолд 4TB болгож хязгаарладаг. &man.sunlabel.8; 
	хэлбэршүүлэлт нь нэг хуваалтын хувьд 2^32-1 сектороор, нийтдээ 16TB-ийн 
	8 хуваалтаар хязгаарлагддаг. Илүү том дискнүүдийн хувьд &man.gpart.8;
      ашиглан <acronym>GPT</acronym> хуваалтуудыг үүсгэж болно. <acronym>GPT</acronym> 
      нь 4 зүсмэлээр хязгаарлагддагүйгээрээ ашигтай байдаг.</para>

    <sect2>
      <title>&man.sysinstall.8;-г ашиглах нь</title>
      <indexterm>
        <primary><application>sysinstall</application></primary>
        <secondary>дискнүүд нэмэх нь</secondary>
      </indexterm>
      <indexterm>
	<primary>su</primary>
      </indexterm>
      <procedure>
	<step>
	  <title><application>Sysinstall</application>-г жолоодох нь</title>

	  <para>Та <command>sysinstall</command>-н хялбар ашиглаж болох 
		цэснүүдийн тусламжтайгаар шинэ дискийг хуваан хаяглаж болох юм. 
		<username>root</username> хэрэгчээр нэвтрэх буюу эсвэл 
		<command>su</command> тушаалыг ашиглаарай. 
		<command>sysinstall</command>-г ажиллуулж 
		<literal>Configure</literal> цэс уруу орно. 
		<literal>FreeBSD Configuration Menu</literal> дотор 
		доош шилжиж <literal>Fdisk</literal> тохируулгыг 
		сонгоно.</para>
	</step>

	<step>
	  <title><application>fdisk</application> хуваалт засварлагч</title>
	  <para><application>fdisk</application>-ийн дотор байхдаа 
		<keycap>A</keycap>-г дарвал дискийг бүхэлд нь FreeBSD-д 
		ашиглах болно. Асуух үед нь хэрэв та <quote>ирээдүйд суулгаж болзошгүй 
		үйлдлийн системүүдтэй хамтран ажиллахаар үлдэхийг хүсвэл</quote> 
		<literal>YES</literal> гэж хариулаарай. <keycap>W</keycap>-г 
		ашиглан өөрчлөлтүүдийг диск уруу бичнэ. Одоо FDISK засварлагчаас 
		<keycap>Q</keycap>-г дарж гараарай. Дараа нь танаас 
		<quote>Master Boot Record буюу Мастер Ачаалагч Бичлэгийн</quote> 
		талаар асуух болно. Та ажиллаж байгаа систем дээр диск нэмж байгаа болохоор 
		<literal>None</literal>-г сонгох хэрэгтэй.</para>
	</step>

	<step>
	  <title>Дискний Шошго засварлагч</title>
	  <indexterm><primary>BSD хуваалтууд</primary></indexterm>

	  <para>Дараа нь <application>sysinstall</application>-с гарч дахин 
		түүнийг эхлүүлэх хэрэгтэй. Дээрх заавруудыг дагаарай, гэхдээ 
		энэ удаад <literal>Label</literal> тохируулгыг сонгоорой. 
		Энэ нь <literal>Disk Label Editor буюу дискний шошго засварлагч</literal> 
		уруу орно. Энд та уламжлалт BSD хуваалтуудыг үүсгэдэг. Диск нь 
		<literal>a-h</literal> гэж хаяглагдсан найм хүртэлх хуваалтуудтай 
		байж болно. Хуваалтын шошгонуудын цөөн хэд нь тусгай хэрэглээтэй байдаг. 
		<literal>a</literal> хуваалт нь root хуваалтанд (<filename>/</filename>) 
		ашиглагддаг. Тиймээс зөвхөн таны системийн диск (өөрөөр хэлбэл таны 
		ачаалалт хийсэн диск) <literal>a</literal> хуваалттай байх 
		ёстой. <literal>b</literal> хуваалт нь swap хуваалтуудад 
		хэрэглэгддэг бөгөөд та swap хуваалттай олон дисктэй байж болох юм. 
		<literal>c</literal> хуваалт нь зориулагдсан горимд  
		бүх дискийг, зүсмэлийн горимд бүхэл FreeBSD зүсмэлийг эсвэл заадаг.
		Бусад хуваалтууд нь ерөнхий хэрэглээнд зориулагдсан.</para>

	  <para><application>sysinstall</application>-ийн шошго засварлагч нь 
		root биш, swap биш хуваалтуудад зориулж <literal>e</literal> 
		хуваалтыг илүүтэй үздэг. Шошго засварлагч дотор байхдаа <keycap>C</keycap>-г 
		даран ганц файлын систем үүсгэх хэрэгтэй. Асуух үед, хэрэв энэ нь 
		FS (файлын систем) эсвэл swap байх юм бол <literal>FS</literal>-г 
		сонгож холбох цэгийг (өөрөөр хэлбэл <filename>/mnt</filename>) бичээрэй. 
		Хэрэв дискийг суулгацын дараах горимд нэмж байгаа бол 
		<application>sysinstall</application> нь танд зориулж оруулгуудыг 
		<filename>/etc/fstab</filename> файлд үүсгэхгүй, тиймээс таны 
		зааж өгсөн холбох цэг нь чухал биш юм.</para>

	  <para>Та одоо шинэ шошгыг диск уруу бичиж түүн дээр файлын систем үүсгэхэд 
		бэлэн боллоо. Үүнийг <keycap>W</keycap>-г дарж хийнэ. 
		<application>sysinstall</application>-ын шинэ хуваалтыг 
		холбож чадахгүй байна гэсэн алдааг өнгөрүүлэх хэрэгтэй. Шошго засварлагч
		болон <application>sysinstall</application>-с бүр мөсөн 
		гараарай.</para>
	</step>

	<step>
	  <title>Төгсгөл</title>

	  <para>Хамгийн сүүлийн алхам нь <filename>/etc/fstab</filename> файлыг 
		засварлаж өөрийн шинэ дискний оруулгыг нэмэх явдал юм.</para>
	</step>
      </procedure>
    </sect2>

    <sect2>
      <title>Тушаалын мөрийн хэрэгслүүдийг ашиглах нь</title>

      <sect3>
	<title>Зүсмэлүүдийг ашиглах нь</title>

	<para>Энэ тохиргоо нь таны дискийг өөрийн чинь компьютер дээр суулгагдсан 
	байж болох бусад үйлдлийн системтэй зөв ажиллаж өөр бусад үйлдлийн системийн 
	<command>fdisk</command> хэрэгслүүдтэй эндүүрэхгүй байх боломжийг 
	бүрдүүлдэг. Шинэ дискийг суулгахад энэ аргыг ашиглахыг зөвлөдөг. 
	Хэрэв танд үнэхээр тохирох шалтгаан байгаа тохиолдолд <literal>зориулагдсан</literal> 
	горимыг ашиглаарай!</para>

	<screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/da1 bs=1k count=1</userinput>
&prompt.root; <userinput>fdisk -BI da1</userinput> #Initialize your new disk
&prompt.root; <userinput>bsdlabel -B -w da1s1 auto</userinput> #Label it.
&prompt.root; <userinput>bsdlabel -e da1s1</userinput> # Edit the bsdlabel just created and add any partitions.
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>newfs /dev/da1s1e</userinput> # Repeat this for every partition you created.
&prompt.root; <userinput>mount /dev/da1s1e /1</userinput> # Mount the partition(s)
&prompt.root; <userinput>vi /etc/fstab</userinput> # Add the appropriate entry/entries to your <filename>/etc/fstab</filename>.</screen>

	<para>Хэрэв танд IDE диск байвал <filename>da</filename>-г 
	<filename>ad</filename> гэж солиорой.</para>
      </sect3>

      <sect3>
	<title>Зориулагдсан</title>
	<indexterm><primary>OS/2</primary></indexterm>

	<para>Хэрэв та шинэ хөтчийг өөр үйлдлийн системтэй цуг хуваалцахгүй бол 
	<literal>зориулагдсан</literal> горимыг ашиглаж болох юм. Энэ горим нь 
	Microsoft үйлдлийн системийн толгойг эргүүлж болохыг санаарай; гэхдээ 
	тэдгээр нь ямар ч эвдрэл гэмтэл үүсгэхгүй. IBM-ийн &os2; нь харин 
	олсон бүх ойлгохгүй байгаа ямар ч хуваалтыг хувьдаа <quote>завших</quote> 
	болно.</para>

	<screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/da1 bs=1k count=1</userinput>
&prompt.root; <userinput>bsdlabel -Bw da1 auto</userinput>
&prompt.root; <userinput>bsdlabel -e da1</userinput>				# create the `e' partition
&prompt.root; <userinput>newfs /dev/da1e</userinput>
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>vi /etc/fstab</userinput>				# add an entry for /dev/da1e
&prompt.root; <userinput>mount /1</userinput></screen>

	<para>Өөр нэг арга нь:</para>

	<screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/da1 count=2</userinput>
&prompt.root; <userinput>bsdlabel /dev/da1 | bsdlabel -BR da1 /dev/stdin</userinput>
&prompt.root; <userinput>newfs /dev/da1e</userinput>
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>vi /etc/fstab</userinput>					# add an entry for /dev/da1e
&prompt.root; <userinput>mount /1</userinput></screen>

      </sect3>
    </sect2>
  </sect1>

  <sect1 id="raid">
    <title>RAID</title>

    <sect2 id="raid-soft">
      <title>Програм хангамжийн RAID</title>

      <sect3 id="ccd">
	<sect3info>
	  <authorgroup>
	    <author>
	      <firstname>Кристофер</firstname>
	      <surname>Шамвэй</surname>
	      <contrib>Анхлан ажилласан </contrib>
	    </author>
	  </authorgroup>
	  <authorgroup>
	    <author>
	      <firstname>Жим</firstname>
	      <surname>Браун</surname>
	      <contrib>Хянан тохиолдуулсан </contrib>
	    </author>
	  </authorgroup>
	</sect3info>

<indexterm><primary>RAID</primary><secondary>програм хангамж</secondary></indexterm>
<indexterm>
  <primary>RAID</primary><secondary>CCD</secondary>
</indexterm>

	<title>Нийлүүлэгдсэн Дискний Драйвер (Concatenated Disk Driver буюу CCD) тохиргоо</title>
	<para>Бөөн хадгалалтын шийдлийг сонгохдоо бодолцох хамгийн чухал хүчин зүйлүүд нь 
	хурд, найдвартай байдал болон өртөг юм. Энэ гурвыг гурвууланг нь тэнцүү байлгах нь 
	ховор байдаг; ерөнхийдөө хурдан, найдвартай бөөн хадгалалтын төхөөрөмж нь үнэтэй 
	бөгөөд үнийн хувьд хямдыг сонгох нь хурд эсвэл найдвартай байдлын аль нэгийг золиослох 
	хэрэгтэй болдог.</para>

          <para>Доор тайлбарласан системийг дизайн хийхдээ өртгийг хамгийн чухал хүчин зүйл гэж 
		сонгож авсан бөгөөд үүний дараа хурд, хурдын дараа найдвартай байдлыг 
		сонгосон. Энэ системийн өгөгдөл дамжуулах хурд нь эцсийн эцэст сүлжээгээр 
		шахагддаг. Найдвартай байдал нь маш чухал боловч доор тайлбарласан CCD 
		хөтөч нь CD-R-ууд дээр аль хэдийн бүтнээрээ нөөцлөгдсөн, амархнаар 
		солигдож болох өгөгдөлд шууд үйлчилдэг.</para>

          <para>Өөрийн шаардлагыг тодорхойлох нь бөөн хадгалалтын шийдлийг сонгох анхны 
		алхам юм. Хэрэв таны шаардлага нь хурд эсвэл найдвартай байдлыг өртгөөс 
		илүүтэй үзэж байгаа бол таны шийдэл энэ хэсэгт тайлбарласан шийдлээс 
		өөр болох болно.</para>


	<sect4 id="ccd-installhw">
	  <title>Тоног төхөөрөмжийг суулгах нь</title>

	  <para>IDE системийн дискнээс гадна гурван Western
            Digital 30GB, 5400 RPM IDE диск нь доор тайлбарласан 
		CCD дискний гол цөм болж нийтдээ ойролцоогоор 90GB 
		шууд хадгалалт болно. Туйлын хүслээр бол IDE диск бүр өөрийн IDE 
		хянагч болон кабельтай байна, гэхдээ өртгийг багасгахын 
		тулд нэмэлт IDE хянагчууд ашиглагдаагүй болно. Харин дискнүүд нь 
		jumper буюу холбогчоор тохируулагдсан бөгөөд ингэснээр IDE хянагч 
		бүр нэг мастер болон нэг боолтой байна.</para>

	  <para>Дахин ачаалах үед системийн BIOS залгагдсан дискнүүдийг автоматаар олохоор 
		тохируулагдсан байдаг. Илүү чухал зүйл нь FreeBSD тэдгээрийг дахин ачаалахад 
		олсон явдал юм:</para>

	  <programlisting>ad0: 19574MB &lt;WDC WD205BA&gt; [39770/16/63] at ata0-master UDMA33
ad1: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata0-slave UDMA33
ad2: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-master UDMA33
ad3: 29333MB &lt;WDC WD307AA&gt; [59598/16/63] at ata1-slave UDMA33</programlisting>

 	  <note><para>Хэрэв FreeBSD дискнүүдийг бүгдийг нь олохгүй байгаа бол 
		та тэдгээрийг зөвөөр холбосон эсэхээ шалгаарай. IDE хөтчүүдийн 
		ихэнх нь бас <quote>Cable Select</quote> холбогчтой байдаг. 
		Энэ нь мастер/боол харилцаанд зориулагдсан холбогч 
		<emphasis>биш</emphasis> юм. Хөтчийн баримтаас зөв 
		холбогчийг таних талаар лавлаарай.</para></note>

 	  <para>Дараа нь тэдгээрийг файлын системийн хэсэг болгон залгах талаар 
		бодох хэрэгтэй. Та &man.vinum.4; (<xref
 	    linkend="vinum-vinum">) болон &man.ccd.4; хоёуланг 
		судлах хэрэгтэй. Энэ тохиргооны хувьд &man.ccd.4;-г сонгосон.</para>
	</sect4>

	<sect4 id="ccd-setup">
	  <title>CCD-г тохируулах нь</title>

 	  <para>&man.ccd.4; хөтөч нь хэд хэдэн адил дискнүүдийг авч тэдгээрийг 
		нэг логик файл систем болгон нийлүүлэх боломжийг олгодог. 
		&man.ccd.4;-г ашиглахын тулд танд &man.ccd.4; дэмжлэг 
		цуг бүтээгдсэн цөм хэрэгтэй. Энэ мөрийг цөмийн тохиргооны файлдаа
		нэмээд цөмөө дахин бүтээж суулгаарай:</para>

	  <programlisting>device   ccd</programlisting>

	  <para>&man.ccd.4; дэмжлэг цөмийн дуудагдах модуль хэлбэрээр 
		бас дуудагдаж болно.</para>

 	  <para>&man.ccd.4;-г тохируулахын тулд та эхлээд дискнүүдийг 
		хаяглах &man.bsdlabel.8;-г ашиглах ёстой:</para>

	  <programlisting>bsdlabel -w ad1 auto
bsdlabel -w ad2 auto
bsdlabel -w ad3 auto</programlisting>

 	  <para>Энэ нь бүх дискний дагуух <devicename>ad1c</devicename>, <devicename>ad2c</devicename> болон <devicename>ad3c</devicename>-д зориулж  bsdlabel үүсгэдэг.</para>

 	  <para>Дараагийн алхам нь дискний шошгоны төрлийг өөрчлөх явдал юм. 
		Та дискнүүдийг засварлахдаа &man.bsdlabel.8;-г ашиглаж 
		болно:</para>

	  <programlisting>bsdlabel -e ad1
bsdlabel -e ad2
bsdlabel -e ad3</programlisting>

 	  <para>Энэ нь диск бүр дэх тухайн дискний шошгыг <envar>EDITOR</envar> 
		орчны хувьсагчид заасан засварлагчаар, ихэнхдээ &man.vi.1;-ээр 
		онгойлгодог.</para>

	  <para>Өөрчлөлт хийгдээгүй дискний шошго иймэрхүү харагдах болно:</para>

	  <programlisting>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)</programlisting>

 	  <para>&man.ccd.4;-д зориулж ашиглахаар шинэ <literal>e</literal> 
		хуваалтыг нэмнэ. Үүнийг ихэвчлэн <literal>c</literal> хуваалтаас хуулж 
		болох боловч <option>fstype</option> нь <userinput>4.2BSD</userinput> 
		байх <emphasis>ёстой</emphasis>. Дискний шошго одоо иймэрхүү харагдах 
		ёстой:</para>

	  <programlisting>8 partitions:
#        size   offset    fstype   [fsize bsize bps/cpg]
  c: 60074784        0    unused        0     0     0   # (Cyl.    0 - 59597)
  e: 60074784        0    4.2BSD        0     0     0   # (Cyl.    0 - 59597)</programlisting>

	</sect4>

	<sect4 id="ccd-buildingfs">
	  <title>Файлын системийг бүтээх нь</title>

	  <para>Та бүх дискнүүдээ хаягласны дараа &man.ccd.4;-г бүтээх 
		ёстой. Үүнийг хийхийн тулд дараах тохируулгуудтай адилаар
		&man.ccdconfig.8;-г ашиглана:</para>

	    <programlisting>ccdconfig ccd0<co id="co-ccd-dev"> 32<co id="co-ccd-interleave"> 0<co id="co-ccd-flags"> /dev/ad1e<co id="co-ccd-devs"> /dev/ad2e /dev/ad3e</programlisting>

	  <para>Тохируулга бүрийн хэрэглээ болон утгыг доор харуулав:</para>

          <calloutlist>
            <callout arearefs="co-ccd-dev">
	    <para>Эхний нэмэлт өгөгдөл нь тохируулах төхөөрөмж байх бөгөөд энэ 
		тохиолдолд <filename>/dev/ccd0c</filename> байна. 
		<filename>/dev/</filename> хэсэг байхгүй ч байж болно.</para>
            </callout>

            <callout arearefs="co-ccd-interleave">

	    <para>Файлын системд зориулсан interleave.  interleave нь 
		дискний блокууд дээрх судлын хэмжээг тодорхойлдог бөгөөд нэг бүр нь 
		ихэвчлэн 512 байт байдаг. Тэгэхээр 32 interleave нь 16,384 байт 
		байна.</para>
            </callout>

            <callout arearefs="co-ccd-flags">
	    <para>&man.ccdconfig.8;-д зориулсан тугнууд. Хэрэв та хөтчийг 
		толин тусгал үүсгэж идэвхжүүлэхийг хүсвэл тугийг энд зааж өгч 
		болно. Энэ тохиргоо нь &man.ccd.4;-н хувьд толин тусгал 
		үүсгэлтийг хангадаггүй учир энэ нь 0 (тэг) гэж тохируулагдсан.</para>
            </callout>

            <callout arearefs="co-ccd-devs">
	    <para>&man.ccdconfig.8; уруу өгөгдөх сүүлийн нэмэлт өгөгдлүүд нь 
		массивт оруулах төхөөрөмжүүд юм. Төхөөрөмж бүрийн хувьд бүрэн 
		гүйцэд замын нэрийг ашиглах хэрэгтэй.</para>
            </callout>
          </calloutlist>


	  <para>&man.ccdconfig.8;-г ажиллуулсны дараа &man.ccd.4; тохируулагдана.
		Файлын систем суулгагдаж болно. Тохируулгуудын талаар &man.newfs.8;-с 
		лавлана уу, эсвэл ердөө л ингэж ажиллуулна: </para>

	  <programlisting>newfs /dev/ccd0c</programlisting>


	</sect4>

	<sect4 id="ccd-auto">
	  <title>Бүгдийг автомат болгох нь</title>

	  <para>Ерөнхийдөө та &man.ccd.4;-г дахин ачаалах бүртээ холбохыг хүснэ. 
		Үүнийг хийхийн тулд та эхлээд тохируулах хэрэгтэй. Өөрийн одоогийн 
		тохиргоогоо дараах тушаал ашиглаж <filename>/etc/ccd.conf</filename> 
		уруу бичих хэрэгтэй:</para>

	  <programlisting>ccdconfig -g &gt; /etc/ccd.conf</programlisting>

	  <para>Дахин ачаалах үед скрипт <command>/etc/rc</command> нь 
		хэрэв <filename>/etc/ccd.conf</filename> байвал 
		<command>ccdconfig -C</command> тушаалыг ажиллуулна. 
		Энэ нь &man.ccd.4;-г холбож болохоор болгож 
		автоматаар тохируулна.</para>

	  <note><para>Хэрэв та ганц хэрэглэгчийн горим уруу ачаалж байгаа бол 
		&man.ccd.4;-г &man.mount.8; хийхээсээ өмнө массивыг 
		тохируулахын тулд дараах тушаалыг ажиллуулах 
		шаардлагатай:</para>

	  <programlisting>ccdconfig -C</programlisting>
          </note>

	  <para>&man.ccd.4;-г автоматаар холбохын тулд &man.ccd.4;-н оруулгыг 
		<filename>/etc/fstab</filename> файлд байрлуулах хэрэгтэй. Ингэсэн 
		тохиолдолд энэ нь ачаалах үед холбогдох болно:</para>

	  <programlisting>/dev/ccd0c              /media       ufs     rw      2       2</programlisting>
	</sect4>
      </sect3>

      <sect3 id="vinum">
	<title>Vinum Эзлэхүүн Менежер</title>

<indexterm><primary>RAID</primary><secondary>програм хангамж</secondary></indexterm>
<indexterm>
  <primary>RAID</primary>
  <secondary>Vinum</secondary>
</indexterm>

	<para>Vinum Эзлэхүүн Менежер нь виртуал диск хөтчийг хийдэг блок төхөөрөмжийн драйвер 
		юм. Энэ нь дискний тоног төхөөрөмжийг блок төхөөрөмжийн интерфэйсээс 
		тусгаарлаж уян хатан байдал, ажиллагаа болон найдвартай байдлыг дискний 
		хадгалалтын уламжлалт зүсмэлийн харагдалтаас илүүтэйгээр хангах тийм аргаар 
		өгөгдлийг дүрсэлдэг. &man.vinum.4; нь RAID-0, RAID-1 болон RAID-5 
		загваруудыг тус бүрт нь болон холбоотой байдлаар нь шийддэг.</para>

	<para>&man.vinum.4;-ийн талаар дэлгэрэнгүй мэдээллийг 
		<xref linkend="vinum-vinum">-с үзнэ үү.</para>
      </sect3>
    </sect2>

    <sect2 id="raid-hard">
      <title>Тоног төхөөрөмжийн RAID</title>

      <indexterm>
	<primary>RAID</primary>
	<secondary>тоног төхөөрөмж</secondary>
      </indexterm>

      <para>FreeBSD нь бас төрөл бүрийн тоног төхөөрөмжийн <acronym>RAID</acronym> 
	хянагчуудыг дэмждэг. Эдгээр төхөөрөмжүүд нь FreeBSD-д зориулсан тусгай програм 
	хангамжаар массивыг удирдах шаардлагагүйгээр <acronym>RAID</acronym> дэд 
	системийг хянадаг.</para>

      <para>Карт дээрх <acronym>BIOS</acronym>-г ашиглан карт нь дискний үйлдлүүдийн 
	ихэнхийг өөрөө хянадаг. Дараах нь Promise <acronym>IDE</acronym> <acronym>RAID</acronym> 
	хянагчийг ашиглах тохиргооны товч тайлбар юм. Энэ карт суулгагдаж систем эхлэх үед 
	мэдээллийг хүсэх мөрийг харуулна. Картны тохиргооны дэлгэц уруу орохын тулд
	заавруудыг дагана. Эндээс залгагдсан бүх хөтчүүдийг нэгтгэх боломж танд байх 
	болно. Ингэж хийснийхээ дараа диск(нүүд) нь FreeBSD-д нэг хөтөч шиг харагдах 
	болно. Бусад <acronym>RAID</acronym> түвшингүүдийг бас 
	тохируулж болно.
      </para>
    </sect2>

    <sect2>
      <title>ATA RAID1 массивуудыг дахин бүтээх нь</title>

      <para>FreeBSD нь массив дахь гэмтсэн, ажиллагаагүй болсон дискийг шууд солих боломжийг 
	олгодог. Энэ нь дахин ачаалахаасаа өмнө таныг ийм асуудлыг мэдэхийг шаарддаг.</para>

      <para>Та магадгүй доор дурдсантай адилыг <filename>/var/log/messages</filename> эсвэл 
	&man.dmesg.8; гаралт дээр харж болох юм:</para>

      <programlisting>ad6 on monster1 suffered a hard error.
ad6: READ command timeout tag=0 serv=0 - resetting
ad6: trying fallback to PIO mode
ata3: resetting devices .. done
ad6: hard error reading fsbn 1116119 of 0-7 (ad6 bn 1116119; cn 1107 tn 4 sn 11)\\
status=59 error=40
ar0: WARNING - mirror lost</programlisting>

      <para>&man.atacontrol.8; ашиглан дэлгэрэнгүй мэдээллийг шалгана:</para>

      <screen>&prompt.root; <userinput>atacontrol list</userinput>
ATA channel 0:
	Master:      no device present
	Slave:   acd0 &lt;HL-DT-ST CD-ROM GCR-8520B/1.00&gt; ATA/ATAPI rev 0

ATA channel 1:
	Master:      no device present
	Slave:       no device present

ATA channel 2:
	Master:  ad4 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

ATA channel 3:
	Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
	Slave:       no device present

&prompt.root; <userinput>atacontrol status ar0</userinput>
ar0: ATA RAID1 subdisks: ad4 ad6 status: DEGRADED</screen>

      <procedure>
	<step>
	  <para>Та дискийг аюулгүйгээр салган авахын тулд эхлээд ata сувгийг 
		ажиллахгүй байгаа дисктэй цуг салгана:</para>

	  <screen>&prompt.root; <userinput>atacontrol detach ata3</userinput></screen>
	</step>

	<step>
	  <para>Дискийг сольно.</para>
	</step>

	<step>
	  <para>ata сувгийг дахин залгана:</para>

	  <screen>&prompt.root; <userinput>atacontrol attach ata3</userinput>
Master:  ad6 &lt;MAXTOR 6L080J4/A93.0500&gt; ATA/ATAPI rev 5
Slave:   no device present</screen>
	</step>

	<step>
	  <para>Шинэ дискийг массивт нөөц маягаар нэмнэ:</para>

	  <screen>&prompt.root; <userinput>atacontrol addspare ar0 ad6</userinput></screen>
	</step>

	<step>
	  <para>Массивыг дахин бүтээнэ:</para>

	  <screen>&prompt.root; <userinput>atacontrol rebuild ar0</userinput></screen>
	</step>

	<step>
	  <para>Дараах тушаалыг ашиглаж үйл явцыг шалгаж болно:</para>

	  <screen>&prompt.root; <userinput>dmesg | tail -10</userinput>
[output removed]
ad6: removed from configuration
ad6: deleted from ar0 disk1
ad6: inserted into ar0 disk1 as spare

&prompt.root; <userinput>atacontrol status ar0</userinput>
ar0: ATA RAID1 subdisks: ad4 ad6 status: REBUILDING 0% completed</screen>
	</step>

	<step>
	  <para>Энэ үйлдэл хийгдэж дуустал хүлээх хэрэгтэй.</para>
	</step>
      </procedure>
    </sect2>
  </sect1>

  <sect1 id="usb-disks">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Марк</firstname>
	  <surname>Фонвил</surname>
	  <contrib>Хувь нэмэр болгон оруулсан </contrib>
	</author>
      </authorgroup>
      <!-- Jul 2004 -->
    </sect1info>

    <title>USB хадгалалтын төхөөрөмжүүд</title>
    <indexterm>
      <primary>USB</primary>
      <secondary>дискнүүд</secondary>
    </indexterm>

    <para>Одоо үед маш олон гадаад хадгалалтын шийдлүүд байгаа бөгөөд 
	Universal Serial Bus (USB): хатуу хөтчүүд, USB хуруун хөтчүүд, 
	CD-R шарагчид зэргийг ашигладаг. &os; нь эдгээр төхөөрөмжүүдийн 
	дэмжлэгийг хангадаг.</para>

    <sect2>
      <title>Тохиргоо</title>

      <para>USB бөөн хадгалалтын төхөөрөмжүүдийн драйвер &man.umass.4; нь 
	USB хадгалалтын төхөөрөмжүүдийн дэмжлэгийг хангадаг. Хэрэв та 
	<filename>GENERIC</filename> цөм ашиглавал өөрийн тохиргоондоо юу 
	ч өөрчлөх шаардлагагүй. Хэрэв та өөрчлөн тохируулсан цөм ашиглах бол 
	таны цөмийн тохиргооны файлд дараах мөрүүд байгаа эсэхийг 
	шалгаарай:</para>

      <programlisting>device scbus
device da
device pass
device uhci
device ohci
device ehci
device usb
device umass</programlisting>

      <para>&man.umass.4; драйвер нь USB хадгалалтын төхөөрөмжүүдэд хандахын 
	тулд SCSI дэд системийг хэрэглэдэг бөгөөд таны USB төхөөрөмж системд 
	SCSI төхөөрөмж маягаар харагдах болно. Таны эх хавтан дээрх USB бичил 
	схемээс хамаарч USB 1.X-ийн дэмжлэгийн хувьд танд зөвхөн <literal>device
	uhci</literal> эсвэл <literal>device ohci</literal> хоёрын аль нэг 
	хэрэгтэй болно, гэхдээ хоёуланг нь цөмийн тохиргоондоо байлгах нь гэмгүй юм. 
	USB 2.0 хянагчуудад зориулсан дэмжлэгийг &man.ehci.4; драйвер 
	(<literal>device ehci</literal> мөр) хангадаг. 
	Хэрэв та ямар нэг мөр нэмсэн бол шинэ цөмөө эмхэтгэж суулгахаа битгий 
	мартаарай.</para>

      <note>
	<para>Хэрэв таны USB төхөөрөмж чинь CD-R эсвэл DVD шарагч бол 
	SCSI CD-ROM драйвер &man.cd.4;-г цөмд дараах мөрийн тусламжтай 
	нэмэх ёстой:</para>

	<programlisting>device cd</programlisting>

	<para>Шарагч нь SCSI хөтөч гэж харагддаг учир &man.atapicam.4; 
	драйверийг цөмийн тохиргоонд ашиглах ёсгүй.</para>
      </note>
    </sect2>

    <sect2>
      <title>Тохиргоог тест хийх нь</title>

      <para>Тохиргоог тест хийхэд бэлэн боллоо: өөрийн USB төхөөрөмжийг залгахад 
	системийн мэдэгдлийн буферт (&man.dmesg.8;) хөтөч нь иймэрхүү 
	харагдах ёстой:</para>

      <screen>umass0: USB Solid state disk, rev 1.10/1.00, addr 2
GEOM: create disk da0 dp=0xc2d74850
da0 at umass-sim0 bus 0 target 0 lun 0
da0: &lt;Generic Traveling Disk 1.11&gt; Removable Direct Access SCSI-2 device
da0: 1.000MB/s transfers
da0: 126MB (258048 512 byte sectors: 64H 32S/T 126C)</screen>

      <para>Мэдээж хэрэг үйлдвэрлэгч, төхөөрөмжийн цэг (<devicename>da0</devicename>) 
	болон бусад зүйлс таны тохиргооноос хамаараад өөр байж болно.</para>

      <para>USB төхөөрөмж нь SCSI төхөөрөмж гэж харагддаг болохоор 
	<command>camcontrol</command> тушаалыг ашиглаж системд холбогдсон 
	USB хадгалалтын төхөөрөмжүүдийн жагсаалтыг харуулж болно:</para>

      <screen>&prompt.root; <userinput>camcontrol devlist</userinput>
&lt;Generic Traveling Disk 1.11&gt;      at scbus0 target 0 lun 0 (da0,pass0)</screen>

      <para>Хэрэв хөтөч нь файлын системтэй ирвэл та түүнийг холбож чадна. 
	<xref linkend="disks-adding"> хэсэг нь хэрэв шаардлагатай бол 
	USB хөтчийг хэлбэршүүлж түүн дээр хуваалт үүсгэхэд танд туслах 
	болно.</para>

      <warning>
        <para>Дурын төхөөрөмжийг итгэлгүй хэрэглэгчдэд холбох боломжийг 
	  олгох нь өөрөөр хэлбэл <literal>vfs.usermount</literal>-ийг доор 
	  тайлбарласнаар идэвхжүүлэх нь аюулгүй байдлын үүднээс авч үзвэл 
	  аюултай юм. &os; дээрх ихэнх файлын систем нь хортой төхөөрөмжийн 
	  эсрэг хамгаалалтгүй байдаг.</para>
      </warning>

      <para>Энэ төхөөрөмжийг энгийн хэрэглэгч холбож чаддагаар болгохын тулд 
	тодорхой алхмуудыг хийх хэрэгтэй. Эхлээд USB хадгалалтын төхөөрөмж 
	холбогдсон үед үүссэн төхөөрөмжүүдэд хэрэглэгч хандаж болохоор байх 
	хэрэгтэй. Үүний шийдэл нь эдгээр төхөөрөмжүүдийн бүх хэрэглэгчдийг 
	<groupname>operator</groupname> бүлгийн гишүүн болгох явдал 
	юм. Үүнийг &man.pw.8;-ээр хийнэ. Хоёрдугаарт төхөөрөмжүүд нь 
	үүсэх үед <groupname>operator</groupname> бүлэг тэдгээрийг 
	уншиж бичиж чадаж байх ёстой. Тохирох мөрүүдийг 
	<filename>/etc/devfs.rules</filename> файлд 
	нэмснээр үүнийг хийж болно:</para>

      <programlisting>[localrules=5]
add path 'da*' mode 0660 group operator</programlisting>

      <note>
	<para>Хэрэв системд SCSI дискнүүд байгаа бол үүнийг арай өөрөөр хийх 
	ёстой. Өөрөөр хэлбэл хэрэв систем нь аль хэдийн <devicename>da0</devicename>-ээс
	  <devicename>da2</devicename> хүртэлх холбогдсон дискнүүдийг 
	агуулж байвал хоёр дахь мөрийг дараах маягаар солих хэрэгтэй:</para>

	<programlisting>add path 'da[3-9]*' mode 0660 group operator</programlisting>

	<para>Энэ нь байгаа дискнүүдийг <groupname>operator</groupname> 
	бүлэгт хамааруулахгүй болгоно.</para>
      </note>

       <para>Та бас өөрийн &man.devfs.rules.5; дүрмийн олонлогийг 
		<filename>/etc/rc.conf</filename> файлд идэвхжүүлэх 
		хэрэгтэй:</para>
	 
       <programlisting>devfs_system_ruleset="localrules"</programlisting>

      <para>Дараа нь цөм нь ердийн хэрэглэгчдэд файлын системийг холбох боломжтойгоор 
	тохируулагдах ёстой. Хамгийн хялбар арга бол <filename>/etc/sysctl.conf</filename>-д
	мөр нэмэх явдал юм:</para>

      <programlisting>vfs.usermount=1</programlisting>

      <para>Дараагийн дахин ачаалалтын дараа энэ нь идэвхжихийг санаарай. 
	Өөрөөр энэ хувьсагчийг тохируулахын тулд &man.sysctl.8;-г ашиглаж 
	болох юм.</para>

      <para>Төгсгөлийн алхам нь файлын систем холбогдох санг үүсгэх явдал юм. 
	Энэ санг файлын системийг холбох хэрэглэгч эзэмшсэн байх хэрэгтэй. 
	Үүнийг хийх нэг арга нь <username>root</username>-ийн хувьд 
	тэр хэрэглэгчийн эзэмшсэн дэд санг 
	<filename>/mnt/<replaceable>username</replaceable></filename> 
	(<replaceable>username</replaceable>-г тухайн хэрэглэгчийнхээ нэвтрэх 
	нэрээр болон <replaceable>usergroup</replaceable>-г хэрэглэгчийнхээ үндсэн  
	бүлгийн нэрээр солиорой) гэж үүсгэх явдал юм:</para>

      <screen>&prompt.root; <userinput>mkdir /mnt/<replaceable>username</replaceable></userinput>
&prompt.root; <userinput>chown <replaceable>username</replaceable>:<replaceable>usergroup</replaceable> /mnt/<replaceable>username</replaceable></userinput></screen>

      <para>USB хуруун хөтөч залгагдаж  <filename>/dev/da0s1</filename> төхөөрөмж 
	гарч иржээ гэж бодъё. Эдгээр төхөөрөмжүүд нь ихэвчлэн FAT файлын системээр 
	хэлбэршүүлэгдсэн ирдэг бөгөөд эдгээрийг иймэрхүү маягаар холбож 
	болно:</para>

      <screen>&prompt.user; <userinput>mount -t msdosfs -m=644 -M=755 /dev/da0s1 /mnt/<replaceable>username</replaceable></userinput></screen>

      <para>Хэрэв та төхөөрөмжийг залгаснаа салгавал (дискийг урьдаар салгах ёстой)
	та системийн мэдэгдлийн буфераас доор дурдсантай төстэй мэдэгдлийг 
	харах ёстой:</para>

      <screen>umass0: at uhub0 port 1 (addr 2) disconnected
(da0:umass-sim0:0:0:0): lost device
(da0:umass-sim0:0:0:0): removing device entry
GEOM: destroy disk da0 dp=0xc2d74850
umass0: detached</screen>
    </sect2>

    <sect2>
      <title>Нэмэлт унших материалууд</title>

      <para><link linkend="disks-adding">Диск нэмэх</link> болон 
	<link linkend="mount-unmount">Файлын системүүдийг холбох болон салгах</link> 
	хэсгүүдээс гадна төрөл бүрийн гарын авлагын хуудаснуудыг унших нь хэрэгтэй 
	байж болох юм: &os;&nbsp; 8.X-ийн хувьд &man.umass.4;, &man.camcontrol.8;, болон &man.usbconfig.8;
	эсвэл &os;-ийн өмнөх хувилбаруудын хувьд &man.usbdevs.8; байна.</para>
    </sect2>
  </sect1>

  <sect1 id="creating-cds">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Майк</firstname>
	  <surname>Мэйэр</surname>
	  <contrib>Хувь нэмэр болгон оруулсан </contrib>
	  <!-- mwm@mired.org -->
	</author>
      </authorgroup>
      <!-- Apr 2001 -->
    </sect1info>

    <title>Оптик зөөвөрлөгчийг (CD-үүд) үүсгэж ашиглах нь</title>
    <indexterm>
      <primary>CDROM-ууд</primary>
      <secondary>үүсгэх нь</secondary>
    </indexterm>

    <sect2>
      <title>Танилцуулга</title>

      <para>CD-үүд нь тэдгээрийг ердийн дискнүүдээс ялгах хэд хэдэн боломжуудтай 
	байдаг. Эхлээд хэрэглэгч CD дээр бичих боломжгүй байсан. Тэдгээр нь 
	замуудын хооронд толгойг шилжүүлэхдээ сааталгүйгээр үргэлжлэн уншдагаар 
	хийгджээ. Тэр үед байсан адил хэмжээтэй зөөвөрлөгчийг зөөхөөс тэдгээрийг 
	систем хооронд зөөх нь хамаагүй хялбар байдаг.</para>

      <para>CD-үүд нь замтай байдаг боловч энэ нь дискний физик хэсэг биш харин 
	үргэлжлэн уншигдах өгөгдлийн хэсгийг хэлдэг. FreeBSD дээр CD үүсгэхдээ 
	CD дээр замууд үүсгэх өгөгдлийн файлуудыг бэлдэж дараа нь замуудыг CD 
	уруу бичнэ.</para>

      <indexterm><primary>ISO 9660</primary></indexterm>
      <indexterm>
        <primary>файлын системүүд</primary>
        <secondary>ISO 9660</secondary>
      </indexterm>
      <para>ISO 9660 файлын систем нь эдгээр ялгаануудтай ажиллахаар хийгдсэн. 
	Энэ нь тэр үед нийтлэг байсан файлын системийн хязгааруудыг харамсалтай нь 
	кодчилдог. Азаар энэ нь зөв бичигдсэн CD-үүдэд тэдгээр хязгааруудыг давж гарахыг 
	зөвшөөрөх өргөтгөлөөр хангадаг бөгөөд тэдгээр өргөтгөлүүдийг дэмждэггүй системүүдтэй 
	ажиллаж чадсан хэвээр байдаг.</para>

      <indexterm>
        <primary><filename role="package">sysutils/cdrtools</filename></primary>
      </indexterm>
      <para><filename role="package">sysutils/cdrtools</filename> 
	портод ISO 9660 файлын системийг агуулах өгөгдлийн файлыг үүсгэдэг програм 
	&man.mkisofs.8; байдаг. Энэ нь төрөл бүрийн өргөтгөлүүдийг дэмждэг 
	тохируулгуудтай бөгөөд доор тайлбарлагдсан болно.</para>

      <indexterm>
        <primary>CD шарагч</primary>
        <secondary>ATAPI</secondary>
      </indexterm>
      <para>CD шарахдаа ямар хэрэгслийг ашиглах нь таны CD шарагч ATAPI юу аль эсвэл өөр үү 
	гэдгээс шалтгаална. ATAPI CD шарагчид нь үндсэн системийн <command><link
	linkend="burncd">burncd</link></command> програмыг ашигладаг. 
	SCSI болон USB CD шарагчид нь <filename role="package">sysutils/cdrtools</filename> 
	портын <command><link linkend="cdrecord">cdrecord</link></command>-г 
	ашиглах ёстой. Мөн ATAPI тоног төхөөрөмж дээр SCSI хөтчүүдийн хувьд 
	<link linkend="atapicam">ATAPI/CAM модул</link> ашиглан 
	<command><link linkend="cdrecord">cdrecord</link></command>-г 
	хэрэглэх боломжтой байдаг.</para>

      <para>Хэрэв та график хэрэглэгчийн интерфэйстэй CD шарагч програм хангамжийг 
	хүсэж байгаа бол <application>X-CD-Roast</application> эсвэл 
	<application>K3b</application>-г үзээрэй. Эдгээр хэрэгслүүд нь 
	багц хэлбэрээр эсвэл <filename
	role="package">sysutils/xcdroast</filename> болон <filename
	role="package">sysutils/k3b</filename> портуудад байдаг. 
	<application>X-CD-Roast</application> болон
	<application>K3b</application> нь ATAPI тоног төхөөрөмж дээр 
	<link linkend="atapicam">ATAPI/CAM модул</link>ийг шаарддаг.</para>
    </sect2>

    <sect2 id="mkisofs">
      <title>mkisofs</title>

      <para><filename role="package">sysutils/cdrtools</filename> портын 
	хэсэг &man.mkisofs.8; програм нь &unix;-ийн файлын системийн нэрийн талбар 
	дахь сангийн модны дүрс болох ISO 9660 файлын системийг үүсгэдэг.
	Хамгийн хялбар хэрэглээ нь:</para>

      <screen>&prompt.root; <userinput>mkisofs -o <replaceable>imagefile.iso</replaceable> <replaceable>/path/to/tree</replaceable></userinput></screen>

      <indexterm>
        <primary>файлын системүүд</primary>
        <secondary>ISO 9660</secondary>
      </indexterm>
      <para>Энэ тушаал нь <replaceable>/path/to/tree</replaceable> дахь 
	модны хуулбар ISO 9660 файлын системийг агуулах 
	<replaceable>imagefile.iso</replaceable> файлыг үүсгэх болно. 
	Энэ процессод файлын нэрсийг ISO 9660 файлын системийн стандартын 
	хязгаарлалтуудад багтах нэрсэд тааруулах бөгөөд ISO файлын системүүдэд 
	байдаггүй нэрс бүхий файлуудыг оруулахгүй байх болно.</para>

      <indexterm>
        <primary>файлын системүүд</primary>
        <secondary>HFS</secondary>
      </indexterm>
      <indexterm>
        <primary>файлын системүүд</primary>
        <secondary>Joliet</secondary>
      </indexterm>
      <para>Тэдгээр хязгаарлалтуудыг давж гарах хэд хэдэн тохируулгууд байдаг. 
	Ялангуяа <option>-R</option> тохируулга &unix; системүүдэд 
	нийтлэг байдаг Rock Ridge өргөтгөлүүдийг идэвхжүүлдэг, <option>-J</option> 
	нь Microsoft системүүдэд хэрэглэгддэг Joilet өргөтгөлүүдийг идэвхжүүлдэг 
	бөгөөд <option>-hfs</option> нь &macos;-д хэрэглэгддэг HFS файлын 
	системүүдийг үүсгэхэд ашиглагддаг.</para>

      <para>Зөвхөн FreeBSD системүүдэд ашиглагдах CD-үүдийн хувьд <option>-U</option> 
	тохируулга бүх файлын нэрийн хязгаарлалтуудыг хаахад ашиглагдаж болно. 
	<option>-R</option> тохируулгатай хэрэглэгдэх үед энэ нь таны эхэлсэн 
	FreeBSD-ийн модтой ижил файлын системийн дүрсийг үүсгэдэг, гэхдээ энэ нь 
	ISO 9660 стандартыг хэд хэдэн замаар зөрчиж болох юм.</para>

      <indexterm>
        <primary>CDROM-ууд</primary>
        <secondary>ачаалагддаг үүсгэх</secondary>
      </indexterm>
      <para>Ердийн хэрэглээний сүүлийн тохируулга нь <option>-b</option> юм. 
	Энэ нь ачаалагдах <quote>El Torito</quote> CD-г үүсгэхэд хэрэглэгдэх 
	ачаалагдах дүрсний байрлалыг заахад ашиглагддаг. Энэ тохируулга нь 
	CD уруу бичигдэх модны дээд хэсгийн ачаалагдах дүрс хүрэх замыг заах 
	нэмэлт өгөгдлийг авдаг. Анхдагчаар &man.mkisofs.8; нь 
	<quote>floppy disk emulation буюу уян дискний эмуляц</quote> гэж 
	нэрлэгддэг горимд ISO дүрсийг  үүсгэдэг бөгөөд ачаалагдах дүрсийг яг 
	1200, 1440, эсвэл 2880&nbsp;KB хэмжээтэй байна гэж тооцдог. 
	FreeBSD түгээлтийн дискнүүдэд хэрэглэгддэг ачаалагч дуудагч зэрэг зарим 
	ачаалагч дуудагчид нь эмуляц горимыг ашигладаггүй; энэ тохиолдолд 
	<option>-no-emul-boot</option> тохируулгыг ашиглах шаардлагатай. 
	Тэгэхээр хэрэв <filename>/tmp/myboot</filename> нь ачаалагдах 
	FreeBSD системийг <filename>/tmp/myboot/boot/cdboot</filename> 
	дэх ачаалагдах дүрстэй цуг агуулж байвал та ISO 9660 файлын системийн 
	дүрсийг  <filename>/tmp/bootable.iso</filename>-д иймэрхүү 
	маягаар үүсгэж болох юм:</para>

      <screen>&prompt.root; <userinput>mkisofs -R -no-emul-boot -b boot/cdboot -o /tmp/bootable.iso /tmp/myboot</userinput></screen>

      <para>Үүнийг хийснийхээ дараа хэрэв та цөмдөө <devicename>md</devicename>-г 
	тохируулсан бол файлын системийг ингэж холбож болно:</para>

      <screen>&prompt.root; <userinput>mdconfig -a -t vnode -f /tmp/bootable.iso -u 0</userinput>
&prompt.root; <userinput>mount -t cd9660 /dev/md0 /mnt</userinput></screen>

      <para>Энэ үед та <filename>/mnt</filename> болон 
	<filename>/tmp/myboot</filename> нь ижил болохыг шалгаж болно.</para>

      <para>&man.mkisofs.8;-ийн ажиллагааг нарийн тааруулахын тулд та түүний 
	бусад олон тохируулгуудыг ашиглаж болно. Ялангуяа ISO 9660-ийн байрлал 
	болон Joilet ба HFS дискнүүдийн үүсгэлтэд өөрчлөлтүүд хийж болно. 
	Дэлгэрэнгүйг &man.mkisofs.8;-ийн гарын авлагын хуудаснаас үзнэ үү.</para>
    </sect2>

    <sect2 id="burncd">
      <title>burncd</title>
      <indexterm>
        <primary>CDROM-ууд</primary>
        <secondary>шарах</secondary>
      </indexterm>
      <para>Хэрэв танд ATAPI CD шарагч байгаа бол та ISO дүрсийг CD уруу шарахдаа 
	<command>burncd</command> тушаалыг ашиглаж болно. 
	<command>burncd</command> нь үндсэн системийн хэсэг бөгөөд 
	<filename>/usr/sbin/burncd</filename> гэж суулгагдсан байдаг. Энэ нь 
	цөөн тохируулгуудтай болохоор хэрэглэхэд их хялбар байдаг:</para>

      <screen>&prompt.root; <userinput>burncd -f <replaceable>cddevice</replaceable> data <replaceable>imagefile.iso</replaceable> fixate</userinput></screen>

      <para>Дээрх тушаал нь <replaceable>imagefile.iso</replaceable>-н 
	хуулбарыг <replaceable>cddevice</replaceable> уруу шарах болно. 
	Анхдагч төхөөрөмж нь <filename>/dev/acd0</filename> юм. 
	Бичих хурд, шарсны дараа CD-г гаргах болон аудио өгөгдөл бичихийг заах 
	тохируулгуудын талаар &man.burncd.8;-с үзнэ үү.</para>
    </sect2>

    <sect2 id="cdrecord">
      <title>cdrecord</title>

      <para>Хэрэв танд ATAPI CD шарагч байхгүй бол та өөрийн CD-үүдийг шарахын 
	тулд <command>cdrecord</command>-г ашиглах шаардлагатай. 
	<command>cdrecord</command> нь үндсэн системд байдаггүй; та үүнийг 
	<filename role="package">sysutils/cdrtools</filename> дахь 
	портоос эсвэл тохирох багцаас суулгах ёстой. Үндсэн системд хийгдсэн 
	өөрчлөлт нь энэ програмын хоёртын хувилбарыг ажиллахгүй болгож, магадгүй 
	<quote>асуудалд (coaster)</quote> хүргэж болох юм. 
	Тийм болохоор та өөрийн системээ шинэчлэхдээ портоо бас шинэчлэх эсвэл хэрэв 
	та <link linkend="stable">-STABLE салбарыг дагаж</link> байгаа бол 
	портыг шинэ хувилбар гарахад нь шинэчлэх хэрэгтэй.</para>

      <para><command>cdrecord</command> нь олон тохируулгатай байдаг боловч 
	үндсэн хэрэглээ нь <command>burncd</command>-с бүр илүү хялбар байдаг. 
	ISO 9660 дүрсийг шарахдаа:</para>

      <screen>&prompt.root; <userinput>cdrecord dev=<replaceable>device</replaceable> <replaceable>imagefile.iso</replaceable></userinput></screen>

      <para><command>cdrecord</command>-г хэрэглэхэд гардаг нэг заль нь 
	<option>dev</option> тохируулгыг олох явдал юм. Зөв тохиргоог олохын 
	тулд <command>cdrecord</command>-ийн <option>-scanbus</option> 
	тугийг хэрэглэх хэрэгтэй бөгөөд энэ нь иймэрхүү үр дүнд хүргэж болох юм:</para>
      <indexterm>
        <primary>CDROM-ууд</primary>
        <secondary>шарах</secondary>
      </indexterm>
      <screen>&prompt.root; <userinput>cdrecord -scanbus</userinput>
Cdrecord-Clone 2.01 (i386-unknown-freebsd7.0) Copyright (C) 1995-2004 J&ouml;rg Schilling
Using libscg version 'schily-0.1'
scsibus0:
        0,0,0     0) 'SEAGATE ' 'ST39236LW       ' '0004' Disk
        0,1,0     1) 'SEAGATE ' 'ST39173W        ' '5958' Disk
        0,2,0     2) *
        0,3,0     3) 'iomega  ' 'jaz 1GB         ' 'J.86' Removable Disk
        0,4,0     4) 'NEC     ' 'CD-ROM DRIVE:466' '1.26' Removable CD-ROM
        0,5,0     5) *
        0,6,0     6) *
        0,7,0     7) *
scsibus1:
        1,0,0   100) *
        1,1,0   101) *
        1,2,0   102) *
        1,3,0   103) *
        1,4,0   104) *
        1,5,0   105) 'YAMAHA  ' 'CRW4260         ' '1.0q' Removable CD-ROM
        1,6,0   106) 'ARTEC   ' 'AM12S           ' '1.06' Scanner
        1,7,0   107) *</screen>

      <para>Энэ нь жагсаалтан дахь төхөөрөмжүүдийн хувьд тохирох <option>dev</option> утгыг 
	жагсаадаг. Өөрийн CD шарагчийг олохын тулд <option>dev</option> тохируулгын 
	утгад гурван дугаарыг таслалаар тусгаарлан хэрэглэнэ. Энэ тохиолдолд CRW төхөөрөмж 
	нь 1,5,0, байх бөгөөд тохирох оролт нь <option>dev=1,5,0</option> болно. 
	Энэ утгыг заах амархан аргууд байдаг; дэлгэрэнгүйг &man.cdrecord.1;-с үзнэ үү. 
	Мөн тэндээс аудио замуудыг бичих, хурдыг хянах болон бусад зүйлүүдийн тухай 
	мэдээллийг үзэж болно.</para>
    </sect2>

    <sect2 id="duplicating-audiocds">
      <title>Аудио CD-үүдийг хувилах</title>

      <para>Та аудио өгөгдлийг CD-ээс файлуудын цуваа болгон задалж дараа нь эдгээр 
	файлуудыг хоосон CD дээр бичин аудио CD-г хувилж болно. Энэ процесс нь ATAPI болон 
	SCSI хөтчүүдийн хувьд нэлээн өөр байдаг.</para>

      <procedure>
	<title>SCSI хөтчүүд</title>

	<step>
	  <para>Аудиог <command>cdda2wav</command> ашиглан задлана.</para>

	  <screen>&prompt.user; <userinput>cdda2wav -vall -D2,0 -B -Owav</userinput></screen>
	</step>

	<step>
	  <para><command>cdrecord</command> ашиглан <filename>.wav</filename> 
		файлуудыг бичнэ.</para>

	  <screen>&prompt.user; <userinput>cdrecord -v dev=<replaceable>2,0</replaceable> -dao -useinfo  *.wav</userinput></screen>

	  <para><xref linkend="cdrecord"> хэсэгт тайлбарласны дагуу 
		<replaceable>2,0</replaceable> гэж зөв заагдсан эсэхийг 
		шалгаарай.</para>
	</step>
      </procedure>

      <procedure>
	<title>ATAPI хөтчүүд</title>

        <note>
          <para><link
            linkend="atapicam">ATAPI/CAM модулийн</link> тусламжтай
	    <command>cdda2wav</command> тушаал ATAPI хөтчүүд дээр 
	    ашиглагдаж болно. Энэ хэрэгсэл нь доор санал болгож 
	    байгаа аргыг бодвол ихэнх хэрэглэгчдийн хувьд 
	    ихэвчлэн илүүтэй сонголт байдаг (доргио засварлалт, 
	    төгсгөгчийн асуудал гэх мэт).</para>
        </note>

	<step>
	  <para>ATAPI CD драйвер нь зам бүрийг 
		<filename>/dev/acd<replaceable>d</replaceable>t<replaceable>nn</replaceable></filename> 
		маягаар болгодог бөгөөд <replaceable>d</replaceable> нь хөтчийн 
		дугаар ба <replaceable>nn</replaceable> нь шаардлагатай бол урдаа 0 тавьж 
		хоёр оронтой тоогоор бичигдсэн замын дугаар юм. Тэгэхээр эхний диск дээрх 
		эхний зам нь <filename>/dev/acd0t01</filename>, хоёр дахь нь 
		<filename>/dev/acd0t02</filename>, гурав дахь нь 
		<filename>/dev/acd0t03</filename> гэх мэтчилэн байна.</para>

	  <para>Тохирох файлууд <filename>/dev</filename> санд байгаа эсэхийг 
		шалгаарай. Хэрэв оруулгууд байхгүй байгаа бол зөөвөрлөгчийг 
		дахин үзэхээр системийг хүчлэх хэрэгтэй:</para>

	  <screen>&prompt.root; <userinput>dd if=/dev/acd0 of=/dev/null count=1</userinput></screen>
	</step>

	<step>
	  <para>Зам бүрийг &man.dd.1; ашиглан задална. Файлуудыг задлахдаа 
		та тусгай блокийн хэмжээг бас ашиглах ёстой.</para>

	  <screen>&prompt.root; <userinput>dd if=/dev/acd0t01 of=track1.cdr bs=2352</userinput>
&prompt.root; <userinput>dd if=/dev/acd0t02 of=track2.cdr bs=2352</userinput>
...
</screen>
	</step>

	<step>
	  <para>Задалсан файлуудаа диск уруу <command>burncd</command> ашиглан 
		шарна. Та эдгээрийг аудио файл гэж зааж өгөх хэрэгтэй бөгөөд 
		<command>burncd</command> нь дуусахдаа дискийг бэхжүүлэх 
		ёстой.</para>

	  <screen>&prompt.root; <userinput>burncd -f <replaceable>/dev/acd0</replaceable> audio track1.cdr track2.cdr <replaceable>...</replaceable> fixate</userinput></screen>
	</step>
      </procedure>
    </sect2>

    <sect2 id="imaging-cd">
      <title>Өгөгдлийн CD-үүдийг хувилах</title>

      <para>Та өгөгдлийн CD-г &man.mkisofs.8;-р үүсгэсэн дүрс файлтай 
	ажиллагааны хувьд адилхан дүрс файл уруу хуулж болох бөгөөд та үүнийг 
	ямар ч өгөгдлийн CD хувилахад ашиглаж болно. Энд өгөгдсөн жишээ нь 
	таны CDROM төхөөрөмжийг <devicename>acd0</devicename> гэж 
	үзэх болно. Өөрийн зөв CDROM төхөөрөмжөөр солиорой.</para>

      <screen>&prompt.root; <userinput>dd if=/dev/acd0 of=file.iso bs=2048</userinput></screen>

      <para>Одоо та нэгэнт дүрстэй болсон болохоор үүнийг CD уруу дээр тайлбарласны 
	дагуу шарж болно.</para>
    </sect2>

    <sect2 id="mounting-cd">
      <title>Өгөгдлийн CD-үүдийг ашиглах</title>

      <para>Одоо та стандарт өгөгдлийн CDROM үүсгэсэн болохоор түүнийг 
	холбож түүн дээрх өгөгдлийг уншихыг хүсэх байх. Анхдагчаар 
	&man.mount.8; нь файлын системийг <literal>ufs</literal> 
	төрлийнх гэж үздэг. Хэрэв та доорх шиг оролдвол:</para>

      <screen>&prompt.root; <userinput>mount /dev/cd0 /mnt</userinput></screen>

      <para><errorname>Incorrect super block</errorname> гэж 
	гомдоллохыг та харах бөгөөд холболт хийгдэхгүй байх болно. CDROM нь 
	<literal>UFS</literal> файлын систем биш, тэгэхээр ингэж 
	холбохыг оролдох нь амжилтгүй болох болно. Та &man.mount.8;-д 
	файлын системийн төрөл нь <literal>ISO9660</literal> гэж 
	зааж өгөхөд л бүгд ажиллах болно. Та <option>-t cd9660</option> 
	тохируулгыг &man.mount.8;-д өгч үүнийг хийнэ. Жишээ нь хэрэв та 
	CDROM төхөөрөмж <filename>/dev/cd0</filename>-г 
	<filename>/mnt</filename>-д холбохыг хүсвэл дараах тушаалыг 
	ажиллуулах болно:</para>

          <screen>&prompt.root; <userinput>mount -t cd9660 /dev/cd0 /mnt</userinput></screen>

      <para>Таны төхөөрөмжийн нэр (энэ жишээн дээр <filename>/dev/cd0</filename>) 
	таны CDROM ямар интерфэйс ашиглаж байгаагаас хамааран өөр байж болох юм.  
	Мөн <option>-t cd9660</option> тохируулга нь ердөө л 
	&man.mount.cd9660.8;-г ажиллуулдаг. Дээрх жишээг ингэж богиносгож 
	болно:</para>

<screen>&prompt.root; <userinput>mount_cd9660 /dev/cd0 /mnt</userinput></screen>

      <para>Та ерөнхийдөө энэ аргаар ямар ч үйлдвэрлэгчийн өгөгдлийн CDROM-уудыг 
	ашиглаж болно. Гэхдээ зарим нэг ISO 9660 өргөтгөлүүдтэй дискнүүд хачин ажиллаж 
	болох юм. Жишээ нь Joilet дискнүүд нь бүх файлын нэрсийг хоёр байт Юникод 
	тэмдэгтээр хадгалдаг. FreeBSD цөм нь Юникодоор ярьдаггүй, гэхдээ 
	&os;-ийн CD9660 драйвер Юникод тэмдэгтүүдийг шууд хувиргаж чаддаг. 
	Хэрэв зарим нэг Англи бус тэмдэгтүүд асуултын тэмдэг хэлбэрээр харагдвал 
	та ашиглаж байгаа локал тэмдэгтийн олонлогоо <option>-C</option> 
	тохируулгаар зааж өгөх хэрэгтэй. Дэлгэрэнгүй мэдээллийг 
	&man.mount.cd9660.8; гарын авлагын хуудаснаас лавлана уу.</para>
	
      <note>
	<para>Энэ тэмдэгтийн хувиргалтыг <option>-C</option> тохируулгын 
	тусламжтай хийхийн тулд цөм <filename>cd9660_iconv.ko</filename> 
	модулийг дуудсан байхыг шаардах болно. Энэ мөрийг 
	<filename>loader.conf</filename> файлд нэмж үүнийг:</para>

	<programlisting>cd9660_iconv_load="YES"</programlisting>

	<para>гэж хийн машиныг дахин ачаалах буюу эсвэл модулийг &man.kldload.8;-н 
	тусламжтай дуудан хийж болох юм.</para>
      </note>

      <para>Хааяа таныг CDROM-г холбохыг оролдох үед <errorname>Device not
	configured</errorname> гэсэн алдаа гарч болох юм. Энэ нь ихэнхдээ 
	CDROM хөтөч нь төхөөрөмжид диск байхгүй эсвэл хөтөч нь шугаманд (bus) 
	харагдахгүй байна гэж үзэж байна гэсэн үг юм. CDROM хөтөч нь  
	хоёр секундын дотор үүнийг мэддэг болохоор тэвчээртэй байгаарай.</para>

      <para>Шугамын дахин тогтоолтод хариу өгөх хангалттай хугацаа байхгүйн улмаас 
	заримдаа SCSI CDROM-ийг олохгүй байж болох юм. Хэрэв та SCSI CDROM-той 
	бол та дараах тохируулгыг цөмийн тохиргоондоо нэмж 
	<link linkend="kernelconfig-building">өөрийн цөмийг дахин бүтээнэ үү</link>.</para>

      <programlisting>options SCSI_DELAY=15000</programlisting>

      <para>Энэ нь таны SCSI шугамд ачаалах үедээ 15 секунд түр саатахыг хэлж өгөх бөгөөд 
	ингэснээр шугамын дахин тогтоолтод таны CDROM хөтчөөр хариу өгүүлэхийн тулд 
	бүх байж болох боломжийг түүнд өгч байна гэсэн үг юм.</para>
    </sect2>

    <sect2 id="rawdata-cd">
      <title>Түүхий өгөгдлийн CD-үүдийг шарах</title>

      <para>Та ISO 9660 файлын системийг үүсгэлгүйгээр файлыг CD уруу шууд 
	шарахаар сонгож болно. Зарим хүмүүс үүнийг нөөцлөх зорилгоор хийдэг. 
	Энэ нь стандарт CD-г шарахаас илүү хурдан ажилладаг:</para>

      <screen>&prompt.root; <userinput>burncd -f /dev/acd1 -s 12 data archive.tar.gz fixate</userinput></screen>

      <para>Тийм CD-д шарагдсан өгөгдлийг авахын тулд та түүхий төхөөрөмжийн 
		цэгээс өгөгдлийг унших ёстой:</para>

      <screen>&prompt.root; <userinput>tar xzvf /dev/acd1</userinput></screen>

      <para>Та энэ дискийг ердийн CDROM-ийг холбодог шиг холбож чадахгүй. 
	Ийм CDROM нь FreeBSD-ээс өөр ямар ч үйлдлийн систем дээр уншигдахгүй. 
	Хэрэв та CD-гээ холбохыг эсвэл өөр үйлдлийн системтэй өгөгдлөө 
	хуваалцах хүсэлтэй байгаа бол дээр тайлбарласны дагуу &man.mkisofs.8;-г 
	ашиглах ёстой.</para>
    </sect2>

    <sect2 id="atapicam">
      <sect2info>
	<authorgroup>
	  <author>
	    <firstname>Марк</firstname>
	    <surname>Фонвил</surname>
	    <contrib>Хувь нэмэр болгон оруулсан </contrib>
	  </author>
	</authorgroup>
      </sect2info>

      <indexterm>
	<primary>CD шарагч</primary>
	<secondary>ATAPI/CAM драйвер</secondary>
      </indexterm>
      <title>ATAPI/CAM драйверийг ашиглах</title>

      <para>Энэ драйвер нь ATAPI төхөөрөмжүүдэд (CD-ROM, CD-RW, DVD
	хөтчүүд гэх мэт...) SCSI дэд системээр хандах боломжийг олгох 
	бөгөөд ингэснээр <filename role="package">sysutils/cdrdao</filename> 
	эсвэл &man.cdrecord.1; зэрэг програмуудыг ашиглах боломжийг 
	олгодог.</para>

      <para>Энэ драйверыг ашиглахын тулд та дараах мөрийг 
	<filename>/boot/loader.conf</filename> файл уруу нэмэх хэрэгтэй 
	болно:</para>

      <programlisting>atapicam_load="YES"</programlisting>

      <para>тэгээд өөрийн машинаа дахин ачаална.</para>

      <note>
	<para>Хэрэв та өөрийн цөмдөө &man.atapicam.4; дэмжлэгийг статикаар 
	эмхэтгэхийг хүсвэл энэ мөрийг өөрийн цөмийн тохиргооны файлдаа 
	нэмэх хэрэгтэй болно:</para>

      <programlisting>device atapicam</programlisting>

      <para>Мөн та өөрийн цөмийн тохиргооны файлдаа дараах мөрүүдийг бас нэмэх 
	хэрэгтэй болно:</para>

      <programlisting>device ata
device scbus
device cd
device pass</programlisting>

	<para>Эдгээр нь аль хэдийн байж байх ёстой. Дараа нь дахин бүтээгээд 
	өөрийн цөмийг суулгаж машинаа дахин ачаалах хэрэгтэй.</para>
      </note>

      <para>Ачаалах процессийн үед таны шарагч иймэрхүү маягаар гарч 
	ирэх ёстой:</para>

      <screen>acd0: CD-RW &lt;MATSHITA CD-RW/DVD-ROM UJDA740&gt; at ata1-master PIO4
cd0 at ata1 bus 0 target 0 lun 0
cd0: &lt;MATSHITA CDRW/DVD UJDA740 1.00&gt; Removable CD-ROM SCSI-0 device
cd0: 16.000MB/s transfers
cd0: Attempt to query device size failed: NOT READY, Medium not present - tray closed</screen>

      <para>Одоо хөтчид <filename>/dev/cd0</filename> төхөрөөмжийн нэрийг 
	ашиглан хандаж болох бөгөөд жишээ нь CD-ROM-г <filename>/mnt</filename>-д холбохдоо 
	дараах тушаалыг бичих хэрэгтэй:</para>

      <screen>&prompt.root; <userinput>mount -t cd9660 <replaceable>/dev/cd0</replaceable> /mnt</userinput></screen>

      <para><username>root</username> хэрэглэгчээр дараах тушаалыг ажиллуулж 
	та шарагчийн SCSI хаягийг авч  болно:</para>

      <screen>&prompt.root; <userinput>camcontrol devlist</userinput>
&lt;MATSHITA CDRW/DVD UJDA740 1.00&gt;   at scbus1 target 0 lun 0 (pass0,cd0)</screen>

      <para>Тэгэхээр <literal>1,0,0</literal> нь &man.cdrecord.1; 
	болон бусад SCSI програмтай ашиглах SCSI хаяг болох юм.</para>

      <para>ATAPI/CAM болон SCSI системийн талаар дэлгэрэнгүй мэдээллийг 
	&man.atapicam.4; болон &man.cam.4; гарын авлагын хуудаснуудаас 
	лавлана уу.</para>
    </sect2>
  </sect1>

  <sect1 id="creating-dvds">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Марк</firstname>
	  <surname>Фонвил</surname>
	  <contrib>Хувь нэмэр болгон оруулсан </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <firstname>Энди</firstname>
	  <surname>Поляков</surname>
	  <contrib>Зарим зүйл оруулсан </contrib>
	</author>
      </authorgroup>
      <!-- Feb 2004 -->
    </sect1info>

    <title>Оптик зөөвөрлөгчийг (DVD-үүд) үүсгэж ашиглах нь</title>
    <indexterm>
      <primary>DVD</primary>
      <secondary>шарах нь</secondary>
    </indexterm>

    <sect2>
      <title>Танилцуулга</title>

      <para>CD-тэй харьцуулахад DVD нь оптик зөөвөрлөгч хадгалалтын технологийн 
	дараачийн үе юм. DVD нь ямар ч CD-ээс илүү өгөгдлийг агуулдаг бөгөөд 
	одоогийн видео хэвлэлтийн стандарт болжээ.</para>

      <para>Бичигддэг DVD гэж бидний нэрлэдэг DVD-үүдийн физик 5 бичигддэг 
	хэлбэршүүлэлтийг тодорхойлж болно:</para>

      <itemizedlist>
	<listitem>
	  <para>DVD-R: Энэ нь бичигддэг DVD-ий анхны хэлбэршүүлэлт  юм. 
		DVD-R стандарт нь <ulink
	    url="http://www.dvdforum.com/forum.shtml">DVD хэлэлцүүлгээр</ulink> 
		тодорхойлогдсон бөгөөд энэ нь зөвхөн нэг удаа 
		бичих хэлбэршүүлэлт юм.</para>
	</listitem>

	<listitem>
	  <para>DVD-RW: Энэ нь DVD-R стандартын дахин бичигдэх хувилбар юм. 
		DVD-RW нь ойролцоогоор 1000 удаа бичигдэх боломжтой.</para>
	</listitem>

	<listitem>
	  <para>DVD-RAM: Энэ нь DVD хэлэлцүүлгийн дэмждэг бас дахин бичигддэг 
		хэлбэршүүлэлт юм. DVD-RAM нь зөөгдөж болох хатуу хөтөч маягаар 
		харагддаг. Гэхдээ энэ зөөвөрлөгч нь ихэнх DVD-ROM хөтчүүд болон 
		DVD-Видео тоглуулагчуудтай нийцтэй биш байдаг; цөөн DVD бичигчид 
		DVD-RAM хэлбэршүүлэлтийг дэмждэг. DVD-RAM-ийн хэрэглээний талаар 
		илүү дэлгэрэнгүйг <xref linkend="creating-dvd-ram">-с 
		уншина уу.</para>
	</listitem>

	<listitem>
	  <para>DVD+RW: Энэ нь <ulink url="http://www.dvdrw.com/">DVD+RW
	    	холбооноос</ulink> тодорхойлсон дахин бичигдэх хэлбэршүүлэлт юм. 
		DVD+RW нь ойролцоогоор 1000 удаа бичигдэх боломжтой.</para>
	</listitem>

	<listitem>
	  <para>DVD+R: Энэ хэлбэршүүлэлт нь DVD+RW хэлбэршүүлэлтийн нэг удаа бичих 
		хувилбар юм.</para>
	</listitem>
      </itemizedlist>

      <para>Бичигддэг DVD-ий нэг давхарга нь 4,700,000,000&nbsp;байт буюу 
	4.38&nbsp;GB эсвэл 4485&nbsp;MB (1 килобайт нь 1024 байт) 
	хүртэлх мэдээлэл агуулж чадна.</para>

      <note>
	<para>Физик зөөвөрлөгч болон програмыг ялгаж ойлгох ёстой. Жишээ нь 
	DVD-Видео нь дурын бичигддэг DVD физик зөөвөрлөгч DVD-R, DVD+R, DVD-RW гэх зэрэг 
	уруу бичигдэж болох тусгай байршлын зураглал юм. Зөөвөрлөгчийн төрлийг сонгохын өмнө 
	шарагч болон DVD-Видео тоглуулагч (дан тоглуулагч эсвэл компьютер дээрх DVD-ROM хөтөч)
	нь хэрэглэхээр төлөвлөж байгаа зөөвөрлөгчтэй нийцтэй эсэхийг шалгах хэрэгтэй.</para></note>
    </sect2>

    <sect2>
      <title>Тохиргоо</title>

      <para>DVD бичлэг хийхэд &man.growisofs.1; програм ашиглагдана. 
	Энэ тушаал нь <application>dvd+rw-tools</application> хэрэгслүүдийн (<filename
	role="package">sysutils/dvd+rw-tools</filename>) нэг хэсэг 
	юм. <application>dvd+rw-tools</application> нь DVD зөөвөрлөгчийн 
	бүх төрлийг дэмждэг.</para>

      <para>Эдгээр хэрэгслүүд нь төхөөрөмжүүд уруу хандахын тулд SCSI дэд системийг 
	ашигладаг, тиймээс таны цөмд <link linkend="atapicam">ATAPI/CAM
	дэмжлэг</link> нэмэгдсэн байх ёстой. Хэрэв таны шарагч USB интерфэйс ашигладаг 
	бол энэ нэмэлт нь хэрэггүй бөгөөд та USB төхөөрөмжүүдийн тохиргооны талаар илүү 
	дэлгэрэнгүйг  <xref linkend="usb-disks">-с унших шаардлагатай.</para>

      <para>Та мөн ATAPI төхөөрөмжүүдийн хувьд DMA хандалтыг идэвхжүүлэх ёстой бөгөөд 
	дараах мөрийг <filename>/boot/loader.conf</filename> файлд 
	нэмж үүнийг  хийнэ:</para>

      <programlisting>hw.ata.atapi_dma="1"</programlisting>

      <para><application>dvd+rw-tools</application>-г ашиглахаасаа өмнө 
	өөрийн DVD шарагчтай холбоотой мэдээллийг <ulink
	url="http://fy.chalmers.se/~appro/linux/DVD+RW/hcn.html">dvd+rw-tools'
	тоног төхөөрөмжийн нийцтэй байдал</ulink> хаягаас лавлах хэрэгтэй.</para>

      <note>
	<para>Хэрэв та график хэрэглэгчийн интерфэйсийг хүсэж байвал 
	&man.growisofs.1; болон бусад олон шарагч хэрэгслүүдийг 
	хэрэглэгчид ашиглахад амар интерфэйсээр хангадаг 
	<application>K3b</application> (<filename
	  role="package">sysutils/k3b</filename>) програмыг 
	үзэх хэрэгтэй.</para>
      </note>
    </sect2>

    <sect2>
      <title>Өгөгдлийн DVD-үүдийг шарах нь</title>

      <para>&man.growisofs.1; тушаал нь <link
	linkend="mkisofs">mkisofs</link>-ийн нүүр хэсэг юм, энэ нь 
	шинэ файлын системийн байршлыг үүсгэхийн тулд &man.mkisofs.8;-г 
	дуудах бөгөөд DVD дээр бичих үйлдлийг гүйцэтгэнэ. Энэ нь та шарах 
	процессоос өмнө өгөгдлийн дүрсийг үүсгэх хэрэггүй гэсэн үг юм.</para>

      <para>DVD+R эсвэл DVD-R уруу өгөгдлийг <filename
	class="directory">/path/to/data</filename> сангаас шарахдаа 
	дараах тушаалыг ашиглана:</para>

      <screen>&prompt.root; <userinput>growisofs -dvd-compat -Z <replaceable>/dev/cd0</replaceable> -J -R <replaceable>/path/to/data</replaceable></userinput></screen>

      <para>Файлын системийг үүсгэхдээ <option>-J -R</option> тохируулгуудыг 
	&man.mkisofs.8;-д дамжуулдаг (энэ тохиолдолд Joilet болон Rock Ridge 
	өргөтгөлүүдтэй ISO 9660 файлын систем). Дэлгэрэнгүйг &man.mkisofs.8; 
	гарын авлагын хуудаснаас лавлана уу.</para>

      <para><option>-Z</option> тохируулгыг ямар ч тохиолдолд  
	(олон сессүүд эсвэл ганц сесс) эхний сессийг бичихдээ хэрэглэдэг. DVD төхөөрөмж 
	<replaceable>/dev/cd0</replaceable>-г өөрийн тохиргооны дагуу өөрчлөх 
	хэрэгтэй. <option>-dvd-compat</option> параметр дискийг хаах бөгөөд 
	бичилтийг нэмэх нь боломжгүй болох юм. Энэ нь DVD-ROM хөтчүүдтэй 
	зөөвөрлөгчийн нийцтэй байдлыг илүүтэй хангах юм.</para>

      <para>Мөн урьдчилан урласан дүрсийг шарах бас боломжтой, жишээ нь 
	<replaceable>imagefile.iso</replaceable> дүрсийг шарахын 
	тулд бид дараах тушаалыг ажиллуулна:</para>

      <screen>&prompt.root; <userinput>growisofs -dvd-compat -Z <replaceable>/dev/cd0</replaceable>=<replaceable>imagefile.iso</replaceable></userinput></screen>

      <para>Бичих хурдыг олж зөөвөрлөгч ба ашиглагдаж байгаа хөтчөөс 
	хамаарч автоматаар тохируулах болно. Хэрэв та бичих хурдыг өөрчлөх 
	хүсэлтэй байгаа бол <option>-speed=</option> параметрийг ашиглах 
	хэрэгтэй. Дэлгэрэнгүй мэдээллийг &man.growisofs.1; гарын авлагын 
	хуудаснаас уншина уу.</para>

      <note>
	<para>Та өөртөө 4.38GB-аас их хэмжээтэй, ажиллагаатай 
	  файлтай болохын тулд &man.mkisofs.8; болон бусад бүх програмд 
	  (жишээ нь &man.growisofs.1;) <option>-udf -iso-level 3</option> гэсэн сонголтыг өгч 
	  UDF/ISO-9660 гибрид файлын системийг үүсгэсэн байх 
	  шаардлагатай. Энэ нь зөвхөн файлыг шууд диск рүү бичих эсвэл 
	  ISO дүрс файлыг үүсгэхэд л шаардлагатай. Энэ замаар үүсгэсэн 
	  дискийг зөвхөн UDF-г дэмждэг үйлдлийн системд ашиглагдах боломжтой 
	  байхаар &man.mount.udf.8; хэрэгслийн тусламжтайгаар 
	  UDF файлын систем маягаар холбох ёстой бөгөөд тэгэхгүй бол энэ нь
	  эвдэрсэн файлуудтай юм шиг харагдах болно.</para>

	<para>Ийм ISO дүрс үүсгэхийн тулд:</para>

	<screen>&prompt.user; <userinput>mkisofs -R -J -udf -iso-level 3 -o <replaceable>imagefile.iso</replaceable> <replaceable>/path/to/data</replaceable></userinput></screen>

	<para>Диск рүү файлуудыг шууд бичихийн тулд:</para>

	<screen>&prompt.root; <userinput>growisofs -dvd-compat -udf -iso-level 3 -Z <replaceable>/dev/cd0</replaceable> -J -R <replaceable>/path/to/data</replaceable></userinput></screen>

	<para>Том файлууд аль хэдийн агуулсан ISO дүрс танд 
	  байгаа бол түүнийг диск рүү шарахад нэмэлт 
	  сонголтууд &man.growisofs.1;-д шаардлагагүй.</para>

	<para>Мөн хуучин хувилбарууд нь том файлыг дэмждэггүй 
	  учир та <filename role="package">sysutils/cdrtools</filename> 
	  (&man.mkisofs.8;-г агуулдаг) хэрэгслийн хамгийн сүүлийн 
	  хувилбартай байгаа эсэхээ шалгаарай. Хэрэв та асуудалтай 
	  тулгарвал хөгжүүлэлтийн хувилбар руу шилжээрэй, өөрөөр хэлбэл  
	  <filename
	  role="package">sysutils/cdrtools-devel</filename> рүү шилжээд 
	  &man.mkisofs.8;-ийн гаран авлагын хуудсыг уншаарай.</para>
      </note>
    </sect2>

    <indexterm>
      <primary>DVD</primary>
      <secondary>DVD-Video</secondary>
    </indexterm>

    <sect2>
      <title>DVD-Видео шарах нь</title>

      <para>DVD-Видео нь ISO 9660 болон микро-UDF (M-UDF тодорхойлолтууд 
	дээр тулгуурласан тусгай файлын байршлын зураглал юм. DVD-Видео нь бас 
	өгөгдлийн бүтцийн тусгай шатлалыг үзүүлдэг бөгөөд энэ нь DVD-г зохиохын тулд 
	<filename role="package">multimedia/dvdauthor</filename> зэрэг тусгай 
	програмыг та яагаад ашиглах хэрэгтэй болдгийн шалтгаан юм.</para>

      <para>Хэрэв танд DVD-Видео файлын системийн дүрс байгаа бол ямар ч дүрсний нэгэн 
	адил аргаар шарах хэрэгтэй. Өмнөх хэсгийн жишээнээс үзнэ үү. Хэрэв та 
	DVD зохиолт хийсэн бөгөөд үр дүн нь жишээ нь <filename class="directory">/path/to/video</filename> 
	санд байгаа бол DVD-Видеог шарахын тулд дараах тушаалыг ашиглах хэрэгтэй:</para>

      <screen>&prompt.root; <userinput>growisofs -Z <replaceable>/dev/cd0</replaceable> -dvd-video <replaceable>/path/to/video</replaceable></userinput></screen>

      <para><option>-dvd-video</option> тохируулга &man.mkisofs.8;-д 
	дамжуулагдах бөгөөд энэ  нь DVD-Видео файлын системийн байршлын зураглал 
	үүсгэхийг тушаах болно. Үүнээс гадна <option>-dvd-video</option> 
	тохируулга нь &man.growisofs.1;-ийн <option>-dvd-compat</option> 
	тохируулгыг агуулдаг.</para>
    </sect2>

    <indexterm>
      <primary>DVD</primary>
      <secondary>DVD+RW</secondary>
    </indexterm>

    <sect2>
      <title>DVD+RW ашиглах нь</title>

      <para>CD-RW-с ялгаатай нь шинэ DVD+RW нь ашиглагдахаа өмнө хэлбэршүүлэгдсэн 
	байх ёстой. &man.growisofs.1; нь шаардлагатай үед автоматаар үүнийг хийх 
	бөгөөд энэ аргыг <emphasis>зөвлөдөг</emphasis> юм. Гэхдээ та 
	<command>dvd+rw-format</command> тушаалыг ашиглан DVD+RW-г хэлбэршүүлж
	болно:</para>

      <screen>&prompt.root; <userinput>dvd+rw-format <replaceable>/dev/cd0</replaceable></userinput></screen>

      <para>Та энэ үйлдлийг зөвхөн нэг удаа хийх хэрэгтэй бөгөөд зөвхөн шинэ DVD+RW 
	зөөвөрлөгчдийн хувьд хэлбэршүүлэх ёстойг санаарай. Дараа нь та DVD+RW-г дээрх 
	хэсгүүдэд дурдсаны адил шарж болно.</para>

      <para>Хэрэв та шинэ өгөгдлийг (зарим өгөгдлийг нэмэх биш 
	бүр мөсөн шинэ файлын систем шарах) DVD+RW уруу шарахыг хүсэж байгаа бол 
	түүнийг хоосон болгох шаардлагагүй юм, иймэрхүүгээр өмнөх бичилтэн дээрээ 
	(шинэ сесс үүсгээд) дараад л бичих хэрэгтэй юм:</para>

      <screen>&prompt.root; <userinput>growisofs -Z <replaceable>/dev/cd0</replaceable> -J -R <replaceable>/path/to/newdata</replaceable></userinput></screen>

      <para>DVD+RW хэлбэршүүлэлт нь өмнөх бичилтэд өгөгдлийг хялбараар нэмэх 
	боломжийг олгодог. Энэ үйлдэл нь шинэ сессийг хуучин байгаатай нь нийлүүлэх 
	бөгөөд энэ нь олон сесс бүхий бичилт биш юм. &man.growisofs.1; нь зөөвөрлөгч дээр 
	байгаа ISO 9660 файлын системийг <emphasis>өсгөх (сунгах)</emphasis> 
	болно.</para>

      <para>Жишээ нь хэрэв бид өөрсдийн урьдны DVD+RW уруу өгөгдөл нэмэхийг 
	хүсвэл доор дурдсаныг ашиглах хэрэгтэй болно:</para>

      <screen>&prompt.root; <userinput>growisofs -M <replaceable>/dev/cd0</replaceable> -J -R <replaceable>/path/to/nextdata</replaceable></userinput></screen>

      <para>Эхний сессийг шарахдаа бидний хэрэглэдэг  &man.mkisofs.8;-ийн 
	адил тохируулгууд дараагийн бичилтүүдийн үеэр хэрэглэгдэх ёстой.</para>

      <note>
	<para>Хэрэв та DVD-ROM хөтчүүдтэй зөөвөрлөгчийн хувьд илүүтэй нийцтэй байхыг 
	хүсвэл <option>-dvd-compat</option> тохируулгыг хэрэглэхийг 
	хүсэж болох юм. DVD+RW тохиолдлын хувьд энэ нь таныг өгөгдөл нэмэхийг болиулж 
	чадахгүй юм.</para>
      </note>

      <para>Хэрэв та ямар нэг шалтгаанаар зөөвөрлөгчийг хоосон болгохыг хүсвэл 
	доор дурдсаныг хийх хэрэгтэй:</para>

      <screen>&prompt.root; <userinput>growisofs -Z <replaceable>/dev/cd0</replaceable>=<replaceable>/dev/zero</replaceable></userinput></screen>
    </sect2>

    <indexterm>
      <primary>DVD</primary>
      <secondary>DVD-RW</secondary>
    </indexterm>

    <sect2>
      <title>DVD-RW ашиглах нь</title>

      <para>DVD-RW нь дискний хоёр хэлбэршүүлэлтийг авдаг: нэмэгдсэн дараалсан 
	хэлбэршүүлэлт болон хязгаарлагдмал дарж бичих хэлбэршүүлэлт юм. Анхдагчаар 
	DVD-RW дискнүүд нь дараалсан хэлбэршүүлэлтэд байдаг.</para>

      <para>Шинэ DVD-RW нь хэлбэршүүлэлт хийгдэлгүйгээр шууд бичигдэж болдог, 
	гэхдээ шинэ биш дараалсан хэлбэршүүлэлтэд байх DVD-RW нь шинэ эхний сесс 
	бичигдэхээс өмнө хоосон болгогдсон байх шаардлагатай байдаг.</para>

      <para>Дараалсан горим дахь DVD-RW-г хоослохдоо дараах тушаалыг ажиллуулна:</para>

      <screen>&prompt.root; <userinput>dvd+rw-format -blank=full <replaceable>/dev/cd0</replaceable></userinput></screen>

      <note>
	<para>Бүр мөсөн хоослолт (<option>-blank=full</option>) 1x зөөвөрлөгч 
	дээр нэг цаг орчим болно. Хэрэв DVD-RW нь Disk-At-Once (DAO) горимоор 
	бичигдэх бол хурдан хоослолтыг <option>-blank</option> тохируулга ашиглан 
	хийж болно. DVD-RW-г DAO горимд шарахын тулд дараах тушаалыг ашиглана:</para>

	<screen>&prompt.root; <userinput>growisofs -use-the-force-luke=dao -Z <replaceable>/dev/cd0</replaceable>=<replaceable>imagefile.iso</replaceable></userinput></screen>

	<para><option>-use-the-force-luke=dao</option> тохируулгыг 
	шаардах ёсгүй, учир нь &man.growisofs.1; нь (хурдан хоосолсон) 
	зөөвөрлөгчийг илрүүлэхийг бага оролдож DAO бичилтийг захиалах 
	болно.</para>

	<para>Яг үнэндээ дурын DVD-RW-ийн хувьд хязгаарлагдмал дарж бичих горимыг 
	ашиглах хэрэгтэй бөгөөд энэ хэлбэршүүлэлт нь анхдагч нэмэгдсэн дараалсан 
	хэлбэршүүлэлтээс илүү уян хатан байдаг.</para>
      </note>

      <para>Дараалсан DVD-RW дээр өгөгдлийг бичихдээ бусад DVD хэлбэршүүлэлтийн 
	нэгэн адил заавруудыг ашиглана:</para>

      <screen>&prompt.root; <userinput>growisofs -Z <replaceable>/dev/cd0</replaceable> -J -R <replaceable>/path/to/data</replaceable></userinput></screen>

      <para>Хэрэв та зарим өгөгдлийг өөрийн урьдны бичлэгт нэмэхийг хүсвэл 
	&man.growisofs.1;-ийн <option>-M</option> тохируулгыг ашиглах 
	хэрэгтэй болно. Гэхдээ хэрэв та нэмэгдсэн дараалсан горимд байгаа DVD-RW 
	уруу өгөгдлийг нэмэх үйлдлийг хийвэл диск дээр шинэ сесс үүсгэгдэх бөгөөд 
	үүний үр дүн нь олон сесс бүхий диск болох юм.</para>

      <para>DVD-RW нь хязгаарлагдмал дарж бичих хэлбэршүүлэлтэд шинэ эхний 
	сессээс өмнө хоосон болгогдох шаардлагагүй, та ердөө л дискийг 
	<option>-&nbsp;Z</option> тохируулгатай дарж бичих хэрэгтэй бөгөөд энэ нь 
	DVD+RW тохиолдолтой төстэй юм. Мөн диск дээр бичигдсэн байгаа ISO 
	9660 файлын системийг DVD+RW-тэй адил аргаар <option>-M</option> 
	тохируулгын тусламжтай өсгөж (сунгаж) бас болно. Үр дүн нь нэг сесс 
	бүхий DVD болох юм.</para>

      <para>DVD-RW-г хязгаарлагдмал дарж бичих хэлбэршүүлэлтэд оруулахдаа 
	дараах тушаалыг ашиглах ёстой:</para>

      <screen>&prompt.root; <userinput>dvd+rw-format <replaceable>/dev/cd0</replaceable></userinput></screen>

      <para>Дараалсан хэлбэршүүлэлт уруу буцааж өөрчлөхдөө дараах тушаалыг ашиглана:</para>

      <screen>&prompt.root; <userinput>dvd+rw-format -blank=full <replaceable>/dev/cd0</replaceable></userinput></screen>
    </sect2>

    <sect2>
      <title>Олон сесс</title>

      <para>Маш цөөн DVD-ROM хөтчүүд олон сесс бүхий DVD-үүдийг дэмждэг бөгөөд 
	тэдгээр нь ихэнхдээ зөвхөн эхний сессийг уншдаг. DVD+R, DVD-R болон DVD-RW нь 
	дараалсан хэлбэршүүлэлтдээ олон сессийг хүлээн авч чаддаг бөгөөд DVD+RW болон 
	DVD-RW хязгаарлагдмал дарж бичих хэлбэршүүлэлтүүдийн хувьд олон сесс гэсэн ойлголт 
	байдаггүй.</para>

      <para>Дараалсан хэлбэршүүлэлтэд DVD+R, DVD-R эсвэл DVD-RW дээрх эхний 
	(хаагдаагүй) сессийн дараа дараах тушаалыг ашиглаж дискэнд шинэ 
	сесс үүсгэнэ:</para>

      <screen>&prompt.root; <userinput>growisofs -M <replaceable>/dev/cd0</replaceable> -J -R <replaceable>/path/to/nextdata</replaceable></userinput></screen>

      <para>Энэ тушаалын мөрийг DVD+RW эсвэл DVD-RW-тэй цуг ашиглан хязгаарлагдмал дарж бичих 
	горим дээр шинэ сессийг хуучин байгаатай нийлүүлэн өгөгдлийг нэмэх болно. Үр дүн нь 
	нэг сесс бүхий диск болох юм. Энэ нь эдгээр зөөвөрлөгчүүд дээр эхний бичилтийн дараа 
	өгөгдөл нэмэх арга юм.</para>

      <note>
	<para>Зөөвөрлөгч дээрх зарим зай нь сесс бүрийн хооронд сессийн төгсгөл болон 
	эхлэлд хэрэглэгддэг. Тиймээс зөөвөрлөгчийн зайг оновчтой ашиглахын тулд 
	их өгөгдөлтэй сессүүдийг нэмэх ёстой юм. Сессийн тоо DVD+R-ийн хувьд 154, 
	DVD-R-ийн хувьд 2000 орчим, DVD+R хос давхаргын хувьд 127-оор 
	хязгаарлагдана.</para>
      </note>
    </sect2>

    <sect2>
      <title>Дэлгэрэнгүй мэдээллийг</title>

      <para>DVD-ийн талаар илүү мэдээллийг авахын тулд 
	<command>dvd+rw-mediainfo
	<replaceable>/dev/cd0</replaceable></command> тушаалыг хөтөч 
	дотор диск байхад ажиллуулж болно.</para>

      <para><application>dvd+rw-tools</application>-н тухай дэлгэрэнгүй 
	мэдээлэл нь &man.growisofs.1; гарын авлагын хуудас, <ulink
	url="http://fy.chalmers.se/~appro/linux/DVD+RW/">dvd+rw-tools
	вэб сайт</ulink> болон <ulink
	url="http://lists.debian.org/cdwrite/">cdwrite захидлын жагсаалт</ulink>ын 
	архивуудаас олдож болно.</para>

      <note>
	<para>Бичигдсэн үр дүн эсвэл асуудалтай зөөвөрлөгчийн <command>dvd+rw-mediainfo</command> 
	гаралт нь ямар ч асуудлын тайлангийн чухал хэсэг юм. Энэ гаралтгүйгээр танд туслах 
	бараг л боломжгүй юм.</para>
      </note>
    </sect2>

    <sect2 id="creating-dvd-ram">
      <title>DVD-RAM ашиглах нь</title>
      <indexterm>
	<primary>DVD</primary>
	<secondary>DVD-RAM</secondary>
      </indexterm>

      <sect3>
	<title>Тохиргоо</title>

	<para>DVD-RAM бичигчид нь SCSI аль эсвэл ATAPI интерфэйстэй цуг ирдэг.
 	ATAPI төхөөрөмжүүдийн хувьд DMA хандалт идэвхтэй болсон байх ёстой, 
	дараах мөрийг <filename>/boot/loader.conf</filename> 
	файлд нэмж үүнийг хийнэ:</para>

	<programlisting>hw.ata.atapi_dma="1"</programlisting>
      </sect3>

      <sect3>
	<title>Зөөвөрлөгчийг бэлдэх нь</title>

	<para>Өмнө нь бүлгийн танилцуулгад дурдсанаар DVD-RAM нь зөөврийн хатуу 
	хөтөч маягаар харагддаг. Бусад хатуу дискнүүдийн адил DVD-&nbsp;RAM нь ашиглагдаж 
	эхлэхээсээ өмнө <quote>бэлдэгдсэн</quote> байх ёстой. Жишээн дээр дискний 
	бүх зай стандарт UFS2 файлын системтэй ашиглагдана:</para>

	<screen>&prompt.root; <userinput>dd if=/dev/zero of=<replaceable>/dev/acd0</replaceable> bs=2k count=1</userinput>
&prompt.root; <userinput>bsdlabel -Bw <replaceable>acd0</replaceable></userinput>
&prompt.root; <userinput>newfs <replaceable>/dev/acd0</replaceable></userinput></screen>

	<para>DVD төхөөрөмж <devicename>acd0</devicename>-ийг өөрийн тохиргооны 
	дагуу өөрчлөн ашиглах ёстой.</para>
      </sect3>

      <sect3>
	<title>Зөөвөрлөгчийг ашиглах нь</title>

	<para>Дээрх үйлдлүүд DVD-RAM дээр хийгдсэний дараа үүнийг энгийн 
	хатуу хөтчийн нэгэн адил холбож болно:</para>

	<screen>&prompt.root; <userinput>mount <replaceable>/dev/acd0</replaceable> <replaceable>/mnt</replaceable></userinput></screen>

	<para>Үүний дараа DVD-RAM нь уншигдах бичигдэх боломжтой болно.</para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="floppies">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Жулио</firstname>
	  <surname>Мерино</surname>
	  <contrib>Анхлан хийсэн </contrib>
	</author>
      </authorgroup>
      <!-- 24 Dec 2001 -->
      <authorgroup>
	<author>
	  <firstname>Мартин</firstname>
	  <surname>Карлсон</surname>
	  <contrib>Дахин бичсэн </contrib>
	</author>
      </authorgroup>
      <!-- 27 Apr 2003 -->
    </sect1info>

    <title>Уян дискнүүдийг үүсгэж ашиглах нь</title>

    <para>Өгөгдлийг уян дискнүүд уруу хадгалах нь заримдаа ашигтай байдаг. Жишээ нь 
	хэн нэгэнд нь шилжүүлж болдог ямар ч хадгалалтын зөөвөрлөгч байхгүй тохиолдолд 
	эсвэл бага хэмжээний өгөгдлийг өөр компьютер уруу зөөх хэрэгцээ гарсан үед уян 
	диск нь хэрэг болдог.</para>

    <para>Энэ хэсэг нь FreeBSD дээр уян дискийг хэрхэн ашиглах талаар тайлбарлах болно. 
	Энд 3.5 инчийн DOS уян дискнүүдийг хэлбэршүүлж ашиглах талаар үндсэндээ 
	тайлбарлах бөгөөд гэхдээ энэ ойлголт нь бусад уян дискний хэлбэршүүлэлттэй 
	төстэй юм.</para>

    <sect2>
      <title>Уян дискнүүдийг хэлбэршүүлэх нь</title>

      <sect3>
	<title>Төхөөрөмж</title>

	<para>Уян дискнүүдэд бусад төхөөрөмжүүдийн адил <filename>/dev</filename> 
	сан дахь оруулгуудаар ханддаг. Түүхий уян дискэнд хандахын тулд 
	<filename>/dev/fd<replaceable>N</replaceable></filename>-г 
	ердөө л ашиглах хэрэгтэй.</para>
      </sect3>

      <sect3>
	<title>Хэлбэршүүлэх нь</title>

	<para>Уян дискийг ашиглахаасаа өмнө доод түвшний хэлбэршүүүлэлт 
	хийсэн байх хэрэгтэй. Үүнийг ихэвчлэн үйлдвэрлэгч хийдэг боловч 
	хэлбэршүүлэлт нь зөөвөрлөгчийн бүрэн бүтэн байдлыг шалгах нэг сайн 
	арга юм. Илүү том (эсвэл жижиг) дискний хэмжээг хүчлэн ашиглах 
	боломжтой байдаг боловч 1440kB хэмжээнд зориулагдан ихэнх уян 
	диск хийгдсэн байдаг.</para>

	<para>Уян дискэнд доод түвшний хэлбэршүүлэлт хийхийн тулд та 
	&man.fdformat.1;-г ашиглах хэрэгтэй. Энэ хэрэгсэл нь төхөөрөмжийн 
	нэрийг нэмэлт өгөгдөл маягаар оруулахыг хүлээж байдаг.</para>

	  <para>Алдааны мэдэгдлийг тэмдэглэж аваарай, учир нь эдгээр нь 
		дискийг сайн эсвэл муу эсэхийг тодорхойлоход туслах болно.</para>

	<sect4>
	  <title>Уян дискнүүдийг хэлбэршүүлэх нь</title>

	  <para><filename>/dev/fd<replaceable>N</replaceable></filename> 
		төхөөрөмжүүдийг ашиглан уян дискийг хэлбэршүүлэх хэрэгтэй. Шинэ 3.5 инч 
		диск өөрийн хөтөч уруугаа хийгээд дараах тушаалыг ажиллуул:</para>

	  <screen>&prompt.root; <userinput>/usr/sbin/fdformat -f 1440 /dev/fd0</userinput></screen>

	</sect4>
      </sect3>
    </sect2>

    <sect2>
      <title>Дискний шошго</title>

      <para>Дискэнд доод түвшний хэлбэршүүлэлт хийсний дараа танд диск дээр шошго 
	тавих хэрэгтэй болно. Энэ дискний шошго нь дараа нь устгагдах боловч 
	дискний хэмжээ болон геометрийг дараа нь тодорхойлоход системд 
	хэрэг болдог.</para>

      <para>Шинэ дискний шошго нь бүхэл дискийг хамарч уян дискний геометрийн тухай 
	бүх л зөв мэдээллийг агуулах болно. Дискний шошгоны геометрийн утгууд нь 
	<filename>/etc/disktab</filename> файлд жагсаагдсан 
	байдаг.</para>

      <para>Та одоо ингэж &man.bsdlabel.8;-г ажиллуулж болно:</para>

      <screen>&prompt.root; <userinput>/sbin/bsdlabel -B -w /dev/fd0 fd1440</userinput></screen>

    </sect2>

    <sect2>
      <title>Файлын систем</title>

      <para>Одоо уян дискэнд дээд түвшний хэлбэршүүлэлт хийхэд бэлэн боллоо. Энэ нь 
	дискийг FreeBSD унших болон түүнд бичих боломжийг олгох шинэ файлын системийг 
	диск дээр байрлуулах болно. Шинэ файлын системийг үүсгэсний дараа дискний 
	шошго устгагдах бөгөөд хэрэв та дискийг дахин хэлбэршүүлэхийг хүсвэл дискний 
	шошгыг дахин үүсгэх шаардлагатай болно.</para>

      <para>Уян дискний файлын систем нь UFS эсвэл FAT хоёрын аль нэг нь байна.
	FAT нь ерөнхийдөө уян дискнүүдийн хувьд илүү дээр сонголт байдаг.</para>

      <para>Уян диск дээр шинэ файлын системийг байрлуулахын талд дараах тушаалыг ажиллуулна:</para>

      <screen>&prompt.root; <userinput>/sbin/newfs_msdos /dev/fd0</userinput></screen>

      <para>Диск одоо ашиглахад бэлэн боллоо.</para>
    </sect2>


    <sect2>
      <title>Уян дискийг ашиглах нь</title>

      <para>Уян дискийг ашиглахын тулд &man.mount.msdosfs.8; тушаалаар холбох хэрэгтэй. Мөн 
	портын цуглуулгаас <filename role="package">emulators/mtools</filename>-г 
	ашиглаж бас болох юм.</para>
    </sect2>
  </sect1>

  <sect1 id="backups-tapebackups">
    <title>Өгөгдлийн соронзон хальснууд үүсгэж ашиглах нь</title>

    <indexterm><primary>соронзон хальс зөөвөрлөгч</primary></indexterm>
    <para>Гол соронзон хальс зөөвөрлөгчүүд нь 4мм, 8мм, QIC, мини-хайрцаг болон DLT 
	юм.</para>

    <sect2 id="backups-tapebackups-4mm">
      <title>4мм (DDS: Digital Data Storage)</title>

      <indexterm>
        <primary>соронзон хальс зөөвөрлөгч</primary>
	<secondary>DDS (4mm) соронзон хальснууд</secondary>
      </indexterm>
      <indexterm>
        <primary>соронзон хальс зөөвөрлөгч</primary>
	<secondary>QIC соронзон хальснууд</secondary>
      </indexterm>
      <para>4мм соронзон хальснууд нь QIC-г халж ажлын станцын нөөц зөөвөрлөгч болон сонгогдож 
	байна. Conner компани нь QIC хөтчүүдийн тэргүүлэх үйлдвэрлэгч Archive-г 
	худалдаж авч дараа нь QIC хөтчүүдийг үйлдвэрлэхээ зогсоосноор энэ чиг хандлага нь 
	илүү хурдассан юм. 4мм хөтчүүд нь жижиг, чимээгүй боловч 8мм хөтчүүд шиг 
	найдвартай ажиллагаагаараа алдартай биш юм. Хайрцагнууд нь үнэтэй биш бөгөөд 
	8мм-ийн хайрцагнуудаас бага (3 x 2 x 0.5 инч, 76 x 51 x 12 мм) юм. 
	4мм соронзон хальс нь 8мм-ийн нэгэн адил шалтгаанаар толгой нь богино настай бөгөөд 
	хоёулаа мушгиа сканыг ашигладаг.</para>

      <para>Эдгээр хөтчүүд дээрх өгөгдлийн дамжуулах чадвар нь ~150&nbsp;kB/s-с 
	эхэлж ~500&nbsp;kB/s хүрнэ. Өгөгдлийн багтаамж 1.3&nbsp;GB-с эхэлж 
	2.0&nbsp;GB хүрнэ. Тоног төхөөрөмжийн шахалт энэ хөтчүүдийн ихэнхэд байх 
	бөгөөд энэ нь багтаамжийг ойролцоогоор хоёр дахин нэмэгдүүлдэг. Олон хөтөч бүхий 
	соронзон хальсны сан (library) автомат соронзон хальс солигчтой нэг кабинетийн хувьд 6 хөтөчтэй 
	байж болно. Сангийн багтаамж нь 240&nbsp;GB хүрнэ.</para>

      <para>DDS-3 стандарт нь одоогоор 12&nbsp;GB (эсвэл 24&nbsp;GB шахагдсан) 
	багтаамжтай соронзон хальсыг дэмждэг.</para>

      <para>4мм хөтчүүд нь 8мм-ийн хөтчүүдийн нэгэн адил мушгиа хайлтыг хэрэглэдэг. 
	Мушгиа хайлт хийхийн бүх ашигтай тал болон сул талууд нь 4мм болон 8мм-ийн хөтчүүдийн 
	аль алинд нь хамаардаг.</para>

      <para>Соронзон хальснууд нь 2000 удаагийн ашиглалт эсвэл 100 бүрэн нөөцлөлтийн дараа 
	хэрэглээнээс гарах ёстой.</para>
    </sect2>

    <sect2 id="backups-tapebackups-8mm">
      <title>8мм (Exabyte)</title>
      <indexterm>
        <primary>соронзон хальс зөөвөрлөгч</primary>
	<secondary>Exabyte (8мм) соронзон хальснууд</secondary>
      </indexterm>

      <para>8мм соронзон хальснууд нь хамгийн нийтлэг SCSI соронзон хальсны хөтчүүд юм; тэдгээр нь соронзон хальснууд 
	солих хамгийн сайн сонголт болдог. Бараг сайт бүр Exabyte 2&nbsp;GB 8мм-ийн 
	соронзон хальсны хөтөчтэй байдаг. 8мм-ийн хөтчүүд нь найдвартай, хэрэглэхэд амар, чимээгүй 
	байдаг. Хайрцагнууд нь хямд, жижиг (4.8 x 3.3 x 0.6 инч; 122 x 84 x 15 мм) 
	байдаг. 8мм-ийн соронзон хальсны нэг сул тал нь толгойнуудын дагуух соронзон хальсны харьцангуй хөдөлгөөний
	өндөр хувиас болоод харьцангуй богино толгой ба соронзон хальсны амьдрах хугацаатай байдаг явдал юм.</para>

      <para>Өгөгдөл дамжуулах чадвар нь ~250&nbsp;kB/s-аас ~500&nbsp;kB/s хүртэл байна. 
	Өгөгдлийн хэмжээ нь 300&nbsp;MB-аас эхэлж 7&nbsp;GB хүрнэ. Тоног төхөөрөмжийн шахалт 
	энэ хөтчүүдийн ихэнхэд байх бөгөөд энэ нь багтаамжийг ойролцоогоор хоёр дахин нэмэгдүүлдэг.
	Эдгээр хөтчүүд нь нэг буюу эсвэл нэг кабинетдаа 6 хөтөч болон 120 соронзон хальстай олон хөтөч 
	бүхий соронзон хальсны сан (library) хэлбэрээр байдаг. соронзон хальснууд нь автоматаар солигддог. 
	Сангийн багтаамж 840+&nbsp;GB хүрнэ.</para>

      <para>Exabyte <quote>Mammoth</quote> загвар нь нэг соронзон хальс дээр 12&nbsp;GB 
	((24&nbsp;GB шахалттайгаар) дэмждэг бөгөөд ердийн соронзон хальсны хөтчөөс ойролцоогоор 
	хоёр дахин үнэтэй байдаг.</para>

      <para>Өгөгдөл нь соронзон хальс уруу мушгиа скан ашиглагдан бичигддэг, толгойнууд нь зөөвөрлөгч уруу
	өнцгөөр байрладаг (ойролцоогоор 6 градус). Соронзон хальс нь толгойнуудыг барьж байдаг дамрын 
	270 градус орчим ороодог. Соронзон хальс дамар дээгүүр гулгаж байхад дамар нь эргэж байдаг. 
	Үр дүнд нь өгөгдлийн өндөр нягтрал болон соронзон хальсны дагуу нэг ирмэгээс нөгөө уруу өнцөгдсөн ойрхон 
	багцалсан замууд үүсэх болно.</para>
    </sect2>

    <sect2 id="backups-tapebackups-qic">
      <title>QIC</title>
      <indexterm>
        <primary>соронзон хальс зөөвөрлөгч</primary>
	<secondary>QIC-150</secondary>
      </indexterm>

      <para>QIC-150 соронзон хальснууд болон хөтчүүд нь магадгүй хамгийн нийтлэг соронзон хальсны хөтөч, зөөвөрлөгч
	юм. QIC соронзон хальсны хөтчүүд нь хамгийн хямд <quote>нухацтай</quote> нөөцлөлтийн хөтчүүд 
	юм. Сул тал нь зөөвөрлөгчийн үнэ байдаг. QIC соронзон хальснууд нь 8мм болон 4мм соронзон хальснуудтай 
	харьцуулахад GB өгөгдлийн хадгалалтын хувьд 5 дахин үнэтэй байдаг. Гэхдээ таны 
	хэрэглээнд цөөн (half-dozen) соронзон хальснууд хангалттай бол QIC нь магадгүй зөв сонголт 
	болж болох юм. QIC нь <emphasis>хамгийн</emphasis> нийтлэг соронзон хальсны хөтөч юм. 
	Сайт бүр ямар нэг хэмжээний QIC хөтөчтэй байдаг. QIC нь физикийн хувьд төстэй (заримдаа адил) 
	соронзон хальснуудад их хэмжээний нягтралтай байдаг. QIC хөтчүүд нь чимээгүй биш юм. 
	Эдгээр хөтчүүд нь өгөгдлийг бичиж эхлэхээсээ өмнө дуутайгаар хайдаг бөгөөд 
	унших, бичих эсвэл хайхдаа мэдэгдэхүйц дуутай байдаг. QIC соронзон хальснууд нь 
	6&nbsp;x 4&nbsp;x 0.7 инч (152 x 102 x 17 мм) хэмжээтэй байдаг.</para>

      <para>Өгөгдлийн дамжуулах чадвар ~150&nbsp;kB/s-с ~500&nbsp;kB/s хүртэл байна. 
	Өгөгдлийн багтаамж 40&nbsp;MB-с 15&nbsp;GB хүртэл байна. Шинэ QIC хөтчүүдийн 
	ихэнхэд тоног төхөөрөмжийн шахалт байдаг. QIC хөтчүүд нь бага суулгагддаг; тэдгээр нь 
	DAT хөтчүүдээр шахагдсан юм.</para>

      <para>Өгөгдөл нь соронзон хальс уруу замаар бичигддэг. Замууд нь соронзон хальсны зөөвөрлөгчийн нэг төгсгөлөөс 
	нөгөө уруу урт тэнхлэгийн дагуу байдаг. Замуудын тоо болон замын өргөн соронзон хальсны багтаамжаас 
	хамаарч өөр өөр байдаг. Бүх шинэ хөтчүүдийн ихэнх нь хамгийн багадаа бодоход уншилтын 
	(ихэнхдээ бас бичилтийн хувьд) хуучинтайгаа нийцтэй байдаг. QIC нь өгөгдлийн аюулгүй 
	байдлын хувьд нэлээн нэр хүндтэй байдаг (механизм нь хөтчүүдийг мушгиа скан хийснээс 
	илүү хялбар бөгөөд хүчирхэг байдаг).</para>

      <para>5,000 нөөцлөлтийн дараа соронзон хальснуудыг ашиглахаа болих шаардлагатай.</para>
    </sect2>

    <sect2 id="backups-tapebackups-dlt">
      <title>DLT</title>
      <indexterm>
        <primary>соронзон хальс зөөвөрлөгч</primary>
	<secondary>DLT</secondary>
      </indexterm>

      <para>DLT нь энд жагсаагдсан бүх хөтчийн төрлүүдээс хамгийн хурдан өгөгдөл дамжуулах 
	чадвартай байдаг. 1/2" (12.5мм) соронзон хальс нь ганц дамартай хайрцагт 
	(4 x 4 x 1 инч; 100 x 100 x 25 мм) байдаг. Хайрцаг нь нэг талаараа 
	ганхах хаалгатай байдаг. Хөтчийн механизм соронзон хальсны тэргүүнийг гаргаж авахын тулд 
	энэ хаалгыг онгойлгодог. Соронзон хальсны тэргүүн нь зууван нүхтэй байх бөгөөд 
	хөтөч соронзон хальсыг <quote>дэгээдэхдээ</quote> үүнийг  ашигладаг. Авах (take-up) 
	дамар нь соронзон хальсны хөтчийн дотор байрладаг. Энд жагсаагдсан 
	бусад соронзон хальсны хайрцагнууд (9 замтай соронзон хальснууд нь жич юм) нь соронзон хальсны хайрцган дотор 
	байрлах хангах болон take-up дамруудтай  байдаг.</para>

      <para>Өгөгдөл дамжуулах чадвар нь ойролцоогоор 1.5&nbsp;MB/s бөгөөд 4мм, 8м,  QIC 
	соронзон хальсны хөтчүүдийн дамжуулах чадвараас 3 дахин их байдаг. Өгөгдлийн багтаамж нь 
	нэг хөтчийн хувьд 10&nbsp;GB-аас 20&nbsp;GB хүрдэг. Хөтчүүд нь олон соронзон хальс 
	солигчид болон олон соронзон хальс хэлбэрээр байдаг, олон хөтөч бүхий соронзон хальсны сангууд нь 
	нийтдээ 50&nbsp;GB-с 9&nbsp;TB хүртэл хадгалалт бүхий 5-аас 900 хүртэл соронзон хальснуудыг  
	1-ээс 20 хүртэлх хөтчүүд дээр агуулдаг.</para>

      <para>Шахалттай бол DLT Төрөл 4 хэлбэршүүлэлт нь 70&nbsp;GB багтаамжийг 
	дэмждэг.</para>

      <para>Өгөгдөл нь соронзон хальсны замууд дээр аялалын чиглэлийн дагуу (QIC соронзон хальснуудын адил) 
	зэрэгцээгээр бичигддэг. Хоёр зам нэг удаа бичигддэг. Унших/бичих толгойны амьдрах хугацаа 
	харьцангуй урт байдаг; соронзон хальс хөдлөхөө болиход толгой болон соронзон хальсны хоорондын 
	хамаатай хөдөлгөөн байхгүй болно.</para>
    </sect2>

    <sect2>
      <title id="backups-tapebackups-ait">AIT</title>
      <indexterm>
        <primary>соронзон хальс зөөвөрлөгч</primary>
	<secondary>AIT</secondary>
      </indexterm>

      <para>AIT нь Sony-гоос гаргасан шинэ хэлбэршүүлэлт бөгөөд нэг соронзон хальсны хувьд 50&nbsp;
	GB хүртэл (шахалттайгаар) мэдээллийг агуулж чадна. Соронзон хальснууд нь санах ойн бичил 
	схемүүдийг агуулдаг бөгөөд эдгээр нь соронзон хальсны агуулгын индексийг хадгалдаг. Бусад 
	соронзон хальснуудын хувьд хэд хэдэн минут шаардагддаг бол харин энэ индексийг соронзон хальсны хөтөч 
	соронзон хальс дээрх файлуудын байрлалыг тодорхойлохын тулд  маш хурдан уншдаг. 
	<application>SAMS:Alexandria</application> зэрэг програм нь 
	соронзон хальсны санах ойн бичил схемтэй шууд холбогдон агуулгыг дэлгэцэд гаргаж, ямар файлууд аль 
	соронзон хальс уруу нөөцлөгдсөнийг тодорхойлж, зөв соронзон хальсыг олон ачаалж соронзон хальснаас өгөгдлийг 
	сэргээн дөч болон түүнээс дээш AIT соронзон хальсны сангуудыг ажиллуулж чаддаг.</para>

      <para>Үүнтэй адил сангууд $20,000 хавьцаа үнэ хүрч тэдгээрийг сонирхогчдын зах зээлээс 
	бага зэрэг шахдаг байна.</para>
    </sect2>

    <sect2>
      <title>Шинэ соронзон хальсыг анх удаа ашиглах нь</title>

      <para>Анхны удаа шинэ, хов хоосон соронзон хальсыг уншихыг оролдвол амжилтгүй болно. 
	Консолын мэдэгдлүүд үүнтэй төстэй байна:</para>

      <screen>sa0(ncr1:4:0): NOT READY asc:4,1
sa0(ncr1:4:0):  Logical unit is in process of becoming ready</screen>

      <para>Соронзон хальс нь Identifier Block буюу Танигч Блокийг (block number 0) 
	агуулаагүй байна. Бүх QIC соронзон хальснууд нь QIC-525 стандартыг хэрэглэж эхэлснээс 
	хойш Танигч Блокийг соронзон хальсанд бичдэг. Хоёр шийдэл байдаг:</para>

      <itemizedlist>
	<listitem>
	  <para><command>mt fsf 1</command> тушаал нь Танигч Блокийг соронзон хальс уруу 
		бичихийг соронзон хальсны хөтчид хэлнэ.</para>
	</listitem>

	<listitem>
	  <para>Нүүрний товчлуурыг ашиглан соронзон хальсыг гаргаж авна.</para>

	  <para>Соронзон хальсыг дахин хийгээд түүн уруу өгөгдлийг 
		<command>dump</command> хийнэ.</para>

	  <para><command>dump</command> тушаал нь <errorname>DUMP: End of tape
	    detected</errorname> гэж мэдэгдэх бөгөөд консол <errorname>HARDWARE
	    FAILURE info:280 asc:80,96</errorname> гэж харуулна.</para>

	  <para><command>mt rewind</command> тушаал ашиглан соронзон хальсыг буцаана.</para>

	  <para>Дараа дараачийн соронзон хальсны үйлдлүүд амжилттай болно.</para>
	</listitem>
      </itemizedlist>

    </sect2>
  </sect1>

  <sect1 id="backups-floppybackups">
    <title>Уян диск уруу нөөцлөх</title>

    <sect2 id="floppies-using">
      <title>Өөрийн өгөгдлийг нөөцлөхийн тулд би уян дискнүүдийг ашиглаж болох уу?</title>
      <indexterm><primary>нөөц уян дискнүүд</primary></indexterm>
      <indexterm><primary>уян дискнүүд</primary></indexterm>

      <para>Уян дискнүүд нь нөөц хийхэд тийм ч тохиромжтой зөөвөрлөгч биш юм, учир нь:</para>

      <itemizedlist>
	<listitem>
	  <para>Энэ зөөвөрлөгч нь найдваргүй, ялангуяа урт хугацааны туршид найдваргүй 
		байдаг.</para>
	</listitem>

	<listitem>
	  <para>Нөөцлөх болон буцааж сэргээх нь их удаан байдаг.</para>
	</listitem>

	<listitem>
	  <para>Тэдгээр нь маш хязгаарлагдмал багтаамжтай (бүхэл бүтэн хатуу дискийг хэдэн арван 
		уян дискэнд нөөцлөх нь их олон өдөр шаардана).</para>
	</listitem>
      </itemizedlist>

      <para>Гэхдээ хэрэв танд өөрийн өгөгдлийг нөөцлөх өөр ямар ч арга байхгүй бол 
	уян дискнүүдэд нөөцлөх нь нөөц хийхгүй байснаас хамаагүй дээр юм.</para>

      <para>Хэрэв та уян дискнүүд ашиглах шаардлагатай болсон бол сайн чанарынхыг 
	ашигласан эсэхээ шалгах хэрэгтэй. Оффис дээр чинь хоёр жил хэвтсэн уян дискнүүд
	муу сонголт болох юм. Нэр хүндтэй үйлдвэрлэгчээс гаргасан шинэ дискнүүдийг 
	ашиглах нь зүйтэй юм.</para>
    </sect2>

    <sect2 id="floppies-creating">
      <title>Тэгэхээр би өөрийн өгөгдлийг уян диск уруу хэрхэн нөөцлөх вэ?</title>

      <para>Уян диск уруу нөөцлөх хамгийн шилдэг арга нь &man.tar.1; тушаалыг 
	<option>-M</option> (олон эзлэхүүн) тохируулгатайгаар ашиглах 
	явдал юм. Энэ нь олон уян дискнүүдэд нөөцлөх боломжийг олгодог.</para>

      <para>Тухайн сан болон дэд сан доторх бүх файлуудыг нөөцлөхийн тулд үүнийг 
	ашиглах хэрэгтэй (<username>root</username> хэрэглэгчээр):</para>

      <screen>&prompt.root; <userinput>tar Mcvf /dev/fd0 *</userinput></screen>

      <para>Эхний уян диск дүүрсний дараа &man.tar.1; нь дараагийн эзлэхүүнийг 
	оруулахыг хүсэх болно (учир нь &man.tar.1; нь зөөвөрлөгчөөс хамааралгүй бөгөөд 
	эзлэхүүнүүдэд ханддаг; энд уян дискийг хэлж байна).</para>

      <screen>Prepare volume #2 for /dev/fd0 and hit return:</screen>

      <para>Энэ нь заагдсан файлууд архивлагдах хүртэл (эзлэхүүний дугаар нэмэгдэн) 
	давтагдах болно.</para>
    </sect2>

    <sect2 id="floppies-compress">
      <title>Би өөрийнхөө нөөцүүдийг шахаж болох уу?</title>
      <indexterm>
        <primary><command>tar</command></primary>
      </indexterm>
      <indexterm>
        <primary><command>gzip</command></primary>
      </indexterm>
      <indexterm><primary>шахалт</primary></indexterm>

      <para>Харамсалтай нь &man.tar.1; нь олон эзлэхүүн бүхий архивуудын хувьд 
	<option>-z</option> тохируулгыг ашиглахыг зөвшөөрдөггүй. Мэдээж та 
	бүх файлуудыг &man.gzip.1; хийж тэдгээрийг уян диск уруу &man.tar.1; 
	хийж дараа нь файлуудыг дахин &man.gunzip.1; хийж болно!</para>
    </sect2>

    <sect2 id="floppies-restoring">
      <title>Би өөрийн нөөцүүдийг хэрхэн сэргээх вэ?</title>

      <para>Бүхэл архивыг сэргээхдээ дараах тушаалыг ашиглана:</para>

      <screen>&prompt.root; <userinput>tar Mxvf /dev/fd0</userinput></screen>

      <para>Зөвхөн заагдсан файлуудыг сэргээх хоёр арга байдаг бөгөөд та 
	тэдгээрийг ашиглаж болно. Эхлээд та эхний дискнээс эхлээд дараах тушаалыг 
	ашиглана:</para>

      <screen>&prompt.root; <userinput>tar Mxvf /dev/fd0 <replaceable>filename</replaceable></userinput></screen>

      <para>&man.tar.1; хэрэгсэл нь шаардлагатай файлыг олох хүртлээ дараа дараагийн уян дискнүүдийг 
	хийхийг танаас хүсэх болно.</para>

      <para>Өөрөөр, хэрэв та файл нь яг аль уян диск дээр байгааг мэдэж байвал 
	ердөө л тэр уян дискийг оруулж дээрхтэй адил тушаалыг ашиглах хэрэгтэй.
	Хэрэв уян диск дээрх эхний файл нь өмнөх диск дээрхийн үргэлжлэл бол 
	таныг асуугаагүй байсан ч гэсэн &man.tar.1; үүнийг сэргээж чадахгүй 
	гэж танд анхааруулах болно!</para>
    </sect2>
  </sect1>

  <sect1 id="backup-strategies">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Лоуэл</firstname>
	  <surname>Жилбэрт</surname>
	  <contrib>Анхлан хийсэн </contrib>
	</author>
      </authorgroup>
      <!-- 3 Dec 2005 -->
    </sect1info>

    <title>Нөөцлөх стратегууд</title>

    <para>Нөөцлөх төлөвлөгөөг боловсруулах эхний шаардлага нь дараах бүх асуудлуудыг 
	хамарсан эсэхийг шалгах явдал юм:</para>

    <itemizedlist>
      <listitem>
	<para>Дискний гэмтэл</para>
      </listitem>
      <listitem>
	<para>Санамсаргүй файл устгалт</para>
      </listitem>
      <listitem>
	<para>Санамсаргүй файлын эвдрэл</para>
      </listitem>
      <listitem>
	<para>Газар дээрх нөөцүүд байвал тэдгээрийг оруулаад машины 
	бүрэн сүйрэл (өөрөө хэлбэл гал).</para>
      </listitem>
    </itemizedlist>

    <para>Эдгээр асуудал бүрийг шал өөр техникээр шийдэснээр зарим системүүдийг 
	илүүтэй ажиллуулах төгс боломж байж болох юм. Маш бага үнэ цэнэтэй 
	өгөгдөл бүхий чанга хувийн системүүдийг тооцохгүй юм бол нэг техник нь 
	бүх асуудлуудыг хамрах нь бараг боломжгүй юм.</para>

    <para>Хэрэгслийн хайрцаг дахь зарим нэг техникүүдийг дурдвал:</para>

    <itemizedlist>
      <listitem>
	<para>Бүх системийн архивууд нь сайтаас гадна байнгын зөөвөрлөгчид 
	нөөцлөгдөнө. Энэ нь дээр дурдсан бүх асуудлуудаас хамгаалах боловч 
	сэргээх нь тохиромжгүй удаан байдаг. Та нөөцүүдийн хуулбаруудыг 
	газар дээр нь ба/эсвэл шууд авч болохоор хадгалж болох боловч 
	файлуудыг сэргээх нь ялангуяа зөвшөөрөгдөөгүй хэрэглэгчдэд 
	бас л тохиромжгүй хэвээр байдаг.</para>
      </listitem>

      <listitem>
	<para>Файлын системийн хормын хувилбарууд. Энэ нь яг үнэндээ зөвхөн 
	санамсаргүйгээр файлыг устгасан тохиолдолд тустай, гэхдээ 
	энэ нь тийм тохиолдолд <emphasis>маш</emphasis> тус болохуйц 
	байдаг бөгөөд хурдан, ажиллахад хялбар байдаг.</para>
      </listitem>

      <listitem>
	<para>Бүх файлын систем ба/эсвэл дискнүүдийн хуулбарууд (бүхэл машины үе үе давтагдах 
	&man.rsync.1;). Энэ нь ерөнхийдөө онцгой шаардлага бүхий сүлжээнүүдэд хамгийн 
	ашигтай байдаг. Дискний эвдрэл, гэмтлийн эсрэг ерөнхий хамгаалалтын хувьд 
	энэ нь ихэвчлэн <acronym>RAID</acronym>-с чанарын хувьд муу байдаг. Санамсаргүйгээр 
	устгасан файлуудыг сэргээхэд энэ нь <acronym>UFS</acronym> хормын хувилбартай 
	дүйцэхээр боловч та алийг дээдэлдгээс хамаарах юм.</para>
      </listitem>

      <listitem>
	<para><acronym>RAID</acronym>.  Диск эвдрэх, гэмтэх үед зогсох хугацааг 
	багасгаж зайлсхийдэг. Маш бага шаардлагатай хэдий ч дискний эвдрэлүүдтэй илүүтэй 
	зууралдах (учир нь та олон дисктэй) хэрэгтэй болдог.</para>
      </listitem>

      <listitem>
	<para>Файлуудын байрлалыг (хурууны хээ) шалгах. Үүнд &man.mtree.8; хэрэгсэл их 
	ашигтай байдаг. Энэ нь нөөцлөх техник биш боловч танд өөрийн нөөцүүддээ хандахаар 
	болох үед та хэрэг болох болно. Энэ нь сайтаас гаднах шууд 
	бус нөөцүүдийн хувьд ялангуяа чухал бөгөөд үе үе шалгагдаж байх ёстой.</para>
      </listitem>
    </itemizedlist>

    <para>Үүнээс илүү олон техникийг бодож олох нь амархан бөгөөд тэдгээрийн 
	ихэнх нь дээр дурдсан техникүүдийн өөр хувилбарууд юм. Тусгайлсан шаардлагууд нь 
	ихэвчлэн тусгайлсан техникт хүргэдэг (жишээ нь шууд ажиллаж байгаа мэдээллийн 
	баазыг нөөцлөх нь зөвхөн мэдээллийн санд зориулагдсан аргыг дундын шат 
	болгон ихэвчлэн ашиглахыг шаарддаг). Ямар аюулуудаас та хамгаалахыг хүсэж байгаа болон 
	тэдгээр тус бүртэй хэрхэн ажиллахаа мэдэх нь чухал юм.</para>
  </sect1>

  <sect1 id="backup-basics">
    <title>Нөөцлөлтийн үндсүүд</title>

    <para>Гурван гол нөөцлөх програм бол &man.dump.8;, &man.tar.1; болон 
	&man.cpio.1; юм.</para>

    <sect2>
      <title>Dump ба Restore</title>
      <indexterm>
        <primary>нөөцлөх програм хангамж</primary>
	<secondary>dump / restore</secondary>
      </indexterm>
      <indexterm><primary><command>dump</command></primary></indexterm>
      <indexterm><primary><command>restore</command></primary></indexterm>

      <para>Уламжлалт &unix; нөөцлөх програмууд нь <command>dump</command> ба 
	<command>restore</command> юм. Тэдгээр нь файлын системүүдээр үүсгэгдсэн 
	файлууд, холбоосууд болон сангуудын хийсвэр ойлголтуудын доор хөтчүүд дээр дискний 
	блокуудын цуглуулга хэлбэрээр ажилладаг. Бусад нөөцлөх програмуудаас ялгаатай нь 
	<command>dump</command> нь төхөөрөмж дээрх бүхэл файлын системийг нөөцөлдөг. Файлын 
	системийн зөвхөн хэсгийг эсвэл нэгээс илүү файлын систем дагуу байрлах сангийн модыг 
	энэ нь нөөцөлж чаддаггүй. <command>dump</command> нь файлууд болон сангуудыг соронзон 
	хальс уруу бичдэггүй, харин файлууд болон сангуудаас тогтох түүхий өгөгдлийн блокуудыг 
	бичдэг. Өгөгдлийг задлахад хэрэглэгдэхдээ <command>restore</command> нь анхдагчаар 
	түр зуурын файлуудыг <filename>/tmp/</filename> санд хадгалдаг. Хэрэв та жижиг 
	хэмжээний <filename>/tmp</filename> сан бүхий нөөц сэргээх диск дээрээс ажиллаж 
	байгаа бол сэргээлтийг амжилттай гүйцээхийн тулд илүү чөлөөтэй зайтай сан руу 
	<envar>TMPDIR</envar> орчны хувьсагчийг зааж өгөх хэрэгтэй байж болох юм.</para>

      <note><para>Хэрэв та өөрийн root сандаа <command>dump</command>-г 
	хэрэглэвэл та <filename>/home</filename>,
        <filename>/usr</filename> эсвэл бусад олон сангуудыг нөөцлөхгүй бөгөөд 
	үүний учир бол эдгээр нь ихэвчлэн бусад файлын системүүдийн холбох цэгүүд буюу 
	эсвэл тэдгээр файлын системүүд уруу заасан симболын холбоосууд байдаг.</para></note>

      <para><command>dump</command> нь өөрийн хөгжлийн эхний өдрүүд болох 
	AT&amp;T UNIX-ийн 6-р хувилбараас (1975 он орчим) үлдсэн кодтой 
	байдаг. Анхдагч параметрүүд нь өнөөдөр байгаа өндөр нягтралтай (62,182 ftpi хүртэл) 
	зөөвөрлөгчид биш 9 зам (6250 bpi) бүхий соронзон хальсанд тохирдог. Одоогийн соронзон хальсны 
	хөтчүүдийн багтаамжийг хэрэглэхийн тулд эдгээр анхдагчуудыг тушаалын мөрөөс дарж 
	өөрчлөх ёстой.</para>

      <indexterm><primary><filename>.rhosts</filename></primary></indexterm>
      <para>Мөн сүлжээгээр өөр компьютерт холбогдсон соронзон хальсны хөтөч уруу өгөгдлийг 
	<command>rdump</command> болон <command>rrestore</command> 
	тушаал ашиглан нөөцлөх боломжтой байдаг. Энэ хоёр програм нь алсын соронзон хальсны 
	хөтчид хандахдаа &man.rcmd.3; болон &man.ruserok.3;-д тулгуурладаг. 
	Тиймээс нөөцлөлтийг хийж байгаа хэрэглэгч алсын компьютерийн 
	<filename>.rhosts</filename> файл дотор жагсаагдсан байх ёстой. 
	<command>rdump</command> болон <command>rrestore</command> 
	тушаалуудад өгөх нэмэлт өгөгдлүүд нь алсын компьютер дээр ашиглаж болохоор 
	байх ёстой. <hostid>komodo</hostid> гэж нэрлэгдсэн Sun уруу холбогдсон 
	Exabyte соронзон хальсны хөтөч уруу FreeBSD компьютераас <command>rdump</command> 
	хийхдээ дараах тушаалыг ашиглана:</para>

      <screen>&prompt.root; <userinput>/sbin/rdump 0dsbfu 54000 13000 126 komodo:/dev/nsa8 /dev/da0a 2>&amp;1</userinput></screen>

      <para>Болгоомжлоорой: <filename>.rhosts</filename> танин нэвтрэлтийг 
	зөвшөөрөх нь аюулгүй байдлын асуудлууд үүсгэдэг. Өөрийн нөхцөл байдлыг 
	анхааралтай үнэлэх хэрэгтэй.</para>

      <para>Мөн <command>dump</command> болон <command>restore</command> 
	тушаалыг илүү аюулгүй загвараар <command>ssh</command> дээгүүр ашиглах 
	бас боломжтой байдаг.</para>

      <example>
	<title><application>ssh</application>-ээр <command>dump</command>-г ашиглах нь</title>

	<screen>&prompt.root; <userinput>/sbin/dump -0uan -f - /usr | gzip -2 | ssh -c blowfish \
          targetuser@targetmachine.example.com dd of=/mybigfiles/dump-usr-l0.gz</userinput></screen>

      </example>

      <para>Эсвэл <command>dump</command>-ийн дотор байдаг нэг арга болох <envar>RSH</envar> орчны хувьсагчийг 
	тохируулан ашиглаж болно:</para>

      <example>
	<title><application>ssh</application>-ээр <envar>RSH</envar> тохируулан <command>dump</command>-г 
		ашиглах нь</title>

	<screen>&prompt.root; <userinput>RSH=/usr/bin/ssh /sbin/dump -0uan -f targetuser@targetmachine.example.com:/dev/sa0 /usr</userinput></screen>

      </example>

    </sect2>

    <sect2>
      <title><command>tar</command></title>
      <indexterm>
        <primary>нөөцлөх програм хангамж</primary>
        <secondary><command>tar</command></secondary>
      </indexterm>

      <para>&man.tar.1; нь бас AT&amp;T UNIX-ийн 6-р хувилбараас (1975 он орчим) 
	эхтэй. <command>tar</command> нь файлын системтэй хамт ажилладаг; 
	энэ нь файлууд болон сангуудыг соронзон хальс уруу бичдэг. <command>tar</command> 
	нь &man.cpio.1;-д байдаг бүрэн хэмжээний тохируулгуудыг дэмждэггүй боловч 
	энэ нь <command>cpio</command>-ийн хэрэглэдэг ховор тушаалын дамжуулах 
	хоолойг шаарддаггүй.</para>

      <indexterm><primary><command>tar</command></primary></indexterm>

      <para><hostid>komodo</hostid> гэж нэрлэгдсэн Sun уруу холбогдсон 
	Exabyte соронзон хальсны хөтөч уруу <command>tar</command> 
	хийхдээ дараах тушаалыг ашиглана:</para>

      <screen>&prompt.root; <userinput>tar cf - . | rsh komodo dd of=<replaceable>tape-device</replaceable> obs=20b</userinput></screen>

      <para>Хэрэв та сүлжээгээр нөөцлөхийн аюулгүй байдалд санаа зовж байгаа бол 
	<command>rsh</command>-ийн оронд <command>ssh</command> тушаалыг 
	ашиглах хэрэгтэй.</para>
    </sect2>

    <sect2>
      <title><command>cpio</command></title>
      <indexterm>
        <primary>нөөцлөх програм хангамж</primary>
        <secondary><command>cpio</command></secondary>
      </indexterm>

      <para>&man.cpio.1; нь соронзон зөөвөрлөгчид зориулагдсан &unix;-ийн 
	анхны файл солилцох соронзон хальсны програм юм. <command>cpio</command> нь 
	(бусад олон тохируулгуудын дотроос) байт солилцохыг хийх, хэд хэдэн төрлийн 
	архивын хэлбэршүүлэлтүүдийг бичих болон өгөгдлийг өөр програм уруу хоолойгоор 
	гаргах зэрэг тохируулгуудтай байдаг. Сүүлийн боломж нь <command>cpio</command>-г 
	суулгацын зөөвөрлөгчийн хувьд сайн сонголт болгодог. <command>cpio</command> нь 
	сангийн модоор хэрхэн явахаа мэддэггүй бөгөөд файлуудын жагсаалтыг 
	<filename>stdin</filename>-ээс хангаж өгөх ёстой.</para>
      <indexterm><primary><command>cpio</command></primary></indexterm>

      <para><command>cpio</command> нь сүлжээгээр нөөцлөхийг дэмждэггүй. 
	Та дамжуулах хоолой болон <command>rsh</command>-ийг ашиглаж өгөгдлийг 
	алсын соронзон хальсны хөтөч уруу илгээж болно.</para>

      <screen>&prompt.root; <userinput>for f in <replaceable>directory_list; do</replaceable></userinput>
<userinput>find $f &gt;&gt; backup.list</userinput>
<userinput>done</userinput>
&prompt.root; <userinput>cpio -v -o --format=newc &lt; backup.list | ssh <replaceable>user</replaceable>@<replaceable>host</replaceable> "cat &gt; <replaceable>backup_device</replaceable>"</userinput></screen>

      <para><replaceable>directory_list</replaceable> нь таны нөөцлөхийг хүссэн 
	сангуудын жагсаалт бол
	<replaceable>user</replaceable>@<replaceable>host</replaceable> нь 
	нөөцлөлтийг хийж байгаа хэрэглэгч/хостын нэрийн хослол бөгөөд 
	<replaceable>backup_device</replaceable> нь нөөцлөлт хийгдэх төхөөрөмж 
	(өөрөөр хэлбэл <filename>/dev/nsa0</filename>) юм.</para>
    </sect2>

    <sect2>
      <title><command>pax</command></title>
      <indexterm>
        <primary>нөөцлөх програм хангамж</primary>
        <secondary><command>pax</command></secondary>
      </indexterm>
      <indexterm><primary><command>pax</command></primary></indexterm>
      <indexterm><primary>POSIX</primary></indexterm>
      <indexterm><primary>IEEE</primary></indexterm>

      <para>&man.pax.1; нь <command>tar</command> болон <command>cpio</command> 
	тушаалын IEEE/&posix;-ийн хариулт юм. Жил ирэх тутам <command>tar</command> болон 
	<command>cpio</command> тушаалуудын төрөл бүрийн хувилбарууд нь хоорондоо мэдэгдэхүйц 
	нийцгүй болж ирсэн юм. Тэдгээртэй тэмцэж бүр мөсөн стандартчилахын оронд 
	&posix; нь архивын шинэ хэрэгсэл үүсгэсэн юм. <command>pax</command> нь 
	өөрийн шинэ хэлбэршүүлэлтээс гадна <command>cpio</command> болон <command>tar</command> 
	тушаалуудын төрөл бүрийн хэлбэршүүлэлтийн ихэнхийг уншиж бичихийг оролддог. 
	Энэ тушаалын олонлог нь  <command>tar</command> тушаалынхтай биш харин 
	<command>cpio</command> тушаалынхтай илүү төстэй байдаг.</para>
    </sect2>

    <sect2 id="backups-programs-amanda">
      <title><application>Amanda</application></title>
      <indexterm>
        <primary>нөөцлөх програм хангамж</primary>
        <secondary><application>Amanda</application></secondary>
      </indexterm>
      <indexterm><primary><application>Amanda</application></primary></indexterm>

      <!-- Remove link until <port> tag is available -->
      <para><application>Amanda</application> (Advanced Maryland
        Network Disk Archiver) нь нэг програм биш клиент/сервер програм юм. 
	<application>Amanda</application> сервер нь ганц соронзон хальсны хөтөч уруу 
	<application>Amanda</application> клиенттэй, <application>Amanda</application> 
	сервер уруу сүлжээгээр холбогдсон дурын тооны компьютерийг нөөцлөх болно. 
	Хэд хэдэн том дискнүүд бүхий сайтууд дээр байдаг нийтлэг асуудлууд нь өгөгдлийг 
	соронзон хальс уруу нөөцлөхөд шаардагдах хугацаа  нь уг үйлдлийн хувьд зориулагдсан 
	хугацаанаас илүү гарах явдал юм. <application>Amanda</application> нь 
	энэ асуудлыг шийддэг. <application>Amanda</application> нь 
	хэд хэдэн файлын системүүдийг нэг зэрэг нөөцлөхдөө <quote>holding disk буюу хүлээгдэх диск</quote>ийг
	ашигладаг. <application>Amanda</application> нь 
	<quote>архивын олонлогууд</quote> буюу <application>Amanda</application>-ийн 
	тохиргооны файлд жагсаагдсан бүх файлын системүүдийн бүрэн нөөцлөлтүүдийг үүсгэхэд хэсэг хугацаанд 
	хэрэглэгдсэн бүлэг соронзон хальснуудыг үүсгэдэг. <quote>Архивын олонлогууд</quote> нь бас 
	файлын системүүдийн шөнө болгоны нэмэгдсэн (эсвэл ялгаатай) нөөцлөлтүүдийг агуулдаг. 
	Эвдэрсэн файлын системийг сэргээх нь хамгийн сүүлийн бүрэн нөөцлөлт болон нэмэгдсэн 
	нөөцлөлтүүдийг шаарддаг.</para>

      <para>Тохиргооны файл нь нөөцлөлтүүд болон <application>Amanda</application>-ийн 
	үүсгэдэг сүлжээний урсгалыг нарийн хянах боломжийг хангадаг. <application>Amanda</application>
	нь өгөгдлийг соронзон хальс уруу бичихийн тулд дээр дурдсан нөөцлөлтийн програмуудыг 
	ашиглана. <application>Amanda</application> нь порт эсвэл багц хэлбэрээр 
	байдаг бөгөөд анхдагчаар суулгагдаагүй байдаг.</para>
      </sect2>

    <sect2>
      <title>Юу ч хийхгүй байх</title>

      <para><quote>Юу ч хийхгүй байх</quote> нь компьютерийн програм биш боловч энэ нь 
	хамгийн их ашиглагддаг нөөцлөлтийн стратеги юм. Ямар ч эхний зардал байхгүй. 
	Мөрдөх нөөцлөлтийн төлөвлөгөө байхгүй. Зүгээр л үгүй гэх хэрэгтэй. Хэрэв таны 
	өгөгдөлд ямар нэг асуудал тохиолдвол шүд зуугаад л тэвчих хэрэгтэй!</para>

      <para>Хэрэв таны цаг болон өгөгдөл нь тийм ч чухал биш эсвэл юу ч биш бол 
	<quote>Do nothing буюу юу ч хийхгүй байх</quote> нь таны компьютерийн 
	хувьд хамгийн тохиромжтой нөөцлөлтийн програм болох юм. Гэхдээ &unix; 
	нь ашигтай хэрэгсэл юм, та зургаан сарын дотор үнэтэй файлуудын цуглуулгатай  болж 
	үүнийг мэдрэх болно.</para>

      <para><quote>Юу ч хийхгүй байх</quote> нь <filename>/usr/obj</filename> 
	болон таны компьютераар яг үүсгэгдэж болох бусад сангийн моднуудын хувьд зөв 
	нөөцлөх арга болдог. Үүний жишээ нь энэ гарын авлагын  HTML эсвэл &postscript;-с
	тогтох хувилбарын файлууд байж болох юм. Эдгээр баримтын хэлбэршүүлэлтүүд нь 
	SGML оролтын файлуудаас үүсгэгддэг. HTML эсвэл &postscript; файлуудын 
	нөөцлөлтийг үүсгэх нь шаардлагагүй юм. SGML файлууд нь байнга нөөцлөгддөг.</para>
    </sect2>

    <sect2>
      <title>Аль нөөцлөлтийн програм хамгийн шилдэг нь вэ?</title>
      <indexterm>
        <primary>LISA</primary>
      </indexterm>

      <para>&man.dump.8; <emphasis>Үе.</emphasis> Элизабет Д. Звики
	энд дурдагдсан бүх нөөцлөлтийн програмуудыг зовоосон тест хийсэн. Өөрийн бүх өгөгдөл 
	болон &unix; файлын системүүдийн онцлогуудыг хадгалах цэвэр сонголт бол 
	<command>dump</command> болсон байна. Элизабет маш их төрөл бүрийн ховор 
	нөхцөлүүдийг  (зарим нь тийм ч ховор биш) агуулсан файлын системүүдийг үүсгэж 
	тэдгээр файлын системүүдийг нөөцлөн дараа нь сэргээж програм бүрийг тест хийсэн 
	байна. Онцгой зүйлүүдэд цоорхойтой файлууд, хоосон блоктой болон цоорхойтой 
	файлууд, сонин тэмдэгт бүхий нэрээс тогтсон файлууд, бичигдэх боломжгүй уншигдах 
	боломжгүй файлууд, төхөөрөмжүүд, нөөцлөлтийн үед хэмжээгээ өөрчлөх файлууд, 
	нөөцлөлтийн үед үүсгэгдэж/устгагдсан файлууд зэргийг дурдаж болох юм. 
	Тэрээр үр дүнгээ 1991 оны 10 сард LISA дээр үзүүлсэн байна. 
	<ulink url="http://www.coredumps.de/doc/dump/zwicky/testdump.doc.html">Нөөцлөлт 
	болон Архивын програмуудыг зовоох тест</ulink> холбоосыг үзнэ үү.</para>
    </sect2>

    <sect2>
      <title>Яаралтай сэргээх процедур</title>

      <sect3>
	<title>Гамшгийн өмнө</title>

	<para>Учирч болзошгүй гамшигт бэлтгэхийн тулд таны хийх ёстой дөрвөн 
	үе шат байдаг.</para>
	<indexterm>
    <primary><command>bsdlabel</command></primary>
  </indexterm>

	<para>Эхлээд өөрийн диск бүрийн bsdlabel
	(өөрөөр хэлбэл <command>bsdlabel da0 | lpr</command>), өөрийн 
	файлын системийн хүснэгт (<filename>/etc/fstab</filename>) болон 
	бүх ачаалалтын мэдэгдлүүдийг тус бүр хоёр хувь хэвлэх хэрэгтэй.</para>

	<indexterm><primary>livefs CD</primary></indexterm>
	<para>Дараа нь <quote>livefs</quote> CDROM шарах хэрэгтэй.
	  Энэ CDROM нь &os; <quote>livefs</quote> аврах горим руу ачаалж 
	  орох боломжийг агуулсан байдаг. Ингэснээр хэрэглэгч 
	  &man.dump.8;,&man.restore.8;, &man.fdisk.8;, &man.bsdlabel.8;,
	  &man.newfs.8;, &man.mount.8; гэх мэт олон үйлдлийг хийх 
	  боломжтой болох юм. &os;/&arch.i386;&nbsp;&rel.current;-RELEASE-д 
	  зориулсан Livefs CD дүрс <ulink
	  url="ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/&arch.i386;/ISO-IMAGES/&rel.current;/&os;-&rel.current;-RELEASE-&arch.i386;-livefs.iso"></ulink> хаяг дээр бий.</para>

	<para>Гуравдугаарт нөөц соронзон хальснуудыг байнга үүсгэж байх хэрэгтэй. Таны сүүлийн нөөцлөлтөөс 
	хойш хийгдсэн өөрчлөлтүүд буцааж авагдах боломжгүйгээр алга болж болох юм. Нөөц 
	соронзон хальснууд уруу хийж болзошгүй бичилтийг хамгаалах хэрэгтэй.</para>

	<para>Дөрөвдүгээрт хоёрдугаар шатанд хийсэн <quote>livefs</quote> CDROM болон 
	  нөөцийн соронзон хальснуудыг шалгах ёстой. 
	Процедурынхаа талаар тэмдэглэгээ хийх хэрэгтэй. Эдгээр тэмдэглэгээнүүдээ 
	CDROM, хэвлэсэн зүйл болон нөөц соронзон хальснуудтайгаа цуг хадгалах 
	хэрэгтэй. Сэргээж байх үед таны анхаарал их сарнисан байж болох бөгөөд тэдгээр 
	тэмдэглэгээнүүд чинь таныг өөрийн нөөц соронзон хальснуудаа устгахаас сэргийлэх болно 
	(Яаж? <command>tar xvf /dev/sa0</command> тушаалын оронд та 
	санамсаргүйгээр <command>tar cvf /dev/sa0</command> гэж бичээд өөрийн 
	нөөц соронзон хальсыг дарж бичиж болох юм).</para>

	<para>Аюулгүй байдлын нэмэгдэл арга хэмжээ болгож тухайг бүрт нь ачаалагдах 
	  <quote>livefs</quote> CDROM болон нөөц соронзон хальс хоёрыг бэлдэж байх хэрэгтэй. 
	  Тус бүрийг нь тусад нь алсад 	өөр газар хадгалах хэрэгтэй. Тэр өөр газар нь яг 
	  тэр оффисийн байрны подвал байх ЁСГҮЙ. Дэлхийн Худалдааны Төвийн хэд хэдэн 
	  фирм үүнийг хэцүү замаар мэдэрсэн юм. Тэр өөр газар нь таны компьютерууд 
	  болон дискний хөтчүүдээс тусгаарлагдсан физикийн хувьд нэлээд зайтай газар байх ёстой.</para>
      </sect3>

      <sect3>
	<title>Гамшгийн дараа</title>

	<para>Түлхүүр асуулт бол: таны тоног төхөөрөмж амьд гарч чадсан уу? Байнгын 
	нөөцлөлт хийж байсан болохоор програм хангамжийн талаар та санаа зовох хэрэггүй 
	юм.</para>

	<para>Хэрэв тоног төхөөрөмж эвдэрсэн бол компьютерийг ашиглахаасаа өмнө 
	эвдэрсэн хэсгүүдийг солих шаардлагатай.</para>

	<para>Хэрэв таны тоног төхөөрөмж зүгээр байгаа бол 
	  CDROM хөтөч рүү <quote>livefs</quote> CDROM-оо хийгээд
	компьютераа ачаалах хэрэгтэй. Эхний суулгах цэс дэлгэц дээр гарах 
	болно. Зөв улсаа сонгоод 
	  <guimenuitem>Fixit -- Repair mode with CDROM/DVD/floppy or start a shell.</guimenuitem>
	  сонголтыг сонгоод <guimenuitem>CDROM/DVD -- Use the live filesystem CDROM/DVD</guimenuitem>
	  цэсийг сонгоно. Танд хэрэгтэй <command>restore</command> болон бусад програмууд 
	<filename class="directory">/mnt2/rescue</filename> санд байрлана.</para>

	<para>Файлын систем бүрийг тус тусад нь сэргээнэ.</para>

	<indexterm>
    <primary><command>mount</command></primary>
  </indexterm>
	<indexterm><primary>root хуваалт</primary></indexterm>
	<indexterm>
    <primary><command>bsdlabel</command></primary>
  </indexterm>
	<indexterm>
    <primary><command>newfs</command></primary>
  </indexterm>
	<para>Өөрийн эхний дискний root хуваалтыг <command>mount</command> (өөрөөр хэлбэл 
	<command>mount /dev/da0a /mnt</command>) хийхийг оролдоорой. Хэрэв bsdlabel 
	эвдэрсэн бол <command>bsdlabel</command> тушаалыг ашиглан дискийг дахин 
	хувааж таны хэвлэж хадгалсан шошготой адил тааруулж хаяглах хэрэгтэй. 
	<command>newfs</command> тушаал ашиглан файлын системүүдийг дахин үүсгэнэ. 
	Дискний root хуваалтыг унших-бичихээр дахин холбох хэрэгтэй (<command>mount -u -o rw
	    /mnt</command>). Энэ файлын системийн хувьд өгөгдлийг сэргээхийн тулд
	өөрийн нөөцлөх програм болон соронзон хальснуудыг ашиглана (өөрөөр хэлбэл <command>restore vrf
	    /dev/sa0</command>). Файлын системийг салгана (өөрөөр хэлбэл <command>umount
	    /mnt</command>). Эвдэрсэн файлын систем бүрийн хувьд давтана.</para>

	<para>Таны систем ажилласны дараа өөрийн өгөгдлийг шинэ соронзон хальс уруу нөөцлөх хэрэгтэй. 
	Сүйрэл эсвэл өгөгдлийн алдагдалд хүргэсэн тэр явдал дахин болж болох юм. Одоо зарцуулсан 
	нэг цаг таныг зовлонд учрахаас хожим аварч болох юм.</para>
      </sect3>

<![ %not.published; [

      <sect3>
	<title>* I Did Not Prepare for the Disaster, What Now?</title>

	<para></para>
      </sect3>
]]>

    </sect2>
  </sect1>

  <sect1 id="disks-virtual">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Марк</firstname>
	  <surname>Фонвил</surname>
	  <contrib>Дахин зохион байгуулж өргөжүүлсэн </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Сүлжээ, санах ой болон файл дээр тулгуурласан файлын системүүд</title>
    <indexterm><primary>виртуал дискнүүд</primary></indexterm>
    <indexterm>
      <primary>дискнүүд</primary>
      <secondary>виртуал</secondary>
    </indexterm>

    <para>Өөрийн компьютер уруу физикээр хийж болдог уян диск, CD-үүд, хатуу хөтчүүд гэх зэрэг 
	дискнүүдээс гадна бусад хэлбэрийн дискнүүд буюу  <firstterm>виртуал дискнүүд</firstterm>ийг 
	FreeBSD ойлгодог.</para>

    <indexterm><primary>NFS</primary></indexterm>
    <indexterm><primary>Coda</primary></indexterm>
    <indexterm>
      <primary>дискнүүд</primary>
      <secondary>санах ой</secondary>
    </indexterm>
    <para>Эдгээрт <link linkend="network-nfs">Network File System буюу сүлжээний файлын систем</link> 
	болон Coda зэрэг сүлжээний файлын системүүд, санах ой дээр тулгуурласан файлын 
	системүүд болон файл дээр тулгуурласан файлын системүүд орно.</para>

    <para>FreeBSD-ийн ямар хувилбарыг ажиллуулж байгаагаас хамаарч та 
	файл дээр болон санах ой дээр тулгуурласан файлын системүүдийг үүсгэж 
	ашиглахдаа өөр өөр хэрэгслүүдийг хэрэглэх шаардлагатай болно.</para>

    <note>
      <para>Хэрэглэгчийн хувьд мэдэгдэлгүйгээр төхөөрөмжийн цэгүүдийг хуваарилахын тулд 
	&man.devfs.5;-г ашиглана.</para>
    </note>

    <sect2 id="disks-mdconfig">
      <title>Файл дээр тулгуурласан файлын систем</title>
      <indexterm>
        <primary>дискнүүд</primary>
        <secondary>файл дээр тулгуурласан</secondary>
      </indexterm>

      <para>&man.mdconfig.8; хэрэгсэл нь FreeBSD дээр санах ой дээр тулгуурласан 
	дискнүүд, &man.md.4;-г тохируулж идэвхжүүлэхэд хэрэглэгддэг.
	&man.mdconfig.8;-г ашиглахын тулд та &man.md.4; модулийг ачаалах 
	хэрэгтэй, эсвэл өөрийн цөмийн тохиргооны файлдаа дэмжлэгийг нэмэх 
	хэрэгтэй болно:</para>

      <programlisting>device md</programlisting>

      <para>&man.mdconfig.8; тушаал нь гурван төрлийн санах ой дээр тулгуурласан 
	виртуал дискийг дэмждэг: эдгээр нь &man.malloc.9;-р хуваарилагдсан санах 
	ойн дискнүүд, файл эсвэл swap зай ашигласан санах ойн дискнүүд юм. 
	Нэг боломжтой хэрэглээ нь файлд хадгалагдсан уян эсвэл CD дүрсийг 
	холбох явдал юм.</para>

      <para>Байгаа файлын системийн дүрсийг холбохдоо:</para>

      <example>
	<title><command>mdconfig</command> ашиглан байгаа файлын системийн дүрсийг холбох нь</title>

	<screen>&prompt.root; <userinput>mdconfig -a -t vnode -f <replaceable>diskimage</replaceable> -u <replaceable>0</replaceable></userinput>
&prompt.root; <userinput>mount /dev/md<replaceable>0</replaceable> <replaceable>/mnt</replaceable></userinput></screen>
      </example>

      <para>&man.mdconfig.8; ашиглан шинэ файлын системийн дүрсийг үүсгэхдээ:</para>

      <example>
	<title><command>mdconfig</command> тушаал ашиглан шинэ файл дээр тулгуурласан диск үүсгэх нь</title>

	<screen>&prompt.root; <userinput>dd if=/dev/zero of=<replaceable>newimage</replaceable> bs=1k count=<replaceable>5</replaceable>k</userinput>
5120+0 records in
5120+0 records out
&prompt.root; <userinput>mdconfig -a -t vnode -f <replaceable>newimage</replaceable> -u <replaceable>0</replaceable></userinput>
&prompt.root; <userinput>bsdlabel -w md<replaceable>0</replaceable> auto</userinput>
&prompt.root; <userinput>newfs md<replaceable>0</replaceable>a</userinput>
/dev/md0a: 5.0MB (10224 sectors) block size 16384, fragment size 2048
        using 4 cylinder groups of 1.25MB, 80 blks, 192 inodes.
super-block backups (for fsck -b #) at:
 160, 2720, 5280, 7840
&prompt.root; <userinput>mount /dev/md<replaceable>0</replaceable>a <replaceable>/mnt</replaceable></userinput>
&prompt.root; <userinput>df <replaceable>/mnt</replaceable></userinput>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0a       4710    4  4330     0%    /mnt</screen>
      </example>

      <para>Хэрэв та <option>-u</option> тохируулгаар нэгжийн дугаарыг 
	зааж өгөхгүй юм бол &man.mdconfig.8; нь хэрэглэгдээгүй төхөөрөмжийг 
	сонгохын тулд &man.md.4; автомат хуваарилалтыг ашиглах болно. 
	Хуваарилагдсан нэгжийн нэр нь stdout уруу <devicename>md4</devicename> 
	мэтээр гарах болно. &man.mdconfig.8;-ийн тухай дэлгэрэнгүй 
	мэдээллийг гарын авлагын хуудаснаас лавлана уу.</para>

      <para>&man.mdconfig.8; хэрэгсэл нь их ашигтай, гэхдээ энэ нь 
	файл дээр тулгуурласан файлын систем үүсгэхийн тулд олон тушаалын мөрийг 
	асуудаг. FreeBSD нь бас &man.mdmfs.8; гэж нэрлэгддэг хэрэгсэлтэй 
	ирдэг, энэ програм нь &man.md.4;-г &man.mdconfig.8; тушаал 
	ашиглан тохируулж &man.newfs.8; ашиглан UFS файлын систем түүн 
	дээр тавьж &man.mount.8; ашиглан түүнийг холбодог. Жишээ нь 
	хэрэв та дээрхтэй ижил файлын системийн дүрсийг үүсгэж холбохыг 
	хүсвэл ердөө л дараах тушаалыг бичээрэй:</para>

      <example>
	<title><command>mdmfs</command> тушаал ашиглан файл дээр тулгуурласан дискийг тохируулж холбох нь</title>
	<screen>&prompt.root; <userinput>dd if=/dev/zero of=<replaceable>newimage</replaceable> bs=1k count=<replaceable>5</replaceable>k</userinput>
5120+0 records in
5120+0 records out
&prompt.root; <userinput>mdmfs -F <replaceable>newimage</replaceable> -s <replaceable>5</replaceable>m md<replaceable>0</replaceable> <replaceable>/mnt</replaceable></userinput>
&prompt.root; <userinput>df <replaceable>/mnt</replaceable></userinput>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md0        4718    4  4338     0%    /mnt</screen>
      </example>

      <para>Хэрэв та <option>md</option> тохируулгыг нэгжийн дугааргүй 
	ашиглавал &man.mdmfs.8; нь ашиглагдаагүй төхөөрөмжийг автоматаар 
	сонгохдоо &man.md.4; авто-нэгж боломжийг ашиглах болно. 
	&man.mdmfs.8;-ийн тухай дэлгэрэнгүй мэдээллийг гарын авлагын 
	хуудаснаас лавлана уу.</para>

    </sect2>

    <sect2 id="disks-md-freebsd5">
      <title>Санах ой дээр тулгуурласан файлын систем</title>
      <indexterm>
        <primary>дискнүүд</primary>
        <secondary>санах ойн файлын систем</secondary>
      </indexterm>

      <para>Санах ой дээр тулгуурласан файлын системийн хувьд 
	<quote>swap backing буюу swap дээрх тулгуурлалтыг</quote> 
	ихэнхдээ ашиглах хэрэгтэй. swap дээрх тулгуурлалтыг ашиглах нь санах ойн 
	диск нь анхдагчаар диск уруу swap хийгдэнэ гэсэн үг биш бөгөөд харин ердөө л санах 
	ойн диск нь санах ойн цөөрмөөс хуваарилагдаж хэрэв хэрэгцээтэй бол диск уруу 
	swap хийгдэж болно гэсэн үг юм. Мөн &man.malloc.9; дээр тулгуурласан 
	санах ойн дискийг үүсгэх боломжтой байдаг. Гэхдээ malloc дээр тулгуурласан 
	санах ойн дискнүүдийг, ялангуяа том хэмжээтэйг нь ашиглах нь цөм санах ойгүй 
	болох тохиолдолд системийг сүйрэлд хүргэж болох юм.</para>

      <example>
	<title><command>mdconfig</command> тушаал ашиглан шинэ санах ой 
		дээр тулгуурласан диск үүсгэх нь</title>

	<screen>&prompt.root; <userinput>mdconfig -a -t swap -s <replaceable>5</replaceable>m -u <replaceable>1</replaceable></userinput>
&prompt.root; <userinput>newfs -U md<replaceable>1</replaceable></userinput>
/dev/md1: 5.0MB (10240 sectors) block size 16384, fragment size 2048
        using 4 cylinder groups of 1.27MB, 81 blks, 192 inodes.
        with soft updates
super-block backups (for fsck -b #) at:
 160, 2752, 5344, 7936
&prompt.root; <userinput>mount /dev/md<replaceable>1</replaceable> <replaceable>/mnt</replaceable></userinput>
&prompt.root; <userinput>df <replaceable>/mnt</replaceable></userinput>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md1        4718    4  4338     0%    /mnt</screen>
      </example>

      <example>
	<title><command>mdmfs</command> тушаал ашиглан шинэ санах ой 
		дээр тулгуурласан диск үүсгэх нь</title>
	<screen>&prompt.root; <userinput>mdmfs -s <replaceable>5</replaceable>m md<replaceable>2</replaceable> <replaceable>/mnt</replaceable></userinput>
&prompt.root; <userinput>df <replaceable>/mnt</replaceable></userinput>
Filesystem 1K-blocks Used Avail Capacity  Mounted on
/dev/md2        4846    2  4458     0%    /mnt</screen>
      </example>
    </sect2>

    <sect2>
      <title>Системээс санах ойн дискийг салгах нь</title>
      <indexterm>
        <primary>дискнүүд</primary>
        <secondary>санах ойн дискийг салгах нь</secondary>
      </indexterm>

      <para>Санах ой дээр тулгуурласан эсвэл файл дээр тулгуурласан файлын систем 
	ашиглагдахгүй байгаа бол та бүх эх үүсвэрүүдийг системд суллаж өгөх 
	шаардлагатай. Эхний хийх ёстой зүйл нь файлын системийг салгаад дараа нь 
	&man.mdconfig.8; ашиглан дискийг системээс салгаж эх үүсвэрүүдийг 
	суллана.</para>

      <para>Жишээ нь <filename>/dev/md4</filename>-г салгаж түүний хэрэглэсэн 
	бүх эх үүсвэрүүдийг чөлөөлөхийн тулд дараах тушаалыг ажиллуулна:</para>

      <screen>&prompt.root; <userinput>mdconfig -d -u <replaceable>4</replaceable></userinput></screen>

      <para>Тохиргоо хийгдсэн &man.md.4; төхөөрөмжүүдийн тухай мэдээллийг 
	<command>mdconfig -l</command> тушаал ашиглан жагсааж болно.</para>
    </sect2>
  </sect1>

  <sect1 id="snapshots">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Том</firstname>
	  <surname>Рөүдс</surname>
	  <contrib>Хувь нэмэр болгон оруулсан </contrib>
	</author>
      </authorgroup>
      <!-- 15 JUL 2002 -->
    </sect1info>

    <title>Файлын системийн хормын хувилбарууд</title>

    <indexterm>
      <primary>файлын системүүд</primary>
      <secondary>хормын хувилбарууд</secondary>
    </indexterm>

      <para>FreeBSD нь <link linkend="soft-updates">Soft Updates
	буюу зөөлөн шинэчлэлтүүд</link>ийн хамт Файлын системийн хормын хувилбарууд
	боломжийг санал болгодог.</para>

      <para>Хормын хувилбарууд нь заасан файлын системүүдийн дүрсийг үүсгэж 
	тэдгээртэй файлтай ханддаг шиг хандах боломжийг хэрэглэгчид зөвшөөрдөг.
	Хормын хувилбарын файлууд нь үйлдэл хийгдсэн файлын систем дээр 
	үүсгэгдэх ёстой бөгөөд нэг файлын системийн хувьд 20-с ихгүй хормын 
	хувилбаруудыг хэрэглэгч үүсгэж болно. Идэвхтэй хормын хувилбарууд нь 
	супер блокт бичигддэг бөгөөд ингэснээр тэдгээр нь системийн дахин ачаалалтуудын 
	үед салгах болон дахин холбох явцад тэсвэртэй байдаг. Хормын хувилбар нь 
	хэрэггүй болсон үед энэ нь стандарт &man.rm.1; тушаалаар устгагдаж 
	болно. Хормын хувилбарууд нь ямар ч дарааллаар устгагдаж болох 
	бөгөөд гэхдээ ашиглагдсан бүх зайг дахин олж авахгүй байж болох юм. 
	Учир нь өөр нэг хормын хувилбар чөлөөлөгдсөн блокуудын заримыг  
	шаардаж болзошгүй юм.</para>

      <para>Өөрчлөгдөхгүй <option>snapshot</option> файл тохируулга нь 
	хормын хувилбарыг эхлээд үүсгэсний дараа &man.mksnap.ffs.8; тушаалаар 
	заагддаг. &man.unlink.1; тушаал нь хормын хувилбарын файлуудын хувьд 
	орхидог бөгөөд учир нь энэ нь тэдгээрийг устгахыг зөвшөөрдөг байна.</para>

      <para>Хормын хувилбарууд нь &man.mount.8; тушаалаар үүсгэгддэг. 
	<filename>/var</filename>-ийн хормын хувилбарыг 
	<filename>/var/snapshot/snap</filename> файлд байрлуулахын тулд 
	дараах тушаалыг ашиглана:</para>

<screen>&prompt.root; <userinput>mount -u -o snapshot /var/snapshot/snap /var</userinput></screen>

      <para>Өөрөөр та хормын хувилбар үүсгэхийн тулд &man.mksnap.ffs.8;-г 
	ашиглаж болно:</para>
<screen>&prompt.root; <userinput>mksnap_ffs /var /var/snapshot/snap</userinput></screen>

      <para>Файлын систем (өөрөөр хэлбэл <filename>/var</filename>) дээр хормын хувилбарын 
	файлуудыг &man.find.1; тушаал ашиглан олж болно:</para>
<screen>&prompt.root; <userinput>find /var -flags snapshot</userinput></screen>

      <para>Хормын хувилбар үүсгэгдсэний дараа энэ нь хэд хэдэн хэрэглээтэй 
	байдаг:</para>

      <itemizedlist>
	<listitem>
	  <para>Зарим администраторууд хормын хувилбарын файлыг нөөцийн зорилгоор 
		ашигладаг, учир нь хормын хувилбар нь CD-үүд эсвэл соронзон хальс уруу 
		дамжуулагдаж болдог.</para>
	</listitem>

	<listitem>
	  <para>Файлын системийн бүрэн бүтэн байдлыг шалгадаг &man.fsck.8; нь 
		хормын хувилбар дээр ажиллаж болдог. Файлын систем нь холбогдсон 
		үедээ цэвэр байсан гэж үзвэл та үргэлж цэвэр (өөрчлөгдөөгүй) 
		үр дүнг авах болно. Үүнийг гол нь арын &man.fsck.8; 
		процесс хийдэг.</para>
	</listitem>

	<listitem>
	  <para>&man.dump.8; хэрэгслийг хормын хувилбар дээр ажиллуулдаг. 
		Хормын хувилбарын файлын систем болон цагтай нэг янз хуулбар 
		хийгддэг. &man.dump.8; нь бас хормын хувилбарыг авч 
		нөөц дүрсийг үүсгэж чаддаг бөгөөд дараа нь хормын хувилбарыг 
		нэг тушаалаар <option>-L</option> тугийг ашиглан устгаж 
		чаддаг.</para>
	</listitem>

	<listitem>
	  <para>Хормын хувилбарыг файлын системийн хөлдөөгдсөн дүрс маягаар 
		&man.mount.8; хийдэг. <filename>/var/snapshot/snap</filename> 
		хормын хувилбарыг &man.mount.8; хийхийн тулд доор дурдсаныг 
		ажиллуулна:</para>

<screen>&prompt.root; <userinput>mdconfig -a -t vnode -f /var/snapshot/snap -u 4</userinput>
&prompt.root; <userinput>mount -r /dev/md4 /mnt</userinput></screen>

	</listitem>
      </itemizedlist>

      <para>Та одоо <filename>/mnt</filename>-д холбогдсон өөрийн хөлдөөгдсөн 
	<filename>/var</filename> файлын системийн шатлалаар аялж болно. 
	Хормын хувилбар үүсгэх үе дэх төлвийн адил төлөвт бүгд эхлээд байна. 
	Цорын ганц өөр зүйл нь өмнөх хормын хувилбарууд нь тэг урттай файлууд 
	маягаар гарч ирэх болно. Хормын хувилбарын хэрэглээг хязгаарлах 
	үед үүнийг дараах тушаалыг ажиллуулан салгаж болно:</para>

<screen>&prompt.root; <userinput>umount /mnt</userinput>
&prompt.root; <userinput>mdconfig -d -u 4</userinput></screen>

      <para><option>softupdates</option> буюу зөөлөн шинэчлэлтүүд болон 
	файлын системийн хормын хувилбаруудын талаар дэлгэрэнгүй мэдээллийг 
	техникийн баримтуудыг оролцуулаад та Маршал Кирк МкКюзикийн вэб хуудас 
	<ulink url="http://www.mckusick.com/"></ulink> 
	уруу зочлон орж үзэж болно.</para>
  </sect1>

  <sect1 id="quotas">
    <title>Файлын системийн ноогдлууд</title>
    <indexterm>
      <primary>бүртгэл хийх</primary>
      <secondary>дискний зай</secondary>
    </indexterm>
    <indexterm><primary>дискний ноогдлууд</primary></indexterm>

    <para>Quota буюу ноогдол нь хэрэглэгч эсвэл бүлгийн гишүүдийн хувьд дискний зай ба/эсвэл 
	файлуудын тоог файлын систем тус бүрийн хувьд хуваарилж хязгаарлах боломжийг 
	бүрдүүлэх үйлдлийн системийн нэг нэмэлт боломж юм. Энэ нь дурын нэг хэрэглэгч 
	эсвэл бүлэг хэрэглэгчдийн хуваарилж болох эх үүсвэрүүдийг хязгаарлах шаардлагатай 
	цаг хуваалцах систем дээр ихэвчлэн хэрэглэгддэг. Энэ нь нэг хэрэглэгч эсвэл 
	бүлэг хэрэглэгчид бүх байгаа дискний зайг хэрэглэхээс хамгаалдаг юм.</para>

    <sect2>
      <title>Дискний ноогдлуудыг идэвхтэй болгохын тулд өөрийн системийг тохируулах нь</title>

      <para>Дискний ноогдлыг ашиглаж эхлэхээсээ өмнө ноогдлууд нь цөмд тохируулагдсан 
	эсэхийг шалгах шаардлагатай. Дараах мөрийг өөрийн цөмийн тохиргооны файлд 
	нэмж үүнийг хийнэ:</para>

      <programlisting>options QUOTA</programlisting>

      <para>Анхны <filename>GENERIC</filename> цөм нь үүнийг анхнаасаа идэвхжүүлээгүй 
	байдаг болохоор та дискний ноогдлуудыг ашиглахын тулд тусгайлсан цөмийг тохируулж бүтээн 
	суулгах хэрэгтэй болох юм. Цөмийн тохиргооны талаар дэлгэрэнгүй мэдээллийг 
	<xref linkend="kernelconfig">-с лавлана уу.</para>

      <para>Дараа нь та дискний ноогдлуудыг <filename>/etc/rc.conf</filename> файлд 
	идэвхжүүлэх хэрэгтэй. Дараах мөрийг нэмж үүнийг хийнэ:</para>

      <programlisting>enable_quotas="YES"</programlisting>
      <indexterm>
        <primary>дискний ноогдлууд</primary>
        <secondary>шалгах нь</secondary>
      </indexterm>
      <para>Өөрийн ноогдлын эхлүүлэлтэд сайн хяналт тавихад хэрэгтэй нэмэлт тохиргооны 
	хувьсагчууд байдаг. Ердийн үед ачаалалтын үеэр файлын систем бүрийн ноогдлын 
	бүрэн бүтэн байдал  &man.quotacheck.8; програмаар шалгагддаг. 
	&man.quotacheck.8; боломж нь ноогдлын мэдээллийн бааз дахь өгөгдөл 
	файлын систем дээрх өгөгдлийг зөв тусгаж байгаа эсэхийг шалгаж байдаг.
	Энэ нь хугацаа их шаардсан процесс бөгөөд таны систем ачаалах хугацаанд мэдэгдэхүйц 
	нөлөөлдөг. Хэрэв та энэ алхмыг алгасахыг хүсвэл энэ зорилгоор хувьсагчийг 
	<filename>/etc/rc.conf</filename> файлд тохируулах хэрэгтэй:</para>

      <programlisting>check_quotas="NO"</programlisting>

      <para>Төгсгөлд нь та файлын систем бүрийн хувьд дискний ноогдлуудыг идэвхжүүлэхийн 
	тулд <filename>/etc/fstab</filename> файлыг засварлах хэрэгтэй. 
	Энд та хэрэглэгч эсвэл бүлгийн ноогдлууд эсвэп хоёуланг нь өөрийн бүх файлын системийн 
	хувьд идэвхжүүлэх боломжтой юм.</para>

      <para>Файлын систем дээр хэрэглэгч бүрийн хувьд ноогдлуудыг идэвхжүүлэхийн тулд 
	өөрийн ноогдлууд идэвхжүүлэхийг хүсэж байгаа файлын системийн хувьд 
	<filename>/etc/fstab</filename> файлын харгалзах оруулгын options буюу 
	тохируулгыг заах талбарт <option>userquota</option> тохируулгыг нэмж 
	өгөх хэрэгтэй. Жишээ нь:</para>

      <programlisting>/dev/da1s2g   /home    ufs rw,userquota 1 2</programlisting>

      <para>Үүнтэй төстэйгээр бүлгийн ноогдлуудыг идэвхжүүлэхийн тулд 
	<option>userquota</option> тохируулгын оронд <option>groupquota</option> 
	тохируулгыг ашиглах хэрэгтэй. Хэрэглэгч болон бүлгийн ноогдлуудыг хоёуланг нь 
	идэвхжүүлэхийн тулд оруулгыг ингэж өөрчилнө:</para>

      <programlisting>/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</programlisting>

      <para>Анхдагчаар ноогдлын файлууд файлын системийн root санд 
	хэрэглэгчийн ноогдлын хувьд <filename>quota.user</filename>, бүлгийн 
	ноогдлын хувьд <filename>quota.group</filename> нэрээр хадгалагддаг.  
	Дэлгэрэнгүй мэдээллийг &man.fstab.5;-с үзнэ үү. &man.fstab.5; 
	гарын авлагын хуудас ноогдлын файлуудын хувьд өөр байрлалыг зааж өгч болохыг 
	хэлдэг боловч ноогдлын төрөл бүрийн хэрэгслүүд үүнтэй зөв ажиллаж чаддаггүй 
	болохоор ингэхийг зөвлөдөггүй юм.</para>

      <para>Энэ үед хүрээд та өөрийн системийг шинэ цөмтэй дахин ачаалах хэрэгтэй. 
	<filename>/etc/rc</filename> нь таны <filename>/etc/fstab</filename> 
	файлд идэвхжүүлсэн бүх ноогдлуудын хувьд эхний ноогдлын файлуудыг үүсгэдэг
	тохирох тушаалуудыг автоматаар ажиллуулах бөгөөд ингэснээр ямар ч тэг урттай ноогдлын 
	файлуудыг гараар үүсгэх шаардлагагүй юм.</para>

      <para>Ердийн үйлдлүүдийн үед &man.quotacheck.8;, &man.quotaon.8;, эсвэл 
	&man.quotaoff.8; тушаалуудыг та заавал ажиллуулах ёсгүй юм. Гэхдээ 
	тэдгээрийн хийдэг үйлдлүүдтэй танилцахын тулд тэдгээрийн гарын авлагын хуудаснуудыг 
	уншихыг хүсэж болох юм.</para>
    </sect2>

    <sect2>
      <title>Ноогдлын хязгаарлалтуудыг тохируулах нь</title>
      <indexterm>
        <primary>дискний ноогдлууд</primary>
        <secondary>хязгаарлалтууд</secondary>
      </indexterm>

      <para>Та ноогдлыг идэвхжүүлж өөрийн системийг тохируулсны дараа тэдгээр нь 
	яг жинхэнэдээ идэвхтэй болсон эсэхийг шалгаарай. Үүнийг хийх хялбар арга нь 
	дараах тушаалыг ажиллуулах явдал юм:</para>

      <screen>&prompt.root; <userinput>quota -v</userinput></screen>

      <para>Та ноогдлууд идэвхжүүлэгдсэн файлын систем бүрийн хувьд дискний хэрэглээ 
	болон тухайн үеийн ноогдлын хязгаарлалтуудын ерөнхий нэг мөр үр дүнг харах 
	ёстой.</para>

      <para>Та одоо &man.edquota.8; тушаал ашиглан ноогдлын хязгаарлалтуудыг 
	зааж өгч эхлэхэд бэлэн боллоо.</para>

      <para>Хэрэглэгч эсвэл бүлгийн хуваарилж болох дискний зай болон тэд хичнээн файл 
	үүсгэж болох хэмжээний хязгаарлалтуудыг хүчлэн зааж өгч болох хэд хэдэн сонголт танд 
	байдаг. Та хуваарилалтыг дискний зай (блок ноогдлууд) эсвэл файлын тоо (inode ноогдлууд) 
	эсвэл хоёулангийн хослолоор хязгаарлан өгч болно. Эдгээр хязгаарлалт бүр дараа нь 
	хоёр зэрэглэлт хуваагддаг: энэ нь хатуу ба зөөлөн хязгаарлалтууд юм.</para>

      <indexterm><primary>хатуу хязгаарлалт</primary></indexterm>
      <para>Хатуу хязгаарлалтаас илүү гарч болохгүй. Хэрэглэгч өөрийн хатуу хязгаарлалтад 
	хүрэхэд асуудалтай байгаа файлын систем дээр хэрэглэгч ямар ч хуваарилалт хийж 
	чадахгүй болно. Жишээ нь хэрэв хэрэглэгч файлын систем дээр 500 кбайт хатуу 
	хязгаарлалттай бөгөөд 490 кбайтыг одоогоор ашиглаж байгаа бол хэрэглэгч 
	зөвхөн 10 кбайтыг нэмж хуваарилж чадна. 11 кбайт нэмж хуваарилахыг оролдох нь 
	амжилтгүй болох болно.</para>

      <indexterm><primary>зөөлөн хязгаарлалт</primary></indexterm>
      <para>Нөгөө талаас зөөлөн хязгаарлалтууд нь тодорхой хугацааны туршид илүү гарч 
	болно. Энэ хугацааг энэрэнгүй хугацаа гэдэг бөгөөд анхдагчаар нэг долоо хоног 
	байдаг. Хэрэв хэрэглэгч өөрийн зөөлөн хязгаарлалтаас илүү гарсан хэвээр 
	энэрэнгүй хугацааг өнгөрөх юм бол зөөлөн хязгаарлалт нь хатуу хязгаарлалт болж 
	дахин хуваарилалтыг зөвшөөрдөггүй. Хэрэглэгч зөөлөн хязгаарлалтаас доош 
	орвол энэрэнгүй хугацаа дахин тавигдах болно.</para>

      <para>Дараах нь &man.edquota.8; тушаалыг ажиллуулах үед таны харж болох 
	гаралтын жишээ юм. &man.edquota.8; тушаалыг ажиллуулахад 
	<envar>EDITOR</envar> орчны хувьсагчид заагдсан засварлагч уруу 
	эсвэл <envar>EDITOR</envar> хувьсагч заагдаагүй бол 
	<application>vi</application> засварлагч уруу таныг оруулах бөгөөд энэ нь 
	ноогдлын хязгаарлалтуудыг засварлах боломжийг танд олгоно.</para>

      <screen>&prompt.root; <userinput>edquota -u test</userinput></screen>

      <programlisting>Quotas for user test:
/usr: kbytes in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: kbytes in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</programlisting>

      <para>Та ноогдлууд идэвхжүүлэгдсэн файлын систем бүрийн хувьд хоёр мөрийг ердийн үед 
	харах болно. Нэг мөр нь блокийн хязгаарлалтад, нөгөө мөр нь inode хязгаарлалтад 
	зориулагддаг. Ноогдлын хязгаарлалтуудыг өөрчлөхийн тулд та ердөө л утгыг шинэчлэхийг хүсэж 
	байгаа утгаараа солих хэрэгтэй. Жишээ нь энэ хэрэглэгчийн блок хязгаарлалтыг 
	зөөлөн хязгаарлалт 50, хатуу хязгаарлалт 75 байсныг зөөлөн хязгаарлалт 500 болон 
	хатуу хязгаарлалт 600 болгон өсгөхийн тулд дараах:</para>

      <programlisting>/usr: kbytes in use: 65, limits (soft = 50, hard = 75)</programlisting>

      <para>мөрийг доорх шиг болгож өөрчлөх хэрэгтэй:</para>

      <programlisting>/usr: kbytes in use: 65, limits (soft = 500, hard = 600)</programlisting>

      <para>Таныг засварлагчаас гарсны дараа шинэ ноогдлын хязгаарлалтууд 
	байрандаа орох болно.</para>

      <para>Заримдаа ноогдлын хязгаарлалтуудыг зарим UID-ийн хүрээний хувьд 
	зааж өгөх шаардлага гардаг. Үүнийг &man.edquota.8; тушаалд 
	<option>-p</option> тохируулгыг ашиглан хийдэг. Эхлээд хэрэглэгчид 
	хүссэн ноогдлын хязгаарлалтаа зааж өгөөд дараа нь 
	<command>edquota -p protouser startuid-enduid</command> 
	тушаалыг ажиллуулна. Жишээ нь хэрэв хэрэглэгч <username>test</username> 
	хүссэн ноогдлын хязгаарлалттай байгаа бол энэ ноогдлын хязгаарлалтыг 
	10,000-с 19,999 хүртэлх UID-уудад хувилж хамааруулахын тулд дараах тушаалыг 
	ажиллуулна:</para>

      <screen>&prompt.root; <userinput>edquota -p test 10000-19999</userinput></screen>

      <para>Дэлгэрэнгүй мэдээллийг &man.edquota.8; гарын авлагын хуудаснаас үзнэ үү.</para>
    </sect2>

    <sect2>
      <title>Ноогдлын хязгаарлалтууд болон дискний хэрэглээг шалгах нь</title>
      <indexterm>
        <primary>дискний ноогдлууд</primary>
        <secondary>шалгах нь</secondary>
      </indexterm>

      <para>Ноогдлын хязгаарлалтууд болон дискний хэрэглээг шалгахын тулд 
	та &man.quota.1; эсвэл &man.repquota.8; тушаалын нэгийг 
	ашиглаж болно. &man.quota.1; тушаалыг хэрэглэгч эсвэл бүлгийн 
	ноогдлууд болон дискний зайг шалгахад хэрэглэж болно. Хэрэглэгч нь 
	зөвхөн өөрийн ноогдол болон өөрийн гишүүн бүлгийн ноогдлыг шалгаж 
	чадна. Зөвхөн супер хэрэглэгч бүх хэрэглэгч болон бүлгийн ноогдлуудыг 
	харж болно. &man.repquota.8; тушаалыг ноогдлууд идэвхжүүлэгдсэн 
	файлын системүүдийн хувьд бүх ноогдлууд болон дискний хэрэглээний 
	ерөнхий дүнг авахад хэрэглэж болно.</para>

      <para>Дараах нь хоёр файлын систем дээр ноогдлын хязгаарлалттай хэрэглэгчийн 
	хувьд <command>quota -v</command> тушаалын жишээ гаралт 
	юм.</para>

      <programlisting>Disk quotas for user test (uid 1002):
     Filesystem  usage    quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</programlisting>

      <indexterm><primary>энэрэнгүй хугацаа</primary></indexterm>
      <para>Дээрх жишээний <filename>/usr</filename> файлын систем дээр 
	хэрэглэгч 50 кбайтын зөөлөн хязгаарлалтыг 15 кбайтаар илүүдүүлсэн 
	байгаа бөгөөд 5 хоногийн энэрэнгүй хугацаа үлдсэн байна. Од 
	<literal>*</literal> тэмдэгт нь хэрэглэгч өөрийн ноогдлын хязгаарлалтаас 
	илүү гарсныг харуулж байна.</para>

      <para>Ердийн үед хэрэглэгч ямар ч дискний зай ашиглаагүй байгаа тийм файлын системүүд, 
	файлын системийн хувьд ноогдлын хязгаарлалт байсан ч гэсэн &man.quota.1; тушаалын 
	гаралтад  харагддаггүй байна. <option>-v</option> тохируулга нь тэдгээр 
	файлын системүүдийг харуулах бөгөөд дээрх жишээн дээр 
	<filename>/usr/var</filename> файлын системийг харуулж 
	байна.</para>
    </sect2>

    <sect2>
      <title>NFS дээгүүрх ноогдлууд</title>
      <indexterm><primary>NFS</primary></indexterm>

      <para>Ноогдлууд нь NFS сервер дээр ноогдлын дэд системээр хянагддаг. 
	&man.rpc.rquotad.8; демон нь NFS клиентүүд дээр өөрсдийн ноогдлын 
	статистикуудыг хэрэглэгчдэд үзэх боломжийг олгож ноогдлын мэдээллийг тэдгээр 
	машинууд дээр &man.quota.1; тушаалд бэлэн болгож өгдөг.</para>

      <para><command>rpc.rquotad</command>-г 
	<filename>/etc/inetd.conf</filename> файлд ингэж идэвхжүүлнэ:</para>

      <programlisting>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</programlisting>

      <para>Одоо <command>inetd</command>-г дахин ачаал:</para>

      <screen>&prompt.root; <userinput>/etc/rc.d/inetd restart</userinput></screen>
    </sect2>
  </sect1>


  <sect1 id="disks-encrypting">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Лаки</firstname>
	  <surname>Грийн</surname>
	  <contrib>Хувь нэмэр болгон оруулсан </contrib>
	  <affiliation>
	    <address><email>shamrock@cypherpunks.to</email></address>
	  </affiliation>
	</author>
      </authorgroup>
      <!-- 11 MARCH 2003 -->
    </sect1info>

    <title>Дискний хуваалтуудыг шифрлэх нь</title>
    <indexterm>
      <primary>дискнүүд</primary>
      <secondary>шифрлэх нь</secondary></indexterm>

    <para>FreeBSD нь өгөгдөлд зөвшөөрөгдөөгүй хандах хандалтын эсрэг 
	маш сайн шууд хамгаалалтуудыг санал болгодог. Файлын зөвшөөрлүүд болон 
	Mandatory Access Control (MAC) буюу Албадмал Хандалт Хяналт 
	(<xref linkend="mac">-г үзнэ үү) нь компьютер ассан, үйлдлийн систем 
	идэвхтэй байх үед зөвшөөрөлгүй гуравдагч нөхдүүдийг өгөгдөлд хандахаас 
	хамгаалахад тусалдаг. Гэхдээ хэрэв халдагч компьютерт физик хандалт олж аван 
	компьютерийн хатуу хөтчийг өөр систем уруу зөөн эмзэг өгөгдлийг хуулж шинжилгээ хийж чадах 
	бол үйлдлийн системийн мөрдүүлдэг зөвшөөрлүүд нь хамааралгүй болох юм.</para>

    <para>Халдагч хэрхэн хатуу диск эсвэл унтраасан компьютерийг эзэмшсэнээс үл хамаарч 
	&os; дээрх <application>GEOM Based Disk Encryption (gbde)</application> 
	буюу GEOM дээр тулгуурласан дискний шифрлэлт болон <command>geli</command> 
	криптограф дэд системүүд нь компьютерийн файлын системүүд дээрх өгөгдлийг 
	бүр чухал эх үүсвэрүүд бүхий, зорилгодоо хүрэхээр ихээхэн чармайсан халдагчдаас 
	хамгаалж чадах юм. Зөвхөн тухайн файл бүрийг шифрлэдэг ярвигтай шифрлэлтийн 
	аргуудаас ялгаатай нь <command>gbde</command> болон <command>geli</command> 
	нь бүх файлын системүүдийг харагдаж мэдэгдэхгүйгээр шифрлэдэг. Хатуу дискний 
	хавтгайд цэвэр текст хэзээ ч бичигддэггүй.</para>

    <sect2>
      <title><application>gbde</application>-ээр диск шифрлэх</title>

      <procedure>
	<step>
	  <title><username>root</username> болно</title>

	  <para><application>gbde</application>-г тохируулахад супер хэрэглэгчийн 
		эрхүүдийг шаарддаг.</para>

	  <screen>&prompt.user; <userinput>su -</userinput>
Password:</screen>
	</step>

	<step>
	  <title>Цөмийн тохиргооны файлдаа &man.gbde.4; дэмжлэгийг нэмнэ</title>

	  <para>Дараах мөрийг цөмийн тохиргооны файлдаа нэмнэ:</para>

	  <para><literal>options GEOM_BDE</literal></para>

	  <para>Цөмөө <xref linkend="kernelconfig">-д тайлбарласны дагуу дахин бүтээнэ.</para>

	  <para>Шинэ цөм уруугаа дахин ачаална.</para>
	</step>

        <step>
          <para>Цөмийг дахин бүтээхээс өөр нэг арга нь <command>kldload</command>
		ашиглаж &man.gbde.4;-г ачаалах явдал юм:</para>

          <screen>&prompt.root; <userinput>kldload geom_bde</userinput></screen>

        </step>
      </procedure>

    <sect3>
      <title>Шифрлэгдсэн хатуу хөтчүүдийг бэлдэх нь</title>

      <para>Дараах жишээ нь таныг өөрийн систем уруу шинэ хатуу хөтөч нэмж 
	ганц шифрлэгдсэн хуваалтыг агуулна гэж тооцдог. Энэ хуваалт нь 
	<filename>/private</filename> гэж холбогдох болно. 
	<application>gbde</application> нь 
	<filename>/home</filename> болон <filename>/var/mail</filename>-г 
	бас шифрлэхэд ашиглагддаг боловч энэ нь энэ танилцуулгын хүрээнээс хальж 
	илүү төвөгтэй заавруудыг шаарддаг.</para>

      <procedure>
	<step>
	  <title>Шинэ хатуу хөтчийг нэмнэ</title>

	  <para>Шинэ хөтчийг систем уруу <xref
	    linkend="disks-adding">-д тайлбарласны дагуу нэмнэ. Энэ жишээн 
		дээр шинэ хатуу хөтчийн хуваалт <filename>/dev/ad4s1c</filename> 
		гэж нэмэгдсэн байгаа. <filename>/dev/ad0s1<replaceable>*</replaceable></filename> 
		төхөөрөмжүүд нь жишээ систем дээр байгаа стандарт FreeBSD хуваалтуудыг 
		харуулж байна.</para>

	  <screen>&prompt.root; <userinput>ls /dev/ad*</userinput>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4</screen>
	</step>

	<step>
	  <title>gbde цоож файлуудыг агуулах санг үүсгэнэ</title>

	  <screen>&prompt.root; <userinput>mkdir /etc/gbde</userinput></screen>

	  <para><application>gbde</application> цоож файл нь шифрлэгдсэн хуваалтуудад 
		хандахад <application>gbde</application>-д шаардагдах мэдээллийг 
		агуулдаг. Цоож файлд хандах боломжгүй бол <application>gbde</application> 
		нь шифрлэгдсэн хуваалтын агуулсан өгөгдлийг хөндлөнгийн их хүч шаардсан оролцоогүйгээр 
		буцааж тайлж чадахгүй юм. Үүнийг програм хангамж дэмждэггүй. 
		Шифрлэгдсэн хуваалт бүр тусдаа цоож файл ашигладаг.</para>
	</step>

	<step>
	  <title>gbde хуваалтыг эхлүүлнэ</title>

	  <para><application>gbde</application> хуваалт ашиглагдаж эхлэхээсээ өмнө 
		эхэлж тохируулагдсан байх шаардлагатай. Энэ эхний тохируулга нь зөвхөн нэг 
		удаа хийгдэх ёстой:</para>

	  <screen>&prompt.root; <userinput>gbde init /dev/ad4s1c -i -L /etc/gbde/ad4s1c.lock</userinput></screen>

	  <para>&man.gbde.8; нь загварт төрөл бүрийн тохиргооны сонголтуудыг зааж 
		өгөх боломжийг танд өгч таны засварлагчийг онгойлгох болно. UFS1
	    	эсвэл UFS2-той ашиглахын тулд sector_size-г 2048 гэж заана:</para>

	  <programlisting>$<!-- This is not the space you are looking
for-->FreeBSD: src/sbin/gbde/template.txt,v 1.1 2002/10/20 11:16:13 phk Exp $
#
# Sector size is the smallest unit of data which can be read or written.
# Making it too small decreases performance and decreases available space.
# Making it too large may prevent filesystems from working.  512 is the
# minimum and always safe.  For UFS, use the fragment size
#
sector_size     =       2048
[...]
</programlisting>

	  <para>&man.gbde.8; нь өгөгдлийг аюулгүй болгоход хэрэглэгдэх ёстой нэвтрэх 
		үгийг хоёр удаа бичихийг танаас хүснэ. Нэвтрэх үг нь хоёуланд нь адил 
		байх ёстой. <application>gbde</application>-ийн таны өгөгдлийг 
		хамгаалах чадвар таны сонгосон нэвтрэх үгийн чанараас бүхэлдээ 
		хамаарна.
	  <footnote>
          <para>Амархан тогтоож болох аюулгүй нэвтрэх үгийг хэрхэн сонгох талаар 
		зөвлөгөөнүүдийг <ulink
	    url="http://world.std.com/~reinhold/diceware.html">Diceware
	    Passphrase</ulink> вэб хуудаснаас үзнэ үү.</para></footnote></para>

	  <para><command>gbde init</command> тушаал нь таны 
		<application>gbde</application> хуваалтад зориулж цоож файлыг 
		үүсгэх бөгөөд энэ жишээн дээр <filename>/etc/gbde/ad4s1c.lock</filename> 
		гэж хадгалагдсан байна.	<application>gbde</application> цоож файлууд
		нь <filename>/etc/rc.d/gbde</filename> эхлүүлэх скриптээр 
		зөв танигдахын тулд <quote>.lock</quote> гэж төгсөх ёстой.</para>

	  <caution>
	    <para><application>gbde</application> цоож файлууд нь шифрлэгдсэн 
		хуваалтуудын агуулгатай цуг нөөцлөгдөх <emphasis>ёстой</emphasis>. 
		Зөвхөн цоож файлыг устгах нь шийдсэн халдагч
		<application>gbde</application> хуваалтыг буцааж тайлахаас 
		хамгаалж чаддаггүй бөгөөд цоож файлгүйгээр хууль ёсны эзэмшигч 
		нь шифрлэгдсэн хуваалт дээрх өгөгдөлд &man.gbde.8; болон түүнийг зохиогчийн 
		ерөөсөө дэмждэггүй, их хүч шаардсан ажиллагаагүйгээр хандаж чадахгүй болох 
		юм.</para>
	  </caution>
	</step>

	<step>
	  <title>Шифрлэгдсэн хуваалтыг цөмд залгана</title>

	  <screen>&prompt.root; <userinput>gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</userinput></screen>

	  <para>Шифрлэгдсэн хуваалтыг эхэлж тохируулж байх үед таны сонгосон нэвтрэх 
		үгийг оруулахыг танаас асуух болно. Шинэ шифрлэгдсэн төхөөрөмж 
		<filename>/dev</filename> дотор 
		<filename>/dev/device_name.bde</filename> гэж гарч 
		ирнэ:</para>

	  <screen>&prompt.root; <userinput>ls /dev/ad*</userinput>
/dev/ad0        /dev/ad0s1b     /dev/ad0s1e     /dev/ad4s1
/dev/ad0s1      /dev/ad0s1c     /dev/ad0s1f     /dev/ad4s1c
/dev/ad0s1a     /dev/ad0s1d     /dev/ad4        /dev/ad4s1c.bde</screen>
	</step>

	<step>
	  <title>Шифрлэгдсэн төхөөрөмж дээр файлын систем үүсгэнэ</title>

	  <para>Шифрлэгдсэн төхөөрөмж цөмд залгагдсаны дараа та энэ төхөөрөмж дээр 
		файлын систем үүсгэж болно. Шифрлэгдсэн төхөөрөмж дээр файлын 
		систем үүсгэхийн тулд &man.newfs.8;-г ашиглана. Хуучин UFS1 
		файлын системийг эхлүүлснээс шинэ UFS2 файлын системийг эхлүүлэх нь 
		хамаагүй хурдан учраас &man.newfs.8;-г <option>-O2</option> 
		тохируулгатай хэрэглэхийг зөвлөдөг.</para>

	  <screen>&prompt.root; <userinput>newfs -U -O2 /dev/ad4s1c.bde</userinput></screen>

	  <note>
	    <para>&man.newfs.8; тушаал нь төхөөрөмжийн нэрэндээ 
		<filename><replaceable>*</replaceable>.bde</filename> гэж 
		өргөтгөлөөр танигдах залгагдсан <application>gbde</application> 
		хуваалт дээр хийгдэх ёстой.</para>
	  </note>
	</step>

	<step>
	  <title>Шифрлэгдсэн хуваалтыг холбоно</title>

	  <para>Шифрлэгдсэн файлын системд зориулж холбох цэгийг үүсгэнэ.</para>

	  <screen>&prompt.root; <userinput>mkdir /private</userinput></screen>

	  <para>Шифрлэгдсэн файлын системийг холбоно.</para>

	  <screen>&prompt.root; <userinput>mount /dev/ad4s1c.bde /private</userinput></screen>
	</step>

	<step>
	  <title>Шифрлэгдсэн файлын систем байгаа эсэхийг шалгана</title>

	  <para>Шифрлэгдсэн файлын систем одоо &man.df.1;-д харагдаж 
		ашиглахад бэлэн болох ёстой.</para>

	  <screen>&prompt.user; <userinput>df -H</userinput>
Filesystem        Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a      1037M    72M   883M     8%    /
/devfs            1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f       8.1G    55K   7.5G     0%    /home
/dev/ad0s1e      1037M   1.1M   953M     0%    /tmp
/dev/ad0s1d       6.1G   1.9G   3.7G    35%    /usr
/dev/ad4s1c.bde   150G   4.1K   138G     0%    /private</screen>
	</step>
      </procedure>
    </sect3>

    <sect3>
      <title>Байгаа шифрлэгдсэн файлын системүүдийг холбох нь</title>

      <para>Ачаалалт бүрийн дараа ямар ч шифрлэгдсэн файлын системүүдийг 
	ашиглаж эхлэхээсээ өмнө цөмд дахин залгаж, алдааг нь шалгаж холбож болно.
	Шаардлагатай тушаалуудыг  <username>root</username> хэрэглэгч 
	ажиллуулах ёстой гэж үздэг.</para>

      <procedure>
	<step>
	  <title>gbde хуваалтыг цөмд залгана</title>

	  <screen>&prompt.root; <userinput>gbde attach /dev/ad4s1c -l /etc/gbde/ad4s1c.lock</userinput></screen>

	  <para>Шифрлэгдсэн <application>gbde</application> хуваалтыг 
		эхэлж тохируулж байх үед таны сонгосон нэвтрэх үгийг оруулахыг 
		танаас асуух болно.</para>
	</step>

	<step>
	  <title>Файлын систем дээр алдааг шалгана</title>

	  <para>Шифрлэгдсэн файлын системүүд нь автоматаар холбогдохын тулд 
		<filename>/etc/fstab</filename> файлд одоохондоо 
		жагсаагдах боломжгүй учир файлын системүүд дээр алдаа байгаа эсэхийг 
		шалгаж тэдгээрийг холбохоос өмнө &man.fsck.8;-г гараар ажиллуулах ёстой.</para>

	  <screen>&prompt.root; <userinput>fsck -p -t ffs /dev/ad4s1c.bde</userinput></screen>
	</step>

	<step>
	  <title>Шифрлэгдсэн файлын системийг холбоно</title>

	  <screen>&prompt.root; <userinput>mount /dev/ad4s1c.bde /private</userinput></screen>

	  <para>Шифрлэгдсэн файлын систем одоо ашиглахад бэлэн боллоо.</para>
	</step>
      </procedure>

      <sect4>
	<title>Шифрлэгдсэн хуваалтуудыг автоматаар холбох нь</title>

	<para>Шифрлэгдсэн хуваалтыг автоматаар залган шалгаж холбох скриптийг үүсгэж 
		болох боловч аюулгүй байдлын шалтгаанаас болоод скрипт нь 
		&man.gbde.8; нууц үгийг агуулсан байх ёсгүй. Харин эдгээр 
		скриптүүдийг гараар ажиллуулж нууц үгийг консол эсвэл &man.ssh.1;-ээр 
		оруулахыг зөвлөдөг.</para>

	<para>Өөр нэг арга нь <filename>rc.d</filename> скрипт байдаг. Энэ 
		скриптийн нэмэлт өгөгдлүүдийг &man.rc.conf.5;-оор дамжуулж болно, 
		жишээ нь:</para>

	<programlisting>gbde_autoattach_all="YES"
gbde_devices="ad4s1c"
gbde_lockdir="/etc/gbde"</programlisting>

	<para>Энэ нь <application>gbde</application> нэвтрэх үгийг ачаалах 
	үед оруулахыг шаарддаг. Зөв нэвтрэх үгийг бичсэний дараа 
	<application>gbde</application> шифрлэгдсэн хуваалт автоматаар 
	холбогдох болно. Энэ нь <application>gbde</application>-г 
	зөөврийн компьютер дээр хэрэглэж байгаа үед их ашигтай байдаг.</para>
      </sect4>
    </sect3>

      <sect3>
	<title>gbde-ийн ажиллуулдаг криптограф хамгаалалтууд</title>

	<para>&man.gbde.8; нь 128-bit AES-ийг CBC горимд ашиглан сектор ачааг 
	шифрлэдэг. Диск дээрх сектор бүр өөр өөр AES түлхүүрээр шифрлэгддэг. 
	Секторын түлхүүрүүд хэрэглэгчийн оруулсан нэвтрэх үгээс хэрхэн гаргагддаг зэрэг 
	<application>gbde</application>-ийн криптограф дизайны талаар 
	дэлгэрэнгүйг &man.gbde.4;-ээс үзнэ үү.</para>
      </sect3>

      <sect3>
	<title>Нийцтэй байдлын асуудлууд</title>

	<para>&man.sysinstall.8; нь <application>gbde</application>-шифрлэгдсэн 
	төхөөрөмжүүдтэй нийцгүй байдаг. Бүх 
	<devicename><replaceable>*</replaceable>.bde</devicename> төхөөрөмжүүдийг 
	&man.sysinstall.8; эхлүүлэхээс өмнө цөмөөс салгасан байх ёстой бөгөөд 
	ингэхгүй бол энэ нь төхөөрөмжүүдийг шалгаж эхлэхдээ сүйрэх болно. Бидний жишээн 
	дээр ашиглагдсан шифрлэгдсэн төхөөрөмжийг салгахдаа дараах тушаалыг 
	ашиглана:</para>
	<screen>&prompt.root; <userinput>gbde detach /dev/ad4s1c</userinput></screen>

      <para>Мөн &man.vinum.4; нь &man.geom.4; дэд системийг 
	ашигладаггүйг анхаараарай, та <application>gbde</application>-г 
	<application>vinum</application> эзлэхүүнүүдтэй ашиглаж 
	болохгүй.</para>
      </sect3>

    </sect2>

    <sect2>
      <sect2info>
	<authorgroup>
	  <author>
	    <firstname>Даниэл</firstname>
	    <surname>Гэрзо</surname>
	    <contrib>Хувь нэмэр болгон оруулсан </contrib>
	  </author>
	</authorgroup>
	<!-- Date of writing: 28 November 2005 -->
      </sect2info>

      <title><command>geli</command>-ээр диск шифрлэх нь</title>

      <para>Шинэ криптограф GEOM ангилал <command>geli</command> гэж бий. Үүнийг одоогоор 
	&a.pjd; хөгжүүлж байгаа болно. <command>geli</command> нь 
	<command>gbde</command>-ээс өөр бөгөөд энэ нь өөр боломжуудыг 
	санал болгож криптограф үйлдэлдээ өөр схемийг ашигладаг.</para>

      <para>&man.geli.8;-ийн хамгийн чухал боломжууд бол:</para>

      <itemizedlist>
	<listitem>
	  <para>&man.crypto.9; тогтолцоог ашигладаг &mdash; 
		криптограф тоног төхөөрөмж бэлэн болоход <command>geli</command>
		түүнийг автоматаар ашигладаг.</para>
	</listitem>
	<listitem>
	  <para>Олон криптограф алгоритмуудыг дэмждэг (одоогоор AES, Blowfish, 
		болон 3DES).</para>
	</listitem>
	<listitem>
	  <para>root хуваалтыг шифрлэх боломжийг олгодог. Шифрлэгдсэн root 
		хуваалтад хандахад хэрэглэгддэг нэвтрэх үгийг систем ачаалахад 
		асуудаг.</para>
	</listitem>
	<listitem>
	  <para>Бие биеэндээ хамааралгүй хоёр түлхүүрүүдийг ашиглахыг 
		зөвшөөрдөг (өөрөөр хэлбэл <quote>key</quote> болон 
		<quote>company key</quote>).</para>
	</listitem>
	<listitem>
	  <para><command>geli</command> нь хурдан байдаг. Энгийн сектороос сектор уруу 
		шифрлэлтийг хийдэг.</para>
	</listitem>
	<listitem>
	  <para>Мастер түлхүүрүүдийг нөөцлөх ба сэргээхийг зөвшөөрдөг. Хэрэглэгч 
		өөрийн түлхүүрүүдийг устгах хэрэгтэй болоход нөөцөөс түлхүүрүүдийг 
		сэргээж өгөгдөлд дахин хандах боломжтой болох юм.</para>
	</listitem>
	<listitem>
	  <para>Дискийг санамсаргүй, нэг удаагийн түлхүүрээр залгахыг 
		зөвшөөрдөг &mdash; энэ нь swap хуваалтууд болон түр зуурын 
		файлын системүүдэд ашигтай байдаг.</para>
	</listitem>
      </itemizedlist>

      <para><command>geli</command>-ийн илүү боломжуудыг &man.geli.8;-ийн 
	гарын авлагын хуудаснаас олж болно.</para>

      <para>Дараагийн алхмууд нь <command>geli</command>-ийн дэмжлэгийг &os; цөмд 
	хэрхэн идэвхжүүлэхийг тайлбарлах бөгөөд шинэ <command>geli</command> 
	шифрлэлт үзүүлэгчийг хэрхэн үүсгэх болон ашиглах талаар өгүүлэх болно.</para>

      <para>Цөмд өөрчлөлтүүд шаардлагатай учраас 
	супер хэрэглэгчийн эрхүүд хэрэгтэй болно.</para>

      <procedure>
	<step>
	  <title>Цөмд <command>geli</command> дэмжлэгийг 
		нэмэх нь</title>

	  <para>Дараах мөрийг цөмийн тохиргооны файлд нэмнэ:</para>

	  <programlisting>options GEOM_ELI
device crypto</programlisting>

	  <para>Цөмөө <xref linkend="kernelconfig">-д тайлбарласны дагуу дахин бүтээнэ.</para>

	  <para>Мөн <command>geli</command> модулийг ачаалах үед дуудаж болно. 
		Дараах мөрийг <filename>/boot/loader.conf</filename> файлд 
		нэмнэ:</para>

	  <programlisting>geom_eli_load="YES"</programlisting>

	  <para>&man.geli.8; нь одоо цөмд дэмжигдсэн байх ёстой.</para>
	</step>

	<step>
	  <title>Мастер түлхүүр үүсгэх нь</title>

	  <para>Дараах жишээ нь түлхүүр файлыг хэрхэн үүсгэх талаар тайлбарлах бөгөөд 
		энэ нь <filename class="directory">/private</filename> доор 
		холбогдсон шифрлэгдсэн үзүүлэгчийн Мастер түлхүүрийн хэсэг болон 
		ашиглагдах болно. Түлхүүр файл нь Мастер түлхүүрийг шифрлэхэд 
		хэрэглэгдэх зарим санамсаргүй өгөгдлийг өгөх болно. Мастер түлхүүр нь 
		нэвтрэх үгээр бас хамгаалагдах болно. Үзүүлэгчийн секторын хэмжээ 
		4kB том байх болно. Мөн энэ хэлэлцүүлэг нь <command>geli</command> 
		үзүүлэгчийг хэрхэн залгаж түүн дээр файлын систем үүсгэх, хэрхэн түүнийг 
		холбож ажиллах болон төгсгөлд нь хэрхэн салгах талаар тайлбарлах 
		болно.</para>

	  <para>Илүү сайн ажиллагааг хангахын тулд секторын том хэмжээг (4kB ч юм уу) 
		ашиглахыг зөвлөдөг.</para>

	  <para>Мастер түлхүүр нь нэвтрэх үгээр хамгаалагдах бөгөөд түлхүүр файлд зориулагдсан 
		өгөгдлийн эх нь <filename>/dev/random</filename> байх болно. 
		Бидний үзүүлэгч гэж нэрлэдэг <filename>/dev/da2.eli</filename>-ийн 
		секторын хэмжээ 4kB байх болно.</para> 

	  <screen>&prompt.root; <userinput>dd if=/dev/random of=/root/da2.key bs=64 count=1</userinput>
&prompt.root; <userinput>geli init -s 4096 -K /root/da2.key /dev/da2</userinput>
Enter new passphrase:
Reenter new passphrase:</screen>

	  <para>Нэвтрэх үг болон түлхүүр файлыг хоёуланг нь заавал ашиглах шаардлагагүй; 
		Мастер түлхүүрийг нууцлах аль ч аргыг тусад нь ашиглаж болно.</para>

	  <para>Хэрэв түлхүүр файл <quote>-</quote> гэж өгөгдсөн бол стандарт 
		оролтыг ашиглана. Энэ жишээ нь нэгээс олон түлхүүр файлыг 
		хэрхэн ашиглаж болох талаар харуулж байна.</para>

	  <screen>&prompt.root; <userinput>cat keyfile1 keyfile2 keyfile3 | geli init -K - /dev/da2</userinput></screen>
	</step>

	<step>
	  <title>Үзүүлэгчийг үүсгэсэн түлхүүрийн тусламжтай залгах нь</title>

	  <screen>&prompt.root; <userinput>geli attach -k /root/da2.key /dev/da2</userinput>
Enter passphrase:</screen>

	  <para>Шинэ цэвэр текст төхөөрөмж 
		<filename>/dev/<replaceable>da2</replaceable>.eli</filename>
		гэж нэрлэгдэх болно.</para>

	  <screen>&prompt.root; <userinput>ls /dev/da2*</userinput>
/dev/da2  /dev/da2.eli</screen>
	</step>

	<step>
	  <title>Шинэ файлын системийг үүсгэх нь</title>

	  <screen>&prompt.root; <userinput>dd if=/dev/random of=/dev/da2.eli bs=1m</userinput>
&prompt.root; <userinput>newfs /dev/da2.eli</userinput>
&prompt.root; <userinput>mount /dev/da2.eli /private</userinput></screen>

	<para>Шифрлэгдсэн файлын систем &man.df.1;-д харагдаж 
		ашиглахад бэлэн болох ёстой:</para>

	  <screen>&prompt.root; <userinput>df -H</userinput>
Filesystem     Size   Used  Avail Capacity  Mounted on
/dev/ad0s1a    248M    89M   139M    38%    /
/devfs         1.0K   1.0K     0B   100%    /dev
/dev/ad0s1f    7.7G   2.3G   4.9G    32%    /usr
/dev/ad0s1d    989M   1.5M   909M     0%    /tmp
/dev/ad0s1e    3.9G   1.3G   2.3G    35%    /var
/dev/da2.eli   150G   4.1K   138G     0%    /private</screen>

	</step>

	<step>
	  <title>Үзүүлэгчийг холбосныг салгаж залгасныг болиулах</title>

	  <para>Шифрлэгдсэн хуваалт дээрх ажил хийгдэж дуусаад 
		<filename class="directory">/private</filename> хуваалт 
		хэрэггүй болох үед <command>geli</command> шифрлэгдсэн 
		хуваалтыг холбосноо салган цөмд залгаснаа бас салгах нь зүйтэй 
		юм.</para>

	  <screen>&prompt.root; <userinput>umount /private</userinput>
&prompt.root; <userinput>geli detach da2.eli</userinput></screen>
	</step>
      </procedure>

      <para>&man.geli.8;-ийг хэрэглэх тухай дэлгэрэнгүй мэдээллийг гарын авлагын хуудаснаас 
	олж болно.</para>

      <sect3>
	<title><filename>geli</filename> <filename>rc.d</filename> скриптийг ашиглах нь</title>

	<para><command>geli</command> нь <command>geli</command>-ийн 
	хэрэглээг хялбаршуулахад ашиглаж болох <filename>rc.d</filename> 
	скрипттэй цуг ирдэг. <command>geli</command>-г &man.rc.conf.5;-оор 
	тохируулах жишээг дараахаас харж болно:</para>

	<programlisting>geli_devices="da2"
geli_da2_flags="-p -k /root/da2.key"</programlisting>

	<para>Энэ нь <filename>/dev/da2</filename>-г 
	Мастер түлхүүр файл нь <filename>/root/da2.key</filename>-д байрлах 
	<command>geli</command> үзүүлэгч гэж тохируулах бөгөөд 
	үзүүлэгчийг залгаж байхдаа <command>geli</command> нь 
	нэвтрэх үгийг ашиглахгүй (хэрэв <option>-P</option> сонголт 
	<literal>geli init</literal> хийгдэх үед өгөгдсөн тохиолдолд энэ нь 
	ашиглагдах боломжтой). Систем нь <command>geli</command> 
	үзүүлэгчийг цөмөөс систем унтрахаас өмнө салгах болно.</para>

	<para><filename>rc.d</filename>-г тохируулах талаар дэлгэрэнгүй мэдээлэл 
		энэхүү гарын авлагын <link linkend="configtuning-rcd">rc.d</link> 
		хэсэгт байгаа болно.</para>
      </sect3>
    </sect2>	
  </sect1>


  <sect1 id="swap-encrypting">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Крисчан</firstname>
	  <surname>Брюффэр</surname>
	  <contrib>Бичсэн </contrib>
	</author>
      </authorgroup>
    </sect1info>

    <title>Swap зайг шифрлэх</title>
    <indexterm>
      <primary>swap</primary>
      <secondary>шифрлэх</secondary>
    </indexterm>

    <para>&os; дээрх swap-ийн шифрлэлт нь тохируулахад амархан байдаг. &os;-ийн аль 
	хувилбарыг ашиглаж байгаагаас хамаараад өөр өөр тохируулгууд байдаг бөгөөд 
	тохиргоо нь нэлээн өөр өөр байдаг. 
	&man.gbde.8; эсвэл &man.geli.8; шифрлэх системүүдийг swap-ийг 
	шифрлэхэд ашиглаж болно. Энэ хоёр систем нь хоёулаа <filename>encswap</filename>
      <link linkend="configtuning-rcd">rc.d</link> скриптийг 
	ашигладаг.</para>

    <para>Өмнөх <link linkend="disks-encrypting">Дискний хуваалтуудыг шифрлэх</link> 
	хэсэг нь өөр өөр шифрлэх системүүдийн тухай богино хэлэлцүүлгийг агуулдаг.</para>

    <sect2>
      <title>Swap яагаад шифрлэгдэх ёстой вэ?</title>

      <para>Дискний хуваалтуудын шифрлэлтийн нэгэн адил swap зайн шифрлэлт нь эмзэг 
	мэдээллийг хамгаалахын тулд хийгддэг. Нууц үгстэй ажилладаг програм байлаа гэж 
	бодъё. Эдгээр нууц үгс нь физик санах ойд байгаа үед бүгд зүгээр байна. Гэхдээ 
	хэрэв үйлдлийн систем нь бусад програмуудад зориулж зайг чөлөөлөхийн тулд санах 
	ойн хуудаснуудыг swap хийж эхэлбэл нууц үгс нь дискний хавтгай дээр шифрлэгдэлгүй 
	бичигдэж болох бөгөөд энэ нь өрсөлдөгчийн хувьд олж авахад амархан болох юм.
	Swap зайг шифрлэх нь энэ тохиолдолд шийдэл болж болох юм.</para>
    </sect2>

    <sect2>
      <title>Бэлтгэл</title>

      <note>
	<para>Энэ хэсгийн үлдсэн хэсэгт <devicename>ad0s1b</devicename> нь 
	swap хуваалт байх болно.</para>
      </note>

      <para>Энэ хүртэл swap нь шифрлэгдээгүй байгаа билээ. Аль хэдийн нууц үгс эсвэл бусад 
	эмзэг өгөгдөл дискний хавтгайнууд дээр цэвэр текстээр байж болзошгүй юм. Үүнийг 
	засварлахын тулд swap хуваалт дээрх өгөгдлийг санамсаргүй хаягдлаар дарж бичих 
	хэрэгтэй:</para>

      <screen>&prompt.root; <userinput>dd if=/dev/random of=/dev/ad0s1b bs=1m</userinput></screen>
    </sect2>

    <sect2>
      <title>&man.gbde.8; ашиглан swap шифрлэлт хийх</title>

      <para><literal>.bde</literal> дагаварыг <filename>/etc/fstab</filename>-ийн 
	тохирох swap мөр дэх төхөөрөмжид нэмэх шаардлагатай:</para>

      <programlisting>
# Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.bde         none            swap    sw              0       0
      </programlisting>
    </sect2>

    <sect2>
      <title>&man.geli.8; ашиглан swap шифрлэлт хийх</title>

      <para>Өөрөөр, swap шифрлэлтэд зориулж &man.geli.8;-г ашиглах процедур нь 
	&man.gbde.8; ашиглахтай төстэй. <literal>.eli</literal> дагаварыг 
	<filename>/etc/fstab</filename>-ийн тохирох swap мөр дэх төхөөрөмжид 
	нэмэх шаардлагатай:</para>

      <programlisting>
# Device                Mountpoint      FStype  Options         Dump    Pass#
/dev/ad0s1b.eli         none            swap    sw              0       0
      </programlisting>

      <para>&man.geli.8; нь <acronym>AES</acronym> алгоритмийг анхдагчаар 
	256 битийн урттай түлхүүртэй ашигладаг.</para>

      <para>Мөн эдгээр  анхдагчуудыг <filename>/etc/rc.conf</filename> файлд
	<literal>geli_swap_flags</literal> тохируулгыг ашиглан 
	өөрчилж болно. Дараах мөр нь <filename>encswap</filename> rc.d 
	скриптийг <quote>detach on last close</quote> тохируулгыг зааж 4 
	килобайтын секторын хэмжээтэй, 128 бит түлхүүрийн урттайгаар Blowfish 
	алгоритм ашиглан &man.geli.8; swap хуваалт үүсгэ гэж хэлж байна:</para>

      <programlisting>geli_swap_flags="-e blowfish -l 128 -s 4096 -d"</programlisting>

      <para>&man.geli.8; гарын авлагын хуудсан дахь <command>onetime</command> тушаалын тайлбараас 
	боломжит тохируулгуудын жагсаалтыг лавлана уу.</para>
    </sect2>

    <sect2>
      <title>Ажиллаж байгаа эсэхийг шалгах</title>

      <para>Систем дахин ачаалагдсаны дараа шифрлэгдсэн swap-ийн зөв үйлдлийг 
	<command>swapinfo</command> тушаал ашиглан шалгаж 
	болно.</para>

      <para>Хэрэв &man.gbde.8; ашиглагдаж байвал:</para>

      <screen>&prompt.user; <userinput>swapinfo</userinput>
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.bde    542720        0   542720     0%
      </screen>

      <para>Хэрэв &man.geli.8; ашиглагдаж байвал:</para>

      <screen>&prompt.user; <userinput>swapinfo</userinput>
Device          1K-blocks     Used    Avail Capacity
/dev/ad0s1b.eli    542720        0   542720     0%
      </screen>
    </sect2>
  </sect1>
  <sect1 id="disks-hast">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Даниел</firstname>
	  <surname>Гэрзо</surname>
	  <contrib>Хувь нэмэр болгон оруулсан </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <firstname>Фредди</firstname>
	  <surname>Кэш</surname>
	  <contrib>Зарим нэг зүйлс нэмэрлэсэн </contrib>
	</author>
	<author>
	  <firstname>Павел Жакуб</firstname>
	  <surname>Давидек</surname>
	</author>
	<author>
	  <firstname>Майкл В.</firstname>
	  <surname>Лукас</surname>
	</author>
	<author>
	  <firstname>Виктор</firstname>
	  <surname>Петерсон</surname>
	</author>
      </authorgroup>
      <!-- Date of writing: 26 February 2011 -->
    </sect1info>

    <title>Highly Available Storage (HAST)</title>
    <indexterm>
      <primary>HAST</primary>
      <secondary>high availability</secondary>
    </indexterm>

    <sect2>
      <title>Ерөнхий зүйл</title>

      <para>Байнгын бэлэн ажиллагаатай байх (High-availability) нь 
	бизнесийн чухал програм хангамжуудын хувьд хамгийн гол 
	шаардлага бөгөөд тийм хадгалалтын төхөөрөмж нь уг орчны 
	түлхүүр хэсэг юм. Highly Available STorage буюу
	<acronym>HAST<remark role="acronym">Highly Available
	  STorage</remark></acronym>-г &a.pjd; хөгжүүлсэн бөгөөд 
	энэ нь өгөгдлийг TCP/IP сүлжээнд холбогдсон хэд хэдэн 
	тусдаа байгаа машинууд дээр тунгалгаар хадгалах боломжийг 
	бүрдүүлдэг. <acronym>HAST</acronym>-г сүлжээний RAID1 (толь) гэж 
	ойлгож болох бөгөөд GNU/&linux; тавцангийн хувьд байдаг 
	DRBD&reg; хадгалалтын системтэй төстэй юм. <acronym>CARP</acronym> 
	зэрэг &os;-н бусад байнгын бэлэн ажиллагааг хангагч боломжуудын хамтаар
	<acronym>HAST</acronym> нь тоног төхөөрөмжийн эвдрэлээс ангид 
	байнгын бэлэн ажиллагаатай хадгалалтын кластер бүтээх боломжийг 
	бүрдүүлдэг.</para>

      <para>Энэ хэсгийг уншаад та дараах зүйлсийг мэдэх болно:</para>

      <itemizedlist>
	<listitem>
	  <para><acronym>HAST</acronym> гэж юу болох, хэрхэн ажилладаг болон 
	    ямар боломжуудыг хангадаг талаар.</para>
	</listitem>
	<listitem>
	  <para>&os; дээр <acronym>HAST</acronym>-г хэрхэн тохируулж 
	    ашиглах талаар.</para>
	</listitem>
	<listitem>
	  <para><acronym>CARP</acronym> болон &man.devd.8;-г
	    хэрхэн тохируулж уян хатан хадгалалтын систем бүтээх талаар.</para>
 	</listitem>
      </itemizedlist>

      <para>Энэ хэсгийг уншихаасаа өмнө та дараах зүйлсийг мэдсэн байх шаардлагатай:</para>

      <itemizedlist>
	<listitem>
	  <para>&unix; болон &os;-ийн үндсийг ойлгосон байх
	    (<xref linkend="basics">).</para>
	</listitem>
	<listitem>
	  <para>Сүлжээний интерфэйсүүд болон &os;-н бусад гол дэд системүүдийг хэрхэн 
	    тохируулах талаар мэддэг байх (<xref
	    linkend="config-tuning">).</para>
	</listitem>
	<listitem>
	  <para>&os;-н сүлжээний талаар сайн мэддэг байх
	    (<xref linkend="network-communication">).</para>
	</listitem>
	<listitem>
	  <para>&os;&nbsp;8.1-RELEASE буюу түүнээс хойшхи хувилбарыг ашиглах.</para>
	</listitem>
      </itemizedlist>

      <para><acronym>HAST</acronym> төслийг &os; сан <ulink
	  url="http://www.omc.net/">OMCnet Internet Service GmbH</ulink>
	болон <ulink url="http://www.transip.nl/">TransIP BV</ulink>-н дэмжлэгтэйгээр 
	санхүүжүүлжээ.</para>
    </sect2>

    <sect2>
      <title>HAST-н боломжууд</title>

      <para><acronym>HAST</acronym> системийн гол 
	боломжуудад:</para>

      <itemizedlist>
        <listitem>
	  <para>Локал хатуу дискний хөтчүүд дээрх I/O алдаануудыг 
	    халхлахад ашиглаж болох боломж.</para>
	</listitem>
	<listitem>
	  <para>&os;-н дэмждэг дурын файлын системийг ашиглах боломжийг 
	    бүрдүүлдэг файлын системээс үл хамаарсан байдал.</para>
	</listitem>
	<listitem>
	  <para>Тухайн цэг унасан байх үед зөвхөн өөрчлөгдсөн блокуудыг синхрончлох замаар 
	    үр ашигтай, хурдан дахин синхрончлох боломж.</para>
	</listitem>
	<!--
        <listitem>
	  <para>Has several synchronization modes to allow for fast
	    failover.</para>
	</listitem>
	-->
	<listitem>
	  <para>Нэмэлт нөөц бололцоог нэмэхийн тулд 
	    аль хэдийн бий болгосон орчинд ашиглах боломж.</para>
	</listitem>
	<listitem>
	  <para><acronym>CARP</acronym>,
	    <application>Heartbeat</application> эсвэл бусад 
	    хэрэгслүүдийн хамтаар уян хатан, бөх бат хадгалалтын 
	    системийг бүтээхэд цуг ашиглаж боломж.</para>
	</listitem>
      </itemizedlist>
    </sect2>

    <sect2>
      <title>HAST-н ажиллагаа</title>

      <para><acronym>HAST</acronym> нь дурын хадгалалтын төхөөрөмжийн 
	хувьд блок түвшний синхрон олшруулалтыг хэд хэдэн машин уруу 
	хийдэг болохоор хамгийн багадаа хоёр цэг (физик машинууд) шаарддаг
	&mdash; Эдгээр нь <literal>анхдагч</literal> (бас
	<literal>мастер</literal> гэгддэг) цэг болон 
	<literal>хоёрдогч</literal> (<literal>боол</literal>) цэг юм.
	Энэ хоёр машиныг хамтад нь кластер гэж дуудах болно.</para>

      <note>
	<para>HAST нь одоогоор хоёр кластерын цэгээр 
	  хязгаарлагдсан байгаа.</para>
      </note>

      <para><acronym>HAST</acronym> нь анхдагч-хоёрдогч тохиргоогоор 
	ажилладаг болохоор тухайн үед зөвхөн нэг кластерын цэгийг 
	идэвхтэй байхыг зөвшөөрдөг. <literal>анхдагч</literal> цэг буюу 
	<literal>актив</literal> нь <acronym>HAST</acronym>-р удирдуулсан 
	төхөөрөмжүүдэд хандах I/O хүсэлтүүдтэй ажилладаг цэг юм.
	<literal>хоёрдогч</literal> цэг нь дараа нь <literal>primary</literal> 
	цэгээсээ автоматаар синхрончлогддог.</para>

      <para><acronym>HAST</acronym> системийн 
	физик хэсгүүд нь:</para>

      <itemizedlist>
	<listitem>
	  <para>локал диск (анхдагч цэг дээрх)</para>
	</listitem>
	<listitem>
	  <para>алсын машин дээрх диск (хоёрдогч цэг)</para>
	</listitem>
      </itemizedlist>

      <para><acronym>HAST</acronym> нь блок түвшинд синхроноор 
	ажилладаг бөгөөд энэ нь файлын системүүд болон програм хангамжуудын 
	хувьд тунгалаг болгодог. <acronym>HAST</acronym> нь 
	бусад хэрэгслүүд эсвэл програм хангамжуудад ашиглах боломжтойгоор 
	<filename class="directory">/dev/hast/</filename> санд ердийн 
	GEOM үйлчилгээ үзүүлэгчдээр хангадаг бөгөөд ингэснээр 
	<acronym>HAST</acronym>-р хангагдсан төхөөрөмжүүд болон 
	түүхий дискнүүд, хуваалтууд гэх зэргүүдийн хооронд ялгаа байхгүй 
	болдог байна.</para>

      <para>Бичих, устгах, эсвэл flush үйлдэл бүрийг локал диск болон 
	алсын диск рүү TCP/IP ашиглан илгээдэг. Унших үйлдэлд 
	локал диск дээрх мэдээлэл шинэ биш эсвэл I/O алдаа гараагүй л бол 
	локал дискнээс хариу өгдөг. Хэрэв тийм тохиолдол байвал 
	унших үйлдлийг хоёрдогч цэг рүү илгээдэг.</para>

      <sect3>
	<title>Синхрончлол ба Олшруулалтын горимууд</title>

	<para><acronym>HAST</acronym> нь унасан байдлаас хурдан сэргээх 
	  боломжийг бий болгохыг оролддог. Энэ зорилгоор цэг унасны дараа 
	  синхрончлох хугацааг багасгах нь хамгийн чухал юм. Синхрончлолыг 
	  хурдан хангахын тулд <acronym>HAST</acronym> нь диск дээрх 
	  бохир өгөгдлүүдийн битмапыг зохицуулж байдаг бөгөөд ердийн 
	  синхрончлолын үед зөвхөн тэдгээрийг синхрончилдог (эхний синхрончлолыг 
	  тооцолгүйгээр).</para>

	<para>Синхрончлолтой ажиллах олон аргууд байдаг.
	  <acronym>HAST</acronym> нь янз бүрийн синхрончлолын аргуудтай (доор дурдсан)
	  ажиллахын тулд хэд хэдэн олшруулалтын горимыг хийдэг:</para>

	<itemizedlist>
	  <listitem>
	    <para><emphasis>memsync</emphasis>: локал бичих үйлдэл 
	      дууссан ба алсын цэг өгөгдөл ирснийг баталгаажуулсан бөгөөд 
	      өгөгдлийг яг хадгалахаас өмнөх үед бичих үйлдэл дууссан гэж үздэг.
	      Алсын цэг дээрх өгөгдөл баталгаажуулалт илгээгдсэний дараа 
	      хадгалагддаг. Энэ горим нь саатлыг багасгах зориулалттай 
	      бөгөөд маш сайн найдвартай байдлыг хангадаг.
	      <emphasis>memsync</emphasis> олшруулалтын горим нь одоогоор 
	      хийгдээгүй байгаа.</para>
	  </listitem>
	  <listitem>
	    <para><emphasis>fullsync</emphasis>: локал болон алсын бичих 
	      үйлдэл хийгдэж дууссаны дараа бичих үйлдэл дууссан гэж үздэг. Энэ нь 
	      хамгийн найдвартай бөгөөд удаан горим юм. Энэ горим нь анхдагч 
	      байдаг.</para>
	  </listitem>
	  <listitem>
	    <para><emphasis>async</emphasis>: локал бичих үйлдэл дууссан үед 
	      бичих үйлдлийг дууссан гэж үздэг. Энэ нь хамгийн хурдан бөгөөд 
	      аюултай олшруулалтын горим юм. Энэ горимыг бусад горимын хувьд
	      саатал хэтэрхий өндөр байгаа алсын цэг рүү олшруулахдаа 
	      ашиглах ёстой. <emphasis>async</emphasis> олшруулалтын горим 
	      одоогоор хийгдээгүй байгаа.</para>
	  </listitem>
	</itemizedlist>

	<warning>
	  <para>Зөвхөн <emphasis>fullsync</emphasis> олшруулалтын горим 
	    одоогоор дэмжигдсэн.</para>
	</warning>
      </sect3>
    </sect2>

    <sect2>
      <title>HAST-н тохиргоо</title>

      <para><acronym>HAST</acronym> нь ажиллахын тулд 
	<literal>GEOM_GATE</literal> дэмжлэгийг шаарддаг.
	<literal>GENERIC</literal> цөм нь анхдагчаар 
	<literal>GENERIC</literal>-г <emphasis>агуулдаггүй</emphasis>
	боловч &os;-н анхдагч суулгацад дуудагдах боломжтой 
	<filename>geom_gate.ko</filename> модуль байдаг.
	Мөн дараах мөрийг цөмийн тохиргооны файлд нэмэн 
	<literal>GEOM_GATE</literal> дэмжлэгийг цөмд оруулан бүтээж 
	болдог:</para>

      <programlisting>options	GEOM_GATE</programlisting>

      <para><acronym>HAST</acronym> тогтолцоо нь үйлдлийн 
	системийн өнцгөөс харахад хэд хэдэн хэсгээс тогтдог:</para>

      <itemizedlist>
        <listitem>
	  <para>өгөгдлийн синхрончлолд зориулсан &man.hastd.8; 
	    демон,</para>
	</listitem>
	<listitem>
	  <para>хэрэглэгчийн талбарын удирдлагын хэрэгсэл &man.hastctl.8;,</para>
	</listitem>
	<listitem>
	  <para>&man.hast.conf.5; тохиргооны файл.</para>
	</listitem>
      </itemizedlist>

      <para>Дараах жишээ хоёр цэгийг 
	<literal>мастер</literal>-<literal>боол</literal> /
	<literal>анхдагч</literal>-<literal>хоёрдогч</literal> 
	үйлдлийн хувьд өгөгдлийг уг хоёр цэгийн хооронд олшруулахын 
	тулд <acronym>HAST</acronym> ашиглан тохируулах талаар 
	тайлбарлана. Цэгүүдийг <replaceable>172.16.0.1</replaceable> IP 
	хаягтай <literal><replaceable>hasta</replaceable></literal> болон 
	<replaceable>172.16.0.2</replaceable> IP хаягтай
	<literal><replaceable>hastb</replaceable></literal> гэж нэрлэе.
	Эдгээр цэгүүд нь <acronym>HAST</acronym> үйлдлийн хувьд ижил хэмжээтэй 
	өөр өөрийн <devicename>/dev/<replaceable>ad6</replaceable></devicename> 
	хатуу дисктэй байна. <acronym>HAST</acronym> нөөцийг (заримдаа 
	эх үүсвэр гэгддэг, өөрөөр хэлбэл <filename
	  class="directory">/dev/hast/</filename> дахь GEOM үйлчилгээ 
	үзүүлэгч) <filename><replaceable>test</replaceable></filename>
	гэж нэрлэнэ.</para>

      <para><acronym>HAST</acronym>-н тохиргоог 
	<filename>/etc/hast.conf</filename> файлд хийнэ. Энэ файл нь 
	хоёр цэг дээр ижил байх ёстой. Боломжит хамгийн хялбар 
	тохиргоо дараах байдалтай байна:</para>

      <programlisting>resource test {
	on hasta {
		local /dev/ad6
		remote 172.16.0.2
	}
	on hastb {
		local /dev/ad6
		remote 172.16.0.1
	}
}</programlisting>

      <para>Илүү дэлгэрэнгүй тохиргооны талаар 
	&man.hast.conf.5; гарын авлагаас үзнэ үү.</para>

      <tip>
	<para>Мөн <literal>remote</literal> гэсэн хэсэгт хостын 
	  нэрийг ашиглаж бас болно. Тэр тохиолдолд тэдгээр хостуудыг 
	  таних боломжтой байх ёстойг анхаараарай, өөрөөр хэлбэл 
	  тэдгээр нь <filename>/etc/hosts</filename> файл юм уу эсвэл 
	  локал <acronym>DNS</acronym> дээр тодорхойлогдсон байх 
	  ёстой.</para>
      </tip>

      <para>Одоо хоёр цэг дээр тохиргоо байгаа болохоор 
	<acronym>HAST</acronym> нөөцийг үүсгэх боломжтой. Хоёр 
	цэг дээр дараах тушаалыг ажиллуулж эхний мета өгөгдлийг 
	локал диск дээр байрлуулж &man.hastd.8; демонг ажиллуулна:</para>

      <screen>&prompt.root; <userinput>hastctl create test</userinput>
&prompt.root; <userinput>/etc/rc.d/hastd onestart</userinput></screen>

      <note>
	<para>GEOM үйлчилгээ үзүүлэгчдийг одоо байгаа файлын 
	  систем дээр ашиглаж <emphasis>болохгүй</emphasis>
	  (жишээ нь <acronym>HAST</acronym>-р удирдуулсан нөөц рүү 
	  одоо байгаа хадгалалтын төхөөрөмжийг хувиргах). Учир нь 
	  энэ процедур нь ямар нэг мета өгөгдлийг үйлчилгээ 
	  үзүүлэгч дээр хадгалах хэрэгтэй байдаг бөгөөд шаардлагатай 
	  зай хангалттай байхгүй байх болно.</para>
      </note>

      <para>HAST нь цэгийн үүргийг сонгох үүрэггүй
	(<literal>анхдагч</literal> эсвэл <literal>хоёрдогч</literal>).
	Цэгийн үүргийг администратор тохируулах юм уу эсвэл 
	&man.hastctl.8; хэрэгсэл ашиглан <application>Heartbeat</application> 
	зэрэг бусад програмаар тохируулж болно. Анхдагч цэг рүү 
	(<literal><replaceable>hasta</replaceable></literal>) шилжээд 
	дараах тушаалыг өгнө:</para>

      <screen>&prompt.root; <userinput>hastctl role primary test</userinput></screen>

      <para>Үүнтэй адилаар хоёрдогч цэг дээр 
	(<literal><replaceable>hastb</replaceable></literal>)
	дараах тушаалыг ажиллуулна:</para>

      <screen>&prompt.root; <userinput>hastctl role secondary test</userinput></screen>

      <caution>
	<para>Хоёр цэг хоорондоо холбогдож чадахгүй бөгөөд 
	  хоёулаа анхдагч гэж тохируулагдсан байж болно. Энэ 
	  нөхцлийг <literal>split-brain</literal> гэж нэрлэдэг.
	  Энэ тохиолдолд алдааг олж засварлахын тулд <xref
	  linkend="disks-hast-sb"> хэсэгт зааснаар ажиллана.</para>
      </caution>

      <para>Үр дүнг хоёр цэг дээр &man.hastctl.8; хэрэгсэл 
	ашиглан шалгаж болно:</para>

      <screen>&prompt.root; <userinput>hastctl status test</userinput></screen>

      <para>Гаралтаас хамгийн чухал текст нь <literal>status</literal> 
	мөр бөгөөд хоёр цэг дээр <literal>complete</literal> гэж 
	байх ёстой. Хэрэв энэ нь <literal>degraded</literal> 
	гэж байх юм бол ямар нэг юм болохоо больсныг илтгэнэ.
	Энэ үед цэгүүдийн хооронд синхрончлол явагдаад эхэлчихсэн 
	байна. <command>hastctl status</command> тушаал 
	<literal>dirty</literal> гэдэг дээр 0 байт харуулж байвал 
	синхрончлол дууссан гэсэн үг юм.</para>


      <para>Эцсийн алхам бол <devicename>/dev/hast/<replaceable>test</replaceable></devicename> 
	GEOM үйлчилгээ үзүүлэгч дээр файлын систем үүсгэж холбох явдал юм. 
	Үүнийг <literal>анхдагч</literal> цэг (учир нь
	<filename>/dev/hast/<replaceable>test</replaceable></filename>
	зөвхөн <literal>primary</literal> цэг дээр харагдана) дээр 
	хийх ёстой бөгөөд хатуу дискийн хэмжээнээс хамаарч хэдэн 
	минут үргэлжилж болох юм:</para>

      <screen>&prompt.root; <userinput>newfs -U /dev/hast/test</userinput>
&prompt.root; <userinput>mkdir /hast/test</userinput>
&prompt.root; <userinput>mount /dev/hast/test /hast/test</userinput></screen>

      <para><acronym>HAST</acronym> тогтолцоог зөв тохируулсны дараа 
	хамгийн сүүлийн алхам бол <acronym>HAST</acronym> систем 
	ачаалах үед автоматаар эхэлсэн байхыг шалгах явдал юм.
	Дараах мөрийг <filename>/etc/rc.conf</filename> файлд 
	нэмж өгөх шаардлагатай:</para>

      <programlisting>hastd_enable="YES"</programlisting>

      <sect3>
	<title>Нэгээс нөгөөд шилжих тохиргоо</title>

	<para>Энэ жишээний зорилго нь өгөгдсөн дурын цэг ажиллахаа 
	  больсон тохиолдолд ажиллаж байх уян хатан хадгалалтын 
	  систем бүтээх явдал юм. Энд хамгийн түлхүүр ажил бол 
	  кластерын <literal>анхдагч</literal> цэг ажиллахаа болих 
	  тохиолдлыг байхгүй болгох юм. Хэрэв боллоо гэхэд 
	  <literal>хоёрдогч</literal> цэг сааталгүйгээр авч 
	  ажиллан файлын системийг шалган холбож өгөгдлийн нэг 
	  ч битийг алдалгүйгээр үргэлжлүүлэн ажиллах ёстой.</para>

	<para>Энэ зорилтод хүрэхийн тулд &os;-ийн өөр нэг боломж 
	  болох IP давхарга дээр автоматаар шилжих боломжийг 
	  бүрдүүлдэг <acronym>CARP</acronym>-г ашиглах шаардлагатай 
	  байдаг. <acronym>CARP</acronym> нь Common Address Redundancy Protocol 
	  гэсэн үг бөгөөд ижил сүлжээнд олон хостууд IP хаяг 
	  хуваалцаж хэрэглэх боломжийг бүрдүүлдэг. <acronym>CARP</acronym>-г 
	  кластерын цэг бүр дээр <xref linkend="carp"> хэсэгт зааснаар 
	  тохируулна. Үүнийг хийснийхээ дараа цэг бүр 
	  хуваалцсан IP <replaceable>172.16.0.254</replaceable> гэсэн 
	    хаягтай <devicename>carp0</devicename> гэсэн интерфэйстэй байх 
	    болно. Мэдээж кластерын анхдагч <acronym>HAST</acronym> цэг
	    мастер <acronym>CARP</acronym> цэг байх ёстой.</para>

	<para>Өмнөх хэсэгт үүсгэсэн <acronym>HAST</acronym> нөөц 
	  сүлжээн дэх бусад хостууд руу экспорт хийгдэхэд 
	  бэлэн болсон байна. Үүнийг <acronym>NFS</acronym>,
	  <application>Samba</application> гэх мэтүүдийн тусламжтайгаар 
	  хуваалцсан IP хаяг <replaceable>172.16.0.254</replaceable>
	  ашиглан экспорт хийх замаар хийнэ. Шийдэгдээгүй цор 
	  ганц асуудал бол анхдагч цэг унахад автоматаар шилжих 
	  асуудал юм.</para>

	<para>Хэрэв <acronym>CARP</acronym> интерфэйсүүд унаж босоод 
	  байвал &os; үйлдлийн систем &man.devd.8; үйл явдал гаргах 
	  бөгөөд энэ нь <acronym>CARP</acronym> интерфэйсүүд дээр 
	  төлвийг харах боломжийг бүрдүүлдэг. <acronym>CARP</acronym> 
	  интерфэйс дээрх төлвийн өөрчлөлт нь аль нэг цэг ажиллахаа 
	  байсан эсвэл ажиллаж эхэлснийг харуулна. Энэ тохиолдолд 
	  шилжилтийг автоматаар зохицуулах тусгай скриптийг 
	  ажиллуулах боломжтой юм.</para>

	<para><acronym>CARP</acronym> интерфэйсүүд дээрх төлвийн өөрчлөлтүүдийг 
	  барьж чадахын тулд дараах тохиргоог цэг бүр дээр 
	  <filename>/etc/devd.conf</filename> файлд хийж өгөх ёстой:</para>

	<programlisting>notify 30 {
	match "system" "IFNET";
	match "subsystem" "carp0";
	match "type" "LINK_UP";
	action "/usr/local/sbin/carp-hast-switch master";
};

notify 30 {
	match "system" "IFNET";
	match "subsystem" "carp0";
	match "type" "LINK_DOWN";
	action "/usr/local/sbin/carp-hast-switch slave";
};</programlisting>

	<para>Шинэ тохиргоог идэвхтэй болгохын тулд 
	  дараах тушаалыг цэг бүр дээр ажиллуулна:</para>

	<screen>&prompt.root; <userinput>/etc/rc.d/devd restart</userinput></screen>

	<para><devicename>carp0</devicename> интерфэйс унаж босож байгаа 
	  тохиолдолд (өөрөөр хэлбэр интерфэйсийн төлөв өөрчлөлгдсөн тохиолдолд)
	  систем мэдээлэл өгөх бөгөөд энэ нь &man.devd.8; дэд системд 
	  скрипт ажиллуулах боломжийг бүрдүүлэх бөгөөд энэ тохиолдолд
	  <filename>/usr/local/sbin/carp-hast-switch</filename> байна. Энэ скрипт нь 
	  автоматаар шилжих шилжилтийг зохицуулах юм. Дээрх &man.devd.8; 
	  тохиргооны талаар дэлгэрэнгүйг &man.devd.conf.5; гарын авлагаас 
	  үзнэ үү.</para>

	<para>Ийм скриптийн жишээ дараах байдлаар байж болох юм:</para>

<programlisting>#!/bin/sh

# Original script by Freddie Cash &lt;fjwcash@gmail.com&gt;
# Modified by Michael W. Lucas &lt;mwlucas@BlackHelicopters.org&gt;
# and Viktor Petersson &lt;vpetersson@wireload.net&gt;

# The names of the HAST resources, as listed in /etc/hast.conf
resources="test"

# delay in mounting HAST resource after becoming master
# make your best guess
delay=3

# logging
log="local0.debug"
name="carp-hast"

# end of user configurable stuff

case "$1" in
	master)
		logger -p $log -t $name "Switching to primary provider for ${resources}."
		sleep ${delay}

		# Wait for any "hastd secondary" processes to stop
		for disk in ${resources}; do
			while $( pgrep -lf "hastd: ${disk} \(secondary\)" > /dev/null 2>&1 ); do
				sleep 1
			done

			# Switch role for each disk
			hastctl role primary ${disk}
			if [ $? -ne 0 ]; then
				logger -p $log -t $name "Unable to change role to primary for resource ${disk}."
				exit 1
			fi
		done

		# Wait for the /dev/hast/* devices to appear
		for disk in ${resources}; do
			for I in $( jot 60 ); do
				[ -c "/dev/hast/${disk}" ] && break
				sleep 0.5
			done

			if [ ! -c "/dev/hast/${disk}" ]; then
				logger -p $log -t $name "GEOM provider /dev/hast/${disk} did not appear."
				exit 1
			fi
		done

		logger -p $log -t $name "Role for HAST resources ${resources} switched to primary."


		logger -p $log -t $name "Mounting disks."
		for disk in ${resources}; do
			mkdir -p /hast/${disk}
			fsck -p -y -t ufs /dev/hast/${disk}
			mount /dev/hast/${disk} /hast/${disk}
		done

	;;

	slave)
		logger -p $log -t $name "Switching to secondary provider for ${resources}."

		# Switch roles for the HAST resources
		for disk in ${resources}; do
			if ! mount | grep -q "^/dev/hast/${disk} on "
			then
			else
				umount -f /hast/${disk}
			fi
			sleep $delay
			hastctl role secondary ${disk} 2>&1
			if [ $? -ne 0 ]; then
				logger -p $log -t $name "Unable to switch role to secondary for resource ${disk}."
				exit 1
			fi
			logger -p $log -t $name "Role switched to secondary for resource ${disk}."
		done
	;;
esac</programlisting>

	<para>Товчхондоо скрипт нь цэг <literal>мастер</literal> /
	  <literal>анхдагч</literal> болох үед дараахийг хийнэ:</para>

	<itemizedlist>
	  <listitem>
	    <para>Өгөгдсөн цэг дээр <acronym>HAST</acronym> нөөцийг анхдагч 
	      болгоно.</para>
	  </listitem>
	  <listitem>
	    <para><acronym>HAST</acronym> нөөц доор байгаа файлын системийг 
	      шалгана.</para>
	  </listitem>
	  <listitem>
	    <para>Тохирох газарт нь нөөцүүдийг холбоно.</para>
	  </listitem>
	</itemizedlist>

	<para><literal>нөөц</literal> /
	  <literal>хоёрдогч</literal> болсон тохиолдолд:</para>

	<itemizedlist>
	  <listitem>
	    <para><acronym>HAST</acronym> нөөцүүдийг салгана.</para>
	  </listitem>
	  <listitem>
	    <para><acronym>HAST</acronym> нөөцүүдийг хоёрдогч болгож 
	      бууруулна.</para>
	  </listitem>
	</itemizedlist>

	<caution>
	  <para>Энэ нь зөвхөн боломжой шийдэл байдаг гэдгийг харуулсан 
	    жишээ скрипт гэдгийг санаарай. Энэ нь бүх л боломжит 
	    нөхцлийг тооцоогүй бөгөөд шаардлагатай үйлчилгээг эхлүүлэх/зогсоох 
	    гэх мэтээр сайжруулж өргөтгөх юм уу эсвэл 
	    дураараа өөрчлөх боломжтой юм.</para>
	</caution>

	<tip>
	  <para>Энэ жишээн дээр бид стандарт UFS файлын системийг 
	    ашигласан. Сэргээхэд шаардлагатай цагийг багасгахын 
	    тулд журнал дэмжигдсэн UFS эсвэл ZFS файлын системийг 
	    ашиглаж болох юм.</para>
	</tip>

	<para>Нэмэлт жишээнүүд бүхий илүү дэлгэрэнгүй мэдээллийг 
	  <ulink
	    url="http://wiki.FreeBSD.org/HAST">HAST Wiki</ulink> хуудаснаас 
	  олж болно.</para>
      </sect3>
    </sect2>
    <sect2>
      <title>Алдааг олж засварлах</title>

      <sect3>
	<title>Алдааг олж засварлах ерөнхий аргууд</title>

	<para><acronym>HAST</acronym> ерөнхийдөө асуудалгүй ажиллах 
	  ёстой боловч бусад програмуудын нэгэн адил ажиллах ёстойгоосоо 
	  өөрөөр ажиллах тохиолдол байдаг. Асуудлын шалтгаан өөр өөр 
	  байж болох боловч гол шалгах юм нь кластерын цэгүүдийн 
	  хооронд цаг синхрончлогдсон байгаа эсэхийг мэдэх явдал 
	  юм.</para>

	<para><acronym>HAST</acronym>-н асуудлуудыг шалгаж байхдаа 
	  &man.hastd.8;-н дибаг түвшинг ихэсгэж үзэх ёстой.
	  Ингэхдээ &man.hastd.8;-г <literal>-d</literal> өгөгдөлтэйгээр 
	  ажиллуулах хэрэгтэй. Дибаг түвшинг дахин дахин ихэсгэхийн 
	  тулд энэ аргументыг олон удаа тавьж өгч болно. Энэ замаар 
	  маш их хэрэгтэй мэдээллийг олж авч болно. 
	  Мөн <literal>-F</literal> аргументыг ашиглан &man.hastd.8;
	  демонг ил ажиллуулах нь зүйтэй байдаг.</para>
     </sect3>

      <sect3 id="disks-hast-sb">
	<title>Split-brain нөхцлөөс сэргэж гарах</title>

	<para>Хоёр цэг нэг нэгэнтэйгээ холбогдож чадахгүй бөгөөд 
	  хоёул анхдагч цэг гэж тохируулагдсан үеийн нөхцлийг 
	  <literal>split-brain</literal> гэдэг. Энэ нь аюултай нөхцөл 
	  бөгөөд учир нь энэ тохиолдолд өгөгдөлд хоёр цэг хоёул 
	  нийцгүй өөрчлөлтийг хийх боломжийг олгодог. Энэ нөхцлийг 
	  системийн администратор гараар зохицуулах шаардлагатай.</para>

	<para>Энэ тохиолдлыг засварлахын тулд администратор 
	  аль цэг хамгийн чухал өөрчлөлттэй байгаа дээр шийдвэр 
	  гаргаж (эсвэл гараар нийлүүлэн) <acronym>HAST</acronym>-д 
	  эвдэрсэн өгөгдөл бүхий цэгийн бүтэн синхрончлол хийх
	  боломжийг олгох ёстой. Ингэхийн тулд дараах тушаалуудыг 
	  дахин синхрончлол шаардлагатай байгаа цэг дээр ажиллуулна:</para>

        <screen>&prompt.root; <userinput>hastctl role init &lt;resource&gt;</userinput>
&prompt.root; <userinput>hastctl create &lt;resource&gt;</userinput>
&prompt.root; <userinput>hastctl role secondary &lt;resource&gt;</userinput></screen>
      </sect3>
     </sect2>
   </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
