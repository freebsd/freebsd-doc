<!--
     The FreeBSD Documentation Project

     The FreeBSD Spanish Documentation Project
     %SOURCE% en_US.ISO8859-1/books/handbook/multimedia/chapter.sgml
     %SRCID%    1.130

     $FreeBSD$
-->

<chapter id="multimedia">
  <chapterinfo>
    <authorgroup>
      <author>
        <firstname>Ross</firstname>
	<surname>Lippert</surname>
	<contrib>Editado por </contrib>
      </author>
    </authorgroup>
    <!-- 20 November 2000 -->
  </chapterinfo>

  <title>Multimedia</title>

  <sect1>
    <title>Sinopsis</title>

    <para>&os; admite una gran variedad de tarjetas de sonido,
      lo que permite disfrutar de sonido de alta fidelidad en su
      sistema. &Eacute;sto incluye la posibilidad de grabar y reproducir
      ficheros de audio tanto en los formatos MPEG Audio Layer 3
      (MP3), WAV y Ogg Vorbis, as&iacute; como muchos otros.  
      La Colecci&oacute;n de Ports de &os; contiene tambi&eacute;n
      aplicaciones que le permitir&aacute;n editar audio previamente grabado,
      a&ntilde;adir efectos y controlar dispositivos MIDI.</para>
    

    <para>Tras unas cuantas pruebas podr&aacute; reproducir ficheros de
      video y DVD en &os;.  La cantidad de aplicaciones disponibles
      para codificar, convertir y reproducir los diversos soportes de
      video es m&aacute;s limitada que lo que hay disponible para
      el sonido.  Por ejemplo, en el momento de escribir este texto
      no hay en la Colecci&oacute;n de Ports de &os; una buena
      aplicaci&oacute;n que permita pasar datos de un formato a
      otro, el equivalente a lo que hay en el campo del sonido con
      <filename role="package">audio/sox</filename>.  A pesar de eso
      la situaci&oacute;n en este &aacute;rea est&aacute; cambiando
      r&aacute;pidamente.</para>

    <para>Este cap&iacute;tulo muestra los pasos necesarios para configurar
      una tarjeta de sonido.  La configuraci&oacute;n e instalaci&oacute;n
      de X11 (<xref linkend="x11">) habr&aacute; solucionado ya todos
      los problemas que hubiera podido darle su tarjeta gr&aacute;fica,
      aunque quiz&aacute;s haya alg&uacute;n peque&ntilde;o detalle que 
      a&ntilde;adir para mejorar la reproducci&oacute;n.</para>



    <para>Tras leer &eacute;ste cap&iacute;tulo sabr&aacute; usted:</para>
    <itemizedlist>
      <listitem><para>C&oacute;mo configurar su sistema de modo que su tarjeta
        de sonido sea reconocida por el mismo.</para></listitem> 

      <listitem><para>Confirmar el funcionamiento de su tarjeta usando
        herramientas de muestreo.</para></listitem>

      <listitem><para>C&oacute;mo enfrentarse a problemas de
        configuraci&oacute;n de sonido.</para></listitem>

      <listitem><para>C&oacute;mo reproducir y crear ficheros
        MP3 y otros.</para></listitem>

      <listitem><para>C&oacute;mo gestiona el video el servidor X.</para></listitem>
      <listitem><para>Identificar unos cuantos ports para reproducir y
        codificar video que le dar&aacute;n muy buenos resultados.</para></listitem>
      <listitem><para>C&oacute;mo reproducir DVD y ficheros
        <filename>.mpg</filename> y
	<filename>.avi</filename>.</para></listitem>

      <listitem><para>C&oacute;mo convertir CD y DVD en ficheros
        de datos.</para></listitem>
      <listitem><para>C&oacute;mo configurar una tarjeta de TV.</para></listitem>
      <listitem><para>C&oacute;mo configurar un esc&aacute;ner de
        im&aacute;genes.</para></listitem>
    </itemizedlist>

    <para>Antes de leer &eacute;ste cap&iacute;tulo deber&iacute;a:</para>

    <itemizedlist>
      <listitem><para>Saber configurar e instalar un nuevo kernel (<xref
        linkend="kernelconfig">).</para></listitem>
    </itemizedlist>


    <warning>
      <para>&nbsp;Si intenta montar un cd con &man.mount.8; provocar&aacute;
        (como m&iacute;nimo) un error en el sistema, pero puede
        llegar a provocar un <emphasis>kernel
        panic</emphasis>.  Dichos soportes tienen codificaciones
	especiales sustancialmente diferentes de los t&iacute;picos
	sistemas de ficheros ISO.</para>
    </warning>


  </sect1>



  <sect1 id="sound-setup">
    <sect1info>
      <authorgroup>
        <author>
	 <firstname>Moses</firstname>
	 <surname>Moore</surname>
	 <contrib>Escrito por </contrib>
	 <!-- 20 November 2000 -->
        </author>
      </authorgroup>
      <authorgroup>
        <author>
	 <firstname>Marc</firstname>
	 <surname>Fonvieille</surname>
	 <contrib>Ampliado para &os;&nbsp;5.X por </contrib>
	 <!-- 13 September 2004 -->
        </author>
      </authorgroup>
    </sect1info>

    <title>Configuraci&oacute;n de la tarjeta de sonido</title>
    
  <sect2 id="sound-device">
    <title>Configuraci&oacute;n del sistema </title>

    <indexterm><primary>PCI</primary></indexterm>
    <indexterm><primary>ISA</primary></indexterm>
    <indexterm><primary>sound cards</primary></indexterm>
    <para>Antes de nada tendr&aacute; que saber a ciencia cierta el
      modelo de tarjeta que tiene, qu&eacute; chip utiliza y si es PCI
      o ISA.  &os; admite una amplia variedad de tarjetas, tanto PCI como
      ISA.  Consulte la lista de dispositivos de sonido que puede usar
      en &os; en las <ulink
      url="&rel.current.hardware;">Hardware Notes</ulink>.  Las
      &laquo;Hardware Notes&raquo; le dir&aacute;n tambi&eacute;n
      qu&eacute; controlador es el que hace funcionar su tarjeta.</para>

    <indexterm>
      <primary>kernel</primary>
      <secondary>configuration</secondary>
    </indexterm>

    <para>Para poder usar su dispositivo de sonido en &os; tiene que
      cargar el controlador de dispositivo adecuado, cosa que puede
      hacerse de dos maneras.  La forma m&aacute;s f&aacute;cil es
      cargar el m&oacute;dulo del kernel correspondiente a su tarjeta
      de sonido mediante &man.kldload.8;.  Puede hacerlo en su shell
      con la siguiente orden</para>

    <screen>&prompt.root; <userinput>kldload snd_emu10k1</userinput></screen>

    <para>o a&ntilde;adiendo la l&iacute;nea apropiada al fichero
      <filename>/boot/loader.conf</filename>:</para>

    <programlisting>snd_emu10k1_load="YES"</programlisting>

    <para>Ambos ejemplos son para una tarjeta de sonido
      Creative &soundblaster; Live!.  Encontrar&aacute; una lista de
      m&oacute;dulos de sonido que puede cargar del mismo modo en
      <filename>/boot/defaults/loader.conf</filename>.  Si no est&aacute;
      del todo seguro sobre el controlador que debe usar pruebe con el
      m&oacute;dulo <filename>snd_driver</filename>:</para>

    <screen>&prompt.root; <userinput>kldload snd_driver</userinput></screen>

    <para>Se trata de un &laquo;metacontrolador&raquo; que carga en
      memoria todos los controladores m&aacute;s habituales.  De este modo
      acelerar&aacute; notablemente el proceso de detectar cu&aacute;l es
      el controlador perfecto para su hardware.  Tambi&eacute;n
      puede cargar todos los controladores de sonido desde
      <filename>/boot/loader.conf</filename>.</para>

    <para>Si quiere saber qu&eacute; controlador se corresponde
      con su tarjeta de sonido una vez cargado el &laquo;metadriver&raquo;
      <filename>snd_driver</filename> debe comprobar el contenido de
      <filename>/dev/sndstat</filename> mediante la orden
      <command>cat /dev/sndstat</command>.</para>

    <para>El segundo m&eacute;todo es compilar de forma est&aacute;tica
      el soporte para su tarjeta de sonido dentro de un kernel
      personalizado.  En la siguiente secci&oacute;n encontrar&aacute;
      la informaci&oacute;n necesaria para a&ntilde;adir a su kernel
      el soporte que necesita su hardware.  Para m&aacute;s informaci&oacute;n
      sobre la compilaci&oacute;n de un kernel consulte el <xref
      linkend="kernelconfig">.</para>

    <sect3>
      <title>Configuraci&oacute;n de un kernel personalizado con soporte de sonido</title>

      <para>Lo primero que hay que hacer es a&ntilde;adir el
        controlador del &laquo;framework&raquo; de sonido
	&man.sound.4; al kernel;  tendr&aacute; que a&ntilde;adir
	la siguiente l&iacute;nea a su fichero de configuraci&oacute;n
	del kernel:</para>

      <programlisting>device sound</programlisting>

      <para>Una vez hecho esto tiene que a&ntilde;adir el soporte
        para su tarjeta de sonido.  Evidentemente tendr&aacute; que
	saber exactamente qu&eacute; controlador es el que hace
	funcionar su tarjeta.  Consulte la lista de dispositivos de
	sonido soportados que encontrar&aacute; en las <ulink
	url="&rel.current.hardware;">Hardware Notes</ulink> y elija
	el controlador perfecto para su tarjeta.  Por ejemplo una
	una tarjeta de sonido Creative &soundblaster; Live! usar&aacute;
	el controlador &man.snd.emu10k1.4;.  Siguiendo con el ejemplo,
	si queremos a&ntilde;adir soporte para esta tarjeta agregaremos
	lo siguiente:</para>

      <programlisting>device snd_emu10k1</programlisting>

      <para>Por favor, lea la p&aacute;gina de manual del controlador
        si tiene dudas con la sintaxis.  La sintaxis espec&iacute;fica
	para la configuraci&oacute;n en el kernel de cada tarjeta de
	sonido soportada existente puede encontrarse tambi&eacute;n
	en <filename>/usr/src/sys/conf/NOTES</filename>.</para>

      <para>Las tarjetas ISA no PnP pueden requerir que se le
        facilite al kernel la informaci&oacute;n de la
	configuraci&oacute;n de la tarjeta (IRQ, puerto de E/S, etc).  Esto
	se hace modificando el fichero
	<filename>/boot/device.hints</filename>.  Durante el proceso de
	arranque &man.loader.8; leer&aacute; este fichero y le
	pasar&aacute; los par&aacute;metros al kernel.  Veamos un ejemplo:
	una vieja tarjeta Creative &soundblaster; 16 ISA no PnP
	utilizar&aacute; el controlador &man.snd.sbc.4; junto con
	<literal>snd_sb16</literal>.  En el caso de esta tarjeta
	habr&aacute; que a&ntilde;adir las siguientes l&iacute;neas
	al fichero de configuraci&oacute;n del kernel</para>

      <programlisting>device snd_sbc
device snd_sb16</programlisting>

      <para>y a&ntilde;adir lo siguiente a
	<filename>/boot/device.hints</filename>:</para>

      <programlisting>hint.sbc.0.at="isa"
hint.sbc.0.port="0x220"
hint.sbc.0.irq="5"
hint.sbc.0.drq="1"
hint.sbc.0.flags="0x15"</programlisting>

      <para>La tarjeta del ejemplo usa el puerto de E/S <literal>0x220</literal>
	I/O port y la IRQ <literal>5</literal>.</para>

      <para>La sintaxis a utilizar en
	<filename>/boot/device.hints</filename> se explica en
	la p&aacute;gina de manual de &man.sound.4; y en la del
	controlador en cuesti&oacute;n.</para>

      <para>En el ejemplo se muestran los par&aacute;metros por
        omisi&oacute;n.  En ciertos casos habr&aacute; que usar
	otra IRQ o usar otros par&aacute;metros para hacer funcionar
	la tarjeta de sonido.  Consulte la p&aacute;gina de manual de
	&man.snd.sbc.4; para m&aacute;s informaci&oacute;n sobre esta
	tarjeta.</para>
    </sect3>
  </sect2>

  <sect2 id="sound-testing">
    <title>C&oacute;mo probar su tarjeta de sonido</title>

    <para>Una vez que haya reiniciado con su kernel personalizado, o
      tras cargar el m&oacute;lo del kernel necesario la tarjeta de
      sonido aparecer&aacute; en el b&uacute;fer de mensajes del sistema
      (&man.dmesg.8;); deber&iacute; ser algo muy parecido a esto:</para>

    <screen>pcm0: &lt;Intel ICH3 (82801CA)&gt; port 0xdc80-0xdcbf,0xd800-0xd8ff irq 5 at device 31.5 on pci0
pcm0: [GIANT-LOCKED]
pcm0: &lt;Cirrus Logic CS4205 AC97 Codec&gt;</screen>

    <para>Puede comprobar el estado de la tarjeta de sonido en
      el fichero <filename>/dev/sndstat</filename>:</para>

    <screen>&prompt.root; <userinput>cat /dev/sndstat</userinput>
FreeBSD Audio Driver (newpcm)
Installed devices:
pcm0: &lt;Intel ICH3 (82801CA)&gt; at io 0xd800, 0xdc80 irq 5 bufsz 16384
kld snd_ich (1p/2r/0v channels duplex default)</screen>

    <para>El resultado en su sistema seguramente ser&aacute; distinto.  Si
      no aparecen dispositivos <devicename>pcm</devicename> revise todo el
      proceso a ver d&oacute;nde est&aacute; el error.  Revise su fichero
      de configuraci&oacute;n del kernel nuevamente y compruebe que
      eligi&oacute; el controlador de dispositivo adecuado.  Tiene una
      lista de problemas habituales en la <xref
      linkend="troubleshooting">.</para>

    <para>Si todo ha ido bien ya tiene una tarjeta de sonido funcionando
      en su sistema.  Si los pins de salida de sonido de su CD-ROM o DVD-ROM
      est&aacute;n colocados correctamente puede poner un CD en la unidad
      y reproducirlo con &man.cdcontrol.1;.</para>

      <screen>&prompt.user; <userinput>cdcontrol -f /dev/acd0 play 1</userinput></screen>

    <para>Hay muchas aplicaciones como <filename
      role="package">audio/workman</filename> que le ofrecer&aacute;n
      un interfaz m&aacute;s amigable.  Si quiere escuchar ficheros MP3
      puede instalar, por ejemplo,
      <filename role="package">audio/mpg123</filename>.</para>

    <para>Hay otra via a&uacute;n m&aacute;s r&aacute;pida de probar su
      tarjeta de sonido.  Env&iacute;e datos a
      to <filename>/dev/dsp</filename> del siguiente modo:</para>

    <screen>&prompt.user; <userinput>cat <replaceable>fichero</replaceable> &gt; /dev/dsp</userinput></screen>

    <para>donde <filename><replaceable>fichero</replaceable></filename>
      puede ser cualquier fichero.  Esta orden producir&aacute; ruido,
      lo que confirmar&aacute; que la tarjeta de sonido funciona.</para>

    <para>Puede manejar los niveles de la tarjeta de sonido con &man.mixer.8;.  
      Tiene todos los detalles en la p&aacute;gina de manual de
      &man.mixer.8;.</para>

    <sect3 id="troubleshooting">
      <title>Problemas habituales</title>

      <indexterm><primary>device nodes</primary></indexterm>
      <indexterm><primary>I/O port</primary></indexterm>
      <indexterm><primary>IRQ</primary></indexterm>
      <indexterm><primary>DSP</primary></indexterm>

      <informaltable frame="none" pgwide="1">
         <tgroup cols="2">
  	  <thead>
	    <row>
	     <entry>Error</entry>
	      <entry>Solution</entry>
	    </row>
          </thead>

	  <tbody>
            <row>
              <entry><errorname>sb_dspwr(XX) timed out</errorname></entry>
              <entry><para>El puerto de E/S no ha sido configurado correctamente.</para></entry>
            </row>

            <row>
              <entry><errorname>bad irq XX</errorname></entry>
	      <entry><para>No ha elegido correctamente la IRQ.  Aseg&uacute;rese
  	        de que la IRQ que ha elegido y la IRQ del sonido son la misma.</para></entry>
            </row>

            <row>
              <entry><errorname>xxx: gus pcm not attached, out of memory</errorname></entry>
              <entry><para>No queda memoria suficiente en el sistema para poder
	        usar el dispositivo.</para></entry>
            </row>

            <row>
              <entry><errorname>xxx: can't open /dev/dsp!</errorname></entry>
              <entry><para>Compruebe si hay otra aplicaci&oacute;n utilizando
	        (y por tanto ocupando) el dispositivo.  Escriba
	        <command>fstat | grep dsp</command>.  Los sospechosos
                habituales son <application>esound</application> y
		el sistema de sonido de <application>KDE</application>.
                </para></entry>
            </row>
          </tbody>
        </tgroup>
      </informaltable>
    </sect3>
  </sect2>

  <sect2 id="sound-multiple-sources">
    <sect2info>
     <authorgroup>
      <author>
       <firstname>Munish</firstname>
       <surname>Chopra</surname>
       <contrib>Escrito por </contrib>
      </author>
     </authorgroup>
    </sect2info>
    <title>C&oacute;mo utilizar m&uacute;ltiples fuentes de sonido</title>

    <para>Disponer de m&uacute;ltiples fuentes de sonido puede ser muy
      &uacute;til, por ejemplo cuando
      <application>esound</application> o
      <application>artsd</application> no permiten compartir el dispositivo
      de sonido con otra aplicaci&oacute;n.</para>

    <para>&os; permite hacerlo gracias a los <emphasis>Virtual Sound
      Channels</emphasis> (<literal>canales virtuales de sonido</literal>),
      que se activan mediante &man.sysctl.8;.  Los canales virtuales
      permiten multiplexar la reproducci&oacute;n de sonido de su tarjeta
      mezclando el sonido en el kernel.</para>

    <para>El n&uacute;mero de canales virtuales se configura utilizando
      dos sysctl; como <username>root</username> escriba lo siguiente:</para>
    <screen>&prompt.root; <userinput>sysctl hw.snd.pcm0.vchans=4</userinput>
&prompt.root; <userinput>sysctl hw.snd.maxautovchans=4</userinput></screen>

    <para>En el ejemplo anterior se han creado cuatro canales virtuales, una
      cantidad muy razonable para el uso normal.  
      <varname>hw.snd.pcm0.vchans</varname> es el n&uacute;mero de canales
      virtuales de que dispone <devicename>pcm0</devicename>; puede configurarlo
      en cuanto el dispositivo sea reconocido por el sistema.  
      <literal>hw.snd.maxautovchans</literal> es el n&uacute;mero de canales
      virtuales que se le asignan a un nuevo dispositivo de audio cuando se
      conecta al sistema mediante &man.kldload.8;.  Puesto que el
      m&oacute;dulo <devicename>pcm</devicename> puede cargarse independientemente
      de los controladores de hardware
      <varname>hw.snd.maxautovchans</varname> puede almacenar cu&aacute;ntos
      canales virtuales tienen asignados los dispositivos que se vayan
      conectando al sistema.</para>

    <note>
      <para>No es posible modificar el n&uacute;mero de canales virtuales
        de un dispositivo que est&eacute; en marcha.  Cierre antes todos
	los programas que est&eacute;n utilizando el dispositivo, como
	reproductores de m&uacute;sica o d&aelig;mons de sonido.</para>
    </note>

    <para>Si no usa &man.devfs.5; tendr&aacute; que configurar sus
      aplicaciones para que apunten a
      <filename>/dev/dsp0</filename>.<replaceable>x</replaceable>,
      donde <replaceable>x</replaceable> es un n&uacute;mero entre 0 y 3 si
      <varname>hw.snd.pcm.0.vchans</varname> tiene un valor de 4 como en el
      ejemplo anterior.  Si se estuviera usando
      &man.devfs.5; en el ejemplo anterior cualquier programa que pidiera
      <filename>/dev/dsp0</filename> ser&iacute;a atendido de
      forma totalmente transparente.</para>
   </sect2>

  <sect2>
    <sect2info>
      <authorgroup>
	<author>
	  <firstname>Josef</firstname>
	  <surname>El-Rayes</surname>
	  <contrib>Escrito por </contrib>
	</author>
      </authorgroup>
    </sect2info>

    <title>Asignaci&oacute;n a los canales de mezcla de valores por omisi&oacute;n</title>

    <para>Los valores por defecto de los distintos canales de mezcla
      est&aacute;n fijados en el c&oacute;digo del controlador
      &man.pcm.4;.  Hay distintas aplicaciones y d&aelig;mons
      que le permitir&aacute;n asignar valores al mezclador y que
      permanezcan entre uso y uso, pero no es una soluci&oacute;n
      demasiado limpia.  Puede asignar valores por omisi&oacute;n a
      las mezclas a nivel de controlador definiendo los valores
      apropiados en <filename>/boot/device.hints</filename>.  Veamos
      un ejemplo:</para>

<programlisting>hint.pcm.0.vol="50"</programlisting>

    <para>Esto asignar&aacute; al canal de volumen un valor por
      omisi&oacute;n de 50 al cargar el m&oacute;dulo
      &man.pcm.4;.</para>
  </sect2>
</sect1>



  <sect1 id="sound-mp3">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Chern</firstname>
	  <surname>Lee</surname>
	  <contrib>Escrito por </contrib>
	</author>
      </authorgroup>
      <!-- 11 Sept 2001 -->
    </sect1info>

    <title>Sonido MP3</title>

    <para>El formato MP3 (MPEG Layer 3 Audio) llega casi al nivel de
      calidad del CD, por lo que no hay motivo por el deba faltar en
      su escritorio &os;.</para>

    <sect2 id="mp3-players">
      <title>Reproductores de MP3</title>

      <para>El reproductor de MP3 para X11 m&aacute;s extendido
	es, de lejos, <application>XMMS</application> (X Multimedia System).  
	Puede usar en &eacute;l &laquo;skins&raquo;de
	<application>Winamp</application> puesto que el interfaz
	gr&aacute;fico de <application>XMMS</application> es casi
	id&eacute;ntico al de Nullsoft
	<application>Winamp</application>.  
	<application>XMMS</application> incluye tambi&eacute;n soporte nativo
	para &laquo;plug-ins&raquo;.</para>

      <para>Puede instalar <application>XMMS</application> como port 
	(<filename role="package">multimedia/xmms</filename>) o como package.</para>

      <para>La interfaz de <application>XMMS</application> es intuitiva e
	incluye una lista de reproducci&oacute;n, un ecualizador
	gr&aacute;fico y muchas otras cosas.  Si est&aacute; acostumbrado
	a <application>Winamp</application>
	<application>XMMS</application> le ser&aacute; muy
	f&aacute;cil de usar.</para>

      <para>El port <filename role="package">audio/mpg123</filename>
        es un reproductor MP3 que se usa desde la shell.</para>

      <para>Puede especificarle desde la misma l&iacute;nea de &oacute;rdenes
        a <application>mpg123</application> el dispositivo de
        sonido que debe usar y el fichero MP3 que debe reproducir.  Veamos
	un ejemplo:</para>

      <screen>&prompt.root; <userinput>mpg123 -a <replaceable>/dev/dsp1.0</replaceable> ASaber-Grandes&Eacute;xitos.mp3</userinput>
High Performance MPEG 1.0/2.0/2.5 Audio Player for Layer 1, 2 and 3.
Version 0.59r (1999/Jun/15). Written and copyrights by Michael Hipp.
Uses code from various people. See 'README' for more!
THIS SOFTWARE COMES WITH ABSOLUTELY NO WARRANTY! USE AT YOUR OWN RISK!





Playing MPEG stream from ASaber-Grandes&Eacute;xitos.mp3 ...
MPEG 1.0 layer III, 128 kbit/s, 44100 Hz joint-stereo
</screen>

      <para>Sustituya <filename><replaceable>/dev/dsp1.0</replaceable></filename>
	por el dispositivo <devicename>dsp</devicename> que haya en su
	sistema.</para>

    </sect2>

    <sect2 id="rip-cd">
      <title>Extracci&oacute;n de pistas de sonido de un CD</title>

      <para>Antes de convirtir una pista o todo un CD a MP3 la informaci&oacute;n
        sonido debe volcarse al disco duro.  Esto se hace convirtiendo
	los datos &laquo;raw CDDA&raquo; (CD Digital Audio) a ficheros
	WAV.</para>

      <para>La herramienta <command>cdda2wav</command>, que forma parte
	del port <filename role="package">sysutils/cdrtools</filename>,
	permite la extracci&oacute;n de informaci&oacute;n de sonido en
	CD as&iacute; como la informaci&oacute;n asociada a &eacute;l.</para>

      <para>Con el CD en la unidad la siguiente orden
	(como <username>root</username>) un CD entero en ficheros WAV
	individuales, uno por pista:</para>

      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -B</userinput></screen>

      <para><application>cdda2wav</application> soporta unidades CDROM
	ATAPI (IDE).  En el caso de unidades IDE  especifique
	el n&uacute;mero de dispositivo en el lugar correspondiente al
	n&uacute;ro de unidad SCSI.  Por ejemplo, para extraer la pista
	7 desde una unidad IDE:</para>

      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>/dev/acd0</replaceable> -t 7</userinput></screen>

      <para>La opci&oacute;n
        <option>-D <replaceable>0,1,0</replaceable></option>
	indica el dispositivo SCSI <devicename>0,1,0</devicename>,
	que corresponde con la salida de <command>cdrecord
	-scanbus</command>.</para>

      <para>Para extraer pistas de forma selectiva use la opci&oacute;n 
	<option>-t</option>:</para>

      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -t 7</userinput></screen>

      <para>Esta opci&oacute;n extrae la s&eacute;ptima pista de un CDROM
        de sonido.  Si quiere extraer un rango de pistas, por ejemplo las
	pistas de la uno a la siete, declare el rango del siguiente
	modo:</para>

      <screen>&prompt.root; <userinput>cdda2wav -D <replaceable>0,1,0</replaceable> -t 1+7</userinput></screen>

      <para>La herramienta &man.dd.1; le permite tambi&eacute;n extraer
        pistas de sonido desde unidades ATAPI; consulte la <xref
	linkend="duplicating-audiocds"> para m&aacute;s
	informaci&oacute;n.</para>

    </sect2>

    <sect2 id="mp3-encoding">
      <title>Codificaci&oacute;n de MP3</title>

      <para>Hoy por hoy el codificador de MP3 por antonomasia es
	<application>lame</application>.  
	Puede encontrar <application>lame</application> en
	<filename role="package">audio/lame</filename>.</para>

      <para>Partiendo de ficheros WAV previamente extraidos la
        siguiente orden convierte
	<filename><replaceable>audio01.wav</replaceable></filename> en
	<filename><replaceable>audio01.mp3</replaceable></filename>:</para>

      <screen>&prompt.root; <userinput>lame -h -b <replaceable>128</replaceable> \
--tt "<replaceable>T&iacute;tulo de copla o cantar</replaceable>" \
--ta "<replaceable>Grupo, solista o coral sinf&oacute;nica</replaceable>" \
--tl "<replaceable>T&iacute;tulo del &aacute;lbum</replaceable>" \
--ty "<replaceable>2001</replaceable>" \
--tc "<replaceable>Autor de la extracci&oacute;n y paso a MP3</replaceable>" \
--tg "<replaceable>Estilo</replaceable>" \
<replaceable>audio01.wav audio01.mp3</replaceable></userinput></screen>

      <para>Los 128&nbsp;kbits pasan por se el est&aacute;ndar de ratio
        de bits de los MP3, aunque puede que usted sea de los que prefieren
	calidades m&aacute;s altas, 160 o incluso 192.  A mayor ratio
	de bits, m&aacute;s espacio en disco necesitar&aacute;, aunque
	la calidad tambi&eacute;n ser&aacute; mayor.  La opci&oacute;n
	<option>-h</option> usa el modo &laquo;m&aacute;s calidad pero
	algo m&aacute;s lento&raquo;.  Las opciones que empiezan por 
	<option>--t</option> indican etiquetas ID3, que suelen contener
	informaci&oacute;n de la canci&oacute;n que contiene el fichero
	MP3.  Tiene informaci&oacute;n sobre otras opciones de
	codificaci&oacute;n en la p&aacute;gina de manual de
	<application>lame</application>.</para>
    </sect2>

    <sect2 id="mp3-decoding">
      <title>Decodificaci&oacute;n de MP3</title>

      <para>Para grabar un CD de sonido desde ficheros MP3 hay
        que convertirlos a formato WAV no comprimido.  Tanto
	<application>XMMS</application> como
	<application>mpg123</application> soportan la conversi&oacute;n
	de MP3 a un formato de fichero no comprimido.</para>

      <para>Escritura a disco desde <application>XMMS</application>:</para>

      <procedure>
	<step>
	  <para>Arranque <application>XMMS</application>.</para>
	</step>

	<step>
	  <para>Bot&oacute;n derecho del ra&oacute;n en la
	    ventana para acceder al men&uacute; de
	    <application>XMMS</application>.</para>
	</step>

	<step>
	  <para>Elija <literal>Preferences</literal> en
	    <literal>Options</literal>.</para>
	</step>

	<step>
	  <para>Cambie el &laquo;Output Plugin&raquo; a &laquo;Disk Writer
	      Plugin&raquo;.</para>
	</step>

	<step>
	  <para>Pulse <literal>Configure</literal>.</para>
	</step>

	<step>
	  <para>Elija un directorio en el que guardar los ficheros
	    descomprimidos.</para>
	</step>

	<step>
	  <para>Cargue el fichero MP3 en <application>XMMS</application>
	    de la forma habitual, pero aseg&uacute;rese de tener el
	    volumen al 100% y las opciones de ecualizaci&oacute;n
	    desactivadas.</para>
	</step>

	<step>
	  <para>Pulse <literal>Play</literal> &mdash;  parecer&aacute;
	    que <application>XMMS</application> est&aacute; reproduciendo
	    m&uacute;sica pero no sonar&aacute; nada.  Lo que est&aacute;
	    haciendo es volcar el MP3 a un fichero.</para>
	</step>

	<step>
	  <para>Recuerde que antes de poder volver a escuchar ficheros
	    MP3 de nuevo tendr&aacute; que devolver el &laquo;Plugin de
	    salida&raquo; por omisi&oacute;n a la posici&oacute;n
	    inicial.</para>
	</step>
      </procedure>

      <para>Escritura de la salida est&aacute;ndar en <application>mpg123</application>:</para>

      <procedure>
	<step>
	  <para>Ejecute <command>mpg123 -s <replaceable>audio01.mp3</replaceable>
	    &gt; <replaceable>audio01.pcm</replaceable></command></para>
	</step>
      </procedure>

      <para><application>XMMS</application> genera un fichero WAV,
	mientras que  <application>mpg123</application> convierte MP3 a
	datos de sonido raw PCM.  Puede usar
	<application>cdrecord</application> con ambos formatos para crear
	CD de sonido.  Tendr&aacute; que usar &man.burncd.8; para raw PCM.  
	Si lo que tiene son ficheros WAV escuchar&aacute; un ligero clic
	al principio de cada pista: se trata de la cabecera del fichero
	WAV.  Puede eliminar esta cabecera mediante
	<application>SoX</application> (que puede instalar como port desde
	<filename role="package">audio/sox</filename> o si lo prefiere como
	package):</para>

      <screen>&prompt.user; <userinput>sox -t wav -r 44100 -s -w -c 2 <replaceable>pista.wav pista.raw</replaceable></userinput></screen>

      <para>Consulte la <xref linkend="creating-cds"> para m&aacute;s
        informaci&oacute;n sobre el uso de grabadoras de CD en
	&os;.</para>
    </sect2>
 </sect1>


 <sect1 id="video-playback">
  <sect1info>
    <authorgroup>
      <author>
        <firstname>Ross</firstname>
	<surname>Lippert</surname>
	<contrib>Contributed by </contrib>
      </author>
    </authorgroup>
    <!-- 5 June 2002 -->
  </sect1info>


  <title>Reproducci&oacute;n de v&iacute;deo</title>

    <para>La reproducci&oacute;n de v&&iacute;deo es un &aacute;rea muy
      nueva y en la que se producen grandes cambios a gran velocidad.  
      Tenga paciencia.  Aqu&iacute; no va a ser todo tan sencillo como al
      configurar el sonido.</para>

    <para>Antes de comenzar es imprescindible que sepa con certeza
      cu&aacute;l es el modelo de su tarjeta gr&aacute;fica y qu&eacute;
      chip usa.  Tanto <application>&xorg;</application> como
      <application>&xfree86;</application> soportan gran cantidad de
      tarjetas gr&aacute;ficas, pero de pocas se puede decir que den
      un buen rendiemiento de reproducci&oacute;n.  Puede consultar una
      lista de extensiones que el servidor X  puede hacer funcionar en
      su tarjeta ejecutando &man.xdpyinfo.1; desde una sesi&oacute;n
      X11.</para>

    <para>Le recomendamos que tenga a mano un fichero MPEG no muy
      grande para usarlo en las pruebas que haga con los diversos
      reproductores y opciones.  Algunos reproductores de DVD
      buscar&aacute;n por omisi&oacute;n soportes DVD en
      <filename>/dev/dvd</filename> (algunos incluso tienen fijado en
      el c&oacute;digo el nombre de dicha unidad) seguramente le
      resultar&aacute; &uacute;til ejecutar los siguientes enlaces
      simb&oacute;licos:</para>

      <screen>&prompt.root; <userinput>ln -sf /dev/acd0 /dev/dvd</userinput>
&prompt.root; <userinput>ln -sf /dev/acd0 /dev/rdvd</userinput></screen>

    <para>Tenga en cuenta que debido al dise&ntilde;o de &man.devfs.5;
      los enlaces creados a mano no sobrevivir&aacute;n a un reinicio
      del sistema.  Para que as&iacute; suceda tras cada reinicio debe
      a&ntilde;adir las siguientes l&iacute;neas a
      <filename>/etc/devfs.conf</filename>:</para>

    <programlisting>link acd0 dvd
link acd0 rdvd</programlisting>

    <para>Adem&aacute;s, el descifrado de DVD (una tarea que har&aacute;
      necesario llamar a funciones especiales de los DVD-ROM)
      requiere permisos de escritura en unidades DVD.</para>

    <para>Le recomendamos que aumente la memoria compartida del
      interfaz X11, para lo cual tendr&aacute; que incremente los
      valores asignados a varias &man.sysctl.8;:</para>

      <programlisting>kern.ipc.shmmax=67108864
kern.ipc.shmall=32768</programlisting>

  <sect2 id="video-interface">
    <title>C&oacute;mo determinar las caracter&iacute;sticas de video</title>

    <indexterm><primary>XVideo</primary></indexterm>
    <indexterm><primary>SDL</primary></indexterm>
    <indexterm><primary>DGA</primary></indexterm>

    <para>Hay varias formas de reproducir v&iacute;deo en X11, pero cu&aacute;l
      de ellas sea la que funcione depende en gran medida del
      hardware que intervenga.  Cada uno de los m&eacute;todos que
      se describen m&aacute;s son mejores o peores seg&uacute;n en
      qu&eacute; hardware se ejecute.  Adem&aacute;s el procesamiento de
      video en X11 es un asunto que est&aacute; recibiendo mucha
      atenci&oacute;n &uacute;ltimamente y en cada nueva versi&oacute;n
      de <application>&xorg;</application> y de
      <application>&xfree86;</application> no es extra&ntilde;o encontrar
      avances significativos.</para>

    <para>Veamos una lista de interfaces de v&iacute;deo muy comunes:</para>

    <orderedlist>
    <listitem>
      <para>X11: salida normal de X11 utilizando memoria compartida.</para>
    </listitem>
    <listitem>
      <para>XVideo: una extensi&oacute;n del interfaz X11 que permite la
        reproducci&oacute;n de v&iacute;deo en las ventanas de X11.</para>
    </listitem>
    <listitem>
      <para>SDL: Simple Directmedia Layer.</para>
    </listitem>
    <listitem>
      <para>DGA: Direct Graphics Access (<literal>acceso directo
        a gr&aacute;ficos</literal>.</para>
    </listitem>
    <listitem>
      <para>SVGAlib: capa de consola de gr&aacute;ficos a bajo nivel.</para>
    </listitem>
    </orderedlist>

    <sect3 id="video-interface-xvideo">
    <title>XVideo</title>

      <para><application>&xorg;</application> y
        <application>&xfree86; 4.X</application> tienen una extensi&oacute;n
        llamada <emphasis>XVideo</emphasis> (tambi&eacute;n conocida como Xvideo,
	Xv o xv) que permite reproducir v&iacute;deo en ventanas del sistema
        X11 a trav&eacute;s de un tipo de aceleraci&oacute;n especial.
	Dicha extensi&oacute;n ofrece una calidad de reproducci&oacute;n
	muy alta incluso en m&aacute;quinas muy cortas de recursos.</para>

      <para>Utilice <command>xvinfo</command> para saber qu&eacute;
        extensi&oacute;n est&aacute; utilizando:</para>

        <screen>&prompt.user; <userinput>xvinfo</userinput></screen>

      <para>XVideo is supported for your card if the result looks like:</para>
<screen>X-Video Extension version 2.2
screen #0
  Adaptor #0: "Savage Streams Engine"
    number of ports: 1
    port base: 43
    operations supported: PutImage 
    supported visuals:
      depth 16, visualID 0x22
      depth 16, visualID 0x23
    number of attributes: 5
      "XV_COLORKEY" (range 0 to 16777215)
              client settable attribute
              client gettable attribute (current value is 2110)
      "XV_BRIGHTNESS" (range -128 to 127)
              client settable attribute
              client gettable attribute (current value is 0)
      "XV_CONTRAST" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 128)
      "XV_SATURATION" (range 0 to 255)
              client settable attribute
              client gettable attribute (current value is 128)
      "XV_HUE" (range -180 to 180)
              client settable attribute
              client gettable attribute (current value is 0)
    maximum XvImage size: 1024 x 1024
    Number of image formats: 7
      id: 0x32595559 (YUY2)
        guid: 59555932-0000-0010-8000-00aa00389b71
        bits per pixel: 16
        number of planes: 1
        type: YUV (packed)
      id: 0x32315659 (YV12)
        guid: 59563132-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x30323449 (I420)
        guid: 49343230-0000-0010-8000-00aa00389b71
        bits per pixel: 12
        number of planes: 3
        type: YUV (planar)
      id: 0x36315652 (RV16)
        guid: 52563135-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)
        depth: 0
        red, green, blue masks: 0x1f, 0x3e0, 0x7c00
      id: 0x35315652 (RV15)
        guid: 52563136-0000-0000-0000-000000000000
        bits per pixel: 16
        number of planes: 1
        type: RGB (packed)
        depth: 0
        red, green, blue masks: 0x1f, 0x7e0, 0xf800
      id: 0x31313259 (Y211)
        guid: 59323131-0000-0010-8000-00aa00389b71
        bits per pixel: 6
        number of planes: 3
        type: YUV (packed)
      id: 0x0
        guid: 00000000-0000-0000-0000-000000000000
        bits per pixel: 0
        number of planes: 0
        type: RGB (packed)
        depth: 1
        red, green, blue masks: 0x0, 0x0, 0x0</screen>

    <para>Tenga en cuenta que los formatos que aparecen en el listado
     (YUV2, YUV12, etc) no aparecen en todas las implementaciones de
     de XVideo y su ausencia puede despistar a algunos
     reproductores.</para>

    <para>Si el resultado se parece mucho a esto</para>
<screen>X-Video Extension version 2.2
screen #0
no adaptors present</screen>

    <para>lo m&aacute;s probable es que su tarjeta no soporte XVideo.</para>

    <para>Si su tarjeta gr&aacute;fica no soporta XVideo lo &uacute;nico
      que significa es que para su sistema ser&aacute; m&aacute;s
      complicado alcanzar los requisitos computacionales necesarios
      para el procesamiento de v&iacute;deo.  Dependiendo de la tarjeta
      gr&aacute;fica y el procesador que tenga es posible que de todos
      modos pueda salvar la papeleta.  Consulte la secci&oacute;n sobre
      recursos avanzados en la <xref
      linkend="video-further-reading">.</para>

    </sect3>

    <sect3 id="video-interface-SDL">
    <title>Simple Directmedia Layer</title>

    <para>SDL (Simple Directmedia Layer) se cre&oacute; pensando en una
      capa que permitiera aplicaciones f&aacute;ciles de portar entre las
      plataformas  &microsoft.windows;, BeOS y &unix; y que permitiera
      al mismo tiempo un uso eficiente del sonido y el v&iacute;deo.  La
      capa SDL ofrece abstracci&oacute;n de hardware a bajo nivel, lo que
      a veces puee ser m&aacute;s eficiente que la propia
      interfaz X11.</para>

    <para>SDL est&aacute; en <filename role="package">devel/sdl12</filename>.</para>

    </sect3>

    <sect3 id="video-interface-DGA">
    <title>Direct Graphics Access</title>

    <para>&laquo;Direct Graphics Access&raquo; es una extensi&oacute;n
      de X11 que permite que un programa sort&eacute;e el servidor X y
      acceda directamente al &laquo;framebuffer&raquo;.  Utiliza memoria
      de bajo nivel, as&iacute; es imprescindible que se ejecute como
      <username>root</username>.</para>

    <para>Puede probar y analizar el rendimiento de la extensi&oacute;n
      DGA con &man.dga.1;.  Al ejecutar <command>dga</command> la pantalla
      cambia de color cada vez que pulsa una tecla.  Para salir de la
      aplicaci&oacute;n pulse <keycap>q</keycap>.</para>

    </sect3>

  </sect2>

  <sect2 id="video-ports">
    <title>Ports y packages relacionados con el v&iacute;deo</title>

    <indexterm><primary>video ports</primary></indexterm>
    <indexterm><primary>video packages</primary></indexterm>

    <para>Esta secci&oacute;n expone el software existente en la
      Colecci&oacute;n de Ports de &os; que puede usar para la
      reproducci&oacute;n de v&iacute;deo.  La reproducci&oacute;n
      de v&iacute;deo es un &aacute;rea del desarrollo de software
      donde hay much&iacute;sima actividad, de manera que las
      caracter&iacute;sticas de m&aacute;s de una de las aplicaciones
      que vamos a describir pueden ser distintas.</para>

    <para>Lo primero que hay que conocer es el importante detalle de
      que la mayor&iacute;a de las aplicaciones de v&iacute;deo
      que funcionan en &os; se desarrollaron para Linux.  Muchas de
      esas aplicaciones todav&iacute;a est&aacute;n en versiones
      beta.  Estos son algunos de los problemas que puede encontrarse
      durante el uso de software de v&iacute;deo en &os;:</para>

      <orderedlist>

      <listitem>
	<para>Una aplicaci&oacute;n no puede reproducir un fichero
	  que ha generado otra aplicaci&oacute;n distinta.</para>
      </listitem> 

      <listitem>
	<para>Una aplicaci&oacute;n no puede reproducir un fichero
	  que ella misma a generado.</para>
      </listitem>

      <listitem>
	<para>La misma aplicaci&oacute;n ejecut&aacute;ndose en dos
	  m&aacute;quinas distintas, compilada en cada una de esas
	  m&aacute;quinas; la reproducci&oacute;n del mismo fichero
	  da resultados diferentes.</para>
      </listitem>

      <listitem>
	<para>El uso de un filtro aparentemente trivial como es
	  redimensionar una imagen aplicando una escala da como fruto un
	  resultado horroroso debido a que la rutina encargada de
	  aplicarla es defectuosa.</para>
      </listitem>

      <listitem>
        <para>Que una aplicaci&oacute;n de volcados de memoria (&laquo;core
	  dumps&raquo;).</para>
      </listitem>

      <listitem>
        <para>La documentaci&oacute;n no se instala con el port, pero
	  s&iacute; que existe en la web o en el directorio
          <filename class='directory'>work</filename> del port.</para>
      </listitem>

      </orderedlist>

    <para>La mayor&iacute;a de estas aplicaciones muestra
      s&iacute;ntomas evidente de &laquo;Linuxismo&raquo;, es decir,
      hay problemas derivados del modo en el que se implementan las
      bibliotecas en las distribuciones de Linux, o del hecho de que
      ciertas caracter&iacute;sticas del kernel de Linux han sido
      dadas por omnipresentes por los autores de las aplicaciones.  Estos
      problemas no siempre han sido advertidas y solucionadas de alg&uacute;n
      modo por los responsables de los ports, lo que puede desembocar
      en problemas como:</para>
       
      <orderedlist>

      <listitem>
        <para>El uso de <filename>/proc/cpuinfo</filename> para detectar
          las caracter&iacute;sticas del procesador.</para>
      </listitem>

      <listitem>
	<para>El uso err&oacute;neo de los hilos puede causar que
	  ciertos programas se cuelguen al intentar cerrarse en lugar
	  de cerrarse correctamente.</para>
      </listitem>

      <listitem>
	<para>Software que a&uacute;n no est&aacute; en la
	  Colecci&oacute;n de Ports de &os; usado frecuentemente con
	  la aplicaci&oacute;n.</para>
      </listitem>

      </orderedlist>

      <para>Hasta ahora los autores de las aplicaciones han colaborado
        de buen grado con los responsables de los ports para hacer
	m&aacute;s sencillo el trabajo de portar estas aplicaciones
	a &os;.</para>

    <sect3 id="video-mplayer">
      <title>MPlayer</title>

      <para><application>MPlayer</application> es un reproductor de
        v&iacute;deo desarrollado muy recientemente y con un desarrollo
	rapid&iacute;simo.  Los objetivos del equipo
        <application>MPlayer</application> son la velocidad y la flexibilidad
	en Linux y otros sistemas Unix.  El proyecto comenz&oacute;
	cuando el fundador del equipo se cans&oacute; de padecer
	el pobre rendimiento de los reproductores de v&iacute;deo
	que hab&iacute;a disponibles en ese momento.  Hay quien dice
	que el interfaz gr&aacute;fico fue sacrificado en pos de
	un dise&ntilde;o m&aacute;s ligero, aunque una vez que
	se acostumbre a las opciones desde la l&iacute;nea de
	&oacute;rdenes y a los atajos de teclado todo ir&aacute;
	como la seda.</para>

      <sect4 id="video-mplayer-building">
        <title>Compilaci&oacute;n de MPlayer</title>
        <indexterm><primary>MPlayer</primary>
	           <secondary>making</secondary></indexterm>

	<para>Encontrar&aacute; <application>MPlayer</application> en <filename
	  role="package">multimedia/mplayer</filename>.  
	  <application>MPlayer</application> ejecuta una serie de
	  pruebas de hardware durante el proceso de compilaci&oacute;n,
	  dando como resultado un binario que no tiene por qu&eacute;
	  funcionar en otros sistemas.  Recuerde, por tanto, compilar
	  la aplicaci&oacute;n como port y no utilice el package
	  binario.  Adem&aacute;s hay m&uacute;ltiples par&aacute;metros
	  que puede pasarle a <command>make</command>, tal y como
	  ver&aacute; al comenzar la compilaci&oacute;n:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/multimedia/mplayer</userinput>
&prompt.root; <userinput>make</userinput>
N - O - T - E

Take a careful look into the Makefile in order
to learn how to tune mplayer towards you personal preferences!
For example,
make WITH_GTK1
builds MPlayer with GTK1-GUI support.
If you want to use the GUI, you can either install
/usr/ports/multimedia/mplayer-skins
or download official skin collections from
http://www.mplayerhq.hu/homepage/dload.html
</screen>

	<para>Las opciones por omisi&oacute;n del port deber&iacute;an
	  bastar para la mayor&iacute;a de los usuarios, aunque si
	  va a necesitar el codec XviD tendr&aacute; que especificar
	  <makevar>WITH_XVID</makevar> en la l&iacute;nea de
	  &oacute;rdenes.  La unidad de DVD por defecto se puede
	  definir con la opci&oacute;n 
	  <makevar>WITH_DVD_DEVICE</makevar>si la opci&oacute;n por omisi&oacute;n,
	  <filename>/dev/acd0</filename>, no le sirve.</para>

        <para>En el momento de escribir esto el port de
	  <application>MPlayer</application> genera la documentaci&oacute;n
	  en formato HTML y dos ejecutables:
          <command>mplayer</command> y
          <command>mencoder</command>, que es una herramienta para
          recodificar v&iacute;deo.</para>

        <para>La documentaci&oacute;n en HTML de
	  <application>MPlayer</application> es muy informativa.  Si el
	  lector no cubre todas sus dudas sobre hardware de v&iacute;deo
	  e interfaces con el contenido de este cap&iacute;tulo la
          documentaci&oacute;n de <application>MPlayer</application>
          es el sitio donde debe buscar.  Si quiere m&aacute;s informaci&oacute;n
	  sobre el soporte de v&iacute;deo en &unix; el mejor sitio para
	  consultar es, sin duda alguna, la documentaci&oacute;n de
          <application>MPlayer</application>.</para>

      </sect4>

      <sect4 id="video-mplayer-using">
        <title>Uso de MPlayer</title>
        <indexterm><primary>MPlayer</primary>
	           <secondary>use</secondary></indexterm>

        <para>Los usuarios de <application>MPlayer</application> deben
          crear un subdirectorio <filename>.mplayer</filename> en su
          &laquo;home&raquo;.  Para crear este directorio (necesario
	  para el funcionamiento de la aplicaci&oacute;n) tecl&eacute;e
	  lo siguiente:</para>

<screen>&prompt.user; <userinput>cd /usr/ports/multimedia/mplayer</userinput>
&prompt.user; <userinput>make install-user</userinput></screen>

	<para>Las opciones de <command>mplayer</command> para la l&iacute;nea
	  de &oacute;rdenes se detallan en la p&aacute;gina de manual.  Si
	  necesita todav&iacute;a m&aacute;s detalles consulte la
	  documentaci&oacute;n en HTML.  En esta secci&oacute;n se
	  va a explicar solamente lo m&aacute;s b&aacute;sico.</para>

	<para>Para reproducir el fichero
	  <filename><replaceable>ficherodeprueba.avi</replaceable></filename>,
	  mediante una de las diversas interfaces de v&iacute;deo utilice la
	  opci&oacute;n <option>-vo</option>:</para>

	  <screen>&prompt.user; <userinput>mplayer -vo xv <replaceable>ficherodeprueba.avi</replaceable></userinput></screen>
	  <screen>&prompt.user; <userinput>mplayer -vo sdl <replaceable>ficherodeprueba.avi</replaceable></userinput></screen>
	  <screen>&prompt.user; <userinput>mplayer -vo x11 <replaceable>ficherodeprueba.avi</replaceable></userinput></screen>
	  <screen>&prompt.root; <userinput>mplayer -vo dga <replaceable>ficherodeprueba.avi</replaceable></userinput></screen>
	  <screen>&prompt.root; <userinput>mplayer -vo 'sdl:dga' <replaceable>ficherodeprueba.avi</replaceable></userinput></screen>

	<para>Merece la pena que pruebe todas, puesto que el rendimiento
	  relativo depende en gran medida de muchos factores y ser&aacute;
	  muy distinto el resultado dependiendo del hardware.</para>

	<para>Si quiere reproducir un DVD sustituya
	 <filename><replaceable>ficherodeprueba.avi</replaceable></filename> por <option>dvd://<replaceable>N</replaceable> -dvd-device
	 <replaceable>DISPOSITIVO</replaceable></option>, donde
	 <replaceable>N</replaceable> es
	 el n&uacute;mero de t&iacute;tulo que quiere reproducir y
	 <filename><replaceable>DISPOSITIVO</replaceable></filename> es el
	 nodo de dispositivo del DVD-ROM.  Veamos un ejemplo: para reproducir el
	 t&iacute;tulo 3 desde <filename>/dev/dvd</filename>
	 ejecutaremos:</para>

	<screen>&prompt.root; <userinput>mplayer -vo xv dvd://3 -dvd-device /dev/dvd</userinput></screen>

	<note>
	  <para>La unidad de DVD por omisi&oacute;n puede definirse
	    durante la compilaci&oacute;n del port de
	    <application>MPlayer</application> con la opci&oacute;n
	    <makevar>WITH_DVD_DEVICE</makevar>.  Por defecto apunta a
	    <filename>/dev/acd0</filename>.  Tiene todos los
	    detalles en el
	    <filename>Makefile</filename> del port.</para>
	</note>

	<para>Consulte los atajos de teclado para parar la
	  reproducci&oacute;n, ponerla en pausa, etc. consulte la
	  salida de <command>mplayer -h</command> o mejor a&uacute;n
	  l&eacute;se la p&aacute;gina de manual.</para>

	<para>Hay otras opciones que le resultar&aacute;n de inter&eacute;s
	  para la reproducci&oacute;n: 
          <option>-fs -zoom</option>, para la reproducci&oacute;n a pantalla
          completa y <option>-framedrop</option>, que mejora el
	  rendimiento.</para>

	<para>Para evitar que la l&iacute;nea de &oacute;rdenes se
	  haga demasiado larga puede crear un fichero 
	  <filename>.mplayer/config</filename> e introducir en &eacute;l
	  las opciones que quiera usar desde el arranque de la
	  aplicaci&oacute;n:</para>
<programlisting>vo=xv
fs=yes
zoom=yes</programlisting>

	<para>Para terminar, puede usar <command>mplayer</command>
	  para extraer un t&iacute;tulo de un DVD a un fichero
	  <filename>.vob</filename>.  Por ejemplo, si quiere extraer
	  el segundo t&iacute;tulo de un DVD escriba esto:</para>

	  <screen>&prompt.root; <userinput>mplayer -dumpstream -dumpfile salida.vob dvd://2 -dvd-device /dev/dvd</userinput></screen>

        <para>El fichero de salida, <filename>salida.vob</filename>,
	  un MPEG y puede manipularlo con las aplicaciones que se
	  describen en esta secci&oacute;n.</para>

      </sect4>
      <sect4 id="video-mencoder">
        <title>mencoder</title>
        <indexterm>
	  <primary>mencoder</primary>
	</indexterm>

	<para>Antes de empezar a usar
         <command>mencoder</command> le recomendamos que se familiarice
	 con las opciones que se detallan en la documentaci&oacute;n 
	 HTML.  Hay tambi&eacute;n una p&aacute;gina de manual, pero no
	 es de mucha utilidad sin la documentaci&oacute;n HTML.  Hay una
	 ingente cantidad de formas de mejorar la calidad, reducir el
	 ratio de bits y cambiar formatos; alguno de esos peque&ntilde;os
	 trucos pueden marcar la diferencia entre un buen y un mal
	 rendimiento.  Le mostramos un par de ejemplos por los que
	 puede empezar.  El primero es una simple copia:</para>

	 <screen>&prompt.user; <userinput>mencoder <replaceable>entrada.avi</replaceable> -oac copy -ovc copy -o <replaceable>salida.avi</replaceable></userinput></screen>

         <para>Ciertas combinaciones err&oacute;neas de opciones en la
	 l&iacute;nea de &oacute;rdenes pueden dar como fruto un fichero
	 de salida que no puede reproducir ni siquiera el propio
	 <command>mplayer</command>, as&iacute; que si lo que quiere es
	 extraer datos a un fichero siga usando tranquilamente la opci&oacute;n
	 <option>-dumpfile</option> de
	 <command>mplayer</command>.</para>

	 <para>Para convertir
	 <filename><replaceable>entrada.avi</replaceable></filename> con
	 codificaci&oacute;n MPEG4 y audio con codificaci&oacute;n MPEG3
	 (necesitar&aacute; <filename role="package">audio/lame</filename>):</para>

	 <screen>&prompt.user; <userinput>mencoder <replaceable>entrada.avi</replaceable> -oac mp3lame -lameopts br=192 \
	 -ovc lavc -lavcopts vcodec=mpeg4:vhq -o <replaceable>salida.avi</replaceable></userinput></screen>

	 <para>El fichero de salida puede verse con <command>mplayer</command>
	 y con <command>xine</command>.</para>

	 <para>Si sustituye
	   <filename><replaceable>entrada.avi</replaceable></filename>
	   por <option>dvd://1 -dvd-device /dev/dvd</option> y lo ejecuta
	   como <username>root</username> puede recodificar un t&iacute;tulo
	   de DVD directamente.  Es posible que el resultado no sea
	   muy satisfactorio tras los primeros intentos, as&iacute; que
	   le recomendamos que vuelque el t&iacute;tulo a un fichero
	   y haga todas las pruebas que necesite sobre ese fichero.</para>
      </sect4>

    </sect3>

    <sect3 id="video-xine">
    <title>El reproductor de v&iacute;deo xine</title>

    <para>El reproductor de v&iacute;deo
      <application>xine</application> es un ambicioso proyecto que
      tiene como meta ofrecer no solamente una aplicaci&oacute;n de
      v&iacute;deo &laquo;todo en uno&raquo;, sino crear una
      biblioteca base reutilizable y un ejecutable modular que
      puede ampliarse mediante &laquo;plugins&raquo;.  Existe como
      package y tambi&eacute;n como port: <filename
     role="package">multimedia/xine</filename>.</para>

    <para>El reproductor <application>xine</application> est&aacute;
     todav&iacute;a en mantillas, pero sus primeros pasos est&aacute;n
     siendo muy interesantes.  <application>xine</application> requiere
     o una CPU r&aacute;pida o una tarjeta gr&aacute;fica, o bien
     soporte para la extensi&oacute;n XVideo.  El GUI es intuitivo, aunque
     un tanto pedestre.</para>

    <para>En el momento de escribir esto
     <application>xine</application> no incorpora ning&uacute;n
     m&oacute;dulo de entrada que sirva para reproducir DVD codificados
     con CSS.  Hay versiones compiladas por terceros que tienen m&oacute;dulos
     que lo permiten, pero ninguna de ellas est&aacute; en la
     Colecci&oacute;n de Ports de &os;.</para>

    <para>Comparado con <application>MPlayer</application>
      <application>xine</application> deja las cosas m&aacute;s hechas
      para el usuario, pero al mismo tiempo pone m&aacute;s dif&iacute;cil
      el control exhaustivo sobre todo lo que pasa.  El reproductor
      <application>xine</application> da un mejor rendimiento
      en interfaces XVideo.</para>
     
    <para>Por omisi&oacute;n <application>xine</application> arranca
      con un intefaz gr&aacute;fico de usuario.  Los men&uacute;s
      pueden usarse para abrir un fichero en concreto:</para>

      <screen>&prompt.user; <userinput>xine</userinput></screen>

    <para>Tambi&eacute;n puede invocar la aplicaci&oacute;n desde la
      l&iacute;nea de &oacute;rdenes para que reproduzca un fichero
      inmediatamente y sin utilizar el GUI:</para>

      <screen>&prompt.user; <userinput>xine -g -p <replaceable>fichero.avi</replaceable></userinput></screen>

    </sect3>

    <sect3 id="video-ports-transcode">
    <title>Las herramientas transcode</title>

    <para><application>transcode</application> no es un reproductor,
      sino una suite de herramientas para recodificar (tambi&eacute;n
      se podr&iacute;a usar la palabra &laquo;transcodificar&raquo;, de
      ah&iacute; su nombre) ficheros de sonido y de v&iacute;deo.  
      Con <application>transcode</application> es posible fundir ficheros
      de video y reparar ficheros deteriorados desde la l&iacute;nea de
      &oacute;rdenes y en las interfaces de flujo
      <filename>stdin/stdout</filename>.</para>

    <para>Puede configurar gran cantidad de opciones en el
      momento de la compilaci&oacute;n de <filename
      role="package">multimedia/transcode</filename>; le
      recomendamos que use la siguiente l&iacute;nea de
      &oacute;rdenes para compilar
      <application>transcode</application>:</para>

    <screen>&prompt.root; <userinput>make WITH_OPTIMIZED_CFLAGS=yes WITH_LIBA52=yes WITH_LAME=yes WITH_OGG=yes \
WITH_MJPEG=yes -DWITH_XVID=yes</userinput></screen>

    <para>La configuraci&oacute;n que le proponemos deber&iacute;
      satisfacer a la mayor&iacute;a de los usuarios.</para>

    <para>Veamos un ejemplo ilustrativo de las posibilidades de
      <command>transcode</command>: convertir un fichero DivX
      en un fichero PAL MPEG-1 (PAL VCD):</para>

      <screen>&prompt.user; <userinput>transcode -i <replaceable>input.avi</replaceable> -V --export_prof vcd-pal -o output_vcd</userinput>
&prompt.user; <userinput>mplex -f 1 -o <replaceable>output_vcd.mpg output_vcd.m1v output_vcd.mpa</replaceable></userinput></screen>

    <para>Puede reproducir el fichero MPEG resultante,
      <filename><replaceable>output_vcd.mpg</replaceable></filename>,
      con <application>MPlayer</application>.  Si quiere tambi&eacute;n
      puede grabar el fichero en un CD-R y tendr&aacute; un VideoCD, 
      aunque para eso tendr&aacute; que instalar <filename
      role="package">multimedia/vcdimager</filename> y <filename
      role="package">sysutils/cdrdao</filename>.</para>

    <para>Consulte la p&aacute;gina de manual de <command>transcode</command>,
      pero no olvide consultar tambi&eacute;n el <ulink
      url="http://www.transcoding.org/cgi-bin/transcode">wiki de
      transcode</ulink>, en el que encontrar&aacute;
      m&aacute;s informaci&oacute;n y muchos ejemplos.</para>
    </sect3>

  </sect2>

  <sect2 id="video-further-reading">
    <title>Lecturas adicionales</title>

    <para>El desarrollo de las diversas aplicaciones de
      v&iacute;deo disponibles en &os; avanza
      r&aacute;pidamente.  Es muy posible que en un futuro
      cercano la mayor&iacute;a de los problemas de los que
      hemos hablado aqu&iacute; hayan sido resueltos.  Mientras
      tanto quien quiera exprimir las capacidades de &os; en
      las &aacute;reas del sonido y el v&iacute;deo tendr&aacute;n
      que recopilar la informaci&oacute;n repartida en varias
      FAQ y tutoriales y utilizar unos cuantos programas
      diferentes.  En esta secci&oacute;n se le proponen al
      lector interesado varias fuentes de informaci&oacute;n
      adicional.</para>

    <para>La
      <ulink url="http://www.mplayerhq.hu/DOCS/">documentaci&oacute;n
      de MPlayer</ulink> contiene una gran cantidad de informaci&oacute;n
      t&eacute;cnica.  Cualquiera que quiera alcanzar un alto grado
      de conocimiento en v&iacute;deo sobre &unix; debe consultar
      esa documentaci&oacute;n.  La lista de correo de
      <application>MPlayer</application> es sumamente hostil hacia
      quien no se ha molestado en leer la documentaci&oacute;n 
      <emphasis>antes</emphasis> de preguntar, as&iacute; que si
      va a enviar informes de errores a esa lista, por favor,
      <emphasis>l&eacute;ase la documentaci&oacute;n.</emphasis>.</para>

    <para>El texto
      <ulink url="http://dvd.sourceforge.net/xine-howto/en_GB/html/howto.html">      xine HOWTO</ulink>
      contiene un cap&iacute;tulo sobre mejora del rendimiento que
      afecta a todos los reproductores.</para>

    <para>Hay unas cuantas aplicaciones muy prometedoras que el lector
      deber&iacute;a al menos probar:</para>

    <itemizedlist>

       <listitem>
         <para><ulink
	   url="http://avifile.sourceforge.net/">Avifile</ulink>, que
	   encontrar&aacute; en los ports:<filename
	   role='package'>multimedia/avifile</filename>.</para>
       </listitem>

       <listitem>
         <para><ulink
	   url="http://www.dtek.chalmers.se/groups/dvd/">Ogle</ulink>,
	   tambi&eacute;n en la colecci&oacute;n de  ports: <filename
	   role='package'>multimedia/ogle</filename>.</para>
       </listitem>

       <listitem>
         <para><ulink url="http://xtheater.sourceforge.net/">Xtheater</ulink></para>
       </listitem>

	<listitem>
         <para><filename
           role="package">multimedia/dvdauthor</filename>, una aplicaci&oacute;n
           libre para la producci&oacute;n de contenidos en DVD.</para>
        </listitem>
    </itemizedlist>

  </sect2>
 </sect1>


  <sect1 id="tvcard">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Josef</firstname>
	  <surname>El-Rayes</surname>
	  <contrib>Texto original de </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <firstname>Marc</firstname>
	  <surname>Fonvieille</surname>
	  <contrib>Ampliado y adaptado por </contrib>
	  <!-- 02 January 2004 -->
	</author>
      </authorgroup>
    </sect1info>

    <title>Configuraci&oacute;n de tarjetas de TV</title>
    <indexterm>
      <primary>TV cards</primary>
    </indexterm>

    <sect2>
      <title>Introducci&oacute;n</title>

      <para>Las tarjetas de TV le permiten ver en su sistema
        emisiones de TV tradicionales o incluso por cable.  La
	mayor&iacute;a aceptan v&iacute;deo compuesto mediante
	RCA o una entrada de S-video; algunas de estas tarjetas
	incorporan tambi&eacute;n un sintonizador de radio FM.</para>

      <para>&os; puede utilizar tarjetas de TV PCI que tengan el chip
	Brooktree Bt848/849/878/879 o el chip de captura de v&iacute;deo
	Conexant CN-878/Fusion 878a gracias al controlador
	&man.bktr.4;.  Aseg&uacute;rese de que la tarjeta tiene un
	sintonizador que est&eacute; soportado: consulte la lista de
	sintonizadores soportados que encontrar&aacute; en la p&aacute;gina
	de manual de &man.bktr.4;.</para>
    </sect2>

    <sect2>
      <title>A&ntilde;adir el controlador</title>

      <para>Poder usar la tarjeta tendr&aacute; que cargar el
        controlador &man.bktr.4;.  Una forma de hacerlo es
	a&ntilde;dir la siguiente l&iacute;nea al fichero
	<filename>/boot/loader.conf</filename>:</para>

      <programlisting>bktr_load="YES"</programlisting>

      <para>Tambi&eacute;n puede hacerlo compilando est&aacute;ticamente
        el soporte para la tarjeta de TV en su kernel;  a&ntilde;ada
	las siguientes l&iacute;neas al fichero de configuraci&oacute;n
	de su kernel:</para>
	
      <programlisting>device	 bktr
device	iicbus
device	iicbb
device	smbus</programlisting>

      <para>Es necesario incluir todas esas lineas adicionales porque
        los componentes de la tarjeta est&aacute;n conectados entre
	s&iacute; por un bus I2C.  Hecho esto compile e instale su
	nuevo kernel.</para>

      <para>Una vez a&ntilde;adido el soporte de la tarjeta al sistema
        tendr&aacute; que reiniciar.  Durante el arranque deber&iacute;an
	aparecer rastros de su tarjeta de TV. Veamos un ejemplo:</para>

      <programlisting>bktr0: &lt;BrookTree 848A&gt; mem 0xd7000000-0xd7000fff irq 10 at device 10.0 on pci0
iicbb0: &lt;I2C bit-banging driver&gt; on bti2c0
iicbus0: &lt;Philips I2C bus&gt; on iicbb0 master-only
iicbus1: &lt;Philips I2C bus&gt; on iicbb0 master-only
smbus0: &lt;System Management Bus&gt; on bti2c0
bktr0: Pinnacle/Miro TV, Philips SECAM tuner.</programlisting>

      <para>Es obvio que estos mensajes ser&aacute;n distintos
        seg&uacute;n sea el hardware del que se trate.  
	Aseg&uacute;rese de que el sistema detecta correctamente
	el sintonizador.  Se puede sobreescribir alguno de los
	par&aacute;metros detectados por el sistema mediante
	MIB &man.sysctl.8; y opciones del fichero de configuraci&oacute;n
	del kernel.  Si por ejemplo quiere obligar al sintonizador
	para que se comporte como un Phillips SECAM a&ntilde;ada
	lo siguiente al fichero de configuraci&oacute;n de su
	kernel:</para>

      <programlisting>options OVERRIDE_TUNER=6</programlisting>

      <para>Puede utilizar directamente &man.sysctl.8;:</para>

      <screen>&prompt.root; <userinput>sysctl hw.bt848.tuner=6</userinput></screen>

      <para>Consulte en &man.bktr.4; y en
	<filename>/usr/src/sys/conf/NOTES</filename> si necesita
	m&aacute;s detalles sobre las opciones disponibles.</para>
    </sect2>

    <sect2>
      <title>Aplicaciones &uacute;tiles</title>

      <para>Tendr&aacute; que instalar una de estas aplicaciones
        para poder utilizar su tarjeta de TV:</para>

      <itemizedlist>
	<listitem>
	  <para><filename role="package">multimedia/fxtv</filename>
	    ofrece &laquo;TV en una ventana&raquo; y captura de
	    imagen/sonido/v&iacute;deo.</para>
	</listitem>
	<listitem>
	  <para><filename role="package">multimedia/xawtv</filename>:
	    otra aplicaci&oacute;n de TV; ofrece lo mismo que
	    <application>fxtv</application>.</para>
	</listitem>
	<listitem>
	  <para><filename role="package">misc/alevt</filename> decodifica
	    y reproduce videotexto y teletexto.</para>
	</listitem>
	<listitem>
	  <para><filename role="package">audio/xmradio</filename> permite
	    utilizar el sintonizador de radio FM que incorporan algunas
	    tarjetas de TV.</para>
	</listitem>
	<listitem>
	  <para><filename role="package">audio/wmtune</filename>, una
	    aplicaci&oacute;n de escritorio muy &uacute;til para
	    el uso de sintonizadores de radio.</para>
	</listitem>
      </itemizedlist>

      <para>Hay m&aacute;s aplicaciones &uacute;tiles en la Colecci&oacute;n de
        de Ports de &os;.</para>
    </sect2>

    <sect2>
      <title>Soluci&oacute;n de problemas</title>

      <para>Si tiene alg&uacute;n problema con su tarjeta de TV compruebe
        en primer lugar que el chip de captura de v&iacute;deo y el
	sintonizador realmente funcionan con el controlador 
	&man.bktr.4; y si ha utilizado las opciones de configuraci&oacute;n
	m&aacute;s adecuadas.  Si necesita m&aacute;s ayuda o necesita
	respuestas sobre su tarjeta de TV puede recurrir a la lista
	de correo &a.multimedia.name;.</para>
    </sect2>
  </sect1>


  <sect1 id="scanners">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Marc</firstname>
	  <surname>Fonvieille</surname>
	  <contrib>Escrito por </contrib>
	  <!-- 04 August 2004 -->
	</author>
      </authorgroup>
    </sect1info>

    <title>Esc&aacute;neres de im&aacute;genes</title>
    <indexterm>
      <primary>image scanners</primary>
    </indexterm>

    <sect2>
      <title>Introducci&oacute;n</title>

      <para>El acceso a esc&aacute;neres de im&aacute;genes en &os;
        funciona gracias a la  <acronym role="Application Programming
	Interface">API</acronym>
	<application>SANE</application> (siglas de &laquo;Scanner Access Now
	Easy&raquo;, &laquo;el acceso a esc&aacute;neres ahora es
	f&aacute;cil&raquo;), disponible en la Colecci&oacute;n de Ports
	de &os;.  <application>SANE</application> utiliza tambi&eacute;n
	ciertos controladores de &os; para acceder al hardware del
	esc&aacute;ner.</para>

      <para>&os; puede utilizar tanto esc&aacute;neres SCSI como USB.  
        Aseg&uacute;rese de que el suyo funciona con
	<application>SANE</application> antes de intentar ning&uacute;n
	tipo de configuraci&oacute;n.  <application>SANE</application>
	tiene una lista de <ulink
	url="http://www.sane-project.org/sane-supported-devices.html">dispositivos
	soportados</ulink> donde encontrar&aacute; informaci&oacute;n
	actualizada sobre hasta d&oacute;nde funciona el esc&aacute;ner
	y su estatus.  La p&aacute;gina de manual de &man.uscanner.4;
	incluye una listas de esc&aacute;neres USB que funcionan con
	<application>SANE</application>.</para>
    </sect2>

    <sect2>
      <title>Configuraci&oacute;n del kernel</title>

      <para>Como ya se ha dicho tanto los interfaces USB como las
         SCSI funcionan.  Seg&uacute;n sea el interfaz de su
	 esc&aacute;ner necesitar&aacute; un tipo diferente de
	 controlador:</para>

      <sect3 id="scanners-kernel-usb">
	<title>Interfaz USB</title>

	<para>El kernel <filename>GENERIC</filename> incluye por
	  omisi&oacute;n los controladores de dispositivo necesarios
	  para poder usar esc&aacute;neres USB.  Si va a personalizar
	  su kernel aseg&uacute;rese de que esto est&aacute; en el
	  fichero de configuraci&oacute;n del mismo:</para>

	<programlisting>device usb
device uhci
device ohci
device uscanner</programlisting>

	<para>Seg&uacute;n cual sea el chipset de su placa base
	  tendr&aacute; que usar <literal>device uhci</literal> o
	  <literal>device ohci</literal>, aunque si tiene ambos
	  no tendr&aacute; problemas por eso.</para>

	<para>Si por cualquier motivo no quiere recompilar su
	  kernel y su kernel no es el
	  <filename>GENERIC</filename> puede cargar el m&oacute;dulo
	  controlador de dispositivo &man.uscanner.4; con
	  &man.kldload.8;:</para>

	<screen>&prompt.root; <userinput>kldload uscanner</userinput></screen>

	<para>Si quiere cargar este m&oacute;dulo cada vez que arranque
	  el sistema debe a&ntilde;adir la siguiente
	  l&iacute;nea a
	  <filename>/boot/loader.conf</filename>:</para>

	<programlisting>uscanner_load="YES"</programlisting>

	<para>Tras reiniciar con el kernel correcto (o una vez
	  que el m&oacute;dulo est&eacute; cargado) conecte su
	  esc&aacute;ner USB.  Debe aparecer en el &laquo;buffer&raquo;
	  de mensajes del sistema (&man.dmesg.8;) un mensaje una
	  l&iacute;nea como la siguiente:</para>

	<screen>uscanner0: EPSON EPSON Scanner, rev 1.10/3.02, addr 2</screen>

	<para>La l&iacute;nea del ejemplo muestra que nuestro
	  esc&aacute;ner est&aacute; utilizando el nodo de
	  dispositivo<filename>/dev/uscanner0</filename>.</para>
      </sect3>

      <sect3>
	<title>Interfaz SCSI</title>

	<para>Si su esc&aacute;ner tiene un interfaz SCSI es importante
	  saber qu&eacute; controladora SCSI incorpora.  
	  El chipset SCSI que tenga influir&aacute; en la
	  configuraci&oacute;n del kernel que tenga que
	  personalizar.  El kernel <filename>GENERIC</filename>
	  tiene controladores de dispositivo para las controladoras
	  SCSI m&aacute;s comunes.  Consulte el fichero
	  <filename>NOTES</filename> y a&ntilde;ada la
	  l&iacute;nea correcta al fichero de configuraci&oacute;n
	  de su kernel.  Tendr&aacute; que a&ntilde;adir
	  tambi&eacute;n la siguiente l&iacute;nea:</para>

	<programlisting>device scbus
device pass</programlisting>

	<para>Una vez compilado e instalado el kernel correctamente
	  tiene ya que ver sus nuevos dispositivos en el
	  &laquo;buffer&raquo; de mensajes del sistema:</para>

	<screen>pass2 at aic0 bus 0 target 2 lun 0
pass2: &lt;AGFA SNAPSCAN 600 1.10&gt; Fixed Scanner SCSI-2 device
pass2: 3.300MB/s transfers</screen>

	<para>Si su esc&aacute;ner estaba apagado durante el arranque
	  puede forzar manualmente la detecci&oacute;n si ejecuta una
	  b&uacute;squeda de buses SCSI con &man.camcontrol.8;:</para>

	<screen>&prompt.root; <userinput>camcontrol rescan all</userinput>
Re-scan of bus 0 was successful
Re-scan of bus 1 was successful
Re-scan of bus 2 was successful
Re-scan of bus 3 was successful</screen>

	<para>El esc&aacute;ner aparecer&aacute; en la lista de
	  dispositivos SCSI:</para>

	<screen>&prompt.root; <userinput>camcontrol devlist</userinput>
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 5 lun 0 (pass0,da0)
&lt;IBM DDRS-34560 S97B&gt;              at scbus0 target 6 lun 0 (pass1,da1)
&lt;AGFA SNAPSCAN 600 1.10&gt;           at scbus1 target 2 lun 0 (pass3)
&lt;PHILIPS CDD3610 CD-R/RW 1.00&gt;     at scbus2 target 0 lun 0 (pass2,cd0)</screen>

	<para>Tiene todos los detalles sobre los dispositivos
	  SCSI en las p&aacute;ginas de manual de
	  &man.scsi.4; y &man.camcontrol.8;.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Configuraci&oacute;n de SANE</title>

      <para>El sistema <application>SANE</application> se divide
	en dos partes: los &laquo;backends&raquo; (<filename
	role="package">graphics/sane-backends</filename>) y los
	&laquo;frontends&raquo; (<filename
	role="package">graphics/sane-frontends</filename>).  Los
	 &laquo;backends&raquo; facilitan el acceso al esc&aacute;ner
	 propiamente dicho.  La
	<ulink
	url="http://www.sane-project.org/sane-supported-devices.html">lista
	de dispositivos que funcionan con </ulink>
	<application>SANE</application> le dir&aacute; qu&eacute;
	&laquo;backend&raquo; har&aacute; funcionar su esc&aacute;ner
	de im&aacute;genes.  No hay m&aacute;s remedio que identificar
	correctamente el &laquo;backend&raquo; de su esc&aacute;ner
	para poder usarlo.  Los &laquo;frontends&raquo; ofrecen
	una interfaz gr&aacute;fica para escanear
	(<application>xscanimage</application>).</para>

      <para>Lo primero que hay que hacer es instalar el port
        o package de <filename
	role="package">graphics/sane-backends</filename>.  Despu&eacute;s
	ejecute la orden <command>sane-find-scanner</command>
	para comprobar el funcionamiento de la detecci&oacute;n
	de esc&aacute;neres del sistema
	<application>SANE</application>:</para>

      <screen>&prompt.root; <userinput>sane-find-scanner -q</userinput>
found SCSI scanner "AGFA SNAPSCAN 600 1.10" at /dev/pass3</screen>

      <para>En la salida de la orden anterior se le mostrar&aacute;
        el tipo de interfaz del esc&aacute;ner y el nodo de dispositivo
	a trav&eacute;s del cual el sistema accede a &eacute;l.  Es
	posible que no aparezcan la marca y el modelo, pero eso no
	tiene importancia.</para>

      <note>
	<para>Algunos esc&aacute;neres USB necesitan que les instale un
	  &laquo;firmware&raquo;; esto se explica en la p&aacute;gina
	  de manual del &laquo;backend&raquo; correspondiente.  Tambi&eacute;n
	  debe leer las p&aacute;ginas de manual &man.sane-find-scanner.1;
	  y &man.sane.7;.</para>
      </note>

      <para>Ahora hay que comprobar que el &laquo;frontend&raquo; de
        escaneo puede identificar el esc&aacute;ner.  Por omisi&oacute;n
	los &laquo;backends&raquo; de
	<application>SANE</application> incorporan una herramienta de
	l&iacute;nea de &oacute;rdenes llamada &man.scanimage.1;, que
	le mostrar&aacute; una lista de dispositivos e incluso una
	captura de imagen desde la shell.  La opci&oacute;n
	<option>-L</option> muestra una lista de esc&aacute;ners:</para>

      <screen>&prompt.root; <userinput>scanimage -L</userinput>
device `snapscan:/dev/pass3' is a AGFA SNAPSCAN 600 flatbed scanner</screen>

      <para>Si el software no lanza ning&uacute;n mensaje, o si
        el mensaje indica que no se han encontrado esc&aacute;neres
	significa que &man.scanimage.1; no puede identificar su
	esc&aacute;ner.  Si este es el caso tendr&aacute; que
	editar el fichero de configuraci&oacute;n del
	&laquo;backend&raquo;y definir en &eacute;l el
	esc&aacute;ner que quiera utilizar.  Encontrar&aacute;
	todos los ficheros de configuraci&oacute;n de los
	&laquo;backends&raquo; en el directorio <filename
	class="directory">/usr/local/etc/sane.d/</filename>.  Este
	problema con la identificaci&oacute;n del hardware
	es relativamente frecuente con ciertos modelos de
	esc&aacute;neres USB.</para>

      <para>Por ejemplo, con el esc&aacute;ner que hemos usado en
        la <xref
	linkend="scanners-kernel-usb"> la orden
	<command>sane-find-scanner</command> nos da la siguiente
	informaci&oacute;n:</para>

      <screen>&prompt.root; <userinput>sane-find-scanner -q</userinput>
found USB scanner (UNKNOWN vendor and product) at device /dev/uscanner0</screen>

      <para>El esc&aacute;ner ha sido detectado sin problemas, utiliza el
        interfaz USB y est&aacute; conectado al nodo de dispositivo
	<filename>/dev/uscanner0</filename> .  Ahora comprobaremos
	que podemos identificar correctamente el esc&aacute;ner:</para>

      <screen>&prompt.root; <userinput>scanimage -L</userinput>

No scanners were identified. If you were expecting something different,
check that the scanner is plugged in, turned on and detected by the
sane-find-scanner tool (if appropriate). Please read the documentation
which came with this software (README, FAQ, manpages).</screen>

      <para>No hemos podido identificar el esc&aacute;ner, as&iacute;
        que hemos de editar el fichero
	<filename>/usr/local/etc/sane.d/epson.conf</filename>.  Estamos
	usando el modelo de esc&aacute;ner &epson.perfection; 1650,
	as&iacute; que ya sabemos que el esc&aacute;ner utilizar&aacute;
	el &laquo;backend&raquo; <literal>epson</literal>.  Lea
	atentamente los comentarios que hay en los ficheros de
	configuraci&oacute;n de los &laquo;backends&raquo;.  Lo que
	hay que hacer es muy sencillo: basta con comentar las
	l&iacute;neas en las que aparecen interfaces que no sean el
	perfecto para su esc&aacute;ner.  En nuestro caso comentaremos
	todas las l&iacute;neas que comiencen por
	<literal>scsi</literal> puesto que nuestro esc&aacute;ner
	tiene interfaz USB.  Despu&eacute;s de esto hay que
	a&ntilde;adir una l&iacute;na al final del fichero declarando
	el interfaz y el nodo de dispositivo que se van a usar.  En
	el caso del ejemplo esto es lo que a&ntilde;adimos:</para>

      <programlisting>usb /dev/uscanner0</programlisting>

      <para>Por favor, lea los comentarios que encontrar&aacute;
        en el fichero de configuraci&oacute;n del &laquo;backend&raquo;
	y la p&aacute;ngina de manual de del &laquo;backend&raquo;
	si necesita m&aacute;s informaci&oacute;n sobre la
	sintaxis que debe usar.  Hecho esto podemos verificar si
	ya podemos identificar el esc&aacute;ner:</para>

      <screen>&prompt.root; <userinput>scanimage -L</userinput>
device `epson:/dev/uscanner0' is a Epson GT-8200 flatbed scanner</screen>

      <para>Hemos identificado nuestro esc&aacute;ner USB.  Ni tiene
        importancia si la marca y modelo que hemos visto no coinciden
	con nuestro esc&aacute;ner.  Lo &uacute;nico realmente
	importante es el campo
	<literal>`epson:/dev/uscanner0'</literal>, que nos da
	el nombre correcto del &laquo;backend&raquo; y el
	nodo de dispositivo correcto.</para>

      <para>Una vez que <command>scanimage -L</command> llega a ver
        al esc&aacute;ner hemos terminado con la configuraci&oacute;n.  
	El dispositivo est&aacute; listo para escanear
	im&aacute;ngenes.</para>

      <para>&man.scanimage.1; permite ejecutar una captura de
        im&aacute;gen desde la l&iacute;nea de &oacute;rdenes,
	pero siempre es mejor utilizar un interfaz gr&aacute;fico de
	usuario para estas tareas.  
	<application>SANE</application> ofrece un interfaz
	gr&aacute;fico simple pero eficiente:
	<application>xscanimage</application>
	(<filename
	role="package">graphics/sane-frontends</filename>).</para>

      <para>Otro &laquo;frontend&raquo; gr&aacute;fico para
        escanear que se ha hecho muy popular es
	<application>Xsane</application> (<filename
	role="package">graphics/xsane</filename>).  Este
	&laquo;frontend&raquo; tiene caracter&iacute;sticas muy
	avanzadas como varios modos de escaneo (fotocopia, fax, etc.),
	correcci&oacute;n de color, escaneo de im&aacute;genes por
	lotes, etc.  Ambas aplicaciones pueden utilizarse adem&aacute;s
	como &laquo;plugins&raquo; de
	<application>GIMP</application>.</para>
    </sect2>

    <sect2>
      <title>Dar acceso al esc&aacute;ner a otros usuarios</title>

      <para>Todo lo que se ha mostrado en esta secci&oacute;n
        se ha ejecutado con privilegios de
	<username>root</username>.  Lo normal es que haya otros usuarios
	que tengan que tener acceso al esc&aacute;ner.  Un usuario
	que quiera usar el esc&aacute;ner tiene que tener acceso
	de lectura y escritura al nodo de dispositivo que usa
	el esc&aacute;ner.  Por ejemplo, nuestro esc&aacute;ner
	USB utiliza el nodo de dispositivo
	<filename>/dev/uscanner0</filename> propiedad del grupo
	<groupname>operator</groupname>.  Al a&ntilde;adir al usuario
	<username><replaceable>joe</replaceable></username> al
	grupo <groupname>operator</groupname> &eacute;ste podr&aacute;
	acceder al esc&acute;ner:</para>

      <screen>&prompt.root; <userinput>pw groupmod operator -m <replaceable>joe</replaceable></userinput></screen>

      <para>Para m&aacute;s informaci&oacute;n sobre el uso de
        &man.pw.8; lea su p&aacute;gina de manual.  Tendr&aacute;
	tambi&eacute;n que configurar correctamente los permisos de
	escritura (0660 o 0664) en el nodo de dispositivo
	<filename>/dev/uscanner0</filename>; por omisi&oacute;n los
	miembros del grupo <groupname>operator</groupname> s&oacute;lo
	tienen acceso de lectura en este nodo de dispositivo.  
	A&ntilde;ada las siguientes l&iacute;neas al fichero
	lines to the <filename>/etc/devfs.rules</filename>:</para>

      <programlisting>[system=5]
add path uscanner0 mode 660</programlisting>

      <para>Ahora a&ntilde;ada lo siguiente a
	<filename>/etc/rc.conf</filename> y reinicie la
	m&aacute;quina:</para>

      <programlisting>devfs_system_ruleset="system"</programlisting>

      <para>Para m&aacute;s informaci&oacute;n sobre lo que acaba de
        leer consulte la p&aacute;gina de manual de
	&man.devfs.8;.</para>

      <note>
	<para>Por seguridad deber&iacute;a pensarse dos veces
	  el hecho mismo de a&ntilde;adir cualquier usuario
	  a un grupo y muy especialmente al grupo
	  <groupname>operator</groupname>.</para>
      </note>
    </sect2>
  </sect1>



</chapter>
