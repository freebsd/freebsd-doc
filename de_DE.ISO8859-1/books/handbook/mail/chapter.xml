<?xml version="1.0" encoding="iso-8859-1"?>
<!--
     The FreeBSD Documentation Project
     The FreeBSD German Documentation Project

     Original Revision der ersten Uebersetzung: 1.20

     $FreeBSD$
     $FreeBSDde: de-docproj/books/handbook/mail/chapter.xml,v 1.68 2011/07/25 15:00:09 bcr Exp $
     basiert auf: r50808
-->
<!--
     Ein paar Anmerkungen zur Uebersetzung bestimmter Begriffe

     ``Domain'' wurde mit ,,Domaene`` uebersetzt.
	,,TCP/IP und OCS/NFS`` (Michael Santifaller)
	FdI*

     Aus ``Host'' wurde ,,Rechner``.
	FdI* beschreibt ``Host'' als ,,Hauptrechner`` oder ,,gastgebender
	Rechner``.  Als Ausnahme wurde ``mail host'' mit ``E-Mail-Server''
	uebersetzt.


     *	Fdi = Fachausdruecke der Informationsverarbeitung -
	      Woerterbuch und Glossar (IBM 1985)
-->
<chapter xmlns="http://docbook.org/ns/docbook"
  xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0"
  xml:id="mail">
  <info>
    <title>Elektronische Post (E-Mail)</title>

    <authorgroup>
      <author>
	<personname>
	  <firstname>Bill</firstname>
	  <surname>Lloyd</surname>
	</personname>
	<contrib>Ursprüglicher Text von </contrib>
      </author>
    </authorgroup>
    <authorgroup>
      <author>
	<personname>
	  <firstname>Jim</firstname>
	  <surname>Mock</surname>
	</personname>
	<contrib>Neugeschrieben von </contrib>
      </author>
    </authorgroup>
    <authorgroup>
      <author>
	<personname>
	  <firstname>Robert</firstname>
	  <surname>Drehmel</surname>
	</personname>
	<contrib>Übersetzt von </contrib>
      </author>
    </authorgroup>
  </info>

  <sect1 xml:id="mail-de-term">
    <title>Terminologie</title>

    <indexterm>
      <primary>E-Mail</primary>
      <secondary>Terminologie</secondary>
    </indexterm>

    <para>Das Akronym <firstterm>MTA</firstterm> steht für
      <firstterm>Mail Transfer Agent</firstterm> was übersetzt
      <quote>Mailübertragungs-Agent</quote> bedeutet.</para>

    <para>Während die Bezeichnung <firstterm>Server-Dämon</firstterm>
      die Komponente eines <acronym>MTA</acronym> benennt, die für
      eingehende Verbindungen zuständig ist, wird mit dem Begriff
      <firstterm>Mailer</firstterm> öfters die Komponente des
      <acronym>MTA</acronym> bezeichnet, die E-Mails versendet.</para>
  </sect1>

  <sect1 xml:id="mail-synopsis">
    <title>Übersicht</title>

    <indexterm>
      <primary>E-Mail</primary>
    </indexterm>

    <para><quote>Elektronische Post</quote>, besser bekannt als
      E-Mail, ist eine der am weit verbreitetsten Formen der
      Kommunikation heutzutage.  Dieses Kapitel bietet eine
      grundlegende Einführung in das Betreiben eines E-Mail-Servers
      unter &os;.  Ebenfalls wird der Versand und Empfang von E-Mails
      unter &os; behandelt.  Eine umfassende Betrachtung zu diesem
      Thema finden Sie in den Büchern, die in <xref
	linkend="bibliography"/> aufgelistet sind.</para>

    <para>Dieses Kapitel behandelt die folgenden Punkte:</para>

    <itemizedlist>
      <listitem>
	<para>Welche Software-Komponenten beim Senden und
	  Empfangen von elektronischer Post involviert sind.</para>
      </listitem>

      <listitem>
	<para>Wo sich grundlegende <application>Sendmail</application>
	  Konfigurationsdateien in &os; befinden.</para>
      </listitem>

      <listitem>
	<para>Den Unterschied zwischen entfernten und lokalen
	  Postfächern.</para>
      </listitem>

      <listitem>
	<para>Wie man Versender von Spam daran hindern kann,
	  E-Mail-Server illegalerweise als Weiterleitung zu
	  verwenden.</para>
      </listitem>

      <listitem>
	<para>Wie man einen alternativen <acronym>MTA</acronym>
	  installiert und konfiguriert, um
	  <application>Sendmail</application> zu ersetzen.</para>
      </listitem>

      <listitem>
	<para>Wie man oft auftretende E-Mail-Server Probleme
	  behebt.</para>
      </listitem>

      <listitem>
	<para>Wie E-Mails über einen Relay verschickt werden.</para>
      </listitem>

      <listitem>
	<para>Wie E-Mails über eine Einwahlverbindung gehandhabt
	  werden.</para>
      </listitem>

      <listitem>
	<para>Wie SMTP-Authentifizierung einrichtet wird.</para>
      </listitem>

      <listitem>
	<para>Den Empfang und den Versand von E-Mails mithilfe
	  von Programmen wie <application>mutt</application>.</para>
      </listitem>

      <listitem>
	<para>Wie E-Mails von einem entfernten Server mit
	  <acronym>POP</acronym> oder <acronym>IMAP</acronym>
	  abgeholt werden.</para>
      </listitem>

      <listitem>
	<para>Wie eingehende E-Mail automatisch gefiltert wird.</para>
      </listitem>
    </itemizedlist>

    <para>Bevor Sie dieses Kapitel lesen, sollten Sie:</para>

    <itemizedlist>
      <listitem>
	<para>Die Netzwerk-Verbindung richtig einrichten.
	  (<xref linkend="advanced-networking"/>).</para>
      </listitem>

      <listitem>
	<para>Die <acronym>DNS</acronym>-Information für einen
	  E-Mail-Server einstellen
	  (<xref linkend="network-servers"/>).</para>
      </listitem>

      <listitem>
	<para>Wissen, wie man zusätzliche Dritthersteller-Software
	  installiert (<xref linkend="ports"/>).</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="mail-using">
    <title>E-Mail Komponenten</title>

    <indexterm><primary>POP</primary></indexterm>
    <indexterm><primary>IMAP</primary></indexterm>
    <indexterm><primary>DNS</primary></indexterm>

    <indexterm>
      <primary>E-Mail-Server Dämonen</primary>
      <secondary><application>Sendmail</application></secondary>
    </indexterm>
    <indexterm>
      <primary>E-Mail-Server Dämonen</primary>
      <secondary><application>Postfix</application></secondary>
    </indexterm>
    <indexterm>
      <primary>E-Mail-Server Dämonen</primary>
      <secondary><application>qmail</application></secondary>
    </indexterm>
    <indexterm>
      <primary>E-Mail-Server Dämonen</primary>
      <secondary><application>Exim</application></secondary>
    </indexterm>
    <indexterm>
      <primary>E-Mails</primary>
      <secondary>empfangen</secondary>
    </indexterm>
    <indexterm><primary>MX-Eintrag</primary></indexterm>
    <indexterm><primary>E-Mail-Server</primary></indexterm>

    <para>Es gibt fünf größere Komponenten die am Austausch von
      E-Mails beteiligt sind:  der <foreignphrase>Mail User
      Agent</foreignphrase> (<acronym>MUA</acronym>), der
      <foreignphrase>Mail Transfer Agent</foreignphrase>
      (<acronym>MTA</acronym>), der
      <foreignphrase>Mail Host</foreignphrase>, ein entferntes
      oder lokales Postfach, sowie <acronym>DNS</acronym>.  Dieser
      Abschnitt enthält eine Übersicht über diese
      Komponenten.</para>

    <variablelist>
      <varlistentry>
	<term>Mail User Agent (<acronym>MUA</acronym>)</term>
	<listitem>
	  <para>Der <foreignphrase>Mail User Agent</foreignphrase>
	    (<acronym>MUA</acronym>) ist das Benutzerprogramm zum
	    Verfassen, Senden und Empfangen von E-Mails.  Diese
	    Anwendung kann ein Kommandozeilenprogramm sein, wie das
	    in &os; enthaltene Programm <command>mail</command>,
	    oder ein Programm aus der Ports-Sammlung wie
	    beispielsweise <application>mutt</application>,
	    <application>alpine</application> oder
	    <application>elm</application>.  In der Ports-Sammlung
	    sind auch dutzende von grafischen Programmen verfügbar,
	    darunter <application>ClawsMail</application>,
	    <application>Evolution</application> und
	    <application>Thunderbird</application>.  Einige
	    Unternehmen bieten auch ein Web-Mail-Programm an, das
	    über einen Webbrowser verwaltet werden kann.  Weitere
	    Informationen zur Installation und Verwendung von
	    <acronym>MUA</acronym>s unter &os; finden Sie im
	    <xref linkend="mail-agents"/>.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Mail Transfer Agent (<acronym>MTA</acronym>)</term>
	<listitem>
	  <para>Der
	    <foreignphrase>Mail Transfer Agent</foreignphrase>
	    (<acronym>MTA</acronym>) ist ein E-Mail-Server Daemon,
	    welcher für dem Empfang von eingehenden E-Mails und für
	    den Versand von ausgehenden E-Mails verantwortlich ist.
	    &os; wird mit <application>Sendmail</application> als
	    Standard-<acronym>MTA</acronym> ausgeliefert, aber es
	    unterstützt auch weitere E-Mail-Server, darunter
	    <application>Exim</application>,
	    <application>Postfix</application> und
	    <application>qmail</application>.  Die Konfiguration von
	    <application>Sendmail</application> wird im <xref
	      linkend="sendmail"/> beschrieben.  Wenn Sie einen
	    anderen <acronym>MTA</acronym> aus der Ports-Sammlung
	    installieren, lesen Sie die Nachrichten die nach der
	    Installation der Anwendung ausgegeben werden, wenn Sie
	    &os; spezifische Informationen benötigen.  Allgemeine
	    Informationen zur Konfiguration finden Sie in der Regel
	    auf der Webseite des Herstellers.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Mail Host und Postfächer</term>
	<listitem>
	  <para>Der <foreignphrase>Mail Host</foreignphrase> ist für
	    die Zustellung und das Empfangen von E-Mails für den
	    Rechner oder eines Netzwerks zuständig.  Der Mail Host
	    empfängt alle E-Mails für eine Domäne und speichert
	    diese entweder im voreingestellten
	    <filename>mbox</filename>-Format, oder im
	    Maildir-Format.  Diese E-Mails können lokal mit einem
	    Benutzerprogramm <acronym>MUA</acronym> gelesen werden.
	    Mithilfe von Protokollen wie <acronym>POP</acronym> oder
	    <acronym>IMAP</acronym> können die E-Mails auch von
	    entfernten Rechnern gelesen werden.  Wenn die E-Mails
	    direkt auf dem Mail Host gelesen werden, wird kein
	    <acronym>POP</acronym>- oder
	    <acronym>IMAP</acronym>-Server benötigt.</para>

	  <para>Um auf entfernte Postfächer zuzugreifen, wird ein
	    Zugang zu einem <acronym>POP</acronym>- oder
	    <acronym>IMAP</acronym>-Server benötigt.  Beide
	    Protokolle ermöglichen es Benutzern, auf ein entferntes
	    Postfach zuzugreifen.  <acronym>IMAP</acronym> bietet
	    gegenüber <acronym>POP</acronym> einige Vorteiler.  Dazu
	    zählt die Fähigkeit eine Kopie aller Nachrichten auf
	    einem entfernten Server zu speichern, sowie gleichzeitig
	    ablaufende Aktualisierungen.  <acronym>IMAP</acronym>
	    kann auch über langsame Verbindungen nützlich sein, da
	    nicht gleich die komplette Nachricht heruntergeladen
	    wird.  Weiterhin können E-Mails auf dem Server
	    durchsucht werden, was den Datenverkehr zwischen Clients
	    und dem Server minimiert.</para>

	  <para>Die Ports-Sammlung enthält einige
	    <acronym>POP</acronym>- und
	    <acronym>IMAP</acronym>-Server, darunter
	    <package>mail/qpopper</package>,
	    <package>mail/imap-uw</package>,
	    <package>mail/courier-imap</package> und
	    <package>mail/dovecot2</package>.</para>

	  <warning>
	    <para>Beachten Sie, dass sowohl <acronym>POP</acronym>
	      als auch <acronym>IMAP</acronym> Daten, wie den
	      Benutzernamen und das Passwort, im Klartext
	      übertragen.  Um die Übermittlung von Daten über diese
	      Protokolle zu schützen, können Sie Sitzungen über
	      &man.ssh.1; (<xref linkend="security-ssh-tunneling"/>)
	      tunneln oder <acronym>SSL</acronym>
	      (<xref linkend="openssl"/>) verwenden.</para>
	  </warning>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term>Domain Name System (<acronym>DNS</acronym>)</term>
	<listitem>
	  <para>Das
	    <foreignphrase>Domain Name System</foreignphrase>
	    (<acronym>DNS</acronym>) und sein Daemon
	    <command>named</command> spielen eine große Rolle bei
	    der Auslieferung von E-Mails.  Um E-Mails auszuliefern,
	    fragt der <acronym>MTA</acronym> im
	    <acronym>DNS</acronym> den Rechner ab, der E-Mails für
	    das Zielsystem entgegennimmt.  Der gleiche Vorgang läuft
	    ab, wenn eine E-Mail von einem entfernten Server zum
	    <acronym>MTA</acronym> zugestellt wird.</para>

	  <para>Im <acronym>DNS</acronym> werden Rechnernamen auf
	    <acronym>IP</acronym>-Adressen abgebildet.  Daneben werden
	    spezielle Informationen für das Mail-System gespeichert,
	    die <firstterm>MX-Einträge</firstterm>
	    (<foreignphrase>MX record</foreignphrase>) genannt werden.
	    Der MX-Eintrag (von
	    <foreignphrase>Mail eXchanger</foreignphrase>) gibt an,
	    welche Rechner E-Mails für eine Domäne annehmen.</para>

	  <para>Mit &man.host.1; können die
	    <acronym>MX</acronym>-Einträge für eine Domäne abgefragt
	    werden:</para>

	  <screen>&prompt.root; <userinput>host -t mx FreeBSD.org</userinput>
FreeBSD.org mail is handled by 10 mx1.FreeBSD.org</screen>

	  <para>Weitere Informationen zu <acronym>DNS</acronym> und
	    dessen Konfiguration finden Sie im <xref
	      linkend="network-dns"/>.</para>
	</listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 xml:id="sendmail">
    <info>
      <title><application>Sendmail</application>-Konfigurationsdateien</title>

      <authorgroup>
        <author>
	  <personname>
	    <firstname>Christopher</firstname>
	    <surname>Shumway</surname>
	  </personname>
	  <contrib>Beigesteuert von </contrib>
	</author>
      </authorgroup>
    </info>

    <indexterm>
      <primary><application>Sendmail</application></primary>
    </indexterm>

    <para><application>Sendmail</application> ist der standardmäßig in
      &os; installierte <acronym>MTA</acronym>.  Es nimmt E-Mails von
      E-Mail-Benutzerprogrammen (<acronym>MUA</acronym>)
      entgegen und liefert diese zu den entsprechenden Mail Hosts, die
      in der Konfigurationsdatei definiert sind.
      <application>Sendmail</application> kann auch
      Netzwerkverbindungen annehmen und E-Mails an lokale
      <firstterm>Mailboxen</firstterm>, oder an andere Programme
      ausliefern.</para>

    <para>Die Konfigurationsdateien von
      <application>Sendmail</application> befinden sich in
      <filename>/etc/mail</filename>.  In diesem Abschnitt werden
      diese Dateien im Detail beschrieben.</para>

    <indexterm>
      <primary><filename>/etc/mail/access</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/aliases</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/local-host-names</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/mailer.conf</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/mailertable</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/sendmail.cf</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/virtusertable</filename></primary>
    </indexterm>

    <variablelist>
      <varlistentry>
	<term><filename>/etc/mail/access</filename></term>
	<listitem>
	  <para>Diese Datenbank bestimmt, welche Rechner oder
	    <acronym>IP</acronym>-Adressen Zugriff auf den lokalen
	    Mail-Server haben und welche Art von Zugriff ihnen
	    gestattet wird.  Rechner die als <option>OK</option>
	    aufgelistet sind, was der Standard ist, sind berechtigt
	    E-Mails zu diesem Rechner zu schicken, solange die
	    endgültige Zieladresse der lokale Rechner ist.  Rechner
	    die als <option>REJECT</option> aufgelistet sind, werden
	    abgelehnt.  Rechner die als <option>RELAY</option>
	    aufgelistet sind, wird es erlaubt Post für jede
	    Zieladresse durch diesen Mail-Server zu senden.  Rechner
	    die als <option>ERROR</option> aufgelistet sind, bekommen
	    ihre E-Mail mit einem speziellen Fehler zurück.  Wenn ein
	    Rechner als <option>SKIP</option> aufgelistet ist, wird
	    <application>Sendmail</application> die aktuelle Suche
	    abbrechen, ohne die E-Mail zu akzeptieren oder abzulehnen.
	    E-Mails von Rechnern die als <option>QUARANTAINE</option>
	    aufgelistet sind, werden vorerst zurückgehalten.  Dem
	    sendenden Rechner wird ein festgelegter Text als Grund für
	    die Quarantäne zurückgeschickt.</para>

	  <para>Beispiele für die Verwendung dieser Optionen für
	    <acronym>IPv4</acronym>-
	    und <acronym>IPv6</acronym>-Adressen finden Sie in der
	    Beispielkonfiguration
	    <filename>/etc/mail/access.sample</filename>:</para>

	  <programlisting># <phrase its:translate="no">&dollar;FreeBSD&dollar;</phrase>
#
# Mail relay access control list.  Default is to reject mail unless the
# destination is local, or listed in /etc/mail/local-host-names
#
## Examples (commented out for safety)
#From:cyberspammer.com          ERROR:"550 We don't accept mail from spammers"
#From:okay.cyberspammer.com     OK
#Connect:sendmail.org           RELAY
#To:sendmail.org                RELAY
#Connect:128.32                 RELAY
#Connect:128.32.2               SKIP
#Connect:IPv6:1:2:3:4:5:6:7     RELAY
#Connect:suspicious.example.com QUARANTINE:Mail from suspicious host
#Connect:[127.0.0.3]            OK
#Connect:[IPv6:1:2:3:4:5:6:7:8] OK</programlisting>

	  <para>Um die Datenbank zu konfigurieren, verwenden Sie das
	    im Beispiel gezeigte Format, um Einträge in
	    <filename>/etc/mail/access</filename> hinzuzufügen, aber
	    setzen Sie kein Kommentarsymbol (<literal>#</literal>) vor
	    die Einträge.  Erstellen Sie einen Eintrag für jeden
	    Rechner, dessen Zugriff konfiguriert werden soll.
	    E-Mail-Versender, die mit der linken Spalte der Tabelle
	    übereinstimmen, sind betroffen von der Aktion in der
	    rechten Spalte.</para>

	  <para>Immer wenn diese Datei verändert wurde, muss die
	    Datenbank aktualisiert und
	    <application>Sendmail</application> neu gestartet
	    werden:</para>

	  <screen>&prompt.root; <userinput>makemap hash /etc/mail/access &lt; /etc/mail/access</userinput>
&prompt.root; <userinput>service sendmail restart</userinput></screen>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><filename>/etc/mail/aliases</filename></term>
	<listitem>
	  <para>Diese Datenbank enthält eine Liste der virtuellen
	    Mailboxen, die in andere Benutzer, Dateien, Programme oder
	    andere Aliase expandiert werden.  Hier sind ein paar
	    Beispiele, die das Dateiformat verdeutlichen:</para>

	  <programlisting>root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: "|/usr/local/bin/procmail"</programlisting>

	  <para>Der Name der Mailbox auf der linken Seite des
	    Doppelpunkts wird mit den Zielen auf der rechten Seite
	    ersetzt.  Der erste Eintrag ersetzt die Mailbox
	    <systemitem class="username">root</systemitem> mit der
	    Mailbox <systemitem
	      class="username">localuser</systemitem>, die dann
	    in der Datenbank <filename>/etc/mail/aliases</filename>
	    gesucht wird.  Wird kein passender Eintrag gefunden, wird
	    die Nachricht zum <systemitem
	      class="username">localuser</systemitem> geliefert.  Der
	    zweite Eintrag zeigt eine E-Mail-Verteilerliste.  E-Mails
	    an <systemitem class="username">ftp-bugs</systemitem>
	    werden zu den drei lokalen Mailboxen <systemitem
	      class="username">joe</systemitem>,
	    <systemitem class="username">eric</systemitem> und
	    <systemitem class="username">paul</systemitem> gesendet.
	    Eine entfernte Mailbox kann auch als
	    <replaceable>user@example.com</replaceable> angegeben werden.  Der
	    dritte Eintrag zeigt wie E-Mails in eine Datei geschrieben
	    werden, in diesem Fall <filename>/dev/null</filename>.
	    Der letzte Eintrag verdeutlicht das Senden von E-Mails an
	    ein Programm.  Hier wird die Nachricht über eine &unix;
	    Pipe an <filename>/usr/local/bin/procmail</filename>
	    gesendet.  Weitere Informationen zu dem Format dieser
	    Datei finden Sie in &man.aliases.5;.</para>

	  <para>Wenn diese Datei geändert wird, muss
	    <command>newaliases</command> ausgeführt werden, um die
	    Datenbank zu aktualisieren.</para>
	</listitem>
      </varlistentry>
<!--$
This section needs to explain that this feature is for hosts with$
alternate names, such as a host that MXs for a dynamic set of other$
hosts.$
It won't work unless freebsd.mc is built with FEATURE(`use_cw_file'),$
meaning it needs a section to refer to on how to make mc files.$
      <varlistentry>
	<term><filename>/etc/mail/local-host-names</filename></term>
	<listitem>
	  <para>Dies ist eine Liste von Rechnernamen, die
	    <application>Sendmail</application> als lokalen
	    Rechnernamen akzeptiert.  Setzen Sie alle Domänen oder
	    Rechner, für die <application>Sendmail</application> Mail
	    empfangen soll, in diese Datei.  Wenn dieser Mail-Server
	    zum Beispiel E-Mails für die Domäne <systemitem
	      class="fqdomainname">example.com</systemitem> und den
	    Rechner <systemitem
	      class="fqdomainname">mail.example.com</systemitem>
	    annehmen soll, fügen Sie folgende Einträge in
	    <filename>local-host-names</filename> hinzu:</para>

	  <programlisting>example.com
mail.example.com</programlisting>

	  <para>Wird diese Datei geändert, muss &man.sendmail.8; neu
	    gestartet werden, damit es die Änderungen einliest.</para>
	</listitem>
      </varlistentry>
-->
      <varlistentry>
	<term><filename>/etc/mail/sendmail.cf</filename></term>
	<listitem>
	  <para>Dies ist die Hauptkonfigurations-Datei von
	    <application>Sendmail</application>.  Sie kontrolliert das
	    allgemeine Verhalten von
	    <application>Sendmail</application>, einschließlich allem
	    vom Umschreiben von E-Mail Adressen bis hin zum Übertragen
	    von Ablehnungsnachrichten an entfernte E-Mail-Server.
	    Dementsprechend ist die Konfigurationsdatei ziemlich
	    komplex.  Glücklicherweise muss diese Datei selten für
	    Standard E-Mail-Server geändert werden.</para>

	  <para>Die <application>Sendmail</application>
	    Hauptkonfigurationsdatei kann mit &man.m4.1; Makros
	    erstellt werden, die Eigenschaften und Verhalten von
	    <application>Sendmail</application> definieren.  Einige
	    der Details finden Sie in
	    <filename>/usr/src/contrib/sendmail/cf/README</filename>.</para>

	  <para>Wenn Änderungen an dieser Datei vorgenommen werden,
	    muss <application>Sendmail</application> neu gestartet
	    werden, damit die Änderungen Wirkung zeigen.</para>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><filename>/etc/mail/virtusertable</filename></term>
	<listitem>
	  <para>Diese Datenbank ordnet Adressen für virtuelle Domänen
	    und Benutzern reellen Mailboxen zu.  Diese Mailboxen
	    können lokal, auf entfernten Systemen, Aliase in
	    <filename>/etc/mail/aliases</filename> oder eine Datei
	    sein.  Dadurch können mehrere virtuelle Domains auf einem
	    Rechner gehostet werden.</para>

	  <para>&os; enthält eine Beispielkonfiguration in
	    <filename>/etc/mail/virtusertable.sample</filename>, die
	    das Format genauer beschreibt.  Das folgende Beispiel
	    zeigt, wie benutzerdefinierte Einträge in diesem Format
	    erstellt werden:</para>

	  <programlisting>root@example.com                root
postmaster@example.com          postmaster@noc.example.net
@example.com                    joe</programlisting>

	  <para>Diese Datei wird nach dem ersten übereinstimmenden
	    Eintrag durchsucht.  Wenn eine E-Mail-Adresse mit der
	    Adresse auf der linken Seite übereinstimmt, wird sie
	    dem Eintrag auf der rechten Seite zugeordnet.  Der erste
	    Eintrag in diesem Beispiel ordnet eine bestimmte
	    E-Mail-Adresse einer lokalen Mailbox zu, während der
	    zweite Eintrag eine bestimmte E-Mail-Adresse einer
	    entfernten Mailbox zuordnet.  Zuletzt wird jede
	    E-Mail-Adresse von <literal>example.com</literal>, welche
	    nicht mit einem der vorherigen Einträge übereinstimmt, mit
	    dem letzten Eintrag übereinstimmen und der lokalen Mailbox
	    <literal>joe</literal> zugeordnet.  Benutzen Sie dieses
	    Format, wenn Sie neue Einträge in
	    <filename>/etc/mail/virtusertable</filename> hinzufügen.
	    Jedes Mal, wenn diese Datei bearbeitet wurde, muss die
	    Datenbank aktualisiert und
	    <application>Sendmail</application> neu gestartet
	    werden:</para>

	  <screen>&prompt.root; <userinput>makemap hash /etc/mail/virtusertable &lt; /etc/mail/virusertable</userinput>
&prompt.root; <userinput>service sendmail restart</userinput></screen>
	</listitem>
      </varlistentry>

      <varlistentry>
	<term><filename>/etc/mail/relay-domains</filename></term>
	<listitem>
	  <para>In der standardmäßigen &os;-Installation wird
	    <application>Sendmail</application> nur dazu konfiguriert,
	    E-Mails von dem Rechner, auf dem es läuft, zu senden.
	    Wenn zum Beispiel ein <acronym>POP</acronym>-Server
	    installiert ist, können Benutzer ihre E-Mails von
	    entfernten Standorten überprüfen.  Sie werden jedoch keine
	    E-Mails von außen verschicken können.  Typischerweise
	    wird ein paar Sekunden nach dem Versuch eine E-Mail
	    von <application>MAILER-DAEMON</application> mit einer
	    <errorname>5.7 Relaying Denied</errorname> Fehlermeldung
	    versendet werden.</para>

	  <para>Die einfachste Lösung ist, wie im folgenden Beispiel
	    gezeigt, den <acronym>FQDN</acronym> des
	    Internet-Dienstanbieters und gegebenenfalls weitere
	    Adressen in <filename>/etc/mail/relay-domains</filename>
	    einzutragen:</para>

	  <programlisting>your.isq.example.com
other.isp.example.net
users.isp.example.org
www.example.org</programlisting>

	  <para>Nachdem diese Datei erstellt oder editiert wurde, muss
	    <application>Sendmail</application> mittels
	    <command>service sendmail restart</command> neu gestartet
	    werden.</para>

	  <para>Ab jetzt wird jede E-Mail, die von einem in der Liste
	    eingetragenen Rechner durch das System geschickt wird,
	    ihr Ziel erreichen, vorausgesetzt der Benutzer
	    hat einen Account auf dem System.  Dies erlaubt es
	    Benutzern aus der Ferne, E-Mails über das System zu
	    versenden, ohne dem Massenversand
	    (<acronym>SPAM</acronym>) die Tür zu öffnen.</para>
	</listitem>
      </varlistentry>
    </variablelist>
  </sect1>

  <sect1 xml:id="mail-changingmta">
    <info>
      <title>Wechseln des Mailübertragungs-Agenten</title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>Andrew</firstname>
	    <surname>Boothman</surname>
	  </personname>
	  <contrib>Geschrieben von </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <personname>
	    <firstname>Gregory</firstname>
	    <surname>Neil Shapiro</surname>
	  </personname>
	  <contrib>Informationen entnommen aus E-Mails geschrieben von </contrib>
	</author>
      </authorgroup>
    </info>

    <indexterm>
      <primary>E-Mail</primary>
      <secondary>MTA, wechseln</secondary>
    </indexterm>

    <para>&os; enthält mit <application>Sendmail</application> bereits
      einen <acronym>MTA</acronym>, der für die ein- und ausgehenden
      E-Mails verantwortlich ist.  Der Systemadministrator kann aber
      den <acronym>MTA</acronym> des Systems wechseln.  Eine große
      Auswahl an alternativen <acronym>MTA</acronym>s ist in der
      Kategorie <literal>mail</literal> der &os; Ports-Sammlung
      verfügbar.</para>

    <para>Sobald ein neuer <acronym>MTA</acronym> installiert ist,
      können Sie die neue Software konfigurieren und testen, bevor Sie
      <application>Sendmail</application> ersetzen.  Informationen
      über die Konfiguration des neu gewählten <acronym>MTA</acronym>
      finden Sie in der dazugehörigen Dokumentation.</para>

    <para>Sobald der neue <acronym>MTA</acronym> wie gewünscht
      funktioniert, benutzen Sie die Anweisungen in diesem Abschnitt,
      um <application>Sendmail</application> zu deaktivieren und
      stattdessen den neuen <acronym>MTA</acronym> zu
      verwenden.</para>

    <sect2 xml:id="mail-disable-sendmail">
      <title><application>Sendmail</application> deaktivieren</title>

      <warning>
	<para>Wenn der ausgehende Mail-Dienst von
	  <application>Sendmail</application> deaktiviert ist, muss
	  für den E-Mail-Versand ein alternatives System installiert
	  werden.  Andernfalls sind Systemfunktionen wie
	  &man.periodic.8; nicht mehr in der Lage, ihre Resulate und
	  Meldungen als E-Mail zu versenden.  Aber auch viele andere
	  Teile des Systems erwarten einen funktionalen
	  <acronym>MTA</acronym>.  Sind Programme auf die
	  deaktivierten
	  <application>Sendmail</application>-Binärdateien angewiesen,
	  landen deren E-Mails ansonsten in einer inaktiven
	  <application>Sendmail</application>-Warteschlange und
	  können nicht ausgeliefert werden.</para>
      </warning>

      <para>Um <application>Sendmail</application> komplett zu
	deaktivieren, müssen folgende Zeilen in
	<filename>/etc/rc.conf</filename> hinzugefügt oder editiert
	werden:</para>

      <programlisting>sendmail_enable="NO"
sendmail_submit_enable="NO"
sendmail_outbound_enable="NO"
sendmail_msp_queue_enable="NO"</programlisting>

      <para>Um lediglich die Funktion zum Empfang von E-Mails
	durch <application>Sendmail</application> zu deaktivieren,
	muss folgender Eintrag in <filename>/etc/rc.conf</filename>
	gesetzt werden:</para>

	<programlisting>sendmail_enable="NO"</programlisting>

      <para>Weitere Informationen zu den Startoptionen von
	<application>Sendmail</application> finden Sie in der
	Manualpage &man.rc.sendmail.8;.</para>
    </sect2>

    <sect2>
      <title>Den voreingestellten <acronym>MTA</acronym>
	ersetzen</title>

      <para>Wenn ein neuer <acronym>MTA</acronym> über die
	Ports-Sammlung installiert wird, werden auch die Startskripten
	installiert.  Die Anweisungen zum starten dieser Skripte
	werden in den Paketnachrichten erwähnt.  Bevor Sie den neuen
	<acronym>MTA</acronym> in Betrieb nehmen, stoppen Sie alle
	laufenden <application>Sendmail</application>-Prozesse.  In
	diesem Beispiel werden alle notwendigen Dienste gestoppt und
	danach der <application>Postfix</application> Dienst
	gestartet:</para>

      <screen>&prompt.root; <userinput>service sendmail stop</userinput>
&prompt.root; <userinput>service postfix start</userinput></screen>

      <para>Damit der angegebene <acronym>MTA</acronym> automatisch
	beim Hochfahren des Systems gestartet wird, fügen Sie dessen
	Konfigurationszeile in <filename>/etc/rc.conf</filename>
	hinzu.  Dieser Eintrag startet den
	<application>Postfix</application>
	<acronym>MTA</acronym>:</para>

      <programlisting>postfix_enable="YES"</programlisting>

      <para>Da <application>Sendmail</application> allgegenwärtig ist
	und manche Anwendungen einfach davon ausgehen es bereits
	installiert und konfiguriert, wird einige zusätzliche
	Konfiguration benötigt.  Überprüfen Sie
	<filename>/etc/periodic.conf</filename> und stellen Sie
	sicher, dass diese Werte auf <literal>NO</literal> gesetzt
	werden.  Wenn die Datei nicht existiert, erstellen Sie sie
	mit folgenden Einträgen:</para>

      <programlisting>daily_clean_hoststat_enable="NO"
daily_status_mail_enable="NO"
daily_status_include_submit_mailq="NO"
daily_submit_queuerun="NO"</programlisting>

      <para>Viele alternative <acronym>MTA</acronym>s stellen ihre
	eigenen kompatiblen Implementierungen der
	<application>Sendmail</application>
	Kommandozeilen-Schnittstelle zur Verfügung, was die Verwendung
	als <quote>drop-in</quote> Ersatz für
	<application>Sendmail</application> vereinfacht.  Allerdings
	versuchen einige <acronym>MUA</acronym>s
	<application>Sendmail</application>s Standard-Dateien
	auszuführen, anstelle der Dateien des neuen
	<acronym>MTA</acronym>s.  &os; verwendet
	<filename>/etc/mail/mailer.conf</filename> um die erwarteten
	<acronym>Sendmail</acronym> Dateien auf die neuen Dateien
	abzubilden.  Weitere Informationen über diese Zuordnungen
	können in &man.mailwrapper.8; gefunden werden.</para>

      <para>In der Voreinstellung sieht
	<filename>/etc/mail/mailer.conf</filename> wie folgt
	aus:</para>

      <programlisting># <phrase its:translate="no">&dollar;FreeBSD&dollar;</phrase>
#
# Execute the "real" sendmail program, named /usr/libexec/sendmail/sendmail
#
sendmail        /usr/libexec/sendmail/sendmail
send-mail       /usr/libexec/sendmail/sendmail
mailq           /usr/libexec/sendmail/sendmail
newaliases      /usr/libexec/sendmail/sendmail
hoststat        /usr/libexec/sendmail/sendmail
purgestat       /usr/libexec/sendmail/sendmail</programlisting>

      <para>Wenn eines der Kommandos auf der linken Seite ausgeführt
	werden soll,  führt das System tatsächlich den damit
	verbundenen Befehl auf der rechten Seite aus.  Mit diesem
	System lassen sich Programme, die für die
	<application>Sendmail</application>-Funktionen gestartet
	werden, leicht ändern.</para>

      <para>Einige <acronym>MTA</acronym>s aus der Ports-Sammlung
	können diese Datei aktualisieren.  Zum Beispiel würde
	<application>Postfix</application> die Datei wie folgt
	aktualisieren:</para>

      <programlisting>#
# Execute the Postfix sendmail program, named /usr/local/sbin/sendmail
#
sendmail        /usr/local/sbin/sendmail
send-mail       /usr/local/sbin/sendmail
mailq           /usr/local/sbin/sendmail
newaliases      /usr/local/sbin/sendmail</programlisting>

      <para>Falls die Installation des <acronym>MTA</acronym> nicht
	automatisch <filename>/etc/mail/mailer.conf</filename>
	aktualisiert, bearbeiten Sie diese Datei in einem Texteditor,
	so dass auf die neuen Dateien verwiesen wird.  Dieses Beispiel
	zeigt auf die Dateien, die von <package>mail/ssmtp</package>
	installiert wurden:</para>

      <programlisting>sendmail        /usr/local/sbin/ssmtp
send-mail       /usr/local/sbin/ssmtp
mailq           /usr/local/sbin/ssmtp
newaliases      /usr/local/sbin/ssmtp
hoststat        /usr/bin/true
purgestat       /usr/bin/true</programlisting>

      <para>Sobald alles konfiguriert ist, wird empfohlen, das System
	neu zu starten.  Ein Neustart bietet auch die Möglichkeit
	sicherzustellen, dass das System korrekt konfiguriert wurde,
	um den neuen <acronym>MTA</acronym> automatisch beim
	Hochfahren zu starten.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="mail-trouble">
    <title>Fehlerbehebung</title>

    <para>Hier finden sich ein paar häufig gestellte Fragen und ihre
      Antworten, die von der <link
	xlink:href="&url.books.faq;/">FAQ</link> übernommen
      wurden.</para>

    <qandaset>
      <qandaentry>
	<question>
	  <para>Warum muss ich einen FQDN (fully-qualified domain
	    name / voll ausgeschriebenen Domänennamen) für meine
	    Rechner verwenden?</para>
	</question>

	<answer>
	  <para>Vielleicht befindet sich der Rechner in einer anderen
	    Domäne.  Um beispielsweise von einem Rechner in
	    <systemitem class="fqdomainname">foo.bar.edu</systemitem>
	    einen Rechner namens <systemitem>mumble</systemitem> in
	    der Domäne
	    <systemitem class="fqdomainname">foo.bar.edu</systemitem>
	    zu erreichen, geben Sie seinen voll ausgeschriebenen
	    Domänennamen (<acronym>FQDN</acronym>)
	    <systemitem
	      class="fqdomainname">mumble.bar.edu</systemitem>,
	    anstelle von <systemitem>mumble</systemitem> an.</para>

	  <para>Das liegt daran, dass die aktuelle Version von
	    <application>BIND</application><indexterm>
	    <primary>BIND</primary></indexterm>, die mit &os;
	    ausgeliefert wird, keine Standardabkürzungen für nicht
	    komplett angegebene Domänennamen außerhalb der lokalen
	    Domäne unterstützt.  Daher muss ein nicht-qualifizierter
	    Rechner, wie <systemitem>mumble</systemitem>, entweder als
	    <systemitem
	      class="fqdomainname">mumble.foo.bar.edu</systemitem>
	    gefunden werden, oder er wird in der root Domäne
	    gesucht.</para>

	  <para>In älteren Versionen von
	    <application>BIND</application> lief die Suche über
	    <systemitem
	      class="fqdomainname">mumble.bar.edu</systemitem> und
	    <systemitem class="fqdomainname">mumble.edu</systemitem>.
	    RFC 1535 erklärt, warum dieses Verhalten als schlechte
	    Praxis oder sogar als Sicherheitsloch angesehen
	    wird.</para>

	  <para>Um das zu umgehen, setzen Sie die Zeile:</para>

	  <programlisting>search foo.bar.edu bar.edu</programlisting>

	  <para>anstatt der vorherigen</para>

	  <programlisting>domain foo.bar.edu</programlisting>

	  <para>in <filename>/etc/resolv.conf</filename> ein.  Stellen
	    Sie jedoch sicher, dass die Suchordnung nicht die
	    Begrenzung von
	    <quote>lokaler und öffentlicher Administration</quote>,
	    wie RFC 1535 sie nennt, überschreitet.</para>
	</answer>
      </qandaentry>

      <qandaentry>
	<question>
	  <para>Wie kann ich einen E-Mail-Server auf einem
	    Anwahl-PPP<indexterm><primary>PPP</primary></indexterm>
	    Rechner betreiben?</para>
	</question>

	<answer>
	  <para>Sie wollen sich mit einem &os; E-Mail
	    <foreignphrase>Gateway</foreignphrase> im LAN
	    verbinden.  Die PPP-Verbindung ist keine
	    Standleitung.</para>

	  <para>Ein Weg dies zu tun ist, von einem immer mit dem
	    Internet verbundenen Server einen sekundären
	    <acronym>MX</acronym>-Dienst<indexterm><primary>MX-Eintrag</primary></indexterm>
	    für die Domäne zur Verfügung gestellt zu bekommen.  In
	    diesem Beispiel heißt die Domäne <systemitem
	      class="fqdomainname">example.com</systemitem>, und der
	    Internet-Dienstanbieter hat <systemitem
	      class="fqdomainname">example.net</systemitem> so
	    eingestellt, dass er für die Domäne einen sekundären
	    MX-Dienst zur Verfügung stellt:</para>

	  <programlisting>example.com.            MX        10      bigco.com.
	                MX        20      example.net.</programlisting>

	  <para>Nur ein Rechner sollte als Endempfänger angegeben
	    sein.  <application>Sendmail</application> fügen Sie
	    <literal>Cw example.com</literal> zu
	    <filename>/etc/sendmail.cf</filename> auf
	    <systemitem class="fqdomainname">example.com</systemitem>
	    hinzu.</para>

	  <para>Wenn der <acronym>MTA</acronym> des Versenders
	    versucht die E-Mail zuzustellen, wird es versuchen das
	    System <systemitem
	      class="fqdomainname">example.com</systemitem> über die
	    PPP-Verbindung zu erreichen.  Es kommt zu einer
	    Zeitüberschreitung, wenn das Zielsystem offline ist.  Der
	    <acronym>MTA</acronym> wird die E-Mail automatisch der
	    sekundären <acronym>MX</acronym>-Seite des
	    Internet-Providers <systemitem
	      class="fqdomainname">example.net</systemitem> zustellen.
	    Die sekundäre <acronym>MX</acronym>-Seite wird periodisch
	    versuchen, eine Verbindung zur primären
	    <acronym>MX</acronym>-Seite <systemitem
	      class="fqdomainname">example.com</systemitem>
	    aufzubauen.</para>

	  <para>Verwenden Sie etwas wie dies als Login-Skript:</para>

	  <programlisting>#!/bin/sh
# Put me in /usr/local/bin/pppmyisp
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</programlisting>

	  <para>Wenn Sie ein separates Login-Skript für einen Benutzer
	    erstellen, benutzen Sie stattdessen
	    <command>sendmail -qRexample.com</command> in dem oben
	    gezeigten Skript.  Das erzwingt die sofortige Verarbeitung
	    der E-Mails in der Warteschlange für <systemitem
	      class="fqdomainname">example.com</systemitem></para>

	  <para>Eine weitere Verfeinerung der Situation kann an diesem
	    Beispiel von &a.isp; entnommen werden:</para>

	  <programlisting>&gt; wir stellen einem Kunden den sekundären MX zur Verfügung.
&gt; Der Kunde verbindet sich mit unseren Diensten mehrmals am Tag
&gt; automatisch um die E-Mails zu seinem primären MX zu holen
&gt; (wir wählen uns nicht bei ihm ein, wenn E-Mails für seine
&gt; Domäne eintreffen).  Unser sendmail sendet den Inhalt der
&gt; E-Mail-Warteschlange alle 30 Minuten.  Momentan muss er 30 Minuten
&gt; eingewählt bleiben um sicher zu sein, dass alle seine E-Mails
&gt; beim primären MX eingetroffen sind.
&gt;
&gt; Gibt es einen Befehl, der sendmail dazu bringt, alle E-Mails sofort
&gt; zu senden? Der Benutzer hat natürlich keine root-Rechte auf
&gt; unserer Maschine.

In der <quote>privacy flags</quote> Sektion von sendmail.cf befindet sich die
Definition Opgoaway,restrictqrun

Entferne restrictqrun um nicht-root Benutzern zu erlauben, die Verarbeitung
der Nachrichten-Warteschlangen zu starten.  Möglicherweise willst du
auch die MX neu sortieren.  Wir sind der primäre MX für unsere
Kunden mit diesen Wünschen und haben definiert:

# Wenn wir der beste MX für einen Rechner sind, versuche es direkt
# anstatt einen lokalen Konfigurationsfehler zu generieren.
OwTrue

Auf diesem Weg liefern Gegenstellen direkt zu dir, ohne die Kundenverbindung
zu versuchen.  Dann sendest du zu deinem Kunden.  Das funktioniert nur
für <quote>Rechner</quote>, du musst also deinen Kunden dazu bringen,
ihre E-Mail Maschine <quote>customer.com</quote> zu nennen, sowie
<quote>hostname.customer.com</quote> im DNS.  Setze einfach einen A-Eintrag
in den DNS für <quote>customer.com</quote>.</programlisting>
	</answer>
      </qandaentry>
    </qandaset>
  </sect1>

  <sect1 xml:id="mail-advanced">
    <title>Weiterführende Themen</title>

    <para>Dieser Abschnitt behandelt kompliziertere Themen wie
      E-Mail-Konfiguration und Einrichtung von E-Mail für eine
      ganze Domäne.</para>

    <sect2 xml:id="mail-config">
      <title>Grundlegende Konfiguration</title>

      <para>Mit der Software im Auslieferungszustand sollte es möglich
	sein, E-Mails an externe Rechner zu senden, vorausgesetzt
	<filename>/etc/resolv.conf</filename> ist konfiguriert, oder
	das Netzwerk hat Zugriff auf einen konfigurierten
	<acronym>DNS</acronym>-Server.  Um E-Mails an den
	<acronym>MTA</acronym> auf dem Rechner auszuliefern, stehen
	zwei Möglichkeiten zur Auswahl:</para>

      <itemizedlist>
	<listitem>
	  <para>Betreiben Sie einen <acronym>DNS</acronym>-Server für
	    die Domäne.</para>
	</listitem>

	<listitem>
	  <para>Lassen Sie die E-Mails direkt über den
	  <acronym>FQDN</acronym> des Rechners ausliefern.</para>
	</listitem>
      </itemizedlist>

      <para>Um E-Mails direkt zu einem Rechner geliefert zu bekommen,
	wird eine permanente statische IP-Adresse (keine dynamische
	IP-Adresse) benötigt.  Befindet sich das System hinter einer
	Firewall, muss diese den SMTP-Verkehr weiterleiten.  Um
	E-Mails direkt am Rechner zu empfangen, muss eines der
	folgenden Dinge konfiguriert werden:</para>

      <itemizedlist>
	<listitem>
	  <para>Vergewissern Sie sich, dass der
	    <acronym>MX</acronym><indexterm><primary>MX-Eintrag</primary>
	    </indexterm>-Eintrag mit der kleinsten Nummer im
	    <acronym>DNS</acronym> auf die statische IP-Adresse des
	    Rechners zeigt.</para>
	</listitem>

	<listitem>
	  <para>Stellen Sie sicher, dass für den Rechner kein
	    <acronym>MX</acronym>-Eintrag im <acronym>DNS</acronym>
	    existiert.</para>
	</listitem>
      </itemizedlist>

      <para>Jede der erwähnten Konfigurationsmöglichkeiten erlaubt es,
	E-Mails direkt auf dem Rechner zu empfangen.</para>

      <para>Versuchen Sie das:</para>

      <screen>&prompt.root; <userinput>hostname</userinput>
example.FreeBSD.org
&prompt.root; <userinput>host example.FreeBSD.org</userinput>
example.FreeBSD.org has address 204.216.27.XX</screen>

      <para>In diesem Beispiel sollte es funktionieren, E-Mails direkt
	an <email role="nolink">yourlogin@example.FreeBSD.org</email>
	zu senden, vorausgesetzt dass
	<application>Sendmail</application> auf <systemitem
	class="fqdomainname">example.FreeBSD.org</systemitem> korrekt
	läuft.</para>

      <para>In diesem Beispiel:</para>

      <screen>&prompt.root; <userinput>host example.FreeBSD.org</userinput>
example.FreeBSD.org has address 204.216.27.XX
example.FreeBSD.org mail is handled (pri=10) by devnull.FreeBSD.org</screen>

      <para>Hier wird jede an den Rechner <systemitem
	  class="fqdomainname">example.FreeBSD.org</systemitem>
	gesandte E-Mail auf <systemitem>hub</systemitem> unter dem
	gleichen Benutzernamen gesammelt, anstatt diese direkt zu
	Ihrem Rechner zu senden.</para>

      <para>Die obige Information wird von einem
	<acronym>DNS</acronym>-Server verwaltet.  Der
	<acronym>DNS</acronym>-Eintrag, der die Information zum
	E-Mail-Routing enthält, ist der <acronym>MX</acronym>-Eintrag.
	Existiert kein <acronym>MX</acronym>-Eintrag, werden E-Mails
	direkt über die IP-Adresse an den Rechner geliefert.</para>

      <para>Der <acronym>MX</acronym>-Eintrag für <systemitem
	  class="fqdomainname">freefall.FreeBSD.org</systemitem> sah
	einmal so aus:</para>

      <programlisting>freefall		MX	30	mail.crl.net
freefall		MX	40	agora.rdrop.com
freefall		MX	10	freefall.FreeBSD.org
freefall		MX	20	who.cdrom.com</programlisting>

      <para><systemitem>freefall</systemitem> hatte viele
	<acronym>MX</acronym>-Einträge.  Die kleinste
	<acronym>MX</acronym>-Nummer definiert de Rechner, der die
	E-Mails direkt empfängt, wobei die anderen Rechner temporär
	E-Mails in Warteschlangen einreihen, falls
	<systemitem>freefall</systemitem> beschäftigt oder
	unerreichbar ist.</para>

      <para>Es ist sehr sinnvoll, dass stellvertretende
	<acronym>MX</acronym>-Seiten separate Internet-Verbindungen
	verwenden.  Ihr <acronym>ISP</acronym> kann diesen Dienst zur
	Verfügung stellen.</para>
    </sect2>

    <sect2 xml:id="mail-domain">
      <title>E-Mails für eine Domäne</title>

      <para>Wird ein <acronym>MTA</acronym> für ein Netzwerk
	konfiguriert, dann sollte jede E-Mail die an einen Rechner in
	dieser Domäne geschickt wird, an den <acronym>MTA</acronym>
	umgeleitet werden, damit die Benutzer ihre E-Mails vom
	zentralen Mail-Server empfangen können.</para>

      <para>Am einfachsten ist es, wenn Accounts mit gleichen
	<emphasis>Benutzernamen</emphasis> sowohl auf dem
	<acronym>MTA</acronym>, als auch auf dem System mit dem
	<acronym>MUA</acronym> existieren.  Verwenden Sie
	&man.adduser.8;, um Benutzerkonten anzulegen.</para>

      <para>Der <acronym>MTA</acronym> muss auf jeder Workstation im
	Netzwerk als der zuständige Rechner für den E-Mail-Austausch
	gekennzeichnet werden.  Dies wird in der
	<acronym>DNS</acronym>-Konfiguration über den
	<acronym>MX</acronym>-Eintrag gesteuert:</para>

      <programlisting>example.FreeBSD.org	A	204.216.27.XX		; Workstation
			MX	10 devnull.FreeBSD.org	; Mailhost</programlisting>

      <para>Diese Einstellung wird E-Mails für die Workstations zum
	<acronym>MTA</acronym> weiterleiten, egal wo der A-Eintrag
	hinzeigt.  Die E-Mails werden zum
	<acronym>MX</acronym>-Rechner gesendet.</para>

      <para>Diese Einstellung muss auf dem
	<acronym>DNS</acronym>-Server konfiguriert werden.  Besitzt
	das Netzwerk keinen eigenen <acronym>DNS</acronym>-Server,
	kontaktieren Sie Ihren <acronym>ISP</acronym> oder
	<acronym>DNS</acronym>-Verwalter.</para>

      <para>Im Folgenden ist ein Beispiel für virtuelles
	E-Mail-Hosting.  Nehmen wir an, dass für einen Kunden mit der
	Domäne <systemitem
	  class="fqdomainname">customer1.org</systemitem>, alle
	E-Mails für <systemitem
	  class="fqdomainname">customer1.org</systemitem> an
	<systemitem class="fqdomainname">mail.myhost.com</systemitem>
	gesendet werden sollen.  Der entsprechende
	<acronym>DNS</acronym>-Eintrag sollte wie folgt
	aussehen:</para>

      <programlisting>customer1.org		MX	10	mail.myhost.com</programlisting>

      <para>Wenn für die Domäne nur E-Mails verarbeitet werden sollen,
	wird für <systemitem
	  class="fqdomainname">customer1.org</systemitem>
	<emphasis>kein</emphasis> <literal>A</literal>-Eintrag
	benötigt.  Allerdings wird ein <command>ping</command> gegen
	<systemitem class="fqdomainname">customer1.org</systemitem>
	nur dann funktionieren, wenn ein <literal>A</literal>-Eintrag
	existiert.</para>

      <para>Teilen Sie dem <acronym>MTA</acronym> mit, für welche
	Domänen bzw. Hostnamen Post entgegengenommen werden soll.  Die
	beiden folgenden Methoden funktionieren für
	<application>Sendmail</application>:</para>

      <itemizedlist>
	<listitem>
	  <para>Fügen Sie die Rechnernamen in
	    <filename>/etc/mail/local-host-names</filename> hinzu,
	    wenn <literal>FEATURE(use_cw_file)</literal> verwendet
	    wird.</para>
	</listitem>

	<listitem>
	  <para>Fügen Sie eine Zeile
	    <literal>Cwyour.host.com</literal> in
	    <filename>/etc/sendmail.cf</filename> hinzu.</para>
	</listitem>
      </itemizedlist>
    </sect2>
  </sect1>

  <sect1 xml:id="outgoing-only">
    <info>
      <title>Ausgehende E-Mail über einen Relay versenden</title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>Bill</firstname>
	    <surname>Moran</surname>
	  </personname>
	  <contrib>Beigetragen von </contrib>
	</author>
      </authorgroup>
    </info>

    <para>In vielen Fällen möchte man E-Mail nur über
      einen Relay verschicken.  Zum Beispiel:</para>

    <itemizedlist>
      <listitem>
	<para>Der Rechner ist ein Arbeitsplatzrechner und benutzt
	  Programme wie &man.send-pr.1; über ein Relay des
	  <acronym>ISP</acronym>.</para>
      </listitem>

      <listitem>
	<para>Ein Server, der E-Mails nicht selbst verarbeitet,
	  soll alle E-Mails zu einem Relay schicken.</para>
      </listitem>
    </itemizedlist>

    <para>Obwohl jeder <acronym>MTA</acronym> diese Aufgabe erfüllen
      kann, ist es oft schwierig einen vollwertigen
      <acronym>MTA</acronym> so zu konfigurieren, dass er lediglich
      ausgehende E-Mails weiterleitet.  Es ist übertrieben, Programme
      wie <application>Sendmail</application> und
      <application>Postfix</application> nur für diesen Zweck
      einzusetzen.</para>

    <para>Weiterhin kann es sein, dass die Bestimmungen des
      Internetzugangs es verbieten, einen eigenen Mail-Server
      zu betreiben.</para>

    <para>Um die hier beschriebenen Anforderungen zu erfüllen,
      installieren Sie einfach den Port
      <package>mail/ssmtp</package>:</para>

    <screen>&prompt.root; <userinput>cd /usr/ports/mail/ssmtp</userinput>
&prompt.root; <userinput>make install replace clean</userinput></screen>

    <para>Nach der Installation kann
      <package>mail/ssmtp</package> über
      <filename>/usr/local/etc/ssmtp/ssmtp.conf</filename>
      konfiguriert werden:</para>

    <programlisting>root=yourrealemail@example.com
mailhub=mail.example.com
rewriteDomain=example.com
hostname=_HOSTNAME_</programlisting>

    <para>Verwenden Sie eine gültige E-Mail-Adresse für
      <systemitem class="username">root</systemitem>.  Geben Sie für
      <systemitem class="fqdomainname">mail.example.com</systemitem>
      den Mail-Relay des <acronym>ISP</acronym>s an.  Einige
      <acronym>ISP</acronym>s nennen den Relay
      <quote>Postausgangsserver</quote> oder
      <quote>SMTP-Server</quote>.</para>

    <para>Deaktivieren Sie <application>Sendmail</application>,
      einschließlich des Services für den Postausgang.  Details finden
      Sie in <xref linkend="mail-disable-sendmail"/>.</para>

    <para><package>mail/ssmtp</package> verfügt über weitere Optionen.
      Die Beispiele in <filename>/usr/local/etc/ssmtp</filename> oder
      die Manualpage von <application>ssmtp</application> enthalten
      weitere Informationen.</para>

    <para>Wird <application>ssmtp</application> wie hier
      beschrieben eingerichtet, können Anwendungen E-Mails von dem
      lokalen Rechner verschicken.  Man verstößt damit auch nicht
      gegen Bestimmungen des <acronym>ISP</acronym>s und läuft
      nicht Gefahr, dass der Rechner zum Versenden von Spam
      missbraucht wird.</para>
  </sect1>

  <sect1 xml:id="SMTP-dialup">
    <title>E-Mail über Einwahl-Verbindungen</title>

    <para>Wird eine feste IP-Adresse verwendet, müssen die
      Standardeinstellungen wahrscheinlich gar nicht geändert
      werden.  Stellen Sie den Hostnamen auf den entsprechend
      zugeordneten Internetnamen ein und
      <application>Sendmail</application> übernimmt
      das Übrige.</para>

    <para>Bei der Verwendung einer dynamisch zugewiesenen IP-Adresse
      und einer <acronym>PPP</acronym>-Wählverbindung mit dem
      Internet, hat man in der Regel ein Postfach auf dem Mailserver
      des <acronym>ISP</acronym>.  In diesem Beispiel ist die Domäne
      des <acronym>ISP</acronym> <systemitem
	class="fqdomainname">example.net</systemitem>, der
      Benutzername ist <systemitem class="username">user</systemitem>,
      der Rechnername ist <systemitem
	class="fqdomainname">bsd.home</systemitem> und der
      <acronym>ISP</acronym> erlaubt es, <systemitem
	class="fqdomainname">relay.example.net</systemitem> als
      Mail-Relayhost zu benutzen.</para>

    <para>Um Mails aus der Mailbox des <acronym>ISP</acronym>s
      abzuholen, muss ein gesondertes Programm aus der Ports-Sammlung
      installiert werden.  <package>mail/fetchmail</package> ist eine
      gute Wahl, weil es viele verschiedene Protokolle unterstützt.
      Für gewöhnlich stellt der <acronym>ISP</acronym>
      <acronym>POP</acronym> zur Verfügung.  Falls
      User-<acronym>PPP</acronym> verwendet wird, können durch
      folgenden Eintrag in <filename>/etc/ppp/ppp.linkup</filename>
      E-Mails automatisch abgerufen werden, sobald eine Verbindung zum
      Netz aufgebaut wird:</para>

    <programlisting>MYADDR:
!bg su user -c fetchmail</programlisting>

    <para>Wird <application>Sendmail</application> benutzt, um E-Mails
      an nicht-lokale Benutzer zu versenden, konfigurieren Sie es so,
      dass die Warteschlange abgearbeitet wird, sobald eine Verbindung
      mit dem Internet besteht.  Um dies zu erreichen, müssen folgende
      Zeilen nach dem <command>fetchmail</command>-Eintrag in
      <filename>/etc/ppp/ppp.linkup</filename> hinzugefügt
      werden.</para>

    <programlisting>!bg su user -c "sendmail -q"</programlisting>

    <para>In diesem Beispiel existiert auf <systemitem
	class="fqdomainname">bsd.home</systemitem> ein Benutzer
      <systemitem class="username">user</systemitem>.
      Erstellen Sie auf <systemitem
        class="fqdomainname">bsd.home</systemitem> im
      Heimatverzeichnis von <systemitem
        class="username">user</systemitem> die Datei
      <filename>.fetchmailrc</filename> mit folgender
      Zeile:</para>

    <programlisting>poll example.net protocol pop3 fetchall pass MySecret;</programlisting>

    <para>Diese Datei sollte für niemandem außer
      <systemitem class="username">user</systemitem> lesbar sein, weil sie das
      Passwort <literal>MySecret</literal> enthält.</para>

    <para>Um Mails mit dem richtigen <literal>from:</literal>-Header
      zu versenden, müssen Sie <application>Sendmail</application> so
      konfigurieren, dass es <email>user@example.net</email> und nicht
      <email>user@bsd.home</email> benutzen soll und das alle Mails
      über <systemitem
	class="fqdomainname">relay.example.net</systemitem> versendet
      werden, um eine schnellere Übertragung von Mails zu
      gewährleisten.</para>

    <para>Die folgende <filename>.mc</filename> sollte
      ausreichen:</para>

    <programlisting>VERSIONID(`bsd.home.mc version 1.0')
OSTYPE(bsd4.4)dnl
FEATURE(nouucp)dnl
MAILER(local)dnl
MAILER(smtp)dnl
Cwlocalhost
Cwbsd.home
MASQUERADE_AS(`example.net')dnl
FEATURE(allmasquerade)dnl
FEATURE(masquerade_envelope)dnl
FEATURE(nocanonify)dnl
FEATURE(nodns)dnl
define(`SMART_HOST', `relay.example.net')
Dmbsd.home
define(`confDOMAIN_NAME',`bsd.home')dnl
define(`confDELIVERY_MODE',`deferred')dnl</programlisting>

    <para>Im vorherigen Abschnitt finden Sie Details dazu, wie
      Sie diese Datei in das Format <filename>sendmail.cf</filename>
      konvertieren können.  Vergessen Sie nicht,
      <application>Sendmail</application> neu zu starten,
      nachdem <filename>sendmail.cf</filename> verändert wurde.</para>
  </sect1>

  <sect1 xml:id="SMTP-Auth">
    <info>
      <title>SMTP-Authentifizierung</title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>James</firstname>
	    <surname>Gorham</surname>
	  </personname>
	  <contrib>Geschrieben von </contrib>
	</author>
      </authorgroup>
    </info>

    <para>Die Konfiguration von
      <acronym>SMTP</acronym>-Authentifizierung auf dem
      <acronym>MTA</acronym> bietet einige Vorteile.  Die
      erforderliche Authentifizierung erhöht die Sicherheit von
      <application>Sendmail</application> und mobilen Benutzern, die
      auf entfernten Rechnern arbeiten.  Diese Benutzer können
      denselben <acronym>MTA</acronym> verwenden, ohne jedes Mal das
      Benutzerprogramm neu konfigurieren zu müssen.</para>

    <procedure>
      <step>
	<para>Installieren Sie <package>security/cyrus-sasl2</package>
	  aus der Ports-Sammlung.  Dieser Port verfügt über einige
	  Optionen, die während der Übersetzung festgelegt werden.
	  Für die in diesem Abschnitt beschriebene Methode zur
	  SMTP-Authentifizierung muss die Option
	  <option>LOGIN</option> aktiviert werden.</para>
      </step>

      <step>
	<para>Nach der Installation von
	  <package>security/cyrus-sasl2</package> editieren Sie
	  <filename>/usr/local/lib/sasl2/Sendmail.conf</filename>.
	  Erstellen Sie die Datei, wenn sie nicht existiert und fügen
	  Sie die folgende Zeile hinzu:</para>

	<programlisting>pwcheck_method: saslauthd</programlisting>
      </step>

      <step>
	<para>Als nächstes installieren Sie
	  <package>security/cyrus-sasl2-saslauthd</package>,
	  und fügen die folgende Zeile in
	  <filename>/etc/rc.conf</filename> ein:</para>

	<programlisting>saslauthd_enable="YES"</programlisting>

	<para>Abschließend starten Sie den saslauthd-Dämon:</para>

	<screen>&prompt.root; <userinput>service saslauthd start</userinput></screen>

	<para>Dieser Dämon agiert als Broker zwischen
	  <application>Sendmail</application> und der
	  &os;-<filename>passwd</filename>-Datenbank.  Dadurch
	  müssen zum Versenden von E-Mails keine zusätzlichen
	  Accounts und Passwörter angelegt werden.  Die Benutzer
	  verwenden dasselbe Passwort zum Anmelden wie zum Verschicken
	  von E-Mails.</para>
      </step>

      <step>
	<para>Fügen Sie danach in <filename>/etc/make.conf</filename>
	  die folgenden Zeilen hinzu:</para>

	<programlisting>SENDMAIL_CFLAGS=-I/usr/local/include/sasl -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl2</programlisting>

	<para>Beim Übersetzen von <application>Sendmail</application>
	  werden damit die <package>cyrus-sasl2</package>-Bibliotheken
	  benutzt.  Stellen Sie daher vor dem Übersetzen von
	  <application>Sendmail</application> sicher, dass
	  <package>cyrus-sasl2</package> installiert
	  ist.</para>
      </step>

      <step>
	<para>Übersetzen Sie <application>Sendmail</application> mit
	  den nachstehenden Kommandos:</para>

	<screen>&prompt.root; <userinput>cd /usr/src/lib/libsmutil</userinput>
&prompt.root; <userinput>make cleandir &amp;&amp; make obj &amp;&amp; make</userinput>
&prompt.root; <userinput>cd /usr/src/lib/libsm</userinput>
&prompt.root; <userinput>make cleandir &amp;&amp; make obj &amp;&amp; make</userinput>
&prompt.root; <userinput>cd /usr/src/usr.sbin/sendmail</userinput>
&prompt.root; <userinput>make cleandir &amp;&amp; make obj &amp;&amp; make &amp;&amp; make install</userinput></screen>

	<para>Die Übersetzung sollte keine Probleme bereiten, wenn
	  <filename>/usr/src</filename> nicht umfangreich verändert
	  wurde und die benötigten Bibliotheken installiert
	  sind.</para>
      </step>

      <step>
	<para>Nachdem <application>Sendmail</application> übersetzt
	  und installiert wurde, editieren Sie
	  <filename>/etc/mail/freebsd.mc</filename> beziehungsweise
	  die lokale <filename>.mc</filename>-Datei.  Viele
	  Administratoren verwenden die Ausgabe von &man.hostname.1;,
	  um der <filename>.mc</filename> einen eindeutigen
	  Namen zu geben.  Fügen Sie die folgenden Zeilen
	  hinzu:</para>

	<programlisting>dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confAUTH_MECHANISMS', `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl</programlisting>

	<para>Diese Anweisungen konfigurieren die Methoden, die
	  <application>Sendmail</application> zur Authentifizierung
	  von Benutzern verwendet.  Lesen Sie die
	  <application>Sendmail</application> Dokumentation, wenn eine
	  andere Methode als <option>pwcheck</option> verwendet werden
	  soll.</para>
      </step>

      <step>
	<para>Abschließend rufen Sie &man.make.1; in
	  <filename>/etc/mail</filename> auf.  Damit wird aus der
	  <filename>.mc</filename>-Datei eine neue
	  <filename>.cf</filename>-Datei erzeugt.  Der Name ist
	  entweder <filename>freebsd.cf</filename> oder der Name der
	  lokalen <filename>.mc</filename>-Datei.
	  <command>make install restart</command> installiert die
	  Datei nach <filename>/etc/mail/sendmail.cf</filename> und
	  startet <application>Sendmail</application> neu.  Weitere
	  Informationen zu diesem Vorgang entnehmen Sie bitte
	  <filename>/etc/mail/Makefile</filename>.</para>
      </step>
    </procedure>

    <para>Um die Konfiguration zu testen, verwenden Sie einen
      <acronym>MUA</acronym>, um eine Testnachricht zu senden.
      Mail-Benutzerprogramm das Passwort für die Authentifizierung ein
      und versenden Sie zum Testen eine E-Mail.  Zur Fehlersuche,
      setzen Sie den <option>LogLevel</option> von
      <application>Sendmail</application> auf <literal>13</literal>
      und untersuchen die Fehlermeldungen in
      <filename>/var/log/maillog</filename>.</para>

    <para>Weitere Information finden Sie unter
      <link
	xlink:href="http://www.sendmail.org/~ca/email/auth.html">
	<acronym>SMTP</acronym>-Authentifizierung</link>.</para>
  </sect1>

  <sect1 xml:id="mail-agents">
    <info>
      <title>E-Mail-Programme</title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>Marc</firstname>
	    <surname>Silver</surname>
	  </personname>
	  <contrib>Beigetragen von </contrib>
	</author>
      </authorgroup>
    </info>

    <indexterm>
      <primary>Mail-User-Agents</primary>
    </indexterm>

    <indexterm>
      <primary>E-Mail-Programme</primary>
    </indexterm>

    <para>Anwendungen, die E-Mails versenden und empfangen, werden als
      E-Mail-Programme oder Mail-User-Agents (<acronym>MUA</acronym>)
      bezeichnet.  Mit der Entwicklung und Ausbreitung von E-Mail
      wachsen auch die E-Mail-Programme und bieten Benutzern mehr
      Funktionen und höhere Flexibilität.  Die Kategorie
      <literal>mail</literal> der &os; Ports-Sammlung enthält
      zahlreiche E-Mail-Programme.  Dazu gehören grafische Programme,
      wie beispielsweise <application>Evolution</application> oder
      <application>Balsa</application> und Konsolen basierte Programme
      wie <application>mutt</application> oder
      <application>alpine</application>.</para>

    <sect2 xml:id="mail-command">
      <title><command>mail</command></title>

      <para>Das standardmäßig unter &os; installierte
	E-Mail-Programm ist &man.mail.1;.  Das Programm ist
	konsolenorientiert und enthält alle Funktionen,
	die zum Versand und Empfang textbasierter
	E-Mails erforderlich sind.  Es bietet eine begrenzte
	Unterstützung für Anhänge und kann auf lokale Postfächer
	zugreifen.</para>

      <para><command>mail</command> kann nicht direkt auf
	<acronym>POP</acronym>- oder <acronym>IMAP</acronym>-Server
	zugreifen.  Entfernte Postfächer können aber
	mit einer Anwendung wie <application>fetchmail</application>
	in eine lokale <filename>mbox</filename> geladen
	werden.</para>

      <para>Um E-Mails zu versenden oder zu empfangen, starten
	Sie einfach <command>mail</command> wie im nachstehenden
	Beispiel:</para>

      <screen>&prompt.user; <userinput>mail</userinput></screen>

      <para><command>mail</command> liest automatisch
	den Inhalt des Benutzer-Postfachs im Verzeichnis
	<filename>/var/mail</filename>.  Sollte
	das Postfach leer sein, beendet sich <command>mail</command>
	mit der Nachricht, dass keine E-Mails vorhanden sind.
	Wenn E-Mails vorhanden sind, wird die Benutzeroberfläche
	gestartet und eine Liste der E-Mails angezeigt.
	Die E-Mails werden automatisch nummeriert wie
	im folgenden Beispiel gezeigt:</para>

      <screen>Mail version 8.1 6/6/93.  Type ? for help.
"/var/mail/marcs": 3 messages 3 new
&gt;N  1 root@localhost        Mon Mar  8 14:05  14/510   "test"
 N  2 root@localhost        Mon Mar  8 14:05  14/509   "user account"
 N  3 root@localhost        Mon Mar  8 14:05  14/509   "sample"</screen>

      <para>Einzelne Nachrichten können nun durch Eingabe von
	<keycap>t</keycap> gefolgt von der Nummer der Nachricht
	gelesen werden.  Im nachstehenden Beispiel wird die erste
	E-Mail gelesen:</para>

      <screen>&amp; <userinput>t 1</userinput>
Message 1:
From root@localhost  Mon Mar  8 14:05:52 2004
X-Original-To: marcs@localhost
Delivered-To: marcs@localhost
To: marcs@localhost
Subject: test
Date: Mon,  8 Mar 2004 14:05:52 +0200 (SAST)
From: root@localhost (Charlie Root)

Das ist eine Test-Nachricht.  Antworte bitte!</screen>

      <para>Wie in diesem Beispiel zu sehen ist, wird die Nachricht
	zusammen mit dem vollständigen Nachrichtenkopf angezeigt.
	Um die Liste der E-Mails erneut zu sehen, drücken Sie wieder
	die Taste <keycap>h</keycap>.</para>

      <para>Um auf eine E-Mail zu antworten, benutzen Sie
	entweder <keycap>R</keycap> oder <keycap>r</keycap>.
	<keycap>R</keycap> weist <command>mail</command> an, dem
	Versender der Nachricht zu antworten, während mit
	<keycap>r</keycap> allen Empfängern der Nachricht geantwortet
	wird.  Den Kommandos kann die Zahl der E-Mail, auf die
	geantwortet werden soll, mitgegeben werden.  Nachdem die
	Antwort E-Mail verfasst worden ist, sollte die Eingabe mit
	einem einzelnen Punkt (<keycap>.</keycap>) auf einer neuen
	Zeile abgeschlossen werden.  Hierzu ein Beispiel:</para>

      <screen>&amp; <userinput>R 1</userinput>
To: root@localhost
Subject: Re: test

<userinput>Danke, ich habe deine E-Mail erhalten.
.</userinput>
EOT</screen>

      <para>Neue E-Mails können mit <keycap>m</keycap>, gefolgt von
	der E-Mail-Adresse des Empfängers verschickt werden.  Mehrere
	Empfänger werden durch Kommata (<keycap>,</keycap>) getrennt,
	angegeben.  Der Betreff
	(<foreignphrase>subject</foreignphrase>) der Nachricht kann
	dann, gefolgt vom Inhalt der Nachricht eingegeben werden.
	Die Nachricht wird dann mit einem einzelnen Punkt
	(<keycap>.</keycap>) auf einer neuen Zeile
	abgeschlossen.</para>

      <screen>&amp; <userinput>mail root@localhost</userinput>
Subject: <userinput>Ich habe die E-Mails im Griff!

Jetzt kann ich E-Mails versenden und empfangen ... :)
.</userinput>
EOT</screen>

      <para>Die Taste <keycap>?</keycap> zeigt zu jeder Zeit
	einen Hilfetext an.  Lesen Sie &man.mail.1;, wenn Sie weitere
	Hilfe zur Benutzung von <command>mail</command> erhalten
	möchten.</para>

      <note>
	<para>&man.mail.1; wurde nicht für den Umgang mit Anhängen
	  entworfen und kann daher sehr schlecht mit Anhängen umgehen.
	  Neuere <acronym>MUA</acronym>s gehen wesentlich besser
	  mit Anhängen um.  Benutzer, die <command>mail</command>
	  bevorzugen, werden vielleicht den Port
	  <package>converters/mpack</package> zu schätzen
	  wissen.</para>
      </note>
    </sect2>

    <sect2 xml:id="mutt-command">
      <title><application>mutt</application></title>

      <para><application>mutt</application> ist ein leistungsfähiges
	E-Mail-Programm mit vielen Funktionen, darunter:</para>

      <itemizedlist>
	<listitem>
	  <para><application>mutt</application> kann den Verlauf
	    einer Diskussion
	    (<foreignphrase>threading</foreignphrase>)
	    darstellen.</para>
	</listitem>

	<listitem>
	  <para>Unterstützung von PGP für das digitale
	    signieren und verschlüsseln von E-Mail.</para>
	</listitem>

	<listitem>
	  <para>MIME-Unterstützung.</para>
	</listitem>

	<listitem>
	  <para>Maildir-Unterstützung.</para>
	</listitem>

	<listitem>
	  <para><application>mutt</application> lässt sich
	    im höchsten Maße an lokale Bedürfnisse
	    anpassen.</para>
	</listitem>
      </itemizedlist>

      <para>Mehr über <application>mutt</application> erfahren Sie auf
	der Seite <uri
	  xlink:href="http://www.mutt.org">
	  http://www.mutt.org</uri>.</para>

      <para><application>mutt</application> kann über den Port
	<package>mail/mutt</package> installiert werden.  Nachdem der
	Port installiert ist, kann <application>mutt</application>
	mit dem folgenden Befehl gestartet werden:</para>

      <screen>&prompt.user; <userinput>mutt</userinput></screen>

      <para><application>mutt</application> liest automatisch den
	Inhalt des Benutzer-Postfachs im Verzeichnis
	<filename>/var/mail</filename>.  Sind keine E-Mails vorhanden,
	wartet <application>mutt</application> auf Benutzereingaben.
	Das folgende Beispiel zeigt, wie
	<application>mutt</application> eine Nachrichten-Liste
	darstellt:</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/mutt1"/>
	</imageobject>
      </mediaobject>

      <para>Um eine E-Mail zu lesen, wählen Sie die Nachricht einfach
	mit den Pfeiltasten aus und drücken
	<keycap>Enter</keycap>.  <application>mutt</application>
	zeigt E-Mails wie folgt an:</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/mutt2"/>
	</imageobject>
      </mediaobject>

      <para>Änlich wie &man.mail.1;, kann auch
	<application>mutt</application> verwendet werden, um nur dem
	Absender, oder auch allen anderen Empfängern zu antworten.  Um
	nur dem Absender der E-Mail zu antworten, drücken Sie
	<keycap>r</keycap>.  Um sowohl dem Absender, als auch allen
	anderen Empfängern zu antworten, drücken Sie
	<keycap>g</keycap>.</para>

      <note>
	<para>Zum Erstellen oder zum Beantworten von E-Mails
	  ruft <application>mutt</application> den Editor
	  &man.vi.1; auf.  Jeder Benutzer kann diese Einstellung
	  anpassen, indem die Variable <literal>editor</literal> in
	  <filename>.muttrc</filename> im Heimatverzeichnis gesetzt
	  wird, oder die Umgebungsvariable <envar>EDITOR</envar>
	  entsprechend angepasst wird.  Weitere Informationen zur
	  Konfiguration von <application>mutt</application> finden Sie
	  unter <uri
	    xlink:href="http://www.mutt.org/">
	    http://www.mutt.org/</uri>.</para>
      </note>

      <para>Drücken Sie <keycap>m</keycap>, um eine neue Nachricht zu
	verfassen.  Nachdem der Betreff
	(<foreignphrase>subject</foreignphrase>) eingegeben wurde,
	startet <application>mutt</application> den &man.vi.1; und
	die Nachricht kann verfasst werden.  Wenn Sie fertig sind,
	speichern Sie die Nachricht und verlassen den &man.vi.1;.
	<application>mutt</application> wird dann wieder aktiv
	und zeigt eine Zusammenfassung der zu sendenden Nachricht
	an.  Drücken Sie <keycap>y</keycap>, um die E-Mail
	zu versenden.  Der nachstehende Bildschirmabzug zeigt die
	Zusammenfassung der E-Mail:</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/mutt3"/>
	</imageobject>
      </mediaobject>

      <para><application>mutt</application> verfügt über
	eine umfangreiche Hilfestellung.  Aus fast jedem Menü
	können Hilfeseiten mit <keycap>?</keycap> aufgerufen werden.
	In der oberen Statuszeile werden zudem die
	verfügbaren Tastenkombinationen angezeigt.</para>
    </sect2>

    <sect2 xml:id="alpine-command">
      <title><application>alpine</application></title>

      <para><application>alpine</application> wendet sich an
	Anfänger bietet aber ebenfalls einige Funktionen
	für Profis.</para>

      <warning>
	<para>In der Vergangenheit wurden in
	  <application>alpine</application> mehrere Schwachstellen
	  gefunden.  Die Schwachstellen gestatteten entfernten
	  Benutzern, durch das Versenden einer besonders verfassten
	  E-Mail, Programme auf dem lokalen System laufen
	  zu lassen.  Alle <emphasis>bekannten</emphasis>
	  Schwachstellen sind beseitigt worden, doch wird im
	  Quellcode von <application>alpine</application> ein
	  sehr riskanter Programmierstil verwendet, sodass der
	  &os;-Security-Officer von weiteren unbekannten
	  Schwachstellen ausgeht.  Benutzer installieren
	  <application>alpine</application> auf eigene
	  Verantwortung!</para>
      </warning>

      <para>Der Port <package>mail/alpine</package>
	enthält die aktuelle Version von
	<application>alpine</application>.  Nach der Installation
	können Sie <application>alpine</application> mit dem
	nachstehenden Kommando starten:</para>

      <screen>&prompt.user; <userinput>alpine</userinput></screen>

      <para>Beim ersten Start von <application>alpine</application>,
	zeigt das Programm eine Seite mit einer kurzen Einführung an.
	Um die <application>alpine</application>-Benutzer zu zählen,
	bitten die Entwickler auf dieser Seite um eine anonyme E-Mail.
	Sie können diese anonyme E-Mail senden, indem Sie
	<keycap>Enter</keycap> drücken oder den
	Begrüßungsbildschirm mit der Taste
	<keycap>E</keycap> verlassen, ohne die anonyme E-Mail
	zu senden.  Der Begrüßungsbildschirm
	sieht wie folgt aus:</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/pine1"/>
	</imageobject>
      </mediaobject>

      <para>Nach dem Begrüßungsbildschirm wird das
	Hauptmenü dargestellt, das sich mit den
	Pfeiltasten bedienen lässt.  Über Tastenkombinationen
	können aus dem Hauptmenü neue E-Mails erstellt, Postfächer
	angezeigt und das Adressbuch verwaltet werden.  Unterhalb des
	Menüs werden die Tastenkombinationen für die verfügbaren
	Aktionen angezeigt.</para>

      <para>In der Voreinstellung öffnet
	<application>alpine</application> das Verzeichnis
	<filename>inbox</filename>.
	Die Taste <keycap>I</keycap> oder der Menüpunkt
	<guimenuitem>MESSAGE INDEX</guimenuitem> führt
	zu einer Nachrichten-Liste:</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/pine2"/>
	</imageobject>
      </mediaobject>

      <para>Die Liste zeigt die Nachrichten im Arbeitsverzeichnis.
	Sie können Nachrichten mit den Pfeiltasten markieren.
	Um eine Nachricht zu lesen, drücken Sie
	<keycap>Enter</keycap>.</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/pine3"/>
	</imageobject>
      </mediaobject>

      <para>Im nächsten Bildschirmabzug sehen Sie, wie
	<application>alpine</application> eine Nachricht darstellt.
	Die unteren Bildschirmzeilen zeigen die verfügbaren
	Tastenkombinationen.  Mit <keycap>r</keycap>
	können Sie zum Beispiel auf die gerade angezeigte
	Nachricht antworten.</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/pine4"/>
	</imageobject>
      </mediaobject>

      <para>Zum Antworten auf eine E-Mail wird in
	<application>alpine</application> der Editor
	<application>pico</application>, der mit installiert wird,
	benutzt.  <application>pico</application> ist leicht
	zu bedienen und gerade für Anfänger besser
	geeignet als &man.vi.1; oder &man.mail.1;.  Die Antwort
	wird mit der Tastenkombination
	<keycombo action="simul">
	  <keycap>Ctrl</keycap>
	  <keycap>X</keycap>
	</keycombo>
	versendet.  Vor dem Versand bittet <application>alpine</application>
	noch um eine Bestätigung.</para>

      <mediaobject>
	<imageobject>
	  <imagedata fileref="mail/pine5"/>
	</imageobject>
      </mediaobject>

      <para>Über den Menüpunkt <guimenuitem>SETUP</guimenuitem>
	des Hauptmenüs können Sie <application>alpine</application>
	an Ihre Bedürfnisse anpassen.  Erläuterungen
	dazu finden Sie auf der Seite
	<uri xlink:href="http://www.washington.edu/pine/">http://www.washington.edu/pine/</uri>.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="mail-fetchmail">
    <info>
      <title>E-Mails mit <application>fetchmail</application>
	abholen</title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>Marc</firstname>
	    <surname>Silver</surname>
	  </personname>
	  <contrib>Beigetragen von </contrib>
	</author>
      </authorgroup>
    </info>

    <indexterm>
      <primary>fetchmail</primary>
    </indexterm>

    <para><application>fetchmail</application> ist ein vollwertiger
      <acronym>IMAP</acronym>- und <acronym>POP</acronym>-Client.
      Mit <application>fetchmail</application> können Benutzer
      E-Mails von entfernten <acronym>IMAP</acronym>- und
      <acronym>POP</acronym>-Servern in leichter zugängliche
      lokale Postfächer laden.  <application>fetchmail</application>
      wird aus dem Port <package>mail/fetchmail</package>
      installiert.  Das Programm bietet unter anderem folgende
      Funktionen:</para>

    <itemizedlist>
      <listitem>
	<para><application>fetchmail</application> beherrscht die
	  Protokolle <acronym>POP3</acronym>,
	  <acronym>APOP</acronym>, <acronym>KPOP</acronym>,
	  <acronym>IMAP</acronym>, <acronym>ETRN</acronym> und
	  <acronym>ODMR</acronym>.</para>
      </listitem>

      <listitem>
	<para>E-Mails können mit <acronym>SMTP</acronym>
	  weiterverarbeitet werden.  Dadurch ist garantiert, dass
	  Filter, Weiterleitungen und Aliase weiterhin
	  funktionieren.</para>
      </listitem>

      <listitem>
	<para>Das Programm kann als Dienst laufen und periodisch
	  neue Nachrichten abrufen.</para>
      </listitem>

      <listitem>
	<para><application>fetchmail</application> kann mehrere
	  Postfächer abfragen und je nach Konfiguration
	  die E-Mails an verschiedene lokale Benutzer
	  zustellen.</para>
      </listitem>
    </itemizedlist>

    <para>Dieser Abschnitt erklärt einige grundlegende Funktionen von
      <application>fetchmail</application>.  Das Programm benötigt
      eine Konfigurationsdatei <filename>.fetchmailrc</filename> im
      Heimatverzeichnis des Benutzers.  In dieser Datei werden
      Informationen über Server wie auch Benutzerdaten und Passwörter
      hinterlegt.  Wegen des kritischen Inhalts dieser Datei ist es
      ratsam, diese nur für den Benutzer lesbar zu machen:</para>

    <screen>&prompt.user; <userinput>chmod 600 .fetchmailrc</userinput></screen>

    <para>Die folgende <filename>.fetchmailrc</filename> zeigt, wie
      das Postfach eines einzelnen Benutzers mit
      <acronym>POP</acronym> heruntergeladen wird.
      <application>fetchmail</application> wird angewiesen, eine
      Verbindung zu <systemitem
	class="fqdomainname">example.com</systemitem> herzustellen und
      sich dort als Benutzer <systemitem
	class="username">joesoap</systemitem> mit dem Passwort
      <literal>XXX</literal> anzumelden.  Das Beispiel setzt voraus,
      dass der Benutzer <systemitem
	class="username">joesoap</systemitem> auch auf dem lokalen
      System existiert.</para>

    <programlisting>poll example.com protocol pop3 username "joesoap" password "XXX"</programlisting>

    <para>Im folgenden Beispiel werden mehrere <acronym>POP</acronym>-
      und <acronym>IMAP</acronym>-Server benutzt.  Wo notwendig,
      werden E-Mails auf andere lokale Konten umgeleitet:</para>

    <programlisting>poll example.com proto pop3:
user "joesoap", with password "XXX", is "jsoap" here;
user "andrea", with password "XXXX";
poll example2.net proto imap:
user "john", with password "XXXXX", is "myth" here;</programlisting>

    <para><application>fetchmail</application> kann als Dämon
      gestartet werden.  Verwendet wird dazu die Kommandozeilenoption
      <option>-d</option> gefolgt von einer Zeitspanne in Sekunden,
      die angibt, wie oft die Server aus
      <filename>.fetchmailrc</filename> abgefragt werden sollen.
      Mit dem nachstehenden Befehl fragt
      <application>fetchmail</application> die Server alle
      600&nbsp;Sekunden ab:</para>

    <screen>&prompt.user; <userinput>fetchmail -d 600</userinput></screen>

    <para>Mehr über <application>fetchmail</application> erfahren Sie
      auf der Seite <uri xlink:href="http://www.fetchmail.info/">
	http://www.fetchmail.info/</uri>.</para>
  </sect1>

  <sect1 xml:id="mail-procmail">
    <info>
      <title>E-Mails mit <application>procmail</application>
	filtern</title>

      <authorgroup>
	<author>
	  <personname>
	    <firstname>Marc</firstname>
	    <surname>Silver</surname>
	  </personname>
	  <contrib>Beigetragen von </contrib>
	</author>
      </authorgroup>
    </info>

    <indexterm>
      <primary>procmail</primary>
    </indexterm>

    <para><application>procmail</application> ist ein mächtiges
      Werkzeug, mit dem sich eingehende E-Mails filtern lassen.
      Benutzer können Regeln für eingehende E-Mails definieren, die
      E-Mails zu anderen Postfächern oder anderen E-Mail-Adressen
      umleiten.  <application>procmail</application> befindet
      sich im Port <package>mail/procmail</package>.
      <application>procmail</application> kann leicht in die
      meisten <acronym>MTA</acronym>s integriert werden.  Lesen
      Sie dazu bitte die Dokumentation des verwendeten
      <acronym>MTA</acronym>s.  Alternativ kann
      <application>procmail</application> in das E-Mail-System
      eingebunden werden, indem die nachstehende Zeile in
      die Datei <filename>.forward</filename> im Heimatverzeichnis
      eines Benutzers eingefügt wird:</para>

    <programlisting>"|exec /usr/local/bin/procmail || exit 75"</programlisting>

    <para>Der folgende Abschnitt zeigt einige einfache
      <application>procmail</application>-Regeln sowie eine kurze
      Beschreibung dessen, was sie tun.  Regeln müssen in
      <filename>.procmailrc</filename> im Heimatverzeichnis des
      Benutzers eingefügt werden.</para>

    <para>Den Großteil dieser Regeln finden Sie auch
      in &man.procmailex.5;.</para>

    <para>Um E-Mails von <email>user@example.com</email>
      an die externe Adresse <email>goodmail@example2.com</email>
      weiterzuleiten:</para>

    <programlisting>:0
* ^From.*user@example.com
! goodmail@example2.com</programlisting>

    <para>Um E-Mails, die kürzer als 1000&nbsp;Bytes
      sind, an <email>goodmail@example2.com</email>
      weiterzuleiten:</para>

    <programlisting>:0
* &lt; 1000
! goodmail@example2.com</programlisting>

    <para>Um E-Mails, die an <email>alternate@example.com</email>
      geschickt werden, im Postfach <filename>alternate</filename> zu
      speichern:</para>

    <programlisting>:0
* ^TOalternate@example.com
alternate</programlisting>

    <para>Um E-Mails, die im Betreff <literal>Spam</literal>
      enthalten, nach <filename>/dev/null</filename> zu
      verschieben:</para>

    <programlisting>:0
^Subject:.*Spam
/dev/null</programlisting>

    <para>Zuletzt ein nützliches Rezept, das eingehende E-Mails
      von den <systemitem
	class="fqdomainname">&os;.org</systemitem>-Mailinglisten
      in ein separates Postfach für jede Liste einsortiert:</para>

    <programlisting>:0
* ^Sender:.owner-freebsd-\/[^@]+@FreeBSD.ORG
{
	LISTNAME=${MATCH}
	:0
	* LISTNAME??^\/[^@]+
	FreeBSD-${MATCH}
}</programlisting>
  </sect1>
</chapter>
