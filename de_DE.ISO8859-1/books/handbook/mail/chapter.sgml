<!--
     The FreeBSD Documentation Project
     The FreeBSD German Documentation Project

     Original Revision der ersten Uebersetzung: 1.20

     $FreeBSD$
     $FreeBSDde: de-docproj/books/handbook/mail/chapter.sgml,v 1.25 2003/05/18 15:00:33 mheinen Exp $
     basiert auf: 1.76
-->
<!--
     Ein paar Anmerkungen zur Uebersetzung bestimmter Begriffe

     ``Domain'' wurde mit ,,Domaene`` uebersetzt.
	,,TCP/IP und OCS/NFS`` (Michael Santifaller)
	FdI*

     Aus ``Host'' wurde ,,Rechner``.
	FdI* beschreibt ``Host'' als ,,Hauptrechner`` oder ,,gastgebender
	Rechner``.  Als Ausnahme wurde ``mail host'' mit ``E-Mail-Server''
	uebersetzt.


     *	Fdi = Fachausdruecke der Informationsverarbeitung -
	      Woerterbuch und Glossar (IBM 1985)
-->

<chapter id="mail">
  <chapterinfo>
    <authorgroup>
      <author>
	<firstname>Bill</firstname>
	<surname>Lloyd</surname>
	<contrib>Urspr&uuml;glicher Text von </contrib>
      </author>
    </authorgroup>
    <authorgroup>
      <author>
	<firstname>Jim</firstname>
	<surname>Mock</surname>
	<contrib>Neugeschrieben von </contrib>
	<!-- 2 Dec 1999 -->
      </author>
    </authorgroup>
    <authorgroup>
      <author>
	<firstname>Robert</firstname>
	<surname>Drehmel</surname>
      <contrib>&Uuml;bersetzt von </contrib>
      </author>
    </authorgroup>
  </chapterinfo>

  <title>Elektronische Post (E-Mail)</title>

  <sect1 id="mail-de-term">
    <title>Terminologie</title>
    <indexterm>
      <primary>E-Mail</primary>
      <secondary>Terminologie</secondary>
    </indexterm>
    <para>Das Akronym <firstterm>MTA</firstterm> steht f&uuml;r
      <firstterm>Mail Transfer Agent</firstterm> was &uuml;bersetzt
      <quote>Mail&uuml;bertragungs-Agent</quote> bedeutet.</para>
    <para>W&auml;hrend die Bezeichnung <firstterm>Server-D&auml;mon</firstterm>
      die Komponente eines MTA benennt, die f&uuml;r eingehende Verbindungen
      zust&auml;ndig ist, wird mit dem Begriff <firstterm>Mailer</firstterm>
      &ouml;fters die Komponente des MTA bezeichnet, die E-Mails versendet.
    </para>
  </sect1>

  <sect1 id="mail-synopsis">
    <title>&Uuml;bersicht</title>
    <indexterm><primary>E-Mail</primary></indexterm>
    <indexterm><primary>elektronische Post</primary></indexterm>

    <para><quote>Elektronische Post</quote>, besser bekannt als E-Mail, ist
      eine der am weit verbreitetsten Formen der Kommunikation heutzutage.
      Dieses Kapitel bietet eine grundlegende Einf&uuml;hrung in das Betreiben
      eines E-Mail-Servers unter FreeBSD.  Es ist jedoch keine komplette
      Referenz und es werden viele wichtige &Uuml;berlegungen au&szlig;er
      Acht gelassen.  Wenn Sie das Thema detaillierter betrachten
      m&ouml;chten, werden Sie bei einem der exzellenten B&uuml;cher
      f&uuml;ndig, die in <xref linkend="bibliography"> aufgelistet sind.
      </para>

    <para>Nachdem Sie dieses Kapitel gelesen haben, werden Sie wissen:</para>
    <itemizedlist>
      <listitem>
	<para>Welche Software-Komponenten beim Senden und
	  Empfangen von elektronischer Post involviert sind.</para>
      </listitem>
      <listitem>
	<para>Wo sich grundlegende <application>sendmail</application>
	Konfigurationsdateien in FreeBSD befinden.</para>
      </listitem>
      <listitem>
	<para>Wie man Versender von Massennachrichten daran hindern kann,
	  Ihren E-Mail-Server illegalerweise als Weiterleitung zu verwenden.
	  </para>
      </listitem>
      <listitem>
	<para>Wie man den Standard-Mailer des Systems,
	  <application>sendmail</application>, ersetzt.</para>
      </listitem>
      <listitem>
	<para>Wie man oft auftretende E-Mail-Server Probleme behebt.</para>
      </listitem>
      <listitem>
	<para>Wie Sie die SMTP-Authentifizierung einrichten.</para>
      </listitem>
    </itemizedlist>

    <para>Bevor Sie dieses Kapitel lesen, sollten Sie:</para>

    <itemizedlist>
      <listitem>
	<para>Ihre Netzwerk-Verbindung richtig einrichten.
	(<xref linkend="advanced-networking">).</para>
      </listitem>
      <listitem>
	<para>Die DNS-Information f&uuml;r Ihren E-Mail-Server einstellen
	  (<xref linkend="advanced-networking">).</para>
      </listitem>
      <listitem>
	<para>Wissen, wie man zus&auml;tzliche Dritthersteller-Software
	  installiert (<xref linkend="ports">).</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="mail-using">
    <title>Elektronische Post benutzen</title>
    <indexterm><primary>POP</primary></indexterm>
    <indexterm><primary>IMAP</primary></indexterm>
    <indexterm><primary>DNS</primary></indexterm>

    <para>F&uuml;nf gr&ouml;&szlig;ere Teile sind am E-Mail-Austausch beteiligt:
      <link linkend="mail-mua">Das Benutzerprogramm</link>,
      <link linkend="mail-mta">der Server-D&auml;mon</link>,
      <link linkend="mail-dns">DNS</link>,
      <link linkend="mail-receive">ein POP- oder IMAP-D&auml;mon</link>
      und nat&uuml;rlich
      <link linkend="mail-host">der E-Mail-Server</link> selbst.</para>

    <sect2 id="mail-mua">
      <title>Das Benutzerprogramm</title>

      <para>Das beinhaltet Kommandozeilenprogramme wie
        <application>mutt</application>, <application>pine</application>,
	<application>elm</application>, <application>mail</application>
        und Programme mit grafischer Benutzeroberfl&auml;che, wie
        <application>balsa</application> und <application>xfmail</application>
	um einige zu nennen, und <quote>aufw&auml;ndigere</quote>, wie WWW-Browser.
        Diese Programme geben die E-Mail-Transaktionen an den lokalen
        <link linkend="mail-host"><quote>E-Mail-Server</quote></link>,
	weiter, entweder &uuml;ber einen der verf&uuml;gbaren
        <link linkend="mail-mta">Server-D&auml;monen</link> oder eine
        TCP-Verbindung.</para>
    </sect2>

    <sect2 id="mail-mta">
      <title>E-Mail-Server D&auml;mon</title>
      <indexterm>
	<primary>E-Mail-Server D&auml;monen</primary>
	<secondary><application>sendmail</application></secondary>
      </indexterm>
      <indexterm>
	<primary>E-Mail-Server D&auml;monen</primary>
	<secondary><application>postfix</application></secondary>
      </indexterm>
      <indexterm>
	<primary>E-Mail-Server D&auml;monen</primary>
	<secondary><application>qmail</application></secondary>
      </indexterm>
      <indexterm>
	<primary>E-Mail-Server D&auml;monen</primary>
	<secondary><application>exim</application></secondary>
      </indexterm>

      <para>Normalerweise ist das <application>sendmail</application>
        (standardm&auml;&szlig;ig bei FreeBSD) oder einer der anderen E-Mail-Server
	D&auml;monen wie <application>qmail</application>,
	<application>postfix</application> oder
	<application>exim</application>.  Es gibt andere, aber die eben
	genannten werden am h&auml;ufigsten verwendet.</para>

      <para>Der Server-D&auml;mon hat &uuml;blicherweise zwei
	Funktionen &ndash; er k&uuml;mmert sich um das Empfangen von
	eingehenden E-Mails und stellt ausgehende E-Mails zu.  Er erlaubt
	Ihnen nicht, ihn per POP oder IMAP zu kontaktieren um Ihre E-Mails
	zu lesen.  Sie ben&ouml;tigen einen zus&auml;tzlichen
	<link linkend="mail-receive">D&auml;mon</link> daf&uuml;r.</para>

      <para>Bedenken Sie, dass &auml;ltere Versionen von
        <application>sendmail</application> schwerwiegende Sicherheitsprobleme
        haben.  Solange Sie jedoch eine aktuelle Version benutzen, sollten
        Sie keine Probleme haben.  Wie immer ist es eine gute Idee, aktuelle
        Programmversionen zu benutzen.</para>
    </sect2>

    <sect2 id="mail-dns">
      <title>E-Mail und DNS</title>

      <para>Das Domain Name System (DNS) und sein D&auml;mon
        <command>named</command> spielen eine gro&szlig;e Rolle in der
	Auslieferung von E-Mails.  Um E-Mails von Ihrer Stelle zu einer
	anderen zu transportieren, sucht der Server-D&auml;mon im DNS nach
	der Gegenstelle um den Rechner zu ermitteln, der die E-Mails f&uuml;r
	das Ziel empfangen wird.</para>

      <para>Genauso funktioniert es, wenn Ihnen E-Mails geschickt werden.
        Das DNS enth&auml;lt einen Datenbankeintrag mit dem Rechnernamen und
        dazugeh&ouml;riger IP-Adresse sowie einen Eintrag mit Rechnername und
        dazugeh&ouml;rigem E-Mail-Server.  Die IP-Adresse wird in einem
	A-Eintrag angegeben.  Der MX
	(<foreignphrase>Mail eXchanger</foreignphrase>)-Eintrag beschreibt den
	E-Mail-Server, der Ihre E-Mails empf&auml;ngt.  Wenn Sie keinen
	MX-Eintrag f&uuml;r Ihren Rechnernamen haben, wird die E-Mail direkt
	an Ihren Rechner geliefert.</para>
    </sect2>

    <sect2 id="mail-receive">
      <title>E-Mails empfangen</title>
      <indexterm>
	<primary>E-Mail</primary>
	<secondary>empfangen</secondary>
      </indexterm>

      <para>Das Empfangen von E-Mails f&uuml;r Ihre Dom&auml;ne wird von dem
	E-Mail-Server &uuml;bernommen.  Er sammelt die an Sie gesendeten
	E-Mails und lagert diese zum Lesen oder Abholen.  Damit Sie die
	gelagerten E-Mails abholen k&ouml;nnen, m&uuml;ssen Sie mit POP oder
	IMAP eine Verbindung zum E-Mail-Server herstellen.  Wenn Sie die
	E-Mails direkt auf dem E-Mail-Server lesen m&ouml;chten, wird kein
	POP- oder IMAP-Server gebraucht.</para>

      <indexterm><primary>POP</primary></indexterm>
      <indexterm><primary>IMAP</primary></indexterm>
      <para>Wollen Sie einen POP- oder IMAP-Server laufen lassen, gibt es zwei
        Dinge, die Sie tun m&uuml;ssen:</para>

      <procedure>
        <step>
	  <para>Besorgen Sie sich einen POP- oder IMAP-D&auml;mon aus der
	    <ulink url="../../../../ports/mail.html">Ports-Sammlung</ulink>
	    und installieren Sie diesen auf Ihrem System.</para>
	</step>
	<step>
	  <para>Ver&auml;ndern Sie <filename>/etc/inetd.conf</filename>
            um den POP- oder IMAP-Server zu starten.</para>
	</step>
      </procedure>
    </sect2>

    <sect2 id="mail-host">
      <title>Der E-Mail-Server</title>
      <indexterm><primary>E-Mail-Server</primary></indexterm>

      <para><quote>E-Mail-Server</quote> wird der Rechner genannt, welcher
	f&uuml;r die Zustellung und das Empfangen von E-Mails auf Ihrem
	Rechner oder vielleicht Ihrem Netzwerk zust&auml;ndig ist.</para>
    </sect2>
  </sect1>

  <sect1 id="sendmail">
    <sect1info>
      <authorgroup>
        <author>
          <firstname>Christopher</firstname>
          <surname>Shumway</surname>
          <contrib>Beigesteuert von </contrib>
        </author>
      </authorgroup>
    </sect1info>
    <title><application>sendmail</application>-Konfiguration</title>

    <indexterm>
      <primary><application>sendmail</application></primary>
    </indexterm>

    <para>&man.sendmail.8; ist das standardm&auml;&szlig;ig in
      FreeBSD installierte Mail&uuml;bertragungsprogramm (MTA).
      Die Aufgabe von <application>sendmail</application> ist es, E-Mails von
      E-Mail-Benutzerprogrammen anzunehmen und diese zu den
      entsprechenden Mailern zu liefern, die in der Konfigurationsdatei
      definiert sind.  <application>sendmail</application> kann auch
      Netzwerkverbindungen annehmen und E-Mails zu lokalen
      <firstterm>Mailboxen</firstterm>
      <footnote>
	<para>Mailbox = Post- beziehungsweise Briefkasten</para>
      </footnote>
      oder anderen Programmen liefern.</para>

    <para><application>sendmail</application> benutzt folgende
      Konfigurationsdateien:</para>

    <indexterm>
      <primary><filename>/etc/mail/access</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/aliases</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/local-host-names</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/mailer.conf</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/mailertable</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/sendmail.cf</filename></primary>
    </indexterm>
    <indexterm>
      <primary><filename>/etc/mail/virtusertable</filename></primary>
    </indexterm>
    <informaltable>
      <tgroup cols="2">
        <thead>
          <row>
           <entry>Dateiname</entry>
           <entry>Funktion</entry>
          </row>
        </thead>
        <tbody>
          <row>
            <entry>
              <filename>/etc/mail/access</filename>
            </entry>
	    <entry>Datenbank, in der Zugriffsrechte auf
	      <application>sendmail</application> verwaltet werden</entry>
          </row>
          <row>
            <entry>
              <filename>/etc/mail/aliases</filename>
            </entry>
            <entry>Mailbox Aliase</entry>
          </row>
          <row>
            <entry>
              <filename>/etc/mail/local-host-names</filename>
            </entry>
            <entry>Liste der Rechner f&uuml;r die
	      <application>sendmail</application> E-Mails akzeptiert</entry>
          </row>
          <row>
            <entry>
              <filename>/etc/mail/mailer.conf</filename>
            </entry>
            <entry>Mailer Programmkonfiguration</entry>
          </row>
          <row>
            <entry>
              <filename>/etc/mail/mailertable</filename>
            </entry>
            <entry>Mailer Versand-Zuordnungstabelle</entry>
          </row>
          <row>
            <entry>
              <filename>/etc/mail/sendmail.cf</filename>
            </entry>
            <entry>Hauptkonfigurationsdatei f&uuml;r
	      <application>sendmail</application></entry>
          </row>
          <row>
            <entry>
              <filename>/etc/mail/virtusertable</filename>
            </entry>
            <entry>Virtuelle Benutzer und Dom&auml;nen-Tabellen</entry>
          </row>
        </tbody>
      </tgroup>
    </informaltable>

  <sect2>
    <title><filename>/etc/mail/access</filename></title>

    <para>Die Zugriffsdatenbank bestimmt, welche(r) Rechner oder IP-Adresse(n)
      Zugriff auf den lokalen E-Mail-Server haben und welche Art von Zugriff
      ihnen gestattet wird.
      Rechner k&ouml;nnen als <option>OK</option>, <option>REJECT</option>
      oder <option>RELAY</option> eingetragen oder einfach an
      <application>sendmail</application>s Fehlerbehandlungsroutine mit einem
      angegebenen Mailer-Fehler &uuml;bergeben werden.
      Rechner, die als <option>OK</option> eingetragen sind, was die
      Grundeinstellung ist, sind berechtigt E-Mails zu diesem Rechner zu
      schicken, solange die endg&uuml;ltige Zieladresse der lokale Rechner ist.
      Verbindungen von Rechnern, die als <option>REJECT</option>
      aufgelistet sind, werden abgelehnt.
      Rechnern mit gesetzter <option>RELAY</option>-Option f&uuml;r
      ihren Rechnernamen wird erlaubt Post f&uuml;r jede Zieladresse
      durch diesen Mail-Server zu senden.</para>

      <example>
        <title>Konfigurieren der <application>sendmail</application>
          Zugriffsdatenbank</title>

    <programlisting>cyberspammer.com                550 We don't accept mail from spammers
FREE.STEALTH.MAILER@            550 We don't accept mail from spammers
another.source.of.spam          REJECT
okay.cyberspammer.com           OK
128.32                          RELAY</programlisting>
      </example>

   <para>In diesem Beispiel haben wir f&uuml;nf Eintr&auml;ge.
     E-Mail-Versender, die mit der linken Spalte der Tabelle
     &uuml;bereinstimmen, sind betroffen von der Aktion in der rechten
     Spalte.  Die ersten beiden Beispiele &uuml;bergeben einen Fehlercode an
     <application>sendmail</application>s Fehlerbehandlungsroutine.
     Die Nachricht wird an den entfernten Rechner gesendet, wenn eine
     Nachricht mit der linken Spalte der Tabelle &uuml;bereinstimmt.
     Der n&auml;chste Eintrag lehnt Post von einem bestimmten Rechner
     des Internets ab (<hostid>another.source.of.spam</hostid>).
     Der n&auml;chste Eintrag akzeptiert E-Mail-Verbindungen des Rechners
     <hostid role="fqdn">okay.cyberspammer.com</hostid>, der exakter angegeben
     wurde als <hostid role="fqdn">cyberspammer.com</hostid> in der Zeile
     dar&uuml;ber.
     Genauere &Uuml;bereinstimmungen haben den Vorrang vor weniger genauen.
     Der letzte Eintrag erlaubt die Weiterleitung von elektronischer Post
     von Rechnern mit einer IP-Adresse die mit <hostid>128.32</hostid>
     beginnt.  Diese Rechner w&uuml;rden E-Mails durch diesen
     E-Mail-Server senden k&ouml;nnen, die f&uuml;r andere E-Mail-Server
     bestimmt sind.</para>

   <para>Wenn diese Datei ge&auml;ndert wird, m&uuml;ssen Sie
     <command>make</command> in <filename>/etc/mail/</filename>
     ausf&uuml;hren um die Datenbank zu aktualisieren.</para>

   </sect2>

    <sect2>
      <title><filename>/etc/mail/aliases</filename></title>

      <para>Die Alias-Datenbank enth&auml;lt eine Liste der virtuellen
	Mailboxen, die in andere Benutzer, Dateien, Programme oder
	andere Aliase expandiert werden.  Hier sind ein paar Beispiele,
	die in <filename>/etc/mail/aliases</filename> benutzt werden
	k&ouml;nnen:</para>

      <example>
        <title>E-Mail Aliases</title>
    <programlisting>root: localuser
ftp-bugs: joe,eric,paul
bit.bucket:  /dev/null
procmail: "|/usr/local/bin/procmail"</programlisting>
      </example>

      <para>Das Dateiformat ist simpel; Der Name der Mailbox auf der linken
	Seite des Doppelpunkts wird mit den Zielen auf der rechten Seite
	ersetzt.
        Das erste Beispiel ersetzt die Mailbox <username>root</username>
	mit der Mailbox <username>localuser</username>, die dann wieder in der
        Alias-Datenbank gesucht wird.  Wird kein passender Eintrag
        gefunden, wird die Nachricht zum lokalen Benutzer
        <username>localuser</username> geliefert.  Das n&auml;chste Beispiel
        zeigt eine E-Mail-Verteilerliste.  E-Mails an die Mailbox
        <username>ftp-bugs</username> werden zu den drei lokalen Mailboxen
        <username>joe</username>, <username>eric</username> und
        <username>paul</username> gesendet.  Eine lokale Mailbox kann auch
        als <literal>user@example.com</literal> angegeben werden.  Das
	n&auml;chste Beispiel zeigt das Schreiben von E-Mails in eine Datei,
	in diesem Fall <filename>/dev/null</filename>.  Das letzte Beispiel
	verdeutlicht das Senden von E-Mails an ein Programm, in diesem Fall
	wird die Nachricht in die Standardeingabe von
        <filename>/usr/local/bin/procmail</filename> mittels einer UNIX Pipe
        geschrieben.</para>

      <para>Wenn diese Datei ge&auml;ndert wird, m&uuml;ssen Sie
	<command>make</command> in <filename>/etc/mail/</filename>
	ausf&uuml;hren um die &Auml;nderungen in die Datenbank zu
	&uuml;bernehmen.</para>
    </sect2>
    <sect2>
      <title><filename>/etc/mail/local-host-names</filename></title>

      <para>Das ist die Liste der Rechnernamen, die &man.sendmail.8; als
	lokalen Rechnernamen akzeptiert.  Setzen Sie alle Dom&auml;nen oder
	Rechner, f&uuml;r die <application>sendmail</application>
	Mail empfangen soll, in diese Datei.
	Wenn dieser Mail-Server zum Beispiel E-Mails f&uuml;r die
	Dom&auml;ne example.com und den Rechner
	<hostid role="fqdn">mail.example.com</hostid> annehmen soll,
	k&ouml;nnte seine <filename>local-host-names</filename> Datei so
	aussehen:</para>

      <programlisting>example.com
mail.example.com</programlisting>

      <para>Wird diese Datei ge&auml;ndert, muss &man.sendmail.8; neu
	gestartet werden, damit es die Neuerungen einliest.</para>
    </sect2>
    <sect2>
      <title><filename>/etc/mail/sendmail.cf</filename></title>

      <para>Die Hauptkonfigurations-Datei von
	<application>sendmail</application> (<filename>sendmail.cf</filename>)
	kontrolliert das allgemeine Verhalten von
	<application>sendmail</application>, einschlie&szlig;lich allem vom
	Umschreiben von E-Mail Adressen bis hin zum &Uuml;bertragen von
	Ablehnungsnachrichten an entfernte E-Mail-Server.
	Mit solch einer mannigfaltigen Rolle ist die Konfigurationsdatei
	nat&uuml;rlich ziemlich komplex und ihre Einzelheiten k&ouml;nnen
	in diesem Kapitel nicht besprochen werden.
	Gl&uuml;cklicherweise muss diese Datei selten f&uuml;r
	Standard E-Mail-Server ge&auml;ndert werden.</para>

      <para>Die <application>sendmail</application> Hauptkonfigurationsdatei
	kann mit &man.m4.1; Makros erstellt werden, die Eigenschaften
	und Verhalten von <application>sendmail</application> definieren.
	Einige der Details finden Sie in
	<filename>/usr/src/contrib/sendmail/cf/README</filename>.</para>

      <para>Wenn &Auml;nderungen an dieser Datei vorgenommen werden, muss
	<application>sendmail</application> neu gestartet werden, damit die
	&Auml;nderungen Wirkung zeigen.</para>
    </sect2>
    <sect2>
      <title><filename>/etc/mail/virtusertable</filename></title>

      <para>Die Datei <filename>virtusertable</filename> ordnet
	Adressen f&uuml;r virtuelle Dom&auml;nen und Mailboxen reellen
	Mailboxen zu.  Diese Mailboxen k&ouml;nnen lokal, auf entfernten
	Systemen, Aliase in <filename>/etc/mail/aliases</filename> oder
	eine Datei sein.</para>

      <example>
        <title>Beispiel einer virtuellen Dom&auml;nen Zuordnung</title>

        <programlisting>root@example.com                root
postmaster@example.com          postmaster@noc.example.net
@example.com                    joe</programlisting>
      </example>

      <para>In dem obigen Beispiel haben wir einen Eintrag f&uuml;r die
	Dom&auml;ne <hostid role="domainname">example.com</hostid>.  Diese
	Datei wird nach dem ersten &uuml;bereinstimmenden Eintrag durchsucht.
	Die erste Zeile ordnet <literal>root@example.com</literal> der
	lokalen Mailbox <username>root</username> zu.  Der n&auml;chste Eintrag ordnet
	<literal>postmaster@example.com</literal> der Mailbox
	<username>postmaster</username> auf dem Rechner
	<hostid role="fqdn">noc.example.net</hostid> zu.  Zuletzt, wenn keine
	&Uuml;bereinstimmung von <hostid role="fqdn">example.com</hostid>
	gefunden wurde, wird der letzte Eintrag verglichen, der mit jeder
	Mail-Nachricht &uuml;bereinstimmt, die an jemanden bei
	<hostid>example.com</hostid> adressiert wurde.
	Diese werden der lokalen Mailbox joe zugeordnet.</para>
    </sect2>
  </sect1>

  <sect1 id="mail-changingmta">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Andrew</firstname>
	  <surname>Boothman</surname>
	  <contrib>Geschrieben von </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <firstname>Gregory</firstname>
	  <surname>Neil Shapiro</surname>
	  <contrib>Informationen entnommen aus E-Mails geschrieben von
	    </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Wechseln des Mail&uuml;bertragungs-Agenten</title>
    <indexterm>
      <primary>E-Mail</primary>
      <secondary>MTA, wechseln</secondary>
    </indexterm>

    <para>Wie bereits erw&auml;hnt, ist bei FreeBSD
      <application>sendmail</application> schon als Ihr
      Mail&uuml;bertragungs-Agent installiert.
      Deswegen ist es standardm&auml;&szlig;ig f&uuml;r Ihre aus- und
      eingehenden E-Mails verantwortlich.</para>

    <para>Jedoch wollen einige Systemadministratoren den MTA ihres Systems
      wechseln, was eine Reihe von Gr&uuml;nden haben kann.  Diese Gr&uuml;nde
      reichen von einfach einen anderen MTA ausprobieren wollen bis hin dazu
      eine bestimmte Besonderheit zu ben&ouml;tigen oder ein Paket, welches
      auf einen anderen Mailer angewiesen ist.  Gl&uuml;cklicherweise macht
      FreeBSD das Wechseln einfach, egal aus welchem Grund.</para>

    <sect2>
      <title>Installieren eines neuen MTA</title>

      <para>Sie haben eine gro&szlig;e Auswahl an verf&uuml;gbaren
	MTA-Programmen.  Ein guter Startpunkt ist die
	<link linkend="ports">FreeBSD Ports-Sammlung</link>, wo Sie viele
	finden werden.  Selbstverst&auml;ndlich steht es Ihnen frei, jeden
	MTA von &uuml;berall her zu verwenden, solange Sie ihn unter
	FreeBSD zum Laufen bekommen.</para>

      <para>Fangen Sie an, indem Sie Ihren neuen MTA installieren.  Sobald
	er installiert ist, gibt er Ihnen die Chance zu entscheiden ob er
	wirklich Ihren Bed&uuml;rfnissen gen&uuml;gt.  Zus&auml;tzlich gibt
	er Ihnen die M&ouml;glichkeit die neue Software zu konfigurieren,
	bevor sie den Job von <application>sendmail</application>
	&uuml;bernimmt.  Dabei sollten Sie sicherstellen, dass beim
	Installieren der neuen Software keine Versuche unternommen werden,
	System-Programme wie <filename>/usr/bin/sendmail</filename> zu
	&uuml;berschreiben.  Ansonsten wurde Ihre neue E-Mail-Software in
	den Dienst gestellt, bevor Sie sie konfiguriert haben.</para>

      <para>F&uuml;r Informationen &uuml;ber die Konfiguration des von
	Ihnen gew&auml;hlten MTAs sehen Sie bitte in der dazugeh&ouml;rigen
	Dokumentation nach.</para>
    </sect2>

    <sect2>
      <title>Ausschalten von <application>sendmail</application></title>

      <para>Die Prozedur des Startens von <application>sendmail</application>
	hat sich zwischen 4.5-RELEASE und 4.6-RELEASE signifikant
	ver&auml;ndert.  Daher beinhaltet auch die Prozedur des Abschaltens
	subtile Unterschiede.</para>

      <sect3>
	<title>FreeBSD 4.5-STABLE vor dem 4.4.2002 (inklusive 4.5-RELEASE und
	  fr&uuml;here Versionen)</title>

	<para>Schreiben Sie</para>

	<programlisting>sendmail_enable="NO"</programlisting>

	<para>in <filename>/etc/rc.conf</filename>.  Das schaltet die
	  Verarbeitung eingehender E-Mails durch
	  <application>sendmail</application> ab.  Aber bis
	  <filename>/etc/mail/mailer.conf</filename> nicht ge&auml;ndert
	  ist, wird <application>sendmail</application> weiterhin zum
	  Senden von E-Mails verwendet.</para>
      </sect3>

      <sect3>
	<title>FreeBSD 4.5-STABLE nach dem 4.4.2002 (inklusive 4.6-RELEASE
	  und sp&auml;tere Versionen)</title>

	<para>Um <application>sendmail</application> komplett abzuschalten,
	  m&uuml;ssen Sie</para>

	<programlisting>sendmail_enable="NONE"</programlisting>

	<para>in Ihre <filename>/etc/rc.conf</filename> schreiben.</para>

	<warning>
	  <para>Wenn Sie <application>sendmail</application>s Dienst f&uuml;r
	    ausgehende E-Mails auf diesem Weg abschalten, ist es wichtig,
	    dass Sie es mit einem voll funktionsf&auml;higen alternativen
	    E-Mail-Zustellungssystem ersetzen.  Wenn Sie w&auml;hlen das nicht
	    zu tun, werden System-Funktionen wie &man.periodic.8; nicht
	    f&auml;hig sein, Ihre Ergebnisse per E-Mail zuzustellen, wie sie
	    es normalerweise erwarten.  Viele Teile Ihres Systems k&ouml;nnen
	    erwarten, ein funktionierendes
	    <application>sendmail</application>-kompatibles System zu haben.
	    Wenn Anwendungen weiterhin versuchen mit
	    <application>sendmail</application>s Programmdateien E-Mails zu
	    verschicken, nachdem Sie sie abgeschaltet haben, k&ouml;nnten
	    E-Mails in einer inaktiven
	    <application>sendmail</application>-Warteschlange landen, und
	    niemals geliefert werden.</para>
	</warning>

	<para>Wenn Sie nur <application>sendmail</application>s Dienst
	  f&uuml;r eingehende E-Mail abschalten m&ouml;chten, sollten Sie
	</para>

	<programlisting>sendmail_enable="NO"</programlisting>

	<para>in <filename>/etc/rc.conf</filename> setzen.  Mehr
	  Informationen zu <application>sendmail</application>s Start-Optionen
	  sind vorhanden auf der &man.sendmail.8; Manual Page.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Starten Ihres neuen MTA beim Hochfahren des Systems</title>

      <para>Abh&auml;ngig davon, welche FreeBSD Version Sie verwenden,
	haben Sie die Wahl zwischen zwei Methoden, um Ihren
	neuen MTA beim Hochfahren des System zu starten.</para>

      <sect3>
	<title>FreeBSD 4.5-STABLE vor dem 11.4.2002 (inklusive 4.5-RELEASE
	  und fr&uuml;here Versionen</title>

	<para>F&uuml;gen Sie ein Skript zu
	  <filename>/usr/local/etc/rc.d</filename>, dessen Dateiname mit
	  <filename>.sh</filename> endet und von <username>root</username>
	  ausf&uuml;hrbar ist.  Das Skript sollte <literal>start</literal>
	  und <literal>stop</literal> Parameter annehmen.  Beim Hochfahren
	  des Systems werden die System-Skripte den Befehl</para>

	<programlisting>/usr/local/etc/rc.d/supermailer.sh start</programlisting>

	<para>ausf&uuml;hren, den Sie auch manuell zum Starten des Dienstes
	  verwenden k&ouml;nnen.  Beim Herunterfahren des Systems werden die
	  System-Skripte die <literal>stop</literal> Option einsetzen, also
	  den Befehl</para>

	<programlisting>/usr/local/etc/rc.d/supermailer.sh stop</programlisting>

	<para>ausf&uuml;hren, der ebenso manuell von Ihnen zum Stoppen des
	  Dienstes w&auml;hrend das System l&auml;uft, verwendet werden kann.
	  </para>
      </sect3>

      <sect3>
	<title>FreeBSD 4.5-STABLE nach dem 11.4.2000 (inklusive 4.6-RELEASE
	  und sp&auml;tere Versionen)</title>

	<para>F&uuml;r neuere FreeBSD Versionen, k&ouml;nnen Sie die oben
	  dargestellte M&ouml;glichkeit verwenden, oder Sie setzen</para>

	<programlisting>mta_start_script="filename"</programlisting>

	<para>in <filename>/etc/rc.conf</filename>, wobei
	  <replaceable>filename</replaceable> den Namen des Skripts darstellt,
	  das beim Hochfahren des Systems ausgef&uuml;hrt wird, um Ihren MTA
	  zu starten.</para>
      </sect3>
    </sect2>

    <sect2>
      <title>Ersetzen von <application>sendmail</application> als
	Standard-Mailer des Systems</title>

      <para>Das Programm <application>sendmail</application> ist so
	allgegenw&auml;rtig als Standard-Software auf &unix; Systemen, dass
	einige Programme einfach annehmen es sei bereits installiert und
	konfiguriert.
	Aus diesem Grund stellen viele alternative MTAs ihre eigenen
	kompatiblen Implementierung der <application>sendmail</application>
	Kommandozeilen-Schnittstelle zur Verf&uuml;gung.  Das vereinfacht
	ihre Verwendung als <quote>drop-in</quote> Ersatz f&uuml;r
	<application>sendmail</application>.</para>

      <para>Folglich werden Sie, wenn Sie einen alternativen Mailer benutzen,
	sicherstellen m&uuml;ssen, dass ein Programm, das versucht
        <application>sendmail</application>s Standard-Dateien wie
        <filename>/usr/bin/sendmail</filename> auszuf&uuml;hren,
        stattdessen Ihr gew&auml;hltes Mail&uuml;bertragungsprogramm
        ausf&uuml;hrt.
        Zum Gl&uuml;ck stellt FreeBSD das &man.mailwrapper.8;-System
        zur Verf&uuml;gung, das diese Arbeit f&uuml;r Sie erledigt.</para>

      <para>Wenn <application>sendmail</application> arbeitet wie es
	installiert wurde, werden Sie in
	<filename>/etc/mail/mailer.conf</filename> etwas wie das Folgende
	vorfinden:</para>

<programlisting>sendmail	/usr/libexec/sendmail/sendmail
send-mail	/usr/libexec/sendmail/sendmail
mailq		/usr/libexec/sendmail/sendmail
newaliases	/usr/libexec/sendmail/sendmail
hoststat	/usr/libexec/sendmail/sendmail
purgestat	/usr/libexec/sendmail/sendmail</programlisting>

      <para>Das bedeutet, dass wenn eines der gew&ouml;hnlichen Kommandos
	(wie zum Beispiel <filename>/usr/bin/sendmail</filename> selbst)
	ausgef&uuml;hrt wird, das System tats&auml;chlich eine Kopie des
	mailwrapper mit dem Namen <filename>sendmail</filename> startet, die
	<filename>mailer.conf</filename> &uuml;berpr&uuml;ft und
	<filename>/usr/libexec/sendmail/sendmail</filename> ausf&uuml;hrt.
	Mit diesem System lassen sich die Programme, die f&uuml;r die
	<application>sendmail</application>-Funktionen gestartet werden,
	leicht &auml;ndern.</para>

      <para>Daher k&ouml;nnten Sie, wenn Sie wollten, dass
	<filename>/usr/local/supermailer/bin/sendmail-compat</filename>
	anstelle von <application>sendmail</application> ausgef&uuml;hrt
	wird, <filename>/etc/mailer.conf</filename> wie folgt ab&auml;ndern:
      </para>

<programlisting>sendmail	/usr/local/supermailer/bin/sendmail-compat
send-mail	/usr/local/supermailer/bin/sendmail-compat
mailq		/usr/local/supermailer/bin/mailq-compat
newaliases	/usr/local/supermailer/bin/newaliases-compat
hoststat	/usr/local/supermailer/bin/hoststat-compat
purgestat	/usr/local/supermailer/bin/purgestat-compat</programlisting>

    </sect2>

    <sect2>
      <title>Fertigstellen</title>

      <para>Sobald Sie alles Ihren W&uuml;nschen entsprechend
      konfiguriert haben, sollten Sie entweder die
      <application>sendmail</application> Prozesse beenden, die Sie
      nicht mehr ben&ouml;tigen, und die zu Ihrer neuen Software
      zugeh&ouml;rigen Prozesse starten, oder einfach das System
      neustarten.  Das Neustarten des Systems gibt Ihnen auch die
      Gelegenheit sicherzustellen, dass Sie Ihr System korrekt
      konfiguriert haben, um Ihren neuen MTA automatisch beim
      Hochfahren zu starten.</para>
    </sect2>
  </sect1>

  <sect1 id="mail-trouble">
    <title>Fehlerbeseitigung</title>

    <para>Hier finden sich ein paar h&auml;ufig gestellte Fragen und ihre
      Antworten, die von der <ulink url="../faq/">FAQ</ulink> &uuml;bernommen
      wurden.</para>

    <qandaset>
      <qandaentry>
        <question>
	<para>Warum muss ich einen FQDN (fully-qualified domain name/
	  voll ausgeschriebenen Dom&auml;nennamen) f&uuml;r meine Rechner
	  verwenden?</para>
	</question>

	<answer>
	<para>Vielleicht liegen die Rechner in einer unterschiedlichen
	  Dom&auml;ne; zum Beispiel, wenn Sie sich in
          <hostid role="fqdn">foo.bar.edu</hostid> befinden, und einen Rechner
          namens <hostid>mumble</hostid> in der
          <hostid role="domainname">bar.edu</hostid> Dom&auml;ne erreichen
	  wollen, m&uuml;ssen Sie ihn mit dem voll ausgeschriebenen
	  Dom&auml;nennamen <hostid role="fqdn">mumble.bar.edu</hostid>
	  kontaktieren, anstatt blo&szlig; mit <hostid>mumble</hostid>.</para>

	<para>Traditionell wurde das von dem BSD BIND
          <foreignphrase>Resolver</foreignphrase> erlaubt.  Wie auch immer,
          die aktuelle Version von <application>BIND</application>, die mit
          FreeBSD ausgeliefert wird, bietet keine Standardabk&uuml;rzungen
          f&uuml;r nicht komplett angegebene Dom&auml;nennamen au&szlig;erhalb der
          Dom&auml;ne, in der Sie sich befinden.  Daher muss ein
          nicht-qualifizierter Rechner <hostid>mumble</hostid> entweder als
	  <hostid role="fqdn">mumble.foo.bar.edu</hostid> gefunden werden,
	  oder er wird in der root Dom&auml;ne gesucht.</para>

        <para>Damit unterscheidet es sich von vorherigem Verhalten, bei dem
          die Suche &uuml;ber <hostid role="domainname">mumble.bar.edu</hostid>
          und <hostid role="domainname">mumble.edu</hostid> lief.  Schauen Sie
          sich RFC 1535 an, wenn Sie wissen m&ouml;chten, warum das als
          schlecht und sogar als Sicherheitsloch angesehen wurde.</para>

        <para>Um das zu umgehen, k&ouml;nnen Sie die Linie

          <programlisting>
search foo.bar.edu bar.edu</programlisting>

          anstatt der vorherigen

          <programlisting>
domain foo.bar.edu</programlisting>

          in Ihre <filename>/etc/resolv.conf</filename> einsetzen.  Aber
          stellen Sie sicher, dass die Suchordnung nicht die Begrenzung von
          <quote>lokaler und &ouml;ffentlicher Administration</quote>, wie
          RFC 1535 sie nennt, &uuml;berschreitet.</para>
	</answer>
      </qandaentry>

      <qandaentry>
	<question>
	  <para>Warum meldet Sendmail <errorname>mail loops back to myself</errorname>?</para>
	</question>

	<answer>
	  <para>Dies wird in der Sendmail-FAQ wie folgt beantwortet:</para>

	  <literallayout>	* Ich erhalte "Local configuration error" Meldungen, wie:

	553 relay.domain.net config error: mail loops back to myself
	554 &lt;user@domain.net&gt;... Local configuration error

	Wie kann ich dieses Problem l&ouml;sen?

        Sie haben durch die Benutzung eines MX-Eintrags eingestellt, dass
        Mail f&uuml;r die Dom&auml;ne (z.B. domain.net) an einen speziellen
        Host (in diesem Fall relay.domain.net) weitergeleitet wird,
        aber der Relay-Host erkennt sich selbst nicht als
        domain.net.  F&uuml;gen Sie domain.net in /etc/mail/local-host-names
        (falls Sie FEATURE(use_cw_file) benutzen) oder "Cw domain.net"
        in /etc/mail/sendmail.cf ein.
          </literallayout>

          <para>Die aktuelle Version der <ulink
            url="ftp://rtfm.mit.edu/pub/usenet/news.answers/mail/sendmail-faq">Sendmail-FAQ</ulink>
            wird nicht mehr mit dem Sendmail-Release verwaltet.  Sie
            wird jedoch regelm&auml;&szlig;ig nach <ulink
            url="news:comp.mail.sendmail">comp.mail.sendmail</ulink>,
            <ulink url="news:comp.mail.misc">comp.mail.misc</ulink>,
            <ulink url="news:comp.mail.smail">comp.mail.smail</ulink>,
            <ulink url="news:comp.answers">comp.answers</ulink> und
            <ulink url="news:news.answers">news.answers</ulink>
            gepostet.  Sie k&ouml;nnen auch eine Kopie per E-Mail
            bekommen, indem Sie eine Mail mit dem Inhalt <literal>send
            usenet/news.answers/mail/sendmail-faq</literal> an
            <email>mail-server@rtfm.mit.edu</email> schicken.</para>
        </answer>
      </qandaentry>

      <indexterm><primary>PPP</primary></indexterm>
      <qandaentry>
        <question><para>Wie kann ich einen E-Mail-Server auf einem
	  Anwahl-PPP Rechner betreiben?</para>
	</question>

	<answer>
	<para>Sie wollen einen FreeBSD Rechner in einem LAN an das
	  Internet anbinden.  Der FreeBSD Rechner wird ein E-Mail
	  <foreignphrase>Gateway</foreignphrase> f&uuml;r das LAN.
          Die PPP-Verbindung ist keine Standleitung.</para>

	<para>Es gibt mindestens zwei Wege um dies zu tun.  Einer davon ist
	  UUCP zu verwenden.</para>

	<para>Ein anderer Weg ist, von einem immer mit dem Internet
	  verbundenen Server einen sekund&auml;ren MX-Dienst f&uuml;r Ihre
	  Dom&auml;ne zur Verf&uuml;gung gestellt zu bekommen.  Wenn die
	  Dom&auml;ne Ihrer Firma
	  <hostid role="domainname">example.com</hostid> ist, und Ihr
	  Internet-Dienstanbieter
	  <hostid role="domainname">example.net</hostid> so eingestellt hat,
	  dass er Ihrer Dom&auml;ne einen sekund&auml;ren MX-Dienst zur
	  Verf&uuml;gung stellt:</para>

	<programlisting>example.com.            MX        10      bigco.com.
                      MX        20      example.net.</programlisting>

	<para>Nur ein Rechner sollte als Endempf&auml;nger angegeben sein
	  (f&uuml;gen Sie <literal>Cw example.com</literal> zu
	  <filename>/etc/sendmail.cf</filename> auf example.com).</para>

	<para>Wenn das <command>sendmail</command> des Versenders versucht,
	  die E-Mail zuzustellen, wird es versuchen, Sie &uuml;ber die
	  Modem-Verbindung (<hostid role="domainname">example.com</hostid>)
	  zu erreichen.  Wahrscheinlich wird es keine Verbindung zustande
	  bringen k&ouml;nnen, da Sie nicht eingew&auml;hlt sind.
	  <command>sendmail</command> wird die E-Mail automatisch zu der
	  sekund&auml;ren MX-Stelle geliefert, zu Ihrem Internet-Provider
	  (<hostid role="domainname">example.net</hostid>).
	  Die sekund&auml;re MX-Stelle wird periodisch versuchen
	  versuchen eine Verbindung zu Ihnen aufzubauen, um die E-Mail zu
	  der prim&auml;ren MX-Stelle
	  (<hostid role="domainname">example.com</hostid> zu liefern.</para>

	<para>Eventuell wollen Sie etwas wie dies als Login-Skript:</para

	<programlisting>#!/bin/sh
# Put me in /usr/local/bin/pppmyisp
( sleep 60 ; /usr/sbin/sendmail -q ) &amp;
/usr/sbin/ppp -direct pppmyisp</programlisting>

	<para>Wenn Sie ein separates Login-Skript f&uuml;r einen Benutzer
	  erstellen wollen, k&ouml;nnten Sie stattdessen
	  <command>sendmail -qRexample.com</command> in dem oben gezeigten
	  Skript verwenden.  Das erzwingt die sofortige Verarbeitung der
	  E-Mails in Ihrer Warteschlange f&uuml;r
	  <hostid role="domainname">example.com</hostid></para>

	<para>Eine weitere Verfeinerung der Situation ist wie folgt:</para>

	<para>Die Nachricht wurde der &a.isp; entnommen.</para>

	<programlisting>&gt; wir stellen einem Kunden den sekund&auml;ren MX zur Verf&uuml;gung.
&gt; Der Kunde verbindet sich mit unseren Diensten mehrmals am Tag
&gt; automatisch um die E-Mails zu seinem prim&auml;ren MX zu holen
&gt; (wir w&auml;hlen uns nicht bei ihm ein, wenn E-Mails f&uuml;r seine
&gt; Dom&auml;ne eintreffen).  Unser sendmail sendet den Inhalt der
&gt; E-Mail-Warteschlange alle 30 Minuten.  Momentan muss er 30 Minuten
&gt; eingew&auml;hlt bleiben um sicher zu sein, dass alle seine E-Mails
&gt; beim prim&auml;ren MX eingetroffen sind.
&gt;
&gt; Gibt es einen Befehl, der sendmail dazu bringt, alle E-Mails sofort
&gt; zu senden? Der Benutzer hat nat&uuml;rlich keine root-Rechte auf
&gt; unserer Maschine.

In der <quote>privacy flags</quote> Sektion von sendmail.cf befindet sich die
Definition Opgoaway,restrictqrun

Entferne restrictqrun um nicht-root Benutzern zu erlauben, die Verarbeitung
der Nachrichten-Warteschlangen zu starten.  M&ouml;glicherweise willst du
auch die MX neu sortieren.  Wir sind der prim&auml;re MX f&uuml;r unsere
Kunden mit diesen W&uuml;nschen und haben definiert:

# Wenn wir der beste MX f&uuml;r einen Rechner sind, versuche es direkt
# anstatt einen lokalen Konfigurationsfehler zu generieren.
OwTrue

Auf diesem Weg liefern Gegenstellen direkt zu dir, ohne die Kundenverbindung
zu versuchen.  Dann sendest du zu deinem Kunden.  Das funktioniert nur
f&uuml;r <quote>Rechner</quote>, du musst also deinen Kunden dazu bringen,
ihre E-Mail Maschine <quote>customer.com</quote> zu nennen, sowie
<quote>hostname.customer.com</quote> im DNS.  Setze einfach einen A-Eintrag
in den DNS f&uuml;r <quote>customer.com</quote>.</programlisting>
        </answer>
      </qandaentry>

      <qandaentry>
	<question>
	  <para>Warum bekomme ich die Fehlermeldung <errorname>Relaying
	    Denied</errorname>, wenn ich E-Mails von anderen Rechnern
	    verschicke?</para>
	</question>

	<answer>
	  <para>In der standardm&auml;&szlig;igen FreeBSD Installation wird
	    <application>sendmail</application> nur dazu konfiguriert,
	    E-Mails von dem Rechner auf dem es l&auml;uft zu senden.  Wenn zum
	    Beispiel ein POP3-Server installiert ist, werden die Benutzer
	    in der Lage sein, Ihre E-Mails von der Schule, Arbeit oder anderen
	    entfernten Orten zu &uuml;berpr&uuml;fen, jedoch werden sie keine
	    E-Mails von au&szlig;erhalb verschicken k&ouml;nnen.
	    Typischerweise wird ein paar Sekunden nach dem Versuch eine E-Mail
	    von <application>MAILER-DAEMON</application> mit einer
	    <errorname>5.7 Relaying Denied</errorname> Fehlermeldung
	    versendet werden.</para>

	<para>Es sind mehrere Wege m&ouml;glich, dies zu umgehen.  Die
	  geradlinigste L&ouml;sung ist die Adresse Ihres
	  Internet-Dienstanbieters in die Datei f&uuml;r die
	  Weiterleitungs-Dom&auml;nen zu platzieren.  Das l&auml;sst sich
	  schnell erreichen mit:</para>

	<screen>&prompt.root; <userinput>echo "your.isp.example.com" &gt; /etc/mail/relay-domains</userinput></screen>

	<para>Nach Erstellen oder Editieren dieser Datei m&uuml;ssen Sie
	  <application>sendmail</application> neu starten.  Das funktioniert
	  gro&szlig;artig wenn Sie ein Server-Administrator sind und E-Mails
	  nicht lokal versenden, oder gerne ein Client/System mit grafischer
	  Oberfl&auml;che auf einer anderen Maschine oder sogar &uuml;ber
	  einen anderen Internet-Dienstanbieter verwenden wollen.  Es ist auch
	  sehr n&uuml;tzlich, wenn Sie nur ein oder zwei E-Mail Accounts
	  eingerichtet haben.  Soll eine gr&ouml;&szlig;ere Anzahl Adressen
	  hinzugef&uuml;gt werden, k&ouml;nnen Sie die Datei einfach in Ihrem
	  favorisierten Editor &ouml;ffnen und die Dom&auml;nen anf&uuml;gen,
	  je eine pro Zeile:</para>

	<programlisting>your.isp.example.com
other.isp.example.net
users-isp.example.org
www.example.org</programlisting>

	<para>Jetzt wird jede E-Mail, die durch Ihr System von einem der
	  in diese Liste eingetragenen Rechner geschickt wurde, ihr Ziel
	  erreichen (vorausgesetzt, der Benutzer hat einen Account auf Ihrem
	  System).  Dies ist ein sehr sch&ouml;ner Weg, um Benutzern das
	  entfernte E-Mail Versenden von Ihrem System zu erlauben, ohne
	  dem Massenversand (<acronym>SPAM</acronym>) die T&uuml;r zu
	  &ouml;ffnen.
	</answer>
      </qandaentry>
    </qandaset>
  </sect1>

  <sect1 id="mail-advanced">
    <title>Weiterf&uuml;hrende Themen</title>

    <para>Die folgenden Abschnitte behandeln kompliziertere Themen wie
      E-Mail-Konfiguration und das Einrichten von E-Mail f&uuml;r Ihre
      ganze Dom&auml;ne.</para>

    <sect2 id="mail-config">
      <title>Grundlegende Konfiguration</title>

      <para>Mit der Software im Auslieferungszustand sollten Sie f&auml;hig
	sein, E-Mails an externe Rechner zu senden, solange Sie
	<filename>/etc/resolv.conf</filename> eingerichtet haben oder Ihren
	eigenen Name Server laufen lassen.  Wenn Sie die E-Mails f&uuml;r
	Ihren Rechner zu einem anderen Rechner geliefert haben wollen, gibt
	es zwei Methoden:</para>

      <itemizedlist>
        <listitem>
          <para>Betreiben Sie Ihren eigenen Name Server und haben Sie Ihre
	    eigene Dom&auml;ne, zum Beispiel
	    <hostid role="domainname">FreeBSD.org</hostid>.</para>
        </listitem>

        <listitem>
          <para>Lassen Sie sich E-Mails direkt zu Ihrem Rechner liefern.
	    Dies geschieht indem E-Mails direkt zu dem aktuellen DNS Namen
	    Ihrer Maschine geliefert werden.  Zum Beispiel
	    <hostid role="fqdn">example.FreeBSD.org</hostid>.</para>
        </listitem>
      </itemizedlist>

      <para>Ungeachtet welche Methode Sie ausw&auml;hlen, um E-Mails direkt
	zu Ihrem Rechner geliefert zu bekommen, ben&ouml;tigen Sie eine
	permanente (statische) IP-Adresse (keine dynamische PPP-Anwahl).
	Wenn Sie sich hinter einer Firewall befinden, muss diese den
	SMTP-Verkehr an Sie weiterleiten.  Wollen Sie E-Mails an Ihrem
	Rechner selbst empfangen, m&uuml;ssen Sie eines der folgenden
	Dinge sicherstellen:</para>

      <itemizedlist>
        <listitem>
          <para>Vergewissern Sie sich, dass der MX-Eintrag in Ihrem DNS zu
	    der IP-Adresse Ihres Rechners zeigt.</para>
        </listitem>

        <listitem>
          <para>Stellen Sie sicher, dass sich f&uuml;r Ihren Rechner kein
	    MX-Eintrag im DNS befindet.</para>
        </listitem>
      </itemizedlist>

      <para>Jede der erw&auml;hnten Konfigurationsm&ouml;glichkeiten erlaubt
	Ihnen, E-Mails direkt auf Ihrem Rechner zu empfangen.</para>

      <para>Versuchen Sie das:</para>

      <screen>&prompt.root; <userinput>hostname</userinput>
example.FreeBSD.org
&prompt.root; <userinput>host example.FreeBSD.org</userinput>
example.FreeBSD.org has address 204.216.27.XX</screen>

      <para>Wenn Sie diese Ausgabe erhalten, sollten direkt an
        <email>yourlogin@example.FreeBSD.org</email> geschickte E-Mails
	ohne Probleme funktionieren.</para>

      <para>Sehen Sie stattdessen etwas wie dies:</para>

      <screen>&prompt.root; <userinput>host example.FreeBSD.org</userinput>
example.FreeBSD.org has address 204.216.27.XX
example.FreeBSD.org mail is handled (pri=10) by hub.FreeBSD.org</screen>

      <para>So wird jede an Ihren Rechner
	(<hostid role="fqdn">example.FreeBSD.org</hostid>) gesandte E-Mail
	auf <hostid>hub</hostid> unter dem gleichen Benutzernamen gesammelt
	anstatt direkt zu Ihrem Rechner geschickt zu werden.</para>

      <para>Die obige Information wird von Ihrem DNS-Server verwaltet.
	Der DNS-Eintrag, der die E-Mail Routen-Information enth&auml;lt, ist der
        <foreignphrase><emphasis>M</emphasis>ail
	e<emphasis>X</emphasis>change</foreignphrase> Eintrag.  Existiert kein
	MX-Eintrag, werden E-Mails direkt anhand der IP-Adresse geliefert.
      </para>
      <para>Der MX-Eintrag f&uuml;r
	<hostid role="fqdn">freefall.FreeBSD.org</hostid> sah einmal so aus:
        </para>

      <programlisting>freefall		MX	30	mail.crl.net
freefall		MX	40	agora.rdrop.com
freefall		MX	10	freefall.FreeBSD.org
freefall		MX	20	who.cdrom.com</programlisting>

      <para>Wie Sie sehen k&ouml;nnen, hatte <hostid>freefall</hostid>
	viele MX-Eintr&auml;ge.  Die kleinste MX-Nummer ist der Rechner, der
	die E-Mails letztendlich bekommt, wobei die anderen tempor&auml;r
	E-Mails in Warteschlangen einreihen w&auml;hrend
	<hostid>freefall</hostid> besch&auml;ftigt oder unerreichbar ist.

      <para>Um besonders n&uuml;tzlich zu sein, sollten stellvertretende
	MX-Seiten nicht dieselben Internet-Verbindungen wie Ihre eigene
	verwenden.  F&uuml;r Ihren Internet-Dienstleister oder andere
	sollte es kein Problem darstellen, Ihnen diesen Dienst zur
	Verf&uuml;gung zu stellen.</para>
    </sect2>

    <sect2 id="mail-domain">
      <title>E-Mails f&uuml;r Ihre Dom&auml;ne</title>

      <para>Um einen <quote>E-Mail-Server</quote> (auch bekannt als
	Mail-Server) einzurichten, ben&ouml;tigen Sie eine Umlenkung
	jeglicher E-Mails zu Ihm, die an die verschiedenen Workstations
	gesendet werden.  Im Grunde wollen Sie jede an Ihre Dom&auml;ne
	gesendete E-Mail abfangen (in diesem Fall
	<hostid role="fqdn">*.FreeBSD.org</hostid>), damit Ihre Benutzer
	E-Mails mittels POP oder direkt auf dem Server
	&uuml;berpr&uuml;fen k&ouml;nnen.</para>

      <para>Am einfachsten ist es, wenn Accounts mit gleichen
        <emphasis>Benutzernamen</emphasis> auf beiden
	Maschinen existieren.  Verwenden Sie &man.adduser.8;, um
	dies zu erreichen.</para>

      <para>Der E-Mail-Server, den Sie verwenden wollen, muss als
	f&uuml;r den E-Mail-Austausch zust&auml;ndiger Rechner
	auf jeder Workstation im Netzwerk gekennzeichnet werden.  Dies wird
	in der DNS-Konfiguration so ausgef&uuml;hrt:</para>

      <programlisting>example.FreeBSD.org	A	204.216.27.XX		; Workstation
			MX	10 hub.FreeBSD.org	; Mailhost</programlisting>

      <para>Diese Einstellung wird E-Mail f&uuml;r die Workstations zu dem
	E-Mail-Server leiten, wo auch immer der A-Eintrag hinzeigt.
	Die E-Mails werden zum MX-Rechner gesandt.</para>

      <para>Sofern Sie nicht einen DNS-Server laufen haben, k&ouml;nnen
	Sie diese Einstellung nicht selbst vornehmen.  Ist es Ihnen nicht
	m&ouml;glich einen eigenen DNS-Server laufen zu lassen, reden Sie
	mit Ihren Internet-Dienstleister oder wer auch immer Ihre
	DNS-Verwaltung &uuml;bernimmt.

      <para>Wenn Sie ein virtuelles E-Mail System anbieten, werden
	die folgenden Informationen n&uuml;tzlich sein.  F&uuml;r ein Beispiel
	nehmen wir an, Sie haben einen Kunden mit einer eigenen Dom&auml;ne,
	in diesem Fall <hostid role="domainname">customer1.org</hostid> und
	Sie wollen jegliche E-Mails f&uuml;r
	<hostid role="domainname">customer1.org</hostid> zu Ihrem
	E-Mail-Server gesendet haben, der
	<hostid role="fqdn">mail.myhost.com</hostid> hei&szlig;t.
	Der Eintrag in Ihrem DNS sollte wie folgender aussehen:</para>

      <programlisting>customer1.org		MX	10	mail.myhost.com
      </programlisting>

      <para>Sie ben&ouml;tigen <emphasis>keinen</emphasis> A-Eintrag, wenn
        Sie f&uuml;r die Domain nur E-Mails verwalten wollen.</para>

      <note>
	<para>Bedenken Sie, dass das Pingen von
	  <hostid role="domainname">customer1.org</hostid> nicht m&ouml;glich
	  ist, solange kein A-Eintrag f&uuml;r diese Dom&auml;ne existiert.
	  </para>
      </note>

      <para>Jetzt m&uuml;ssen Sie nur noch
	<application>sendmail</application> auf Ihrem Mailrechner mitteilen,
	f&uuml;r welche Dom&auml;nen und/oder Rechnernamen es Mails akzeptieren
	soll.  Es gibt einige Wege wie dies geschehen kann.  Die Folgenden
	funktionieren alle gleicherma&szlig;en:</para>

      <itemizedlist>
        <listitem>
	  <para>F&uuml;gen Sie die Rechnernamen zu Ihrer
	  <filename>/etc/sendmail.cw</filename> Datei hinzu, wenn Sie
	  <literal>FEATURE(use_cw_file)</literal> verwenden.  Ab
	  <application>sendmail</application>&nbsp;8.10 hei&szlig;t diese Datei
	  <filename>/etc/mail/local-host-names</filename>.</para>
	</listitem>

	<listitem>
	  <para>Tragen Sie eine Zeile mit dem Inhalt
	    <literal>Cwyour.host.com</literal> in Ihre
	    <filename>/etc/sendmail.cf</filename> Datei (beziehungsweise
	    <filename>/etc/mail/sendmail.cf</filename> ab
	    <application>sendmail</application>&nbsp;8.10) ein.</para>
	</listitem>
      </itemizedlist>
    </sect2>
  </sect1>

  <sect1 id="SMTP-Auth">
    <title>SMTP-Authentifizierung</title>

    <para>Ein Mail-Server, der <acronym>SMTP</acronym>-Authentifizierung
      verwendet, bietet einige Vorteile.  Die erforderliche
      Authentifizierung erh&ouml;ht die Sicherheit von
      <application>sendmail</application> und Benutzer, die auf wechselnden
      entfernten Rechnern arbeiten, k&ouml;nnen denselben Mail-Server
      verwenden ohne Ihr Benutzerprogramm jedes Mal neu zu
      konfigurieren.</para>

    <procedure>
      <step>
	<para>Installieren Sie den Port <filename
	    role="package">security/cyrus-sasl</filename>.  Der Port
	  verf&uuml;gt &uuml;ber einige Optionen, die w&auml;hrend
	  der &Uuml;bersetzung festgelegt werden.  Das in diesem Abschnitt
	  diskutierte Beispiel verwendet die Option
	  <option>pwcheck</option>.</para>
      </step>


      <step>
	<para>Editieren Sie nach der Installation von <filename
	    role="package">security/cyrus-sasl</filename> die Datei
	  <filename>/usr/local/lib/sasl/Sendmail.conf</filename> (erstellen
	  Sie die Datei, wenn sie nicht existiert) und f&uuml;gen Sie die
	  folgende Zeile hinzu:</para>

	<programlisting>pwcheck_method: passwd</programlisting>

	<para>Zur Authentifizierung eines Benutzers verwendet
	  <application>sendmail</application> dann die
	  <filename>passwd</filename>-Datenbank von FreeBSD.  Damit
	  m&uuml;ssen zum Versenden von E-Mails keine zus&auml;tzlichen
	  Accounts und Passw&ouml;rter angelegt werden.  Die Benutzer
	  verwenden dasselbe Passwort zum Anmelden wie zum Verschicken von
	  E-Mails.</para>
      </step>

      <step>
	<para>F&uuml;gen Sie jetzt in <filename>/etc/make.conf</filename>
	  die nachstehenden Zeilen hinzu:</para>

	<programlisting>SENDMAIL_CFLAGS=-I/usr/local/include/sasl1 -DSASL
SENDMAIL_LDFLAGS=-L/usr/local/lib
SENDMAIL_LDADD=-lsasl</programlisting>

	<para>Beim &Uuml;bersetzen von <application>sendmail</application>
	  werden damit die <filename
	    role="package">cyrus-sasl</filename>-Bibliotheken benutzt.
	  Stellen Sie daher vor dem &Uuml;bersetzen von
	  <application>sendmail</application> sicher, dass der Port
	  <filename role="package">cyrus-sasl</filename> installiert
	  ist.</para>
      </step>

      <step>
	<para>&Uuml;bersetzen Sie <application>sendmail</application> mit
	  den nachstehenden Kommandos:</para>

	<screen>&prompt.root; <userinput>cd /usr/src/usr.sbin/sendmail</userinput>
&prompt.root; <userinput>make cleandir</userinput>
&prompt.root; <userinput>make obj</userinput>
&prompt.root; <userinput>make</userinput>
&prompt.root; <userinput>make install</userinput></screen>

	<para><application>sendmail</application> sollte sich ohne Probleme
	  &uuml;bersetzen lassen, wenn die Dateien in
	  <filename>/usr/src</filename> nicht ver&auml;ndert wurden und die
	  ben&ouml;tigten Bibliotheken installiert sind.</para>
      </step>

      <step>
	<para>Nachdem Sie <application>sendmail</application> installiert
	  haben, editieren Sie <filename>/etc/mail/freebsd.mc</filename>
	  beziehungsweise die verwendete <filename>.mc</filename>-Datei.
	  Viele Administratoren verwenden die Ausgabe von &man.hostname.1;,
	  um der <filename>.mc</filename>-Datei einen eindeutigen Namen
	  zu geben.  F&uuml;gen Sie die folgenden Zeilen in die
	  <filename>.mc</filename>-Datei ein:</para>

	<programlisting>dnl set SASL options
TRUST_AUTH_MECH(`GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confAUTH_MECHANISMS', `GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN')dnl
define(`confDEF_AUTH_INFO', `/etc/mail/auth-info')dnl</programlisting>

	<para>Diese Anweisungen konfigurieren die Methoden, die
	  <application>sendmail</application> zur Authentifizierung
	  verwendet.  Lesen Sie die mitgelieferte Dokumentation, wenn
	  Sie eine andere Methode als <option>pwcheck</option> verwenden
	  wollen.</para>
      </step>

      <step>
	<para>Abschlie&szlig;end rufen Sie &man.make.1; im Verzeichnis
	  <filename>/etc/mail</filename> auf.  Damit wird aus der
	  <filename>.mc</filename>-Datei eine neue
	  <filename>.cf</filename>-Datei (zum Beispiel
	  <filename>freebsd.cf</filename>) erzeugt.  Das Kommando
	  <command>make install restart</command> installiert die Datei
	  nach <filename>/etc/mail/sendmail.cf</filename> und startet
	  <application>sendmail</application> neu.  Weitere Informationen
	  entnehmen Sie bitte
	  <filename>/etc/mail/Makefile</filename>.</para>
      </step>
    </procedure>

    <para>Wenn alles funktioniert hat, tragen Sie in Ihrem
      Mail-Benutzerprogramm das Passwort f&uuml;r die Authentifizierung ein
      und versenden Sie zum Testen eine E-Mail.  Wenn Sie Probleme haben,
      setzen Sie den <option>LogLevel</option> von
      <application>sendmail</application> auf <literal>13</literal> und
      untersuchen die Fehlermeldungen in
      <filename>/var/log/maillog</filename>.</para>

    <para>Weitere Information erhalten Sie im WWW auf der
      <ulink url="http://www.sendmail.org/~ca/email/auth.html">Webseite von
        <application>sendmail</application></ulink>.</para>
  </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
