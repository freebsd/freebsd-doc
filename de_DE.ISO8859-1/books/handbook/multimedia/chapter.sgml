<!--
     The FreeBSD Documentation Project
     The FreeBSD German Documentation Project

     Original version 1.6
     $FreeBSDde: de-docproj/books/handbook/sound/chapter.sgml,v 1.3 2001/06/27 17:33:42 alex Exp $
     $FreeBSD$
-->

<chapter id="sound">
  <title>Sound</title>

  <para><emphasis>Ein Beitrag von Moses Moore
    <email>jm-moses@home.com</email>, 20 November
    2000.</emphasis></para>
  <para><emphasis>&Uuml;bersetzt von &a.de.pierau;, Februar 2001 und
     &a.de.bkoehler;, Juni 2001.</emphasis></para>

  <sect1>
    <title>Zusammenfassung</title>

    <para>Dieses Kapitel des Handbuchs behandelt das Thema, wie man
      auf einem FreeBSD Rechner Sound aktiviert.</para>
  </sect1>

  <sect1>
    <title>Bestimmen des korrekten Ger&auml;ts</title>

    <indexterm><primary>PCI</primary></indexterm>
    <indexterm><primary>ISA</primary></indexterm>
    <indexterm><primary>Soundkarten</primary></indexterm>
    <para>Zuerst sollten Sie in Erfahrung bringen, was f&uuml;r ein
      Modell Ihrer Soundkarte Sie haben, welcher Chip sie benutzt ist
      und ob es sich um eine PCI- oder ISA-Karte handelt.  FreeBSD
      unterst&uuml;tzt eine ganze Reihe sowohl von PCI- als auch von
      ISA-Karten.  Wenn Ihre Sound-Karte in der folgenden Liste nicht
      auftaucht, konsultieren Sie die &man.pcm.4; Manual-Seite.  Diese
      Liste ist zwar nicht vollst&auml;ndig, deckt jedoch einige der
      verbreitesten Karten ab.</para>

    <itemizedlist>
      <listitem>
	<para>Crystal 4237, 4236, 4232, 4231</para>
      </listitem>

      <listitem>
	<para>Yamaha OPL-SAx</para>
      </listitem>

      <listitem>
	<para>OPTi931</para>
      </listitem>

      <listitem>
	<para>Ensoniq AudioPCI 1370/1371</para>
      </listitem>

      <listitem>
	<para>ESS Solo-1/1E</para>
      </listitem>

      <listitem>
	<para>NeoMagic 256AV/ZX</para>
      </listitem>

      <listitem>
	<para>Sound Blaster Pro, 16, 32, AWE64, AWE128, Live</para>
      </listitem>

      <listitem>
	<para>Creative ViBRA16</para>
      </listitem>

      <listitem>
	<para>Advanced Asound 100, 110, and Logic ALS120</para>
      </listitem>

      <listitem>
	<para>ES 1868, 1869, 1879, 1888</para>
      </listitem>

      <listitem>
	<para>Gravis UltraSound</para>
      </listitem>

      <listitem>
	<para>Aureal Vortex 1 or 2</para>
      </listitem>
    </itemizedlist>
    
    <indexterm><primary>Kernel</primary><secondary>Konfiguration</secondary></indexterm>
    <para>Welchen Treiber Sie in Ihrem Kernel benutzen, h&auml;ngt von
      dem Typ Ihrer Karte ab. Die n&auml;chsten Abschnitte liefern
      genauere Informationen und erkl&auml;ren, was Sie zu Ihrer <!--<link
      linkend="kernelconfig">-->Kernelkonfiguration<!--</link>-->. hinzuf&uuml;gen
      m&uuml;ssen.</para>
      
    <sect2>
      <title>Creative, Advance und ESS Soundkarten</title>

      <para>Haben Sie eine dieser Karten, m&uuml;ssen Sie</para>
	
      <programlisting>device pcm</programlisting>

      <para>zu Ihrer Kernelkonfiguration hinzuf&uuml;gen.  Wenn Ihre
	Karte eine PnP ISA-Karte ist, f&uuml;gen Sie weiterhin</para>

      <programlisting>device sbc</programlisting>

      <para>hinzu.  F&uuml;r eine nicht-PnP ISA-Karte mu&szlig;</para>

      <programlisting>device pcm</programlisting>
      
      <para>und</para>

      <programlisting>device sbc0 at isa? port0x220 irq 5 drq 1 flags
      0x15</programlisting>

      <para>in Ihre Kernelkonfiguration. Dies sind die
	Voreinstellungen, Sie werden unter Umst&auml;nden den IRQ
	u.s.w. anpassen m&uuml;ssen.  Schauen Sie dazu in die
	&man.sbc.4; Manual-Seite f&uuml;r weitere
	Informationen.</para>

      <note>
	<para>Die Karte Sound Blaster Live wird unter FreeBSD 4.0
	  nicht unterst&uuml;tzt.  Dazu ben&ouml;tigt man einen Patch,
	  welcher in diesem Dokument nicht behandelt wird.  Es ist
	  deshalb empfehlenswert, da&szlig; Sie in diesem Fall Ihr
	  System auf den neuesten -STABLE Stand aktualisieren, bevor
	  Sie diese Karte benutzen k&ouml;nnen.</para>
      </note>
    </sect2>

    <sect2>
      <title>Gravis UltraSound Karten</title>

      <para>F&uuml;r eine PnP ISA-Karte, m&uuml;ssen Sie</para>

      <programlisting>device pcm</programlisting>

      <para>und</para>

      <programlisting>device gusc</programlisting>

      <para>zu Ihrer Kernelkonfiguration zuf&uuml;gen. Wenn Sie eine
	nicht-PnP ISA-Karte besitzen, erg&auml;nzen Sie</para>

      <programlisting>device pcm</programlisting>

      <para>und</para>

      <programlisting>device gus0 at isa? port 0x220 irq 5 drq 1 flags
      0x13</programlisting>

      <para>in Ihrer Kernelkonfiguration. Es kann sein, da&szlig; Sie
	den IRQ u.s.w. anpassen m&uuml;ssen. Lesen Sie dazu die
	&man.gusc.4; Manual-Seite f&uuml;r weitere
	Informationen.</para>
    </sect2>

    <sect2>
      <title>Crystal Sound-Karten</title>

      <para>F&uuml;r Crystal Karten, brauchen Sie die beiden
      Zeilen</para>

      <programlisting>device pcm</programlisting>

      <para>und</para>

      <programlisting>device csa</programlisting>

      <para>in Ihrer Kernelkonfiguration.</para>
    </sect2>

    <sect2>
      <title>Allgemeine Unterst&uuml;zung</title>

      <para>F&uuml;r PnP ISA- oder PCI-Karten f&uuml;gen Sie</para>

      <programlisting>device pcm</programlisting>

      <para>zu Ihrer Kernelkonfiguration hinzu. Wenn Sie eine
	nicht-PnP ISA-Karte besitzen, die keinen bridge driver hat,
	geben Sie zus&auml;tzlich</para>

      <programlisting>device pcm0 at isa? irq 10 drq 1 flags
      0x0</programlisting>

      <para>in Ihrer Kernelkonfiguration an.  &Auml;ndern Sie IRQ
	u.s.w. so, da&szlig; es mit Ihrer Hardwarekonfiguration
	&uuml;berein stimmt.</para>
    </sect2>
  </sect1>

  <sect1>
    <title>Kernel-Kompilierung</title>

    <para>Nachdem Sie den oder die Treiber zu Ihrer
      Kernelkonfiguration hinzugef&uuml;gt haben, m&uuml;ssen Sie
      Ihren Kernel neu kompilieren.  Lesen Sie das entsprechende
      Kapitel <!-- <xref
      linkend="kernelconfig-building">-->des Handbuchs f&uuml;r
      ausf&uuml;hrliche Informationen dazu.</para>
  </sect1>

  <sect1>
    <title>Erstellen und Testen der Device Nodes</title>

    <indexterm><primary>Device Nodes</primary></indexterm>
    <para>Nach einem Neustart loggen Sie sich ein und geben
      <command>cat /dev/sndstat</command> ein.  Sie sollten etwas wie
      das folgende sehen:</para>

    <programlisting>FreeBSD Audio Driver (newpcm) Sep 21 2000 18:29:53
Installed devices: pcm0: &lt;Aureal Vortex 8830&gt; at memory
0xfeb40000 irq 5 (4p/1r +channels duplex)</programlisting>

    <para>Erhalten Sie eine Fehlermeldung, ist vorher irgendetwas
      schief gegangen.  Wenn das passiert, schauen Sie sich Ihre
      Kernelkonfiguration noch einmal an und stellen Sie sicher,
      da&szlig; Sie den richtigen Treiber gew&auml;hlt haben.</para>

    <para>Wenn es keine Fehlermeldungen gab und das Kommando
      <devicename>pcm0</devicename> ausgab, werden Sie mit
      <command>su</command> zu <username>root</username> und machen
      das folgende:</para>

    <screen>
&prompt.root; <userinput>cd /dev</userinput> &prompt.root;
<userinput>sh MAKEDEV snd0</userinput></screen>

    <para>Wenn es keine Fehlermeldungen gab und das Kommando
      <devicename>pcm1</devicename> ausgab, werden Sie mit
      <command>su</command> zu <username>root</username> und machen
      das folgende:</para>

    <screen>
&prompt.root; <userinput>cd /dev</userinput> &prompt.root;
<userinput>sh MAKEDEV snd1</userinput></screen>

    <para>Beachten Sie bitte, da&szlig; die obigen Kommandos
      <emphasis>kein</emphasis> Device
      <devicename>/dev/snd</devicename> anlegen werden.  Statt dessen
      wird eine Gruppe von Device Nodes erzeugt, unter anderem:</para>

    <informaltable frame="none">
      <tgroup cols="2">
	<thead>
	  <row>
	    <entry>Device</entry>
	    <entry>Beschreibung</entry>
	  </row>
	</thead>

	<tbody>
	  <row>
	    <entry><devicename>/dev/audio</devicename></entry>
	    <entry>SPARC-compatible audio device</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/dsp</devicename></entry>
	    <entry>Digitized voice device</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/dspW</devicename></entry>
	    <entry>Like <devicename>/dev/dsp</devicename>, but 16 bits
	      per sample</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/midi</devicename></entry>
	    <entry>Raw midi access device</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/mixer</devicename></entry>
	    <entry>Control port mixer device</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/music</devicename></entry>
	    <entry>Level 2 sequencer interface</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/sequencer</devicename></entry>
	    <entry>Sequencer device</entry>
	  </row>

	  <row>
	    <entry><devicename>/dev/pss</devicename></entry>
	    <entry>Programmable device interface</entry>
	  </row>
	</tbody>
      </tgroup>
    </informaltable>

    <para>Wenn alles geklappt hat, haben Sie jetzt eine
      funktionierende Sound-Karte.  Falls nicht, lesen Sie den
      n&auml;chsten Abschnitt.</para>
  </sect1>

  <sect1>
    <title>H&auml;ufige Probleme</title>

    <qandaset>
      <indexterm><primary>Device Node</primary></indexterm>
      <qandaentry>
	<question>
	  <para>Ich erhalte den Fehler unsupported subdevice
	  XX!</para>
	</question>

	<answer>
	  <para>Ein oder mehrere Device Nodes wurden nicht korrekt
	    erzeugt.  Wiederholen Sie die obigen Schritte.</para>
	</answer>
      </qandaentry>

      <indexterm><primary>I/O port</primary></indexterm>
      <qandaentry>
	<question>
	  <para>Ich erhalte den Fehler sb_dspwr(XX) timed out!</para>
	</question>

	<answer>
	  <para>Der I/O Port ist nicht korrekt angegeben.</para>
	</answer>
      </qandaentry>

      <indexterm><primary>IRQ</primary></indexterm>
      <qandaentry>
	<question>
	  <para>Ich erhalte den Fehler bad irq XX!</para>
	</question>

	<answer>
	  <para>Der IRQ ist falsch gesetzt.  Stellen Sie sicher,
	    da&szlig; Sie der angegebene IRQ mit dem Sound IRQ
	    &uuml;bereinstimmt.</para>
	</answer>
      </qandaentry>

      <qandaentry>
	<question>
	  <para>Ich erhalte den Fehler "xxx: gus pcm not attached, out
	    of memory".  Was ist die Ursache daf&uuml;r?</para>
	</question>

	<answer>
	  <para>Wenn das passiert, ist nicht genug Speicher
	    verf&uuml;gbar, um das Ger&auml;t betreiben zu
	    k&ouml;nnen.</para>
	</answer>
      </qandaentry>
    </qandaset>
  </sect1>
</chapter>
