<!--
     The FreeBSD Documentation Project
     The FreeBSD German Documentation Project

     $FreeBSD$
     $FreeBSDde: de-docproj/books/handbook/disks/chapter.sgml,v 1.1 2001/07/16 18:07:40 alex Exp $
     Original version 1.35 (ohne Indizes)
-->

<chapter id="disks">
  <title>Laufwerke</title>

  <sect1 id="disks-synopsis">
    <title>&Uuml;bersicht</title>

    <para>Dieses Kapitel behandelt die Benutzung von physikalischen-,
      Speicher- oder Netzwerklaufwerken unter FreeBSD.</para>
  </sect1>

  <sect1 id="disks-bios-numbering">
    <title>Numerierung der Laufwerke im BIOS</title>

    <para>Bevor Sie FreeBSD auf Ihrem System installieren und konfigurieren,
      sollten Sie einen wichtigen Punkt beachten, besonders wenn Sie
      mehrere Festplatten besitzen.</para>

    <para>In einem PC, der unter DOS oder einem anderen vom BIOS 
      abh&auml;ngigen Betriebssystem (WINxxx) l&auml;uft, kann das BIOS die
      normale Reihenfolge der Laufwerke ver&auml;ndern, wobei dies
      vom Betriebssystem beachtet wird.  Damit ist es dem Benutzer
      m&ouml;glich, von einer anderen Platte als dem sogenannten
      <quote>primary master</quote> zu booten.  Besonders bequem
      ist das f&uuml;r Benutzer, die herausgefunden haben, da&szlig;
      der einfachste und billigste Weg, ein Backup zu erstellen, der
      Kauf einer identischen zweiten Platte ist, auf die dann die
      erste Platte mit Ghost oder XCOPY kopiert wird.  Wenn die erste
      Platte ausf&auml;llt, von einem Virus befallen wird, oder
      durch einen Fehler des Betriebssystems verunstaltet wird, kann
      durch logisches Tauschen der beiden Platten im BIOS der alte
      Zustand wiederhergestellt werden.  Es sieht dann so aus, als w&auml;ren
      die Kabel der Laufwerke getauscht worden, ohne das Geh&auml;use
      zu &ouml;ffnen.</para>

    <para>Teurere Systeme mit SCSI-Controllern haben oft BIOS Erweiterungen,
      mit denen die Reihenfolge von bis zu sieben SCSI-Platten in
      &auml;hnlicher Weise ver&auml;ndert werden kann.</para>

    <para>Ein Benutzer, der es gewohnt ist, diese Eigenschaften
      zu nutzen, mag &uuml;berrascht sein, da&szlig; sich FreeBSD
      nicht wie erwartet verh&auml;lt.  FreeBSD verwendet das BIOS nicht
      und wei&szlig; daher nichts von der <quote>logischen Plattenordnung
      im BIOS</quote>.  Dies kann zu sehr verwirrenden Situationen
      f&uuml;hren, insbesondere wenn die Platten identische Geometrien
      besitzen und Kopien voneinander sind.</para>

    <para>Vor der Installation von FreeBSD sollte im BIOS die
      normale Numerierung der Laufwerke eingestellt und so belassen
      werden.  Ist es n&ouml;tig, die Reihenfolge der
      Laufwerke zu ver&auml;ndern, so sollte das immer auf dem schweren
      Weg, also durch &Ouml;ffnen des Geh&auml;uses und Ver&auml;ndern der
      Jumper und Kabel, erfolgen.</para>

    <sidebar>
      <title>Eine Anekdote aus den Aufzeichnungen von Bill und Freds
	au&szlig;ergew&ouml;hnlichen Abenteuern:</title>
      
      <para>Bill verwertet eine &auml;ltere Wintel Kiste, um daraus
        ein weiteres FreeBSD System f&uuml;r Fred zu machen.
	Dazu konfiguriert er eine einzelne SCSI-Platte als SCSI-Einheit null
	und installiert darauf FreeBSD.</para>

      <para>Nachdem Fred das System einige Tage benutzt hat, bemerkt er,
	da&szlig; die &auml;ltere SCSI-Platte viele Fehler meldet 
	und sagt dies Bill.</para>

      <para>Ein paar Tage sp&auml;ter entscheidet Bill, die Sache
        in die Hand zu nehmen und schnappt sich eine identische SCSI-Platte
	aus dem "Lager" im Hinterzimmer.  Ein zuerst 
	durchgef&uuml;hrter Oberfl&auml;chenscan zeigt, da&szlig; das Laufwerk
	in Ordnung ist, also baut Bill die Platte als SCSI-Einheit vier
	ein und kopiert ein Abbild von Platte null auf Platte vier.  Nachdem
	die neue Platte installiert ist und gut funktioniert, entscheidet
	Bill, da&szlig; sie auch benutzt werden soll.  Dazu
	&auml;ndert er im SCSI-BIOS die Reihenfolge der Platten, so da&szlig;
	das System von der SCSI-Einheit vier bootet.  Das FreeBSD System
	bootet und l&auml;uft zufriedenstellend.</para>

      <para>Fred arbeitet einige Zeit mit dem System und bald darauf
	haben Bill und Fred Lust auf ein weiteres
	Abenteuer -- Das System soll auf eine neuere Version von FreeBSD
	migriert werden.  Bill entfernt dabei die instabile SCSI-Einheit null
	und ersetzt sie mit einer identischen Platte
	aus dem "Lager."  Dann installiert er mit Freds wunderbaren FTP
	Disketten aus dem Internet eine neue Version von
	FreeBSD auf die Einheit null.  Die Installation l&auml;uft
	prima.</para>

      <para>Fred braucht ein paar Tage, um die neue FreeBSD
	Version zu testen und entscheidet, da&szlig; sie gut genug ist,
	um sie in der technischen Abteilung einzusetzen...es ist
	an der Zeit seine Arbeit aus der alten Version zu kopieren.
	Dazu h&auml;ngt er
	die Einheit vier, die frischste Kopie der alten Version, an und
	stellt best&uuml;rzt fest, da&szlig; sich nichts von seiner
	wertvollen Arbeit dort befindet.</para>

      <para>Wo sind die Daten hin?</para>

      <para>Als Bill ein Abbild der originalen SCSI-Einheit null auf
	die SCSI-Einheit vier kopierte, erzeugte er einen <quote>Clone</quote>.
	Mit der &Auml;nderung der Reihenfolge im SCSI-BIOS
        f&uuml;hrte er sich nur selbst an der Nase herum.  FreeBSD benutzte
	weiterhin die SCSI-Einheit null.  Durch diese &Auml;nderung im
	BIOS wird ein Teil oder alles der Boot- und Loader-Codes von
	der ausgesuchten Platte geladen.  Wenn allerdings die Kernel Treiber
	von FreeBSD den Bootvorgang &uuml;bernehmen, wird die Numerierung
	im BIOS ignoriert und die normale Numerierung benutzt.
	Im Beispiel lief das System weiterhin von der SCSI-Einheit
	null und alle Daten von Fred befanden sich dort und nicht auf
	Einheit vier.  Die Tatsache, da&szlig; das System auf der
	Einheit vier zu laufen schien, war nur ein Artifakt menschlicher
	Wahrnehmung.</para>

      <para>Wir sind erleichtert zu bemerken, da&szlig; keine Daten verloren
	gingen oder ver&auml;ndert wurden.  Die alte SCSI-Einheit null
	wurde aus dem Abfallberg geborgen und Freds Daten konnten 
	wiederhergestellt werden (Bill wei&szlig; jetzt, da&szlig; er
	nur bis null z&auml;hlen kann).</para>

      <para>Obwohl in diesem Beispiel SCSI-Platten verwendet wurden, gelten
	die Konzepte gleicherma&szlig;en f&uuml;r IDE-Platten.</para>
    </sidebar>
  </sect1>

  <sect1 id="disks-naming">
    <title>Benennung von Laufwerken</title>

    <para>Physikalische Laufwerke existieren in zwei Hauptvarianten:
      <acronym>IDE</acronym> und <acronym>SCSI</acronym>. Es gibt
      aber auch Platten, die von RAID-Controllern, Flash-Speicher
      usw. gesteuert werden.  Da sich diese Laufwerke 
      unterschiedlich verhalten, haben sie ihre eigenen Treiber
      und Ger&auml;te.</para>

    <table id="disk-naming-physical-table">
      <title>Namenskonventionen physikalischer Laufwerke</title>

      <tgroup cols="2">
	<thead>
	  <row>
	    <entry>Laufwerkstyp</entry>
	    <entry>Ger&auml;tename</entry>
	  </row>
	</thead>
	<tbody>
	  <row>
	    <entry>IDE-Festplatten</entry>
	    <entry><literal>ad</literal> in 4.0-RELEASE,
	      <literal>wd</literal> vor 4.0-RELEASE.</entry>
	  </row>
	  <row>
	    <entry>IDE-CDROM Laufwerke</entry>
	    <entry><literal>acd</literal> ab 4.1-RELEASE,
	      <literal>wcd</literal> vor 4.0-RELEASE.</entry>
	  </row>
	  <row>
	    <entry>SCSI-Festplatten</entry>
	    <entry><literal>da</literal> ab 3.0-RELEASE,
	      <literal>sd</literal> vor 3.0-RELEASE.</entry>
	  </row>
	  <row>
	    <entry>SCSI-CDROM Laufwerke</entry>
	    <entry><literal>cd</literal></entry>
	  </row>
	  <row>
	    <entry>Verschiedene propriet&auml;re CDROM Laufwerke</entry>
	    <entry><literal>mcd</literal> Mitsumi CD-ROM,
	      <literal>scd</literal> Sony CD-ROM,
	      <literal>matcd</literal> Matsushita/Panasonic CD-ROM
	    </entry>
	  </row>
	  <row>
	    <entry>Diskettenlaufwerke</entry>
	    <entry><literal>fd</literal></entry>
	  </row>
	  <row>
	    <entry>SCSI-Bandlaufwerke</entry>
	    <entry><literal>sa</literal> ab 3.0-RELEASE,
	      <literal>st</literal> vor 3.0-RELEASE.</entry>
	  </row>
	  <row>
	    <entry>IDE-Bandlaufwerke</entry>
	    <entry><literal>ast</literal> ab 4.0-RELEASE,
	      <literal>wst</literal> vor 4.0-RELEASE.</entry>
	  </row>
	  <row>
	    <entry>Flash-Laufwerke</entry>
	    <entry><literal>fla</literal> DiskOnChip Flash device
	      ab 3.3-RELEASE.</entry>
	  </row>
	  <row>
	    <entry>RAID-Laufwerke</entry>
	    <entry><literal>myxd</literal> Mylex, und
	      <literal>amrd</literal> AMI MegaRAID,
	      <literal>idad</literal> Compaq Smart RAID.
	      ab 4.0-RELEASE.  <literal>id</literal> zwischen
	      3.2-RELEASE und 4.0-RELEASE.</entry>
	  </row>
	</tbody>
      </tgroup>
    </table>

    <sect2>
      <title>Slices und Partitionen</title>

      <para>Physikalische Platten enthalten <firstterm>Slices</firstterm>,
	sofern sie nicht <quote>dangerously dedicated</quote> sind.
	Die Nummer einer Slice folgt dem Ger&auml;tenamen mit
	vorgestelltem <literal>s</literal>:
	<quote>da0<emphasis>s1</emphasis></quote>.</para>

      <para>Slices, <quote>dangerously dedicated</quote> physikalische
	Laufwerke und andere Laufwerke enthalten 
	<firstterm>Partitionen</firstterm>, die mit Buchstaben
	von <literal>a</literal> bis <literal>h</literal> gekennzeichnet
	werden.  <literal>b</literal> ist f&uuml;r Swap-Partitionen
	reserviert und <literal>c</literal> ist eine nicht benutzte
	Partition mit der Gr&ouml;&szlig;e der ganzen Slice bzw.
	des ganzen Laufwerkes.  In <xref linkend="disks-adding">
	wird darauf genauer eingegangen.</para>
    </sect2>
  </sect1>

  <sect1 id="disks-mounting">
    <title>Anh&auml;ngen und Abh&auml;ngen von Dateisystemen</title>

    <para>Ein Dateisystem wird am besten als ein Baum mit der
      Wurzel <filename>/</filename> veranschaulicht.
      <filename>/dev</filename>, <filename>/usr</filename>, und
      die anderen Verzeichnisse im Rootverzeichnis sind Zweige,
      die wiederum eigene Zweige wie <filename>/usr/local</filename>
      haben k&ouml;nnen.</para>

    <para>Es gibt verschiedene Gr&uuml;nde, bestimmte dieser Verzeichnisse
      auf eigenen Dateisystemen anzulegen.  <filename>/var</filename>
      enth&auml;lt <filename>log/</filename>, <filename>spool/</filename>
      sowie verschiedene andere tempor&auml;re
      Dateien und kann sich daher schnell f&uuml;llen.  Es empfiehlt sich
      <filename>/var</filename> von <filename>/</filename> zu trennen,
      da es schlecht ist, wenn das Root-Dateisystem voll
      l&auml;uft.</para>

    <para>Ein weiterer Grund bestimmte Verzeichnisb&auml;ume auf
      andere Dateisysteme zu legen, ist gegeben, wenn sich die
      Verzeichnisb&auml;ume auf gesonderten physikalischen oder
      virtuellen Platten, wie 
      Network File System
      <!--
      <link linkend="nfs">Network File System</link>
      -->
      oder CDROM Laufwerken, befinden.</para>

    <sect2 id="disks-fstab">
      <title>Die fstab Datei</title>

      <para>W&auml;hrend des Boot Prozesses
	<!--
	<link linkend="boot">Boot Prozesses</link>
	-->
	werden in <filename>/etc/fstab</filename> aufgef&uuml;hrte
	Verzeichnisse, sofern sie nicht mit der Option <option>noauto</option>
	versehen sind, automatisch angehangen.</para>

      <para>Die Zeilen in <filename>/etc/fstab</filename> haben das
	folgende Format:</para>

      <programlisting><replaceable>device</replaceable>	<replaceable>/mount-point</replaceable>	<replaceable>fstype</replaceable>	<replaceable>options</replaceable>	<replaceable>dumpfreq</replaceable>	<replaceable>passno</replaceable></programlisting>

      <para><literal>device</literal> ist ein existierender Ger&auml;tename
	wie oben in <link linkend="disks-naming">Benennung von Laufwerken
	</link> beschrieben.</para>

      <para><literal>mount-point</literal> ist ein existierendes Verzeichnis,
	an das das Dateisystem angehangen wird.</para>

      <para><literal>fstype</literal> ist der Typ des Dateisystems,
	der an &man.mount.8; weitergegeben wird.  Das default
	FreeBSD Dateisystem ist <literal>ufs</literal>.</para>

      <para><literal>options</literal> ist entweder <option>rw</option>
	f&uuml;r beschreibbare Dateisysteme oder <option>ro</option>
	f&uuml;r schreibgesch&uuml;tzte Dateisysteme, gefolgt von
	weiteren ben&ouml;tigten Optionen.  Eine h&auml;ufig verwendete
	Option ist <option>noauto</option> f&uuml;r Dateisysteme,
	die w&auml;hrend der normalen Bootsequenz nicht angehangen
	werden sollen.  Weitere Optionen finden sich 
	in &man.mount.8;.</para>

      <para><literal>dumpfreq</literal> ist die Anzahl der Tage,
	nach der das Dateisystem gesichert werden soll.
	Der Zeitpunkt, an dem das Dateisystem w&auml;hrend des Boot Vorgangs
	&uuml;berpr&uuml;ft wird, ist durch <literal>passno</literal>
	gegeben.</para>
    </sect2>

    <sect2 id="disks-mount">
      <title>Das mount Kommando</title>

      <para>&man.mount.8; h&auml;ngt schlie&szlig;lich Dateisysteme 
	an.</para>

      <para>In der grundlegenden Form wird es wie folgt benutzt:</para>

      <informalexample>
	<screen>&prompt.root; <userinput>mount <replaceable>device</replaceable> <replaceable>mountpoint</replaceable></userinput></screen>
      </informalexample>

      <para>Viele Optionen werden in &man.mount.8; beschrieben,
	die am h&auml;ufigsten verwendeten sind:</para>

      <variablelist>
	<title>mount Optionen</title>

	<varlistentry>
	  <term><option>-a</option></term>

	  <listitem>
            <para>H&auml;ngt alle Dateisysteme, oder alle Dateisysteme
	      eines bestimmten Typs, wenn <option>-t</option> angegeben
	      wurde, aus <filename>/etc/fstab</filename> an.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-d</option></term>

	  <listitem>
            <para>F&uuml;hrt alles bis auf das Anh&auml;ngen des
	      Dateisystems aus.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-f</option></term>

	  <listitem>
	    <para>Erzwingt das Anh&auml;ngen des Dateisystems.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-r</option></term>

	  <listitem>
	    <para>H&auml;ngt das Dateisystem schreibgesch&uuml;tzt an.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-t</option>
	    <replaceable>fstype</replaceable></term>

	  <listitem>
            <para>H&auml;ngt das Dateisystem mit dem angebenen Typ an,
	      oder h&auml;ngt nur Dateisysteme mit dem angegebenen Typ
	      an, wenn auch <option>-a</option> angegeben
	      wurde.</para>

            <para>Die Voreinstellung f&uuml;r den Typ des Dateisystems
	      ist <quote>ufs</quote>.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-u</option></term>

	  <listitem>
	    <para>Aktualisiert die Mountoptionen des Dateisystems.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-v</option></term>

	  <listitem>
	    <para>Geschw&auml;tzig sein.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term><option>-w</option></term>

	  <listitem>
	    <para>H&auml;ngt das Dateisystem beschreibbar an.</para>
	  </listitem>
	</varlistentry>
      </variablelist>

      <para><option>-o</option> erwartet eine durch Kommata separierte Liste
	von Optionen, unter anderem die folgenden:</para>

      <variablelist>
	<varlistentry>
	  <term>nodev</term>

	  <listitem>
            <para>Beachtet keine Ger&auml;tedateien auf dem Dateisystem.
	      Dies ist ein n&uuml;tzliches Sicherheitsfeature.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>noexec</term>

	  <listitem>
	    <para>Verbietet das Ausf&uuml;hren von bin&auml;ren
	      Dateien auf dem Dateisystem.  Dies ist ein
	      n&uuml;tzliches Sicherheitsfeature.</para>
	  </listitem>
	</varlistentry>

	<varlistentry>
	  <term>nosuid</term>

	  <listitem>
	    <para>SetUID und SetGID Bits werden auf dem Dateisystem
	      nicht beachtet.  Dies ist ein n&uuml;tzliches
	      Sicherheitsfeature.</para>
	  </listitem>
	</varlistentry>
      </variablelist>
    </sect2>

    <sect2 id="disks-umount">
      <title>Das umount Kommando</title>

      <para><command>umount</command> akzeptiert als Parameter entweder
	einen Mountpoint, einen Ger&auml;tenamen, oder die
	Optionen <option>-a</option> oder <option>-A</option>.</para>

      <para>Jede Form akzeptiert <option>-f</option>, um das
	Abh&auml;ngen zu erzwingen, und <option>-v</option>, um
	etwas geschw&auml;tziger zu sein.</para>

      <para><option>-a</option> und <option>-A</option> werden benutzt
	um alle Dateisysteme, deren Typ durch <option>-t</option>
	modifiziert werden kann, abzuh&auml;ngen.  <option>-A</option>
	h&auml;ngt das Rootdateisystem nicht ab.</para>
    </sect2>
  </sect1>
  
  <sect1 id="disks-adding">
    <title>Hinzuf&uuml;gen von Laufwerken</title>

    <para><emphasis>Im Original von &a.obrien;
      26 April 1998</emphasis></para>
      
    <para>Angenommen, Sie wollen ein neues SCSI-Laufwerk zu einer Maschine
      hinzuf&uuml;gen, die momentan nur ein Laufwerk hat.  Dazu schalten
      Sie zuerst den Rechner aus und installieren das Laufwerk entsprechend
      der Anleitungen Ihres Rechners, Ihres Controllers und Laufwerk
      Herstellers.  Wegen der gro&szlig;en Abweichungen in der genauen 
      Vorgehensweise w&uuml;rde eine detaillierte Beschreibung den Rahmen dieses
      Dokumentes sprengen.</para>

    <para>Nachdem Sie das Laufwerk installiert haben, melden Sie sich als
      Benutzer <username>root</username> an und kontrollieren Sie
      <filename>/var/run/dmesg.boot</filename>, um sicherzustellen,
      da&szlig; das neue Laufwerk gefunden wurde.  Das neue Laufwerk
      wird, um das Beispiel fortzuf&uuml;hren, <filename>da1</filename>
      hei&szlig;en und soll unter <filename>/1</filename> angehangen
      werden.  F&uuml;gen Sie eine IDE-Platte hinzu, wird sie
      <filename>wd1</filename> auf pre-4.0 Systemen und <filename>ad1</filename>
      auf den meisten 4.X Systemen hei&szlig;en.</para>

    <para>Da FreeBSD auf IBM-PC kompatiblen Rechnern l&auml;uft, mu&szlig;
      es die PC BIOS-Partitionen, die verschieden von den traditionellen
      BSD-Partitionen sind, ber&uuml;cksichtigen.  Eine PC Platte kann
      bis zu vier BIOS-Partitionen enthalten.  Wenn die Platte 
      ausschlie&szlig;lich f&uuml;r FreeBSD verwendet wird, k&ouml;nnen
      Sie den <emphasis>dedicated</emphasis> Modus benutzen, ansonsten
      mu&szlig; FreeBSD in eine der BIOS-Partitionen installiert werden.
      In FreeBSD hei&szlig;en die PC BIOS-Partitionen 
      <emphasis>Slices</emphasis>, um sie nicht mit den traditionellen
      BSD-Partitionen zu verwechseln.  Sie k&ouml;nnen auch Slices auf
      einer Platte verwenden, die ausschlie&szlig;ich von FreeBSD benutzt wird,
      sich aber in einem Rechner befindet, der noch ein anderes Betriebssystem
      installiert hat.  Dadurch stellen Sie sicher, da&szlig; Sie
      <command>fdisk</command> des anderen Betriebssystems noch
      benutzen k&ouml;nnen.</para>

    <para>Im Fall von Slices wird die Platte als
      <filename>/dev/da1s1e</filename> hinzugef&uuml;gt.  Das hei&szlig;t:
      SCSI-Platte, Einheit 1 (die zweite SCSI-Platte), Slice 1
      (PC BIOS-Partition 1) und die <filename>e</filename> BSD-Partition.
      Wird die Platte ausschlie&szlig;lich f&uuml;r FreeBSD verwendet
      (<quote>dangerously dedicated</quote>), wird sie einfach als 
      <filename>/dev/da1e</filename> hinzugef&uuml;gt.</para>

    <sect2>
      <title>Verwenden von sysinstall</title>
      
      <para>Um ein Laufwerk zu partitionieren und zu labeln, kann das
	men&uuml;gest&uuml;tzte <command>/stand/sysinstall</command>
	benutzt werden.  Dazu melden Sie sich als <username>root</username>
	an oder benutzen <command>su</command>, um 
	<username>root</username> zu werden.  Starten Sie 
	<command>/stand/sysinstall</command> und w&auml;hlen das
	<literal>Configure</literal> Men&uuml;, w&auml;hlen Sie dort
	den Punkt <literal>Partition</literal> aus.  Jetzt sollten Sie
	eine Liste der installierten Festplatten des Systems sehen.  Ist
	<literal>da1</literal> dort nicht aufgef&uuml;hrt, &uuml;berpr&uuml;fen
	Sie bitte die Installation des Ger&auml;tes und die Ausgabe
	von <command>dmesg</command> in 
	<filename>/var/run/dmesg.boot</filename>.</para>
      
      <para>Um in den <literal>FDISK Partition Editor</literal> zu gelangen,
	w&auml;hlen Sie <literal>da1</literal> aus.  Dr&uuml;cken Sie
	<literal>A</literal>, um die ganze Platte f&uuml;r FreeBSD zu nutzen.
	Beantworten Sie die Frage <quote>remain cooperative with
	any future possible operating systems</quote> mit
	<literal>YES</literal>.  <command>W</command> schreibt die
	&Auml;nderung auf die Platte, danach k&ouml;nnen Sie den
	FDISK Editor mit <command>q</command> verlassen.  Da Sie eine
	Platte zu einem schon laufenden System hinzugef&uuml;gt haben,
	beantworten Sie die Frage nach dem Master Boot Record mit
	<literal>None</literal>.</para>

      <para>Als n&auml;chstes w&auml;hlen Sie den 
	<literal>Disk Label Editor</literal> aus.  Dort werden die
	traditionellen BSD-Partitionen erstellt.  Ein Laufwerk kann acht
	Partitionen, die mit den Buchstaben a-h gekennzeichnet werden,
	besitzen.  Einige Partitionen sind f&uuml;r spezielle Zwecke
	reserviert.  Die <literal>a</literal> Partition ist f&uuml;r die
	Root-Partition (<filename>/</filename>) reserviert.  Deshalb
	sollte nur das Laufwerk, von dem gebootet wird, eine
	<literal>a</literal> Partition besitzen.  Die <literal>b</literal>
	Partition wird f&uuml;r Swap-Partitionen benutzt, wobei Sie
	diese auf mehreren Platten benutzen d&uuml;rfen.
	Im <quote>dangerously dedicated</quote> Modus spricht
	die <literal>c</literal> Partition die gesamte Platte an,
	werden Slices verwendet, wird damit die ganze Slice angesprochen.
	Die anderen Partitionen sind f&uuml;r allgemeine Zwecke
	verwendbar.</para>

      <para>Der Label Editor von Sysinstall bevorzugt die <literal>e</literal>
	Partition f&uuml;r Partitionen, die weder Root-Partitionen noch
	Swap-Partitionen sind.  Im Label
	Editor k&ouml;nnen Sie ein einzelnes Dateisystem 
	mit <command>C</command> erstellen.  W&auml;hlen Sie
	<literal>FS</literal>, wenn Sie gefragt werden, ob Sie ein
	FS (Dateisystem) oder Swap erstellen wollen, und geben Sie einen
	Mountpoint z.B. <filename>/mnt</filename> an.  Wenn Sie nach einer
	FreeBSD Installation ein Dateisystem mit Sysinstall erzeugen,
	so werden die Eintr&auml;ge in <filename>/etc/fstab</filename>
	nicht erzeugt, so da&szlig; die Angabe des Mountpoints nicht
	wichtig ist.</para>

      <para>Sie k&ouml;nnen nun das Label auf das Laufwerk schreiben und
	das Dateisystem erstellen, indem Sie <command>W</command>
	dr&uuml;cken.  Ignorieren Sie die Meldung von Sysinstall, da&szlig;
	die neue Partition nicht angehangen werden konnte, und verlassen
	Sie den Label Editor sowie Sysinstall.</para>

      <para>Im letzten Schritt f&uuml;gen Sie noch in 
	<filename>/etc/fstab</filename> den Eintrag f&uuml;r das neue
	Laufwerk ein.</para>
    </sect2>

    <sect2>
      <title>Die Kommandozeile</title>

      <sect3>
	<title>Anlegen von Slices</title>

        <para>Mit der folgenden Vorgehensweise wird eine Platte mit
	  anderen Betriebssystemen, die vielleicht auf Ihrem Rechner
	  installiert sind, zusammenarbeiten und nicht das
	  <command>fdisk</command> Utility anderer Betriebssysteme
	  st&ouml;ren.  Bitte benutzen
	  Sie den <literal>dedicated</literal> Modus nur dann, wenn
	  Sie dazu einen guten Grund haben!</para>

	<screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/rda1 bs=1k count=1</userinput>
&prompt.root; <userinput>fdisk -BI da1</userinput> # Initialisieren der neuen Platte
&prompt.root; <userinput>disklabel -B -w -r da1s1 auto</userinput> # Labeln
&prompt.root; <userinput>disklabel -e da1s1</userinput> # Editieren des Disklabels und Hinzuf&uuml;gen von Partitionen
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>newfs /dev/da1s1e</userinput> # Wiederholen Sie diesen Schritt f&uuml;r jede Partition
&prompt.root; <userinput>mount -t ufs /dev/da1s1e /1</userinput> # Anh&auml;ngen der Partitionen
&prompt.root; <userinput>vi /etc/fstab</userinput> # Wenn Sie zufrieden sind, &auml;ndern sie <filename>/etc/fstab</filename> entsprechend</screen>

	<para>Wenn Sie ein IDE-Laufwerk besitzen, &auml;ndern Sie
	  <filename>da</filename> in <filename>ad</filename>.  Auf
	  Systemen vor 4.0 benutzen Sie <filename>wd</filename>.</para>
      </sect3>
      
      <sect3>
	<title>Dedicated</title>

        <para>Wenn das neue Laufwerk nicht von anderen Betriebssystemen
	  benutzt werden soll, k&ouml;nnen Sie es im 
	  <literal>dedicated</literal> Modus betreiben.  Beachten Sie bitte,
	  da&szlig; Microsoft Betriebssysteme mit diesem Modus eventuell nicht
	  zurechtkommen, aber es entsteht kein Schaden am Laufwerk.  Im
	  Gegensatz dazu wird IBMs OS/2 versuchen, jede ihm nicht bekannte
	  Partition zu reparieren.</para>
	
	<screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/rda1 bs=1k count=1</userinput>
&prompt.root; <userinput>disklabel -Brw da1 auto</userinput>
&prompt.root; <userinput>disklabel -e da1</userinput> # Erstellen der `e' Partition
&prompt.root; <userinput>newfs -d0 /dev/rda1e</userinput>
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>vi /etc/fstab</userinput> # /dev/da1e hinzuf&uuml;gen
&prompt.root; <userinput>mount /1</userinput></screen>
      
	<para>Eine alternative Methode:</para>
      
	<screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/rda1 count=2</userinput>
&prompt.root; <userinput>disklabel /dev/rda1 | disklabel -BrR da1 /dev/stdin</userinput>
&prompt.root; <userinput>newfs /dev/rda1e</userinput>
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>vi /etc/fstab</userinput> # /dev/da1e hinzuf&uuml;gen
&prompt.root; <userinput>mount /1</userinput></screen>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="disks-virtual">
    <title>Virtuelle Laufwerke: Netzwerk-, Speicher- und dateibasierte
      Dateisysteme</title>

    <para>Neben Laufwerken, die sich physikalisch im Rechner befinden
      wie Floppylaufwerke, CDs, Festplatten usw., kann FreeBSD auch
      mit anderen Laufwerken, den <firstterm>virtuellen Laufwerken</firstterm>,
      umgehen.</para>

    <para>Diese beinhalten Netzwerkdateisysteme wie
      <!--
      <link linkend="nfs">Network Filesystem</link> und Coda,
      -->
      Network Filesystem und Coda,
      speicherbasierte Dateisysteme wie
      <link linkend="disks-md">md</link> und auf Dateien basierende
      Dateisysteme, die mit <link linkend="disks-vnconfig">vnconfig</link>
      erstellt wurden.</para>

    <sect2 id="disks-vnconfig">
      <title>vnconfig: auf dateiebasierte Dateisysteme</title>

      <para>Mit &man.vnconfig.8; werden vnode Pseudo Platten
        konfiguriert und aktiviert.  Ein <firstterm>vnode</firstterm>
	stellt eine Datei dar, auf der Dateioperationen ablaufen.
	Das bedeutet, da&szlig; &man.vnconfig.8; Dateien benutzt,
	um ein Dateisystem zu erstellen und zu verwalten.  Damit
	ist es z.B. m&ouml;glich, Dateien, die Images von Floppies
	oder CDs enthalten, anzuh&auml;ngen.</para>

      <para>Um ein existierendes Image eines Dateisystems 
	anzuh&auml;ngen:</para>

      <example>
	<title>Anh&auml;ngen eines existierenden Images mit vnconfig</title>

	<screen>&prompt.root; <userinput>vnconfig vn<replaceable>0</replaceable> <replaceable>diskimage</replaceable></userinput>
&prompt.root; <userinput>mount /dev/vn<replaceable>0</replaceable>c <replaceable>/mnt</replaceable></userinput></screen>
      </example>

      <para>Um ein neues Dateisystem mit vnconfig anzulegen:</para>

      <example>
	<title>Anlegen eines dateibasierten Laufwerks</title>
	
	<screen>&prompt.root; <userinput>dd if=/dev/zero of=<replaceable>newimage</replaceable> bs=1k count=<replaceable>5</replaceable>k</userinput>
5120+0 records in
5120+0 records out
&prompt.root; <userinput>vnconfig -s labels -c vn<replaceable>0</replaceable> <replaceable>newimage</replaceable></userinput>
&prompt.root; <userinput>disklabel -r -w vn<replaceable>0</replaceable> auto</userinput>
&prompt.root; <userinput>newfs vn<replaceable>0</replaceable>c</userinput>
Warning: 2048 sector(s) in last cylinder unallocated
/dev/rvn0c:     10240 sectors in 3 cylinders of 1 tracks, 4096 sectors
        5.0MB in 1 cyl groups (16 c/g, 32.00MB/g, 1280 i/g)
super-block backups (for fsck -b #) at:
 32
&prompt.root; <userinput>mount /dev/vn<replaceable>0</replaceable>c <replaceable>/mnt</replaceable></userinput>
&prompt.root; <userinput>df <replaceable>/mnt</replaceable></userinput>
Filesystem  1K-blocks     Used    Avail Capacity  Mounted on
/dev/vn0c        4927        1     4532     0%    /mnt</screen>
      </example>
    </sect2>

    <sect2 id="disks-md">
      <title>md: Dateisysteme im Speicher</title>

      <para>md ist ein einfaches und effizientes Mittel um
	mit speicherbasierten Dateisystemen zu arbeiten.</para>

      <para>Nehmen Sie einfach ein Dateisystem, da&szlig; Sie
	z.B. mit &man.vnconfig.8 vorbereitet haben:</para>

      <example>
	<title>md Speicher Laufwerk</title>

	<screen>&prompt.root; <userinput>dd if=<replaceable>newimage</replaceable> of=/dev/md<replaceable>0</replaceable></userinput>
5120+0 records in
5120+0 records out
&prompt.root; <userinput>mount /dev/md<replaceable>0c</replaceable> <replaceable>/mnt</replaceable></userinput>
&prompt.root; <userinput>df <replaceable>/mnt</replaceable></userinput>
Filesystem  1K-blocks     Used    Avail Capacity  Mounted on
/dev/md0c        4927        1     4532     0%    /mnt</screen>
      </example>
    </sect2>
  </sect1>
  
  <sect1 id="quotas">
    <title>Disk Quotas</title>

    <para>Quotas sind ein optionales Feature des Betriebssystems,
      die es Ihnen erlauben, den Plattenplatz und/oder die Anzahl
      der Dateien eines Benutzers oder der Mitglieder einer Gruppe,
      auf Dateisystemebene zu beschr&auml;nken.  Oft wird dies
      auf Timesharing-Systemen (Mehrbenutzersystemen) genutzt, da
      es dort erw&uuml;nscht ist, die Ressourcen, die ein Benutzer oder
      eine Gruppe von Benutzern belegen k&ouml;nnen, zu limitieren.  Das
      verhindert, da&szlig; ein Benutzer den ganzen verf&uuml;gbaren
      Plattenplatz benutzt.</para>

    <sect2>
      <title>Konfiguration des Systems, um Quotas zu
	aktivieren</title>

      <para>Bevor Quotas benutzt werden k&ouml;nnen, m&uuml;ssen
	sie im Kernel konfiguriert werden, wozu die folgende Zeile
	der Kernel Konfiguration hinzugef&uuml;gt wird:</para>

      <programlisting>options QUOTA</programlisting>

      <para>Im gew&ouml;hnlichen <filename>GENERIC</filename> Kernel
        sind Quotas nicht aktiviert, so da&szlig; Sie einen angepa&szlig;ten
	Kernel konfigurieren und bauen m&uuml;ssen, um Quotas zu
	benutzen.  Weitere Informationen gibt das Kapitel 
	Konfiguration des FreeBSD Kernels.</para>
	<!--
	<link linkend="kernelconfig">Konfiguration des FreeBSD Kernels
	</link>.</para>
	-->

      <para>Durch Hinzuf&uuml;gen der folgenden Zeile in
        <filename>/etc/rc.conf</filename> wird das Quota-System
	aktiviert:</para>

      <programlisting>enable_quotas=<quote>YES</quote></programlisting>

      <para>Um den Start des Quota-Systems zu beeinflussen, steht
	eine weitere Variable zur Verf&uuml;gung.  Normalerweise
	wird beim Booten die Integrit&auml;t der Quotas auf
	allen Dateisystemen mit <command>quotacheck</command>
	&uuml;berpr&uuml;ft.  <command>quotacheck</command> stellt
	sicher, da&szlig; die Quota-Datenbank mit den Daten auf
	einem Dateisystem &uuml;bereinstimmt.  Dies ist allerdings
	ein sehr zeitraubender Proze&szlig;, der die Zeit, die
	das System zum Booten braucht, signifikant beeinflu&szlig;t.
	Eine Variable erlaubt es Ihnen, diesen Schritt zu
	&uuml;berspringen:</para>

      <programlisting>check_quotas=<quote>NO</quote></programlisting>

      <para>Wenn Sie ein FreeBSD vor 3.2-RELEASE benutzen, ist
	die Konfiguration einfacher.  In <filename>/etc/rc.conf</filename>
	setzen Sie nur eine Variable:</para>

      <programlisting>check_quotas=<quote>YES</quote></programlisting>

      <para>Schlie&szlig;lich m&uuml;ssen Sie noch in 
	<filename>/etc/fstab</filename> die Plattenquotas auf
	Dateisystemebene aktivieren.  Dort k&ouml;nnen Sie 
	f&uuml;r alle Dateisysteme Quotas f&uuml;r Benutzer, Gruppen
	oder f&uuml;r beide aktivieren.</para>

      <para>Um Quotas pro Benutzer f&uuml;r ein Dateisystem zu
        aktivieren, geben Sie f&uuml;r dieses Dateisystem die
	Option <literal>userquota</literal> im Feld Optionen von
	<filename>/etc/fstab</filename> an.  Beispiel:</para>

      <programlisting>/dev/da1s2g   /home    ufs rw,userquota 1 2</programlisting>

      <para>Um Quotas f&uuml;r Gruppen einzurichten, verwenden
	Sie <literal>groupquota</literal> anstelle des Schl&uuml;sselwortes
	<literal>userquota</literal>.  Um Quotas f&uuml;r Benutzer
	und Gruppen einzurichten, &auml;ndern Sie den Eintrag
	wie folgt ab:</para>

      <programlisting>/dev/da1s2g    /home    ufs rw,userquota,groupquota 1 2</programlisting>

      <para>Die Quotas werden jeweils im Rootverzeichnis des Dateisystems
	unter dem Namen <filename>quota.user</filename> f&uuml;r 
	Benutzer-Quotas und <filename>quota.group</filename> f&uuml;r
	Gruppen-Quotas abgelegt.  Obwohl &man.fstab.5; beschreibt,
	da&szlig; diese Dateien an anderer Stelle gespeichert werden 
	k&ouml;nnen, wird das nicht empfohlen, da es den Anschein hat,
	da&szlig; die verschiedenen Quota-Utilities das nicht richtig
	unterst&uuml;tzen.</para>

      <para>Jetzt sollten Sie Ihr System mit dem neuen Kernel booten.
	<filename>/etc/rc</filename> wird dann automatisch die
	richtigen Kommandos aufrufen, die die Quota-Dateien f&uuml;r
	alle Quotas, die Sie in <filename>/etc/fstab</filename>
	definiert haben, anlegen.  Deshalb m&uuml;ssen vorher auch keine
	leeren Quota-Dateien angelegt werden.</para>

      <para>Normalerweise brauchen Sie die Kommandos 
	<command>quotacheck</command>, <command>quotaon</command> oder
	<command>quotaoff</command> nicht h&auml;ndisch aufzurufen,
	obwohl Sie vielleicht die entsprechenden Seiten im
	Manual lesen sollten, um sich mit ihnen vertraut 
	zu machen.</para>
    </sect2>

    <sect2>
      <title>Setzen von Quota-Limits</title>

      <para>Nachdem Sie Quotas in Ihrem System aktiviert haben, sollten
        Sie &uuml;berpr&uuml;fen, da&szlig; Sie auch tats&auml;chlich
	aktiviert sind.  F&uuml;hren Sie dazu einfach den folgenden
	Befehl aus:</para>

      <screen>&prompt.root; <userinput>quota -v</userinput></screen>
	  
      <para>F&uuml;r jedes Dateisystem, auf dem Quotas aktiviert sind,
	sollten Sie eine Zeile mit der Plattenauslastung und den
	aktuellen Quota-Limits sehen.</para>

      <para>Mit <command>edquota</command> k&ouml;nnen Sie nun
	Quota-Limits setzen.</para>

      <para>Sie haben mehrere M&ouml;glichkeiten, die Limits f&uuml;r
	den Plattenplatz, den ein Benutzer oder eine Gruppe verbrauchen
	kann, oder die Anzahl der Dateien, die angelegt werden d&uuml;rfen,
	festzulegen.  Die Limits k&ouml;nnen auf dem Plattenplatz 
	(Block-Quotas) oder der Anzahl der Dateien (Inode-Quotas) oder
	einer Kombination von beiden basieren.
	Jedes dieser Limits wird weiterhin in zwei Kategorien geteilt:
	Hardlimits und Softlimits.</para>

      <para>Ein Hardlimit kann nicht &uuml;berschritten werden.
	Hat der Benutzer einmal ein Hardlimit erreicht, so kann er
	auf dem betreffenden Dateisystem keinen weiteren Platz mehr
	beanspruchen.  Hat ein Benutzer beispielsweise ein Hardlimit
	von 500 Bl&ouml;cken auf einem Dateisystem und benutzt davon
	490 Bl&ouml;cke, so kann er nur noch 10 weitere Bl&ouml;cke
	beanspruchen.  Der Versuch, weitere 11 Bl&ouml;cke zu beanspruchen,
	wird fehlschlagen.</para>

      <para>Im Gegensatz dazu k&ouml;nnen Softlimits f&uuml;r eine
	befristete Zeit &uuml;berschritten werden.  Diese Frist
	(engl. grace period) betr&auml;gt in der Grundeinstellung
	eine Woche.  Hat der Benutzer das Softlimit &uuml;ber die
	Frist hinaus &uuml;berschritten, so wird das Softlimit in
	ein Hardlimit umgewandelt und der Benutzer kann
	keinen weiteren Platz mehr beanspruchen.  Wenn er einmal
	das Softlimit unterschreitet, wird die Frist wieder
	zur&uuml;ckgesetzt.</para>

      <para>Das folgende Beispiel zeigt die Benutzung von
	<command>edquota</command>.  Wenn <command>edquota</command>
	aufgerufen wird, wird ein Editor, der durch <envar>EDITOR</envar>
	gegeben ist, oder <command>vi</command> falls <envar>EDITOR</envar>
	nicht gesetzt ist, gestartet, in dem Sie die Limits eingeben
	k&ouml;nnen.</para>

      <screen>&prompt.root; <userinput>edquota -u test</userinput></screen>

      <programlisting>Quotas for user test:
/usr: blocks in use: 65, limits (soft = 50, hard = 75)
        inodes in use: 7, limits (soft = 50, hard = 60)
/usr/var: blocks in use: 0, limits (soft = 50, hard = 75)
        inodes in use: 0, limits (soft = 50, hard = 60)</programlisting>

      <para>F&uuml;r jedes Dateisystem, auf dem Quotas aktiv sind, 
	sehen Sie zwei Zeilen, eine f&uuml;r die Block-Quotas und die
	andere f&uuml;r die Inode-Quotas.  Um ein Limit zu modifizieren,
	&auml;ndern Sie einfach den angezeigten Wert.  Um beispielsweise
	das Blocklimit dieses Benutzers von einem Softlimit von 50
	und einem Hardlimit von 75 auf ein Softlimit von 500 und
	ein Hardlimit von 600 zu erh&ouml;hen, &auml;ndern Sie
	die Zeile</para>

      <programlisting>/usr: blocks in use: 65, limits (soft = 50, hard = 75)</programlisting>

      <para>zu:</para>

      <programlisting> /usr: blocks in use: 65, limits (soft = 500, hard = 600)</programlisting>

      <para>Die neuen Limits sind wirksam, wenn Sie den 
	Editor verlassen.</para>

      <para>Manchmal ist es erw&uuml;nscht, die Limits f&uuml;r einen
	Bereich von UIDs zu setzen.  Dies kann mit der <option>-p</option>
	Option von <command>edquota</command> bewerkstelligt werden.
	Weisen Sie dazu die Limits einem Benutzer zu und rufen danach
	<command>edquota -p protouser startuid-enduid</command> auf.
	Besitzt beispielsweise der Benutzer <username>test</username>
	die gew&uuml;nschten Limits, k&ouml;nnen diese mit
	dem folgenden Kommando f&uuml;r die UIDs 10.000 bis 19.999
	dupliziert werden:</para>

      <screen>&prompt.root; <userinput>edquota -p test 10000-19999</userinput></screen>
	  
      <para>Weitere Informationen erhalten Sie in &man.edquota.8;.</para>
    </sect2>

    <sect2>
      <title>&Uuml;berpr&uuml;fen von Quota-Limits und Plattennutzung</title>

      <para>Sie k&ouml;nnen <command>quota</command> oder
	<command>repquota</command> benutzen, um Quota-Limits
	und Plattennutzung zu &uuml;berpr&uuml;fen.  Um die Limits
	oder die Plattennutzung individueller Benutzer und Gruppen
	zu &uuml;berpr&uuml;fen, kann <command>quota</command>
	benutzt werden.  Nur der Superuser darf die Limits und
	Plattenausnutzung f&uuml;r andere Benutzer oder Gruppen,
	denen die Benutzer nicht angeh&ouml;ren, untersuchen.
	Mit <command>repquota</command> erhalten Sie eine Zusammenfassung
	von allen Limits und der Plattenausnutzung f&uuml;r alle
	Dateisysteme, auf denen Quotas aktiv sind.</para>

      <para>Das folgende Beispiel zeigt die Ausgabe von
	<command>quota -v</command> f&uuml;r einen Benutzer, der
	Quota-Limits auf zwei Dateisystemen besitzt:</para>

      <programlisting>Disk quotas for user test (uid 1002):
     Filesystem  blocks   quota   limit   grace   files   quota   limit   grace
           /usr      65*     50      75   5days       7      50      60
       /usr/var       0      50      75               0      50      60</programlisting>

      <para>Im Dateisystem <filename>/usr</filename> liegt der Benutzer
	momentan 15 Bl&ouml;cke &uuml;ber dem Softlimit von
	50 Bl&ouml;cken und hat noch 5 Tage seiner Frist &uuml;brig.
	Der Stern <literal>*</literal> zeigt an, da&szlig; der
	Benutzer sein Limit &uuml;berschritten hat.</para>

      <para>In der Ausgabe von <command>quota</command> werden Dateisysteme,
	auf denen ein Benutzer keinen Platz verbraucht, nicht angezeigt,
	auch wenn diesem Quotas zugewiesen wurden.  Mit <option>-v</option>
	werden diese Dateisysteme, wie <filename>/usr/var</filename>
	im obigen Beispiel, angezeigt.</para>
    </sect2>

    <sect2>
      <title>Quotas &uuml;ber NFS</title>

      <para>Quotas werden von dem Quota-Subsystem auf dem NFS Server
	erzwungen.  Der &man.rpc.rquotad.8; Daemon stellt 
	&man.quota.1; die Quota Informationen auf dem NFS Client
	zur Verf&uuml;gung, so da&szlig; Benutzer auf diesen
	Systemen ihre Quotas abfragen k&ouml;nnen.</para>

      <para>Aktivieren Sie <command>rpc.rquotad</command> in
	<filename>/etc/inetd.conf</filename> wie folgt:</para>

      <programlisting>rquotad/1      dgram rpc/udp wait root /usr/libexec/rpc.rquotad rpc.rquotad</programlisting>

      <para>Anschlie&szlig;end starten Sie <command>inetd</command>
	neu:</para>

      <screen>&prompt.root; <userinput>kill -HUP `cat /var/run/inetd.pid`</userinput></screen>
    </sect2>
  </sect1>

  <sect1 id="creating-cds">
    <title>Erstellen von CDs</title>

    <para><emphasis>Beigesteuert von Mike Meyer
      <email>mwm@mired.org</email>, April 2001.</emphasis></para>

    <sect2>
      <title>Einf&uuml;hrung</title>

      <para>CDs besitzen einige Eigenschaften, die sie von
	konventionellen Laufwerken unterscheiden.  Zuerst konnten
	sie nicht beschrieben werden.  Sie wurden so entworfen, da&szlig;
	sie ununterbrochen, ohne Verz&ouml;gerungen durch Kopfbewegungen
	zwischen den Spuren, gelesen werden k&ouml;nnen.  Sie konnten
	fr&uuml;her auch leichter als vergleichbar gro&szlig;e Medien zwischen
	Systemen bewegt werden.</para>
    
      <para>CDs besitzen Spuren, aber damit ist der Teil Daten
	gemeint, der ununterbrochen gelesen wird, und nicht eine
	physikalische Eigenschaft der CD.  Um eine CD mit FreeBSD
	zu erstellen,  werden die Daten jeder Spur der CD in
	Dateien vorbereitet und dann die Spuren auf die CD 
	geschrieben.</para>
    
      <para>Das ISO 9660-Dateisystem wurde entworfen, um mit diesen
	Unterschieden umzugehen.  Leider hat es auch damals &uuml;bliche
	Grenzen f&uuml;r Dateisysteme implementiert.  Gl&uuml;cklicherweise
	existiert ein Erweiterungsmechanismus, der es korrekt
	geschriebenen CDs erlaubt, diese Grenzen zu &uuml;berschreiten
	und dennoch auf Systemen zu funktionieren, die diese
	Erweiterungen nicht unterst&uuml;tzen.</para>

      <para>Mit <command><link linkend="mkisofs">mkisofs</link></command>
	wird eine Datei erstellt, die ein ISO 9660-Dateisystem enth&auml;lt.
	Das Kommando hat Optionen, um verschiedene Erweiterungen
	zu unterst&uuml;tzen, und wird unten beschrieben.  Sie
	k&ouml;nnen es aus dem <filename>/usr/ports/sysutils/mkisofs</filename>
	Port installieren.</para>
    
      <para>Welches Tool Sie zum Brennen von CDs benutzen, h&auml;ngt davon
	ab, ob Ihr CD Brenner ein ATAPI Ger&auml;t ist oder nicht.
	Mit ATAPI CD Brennern wird <command><link linkend="burncd"
	</link>burncd</command> benutzt, das Teil des Basissystems ist.
	SCSI und USB CD-Brenner werden mit <command><link linkend="cdrecord">
	cdrecord</link></command> aus 
	<filename>/usr/ports/sysutils/cdrecord</filename>
	benutzt.</para>
    </sect2>

    <sect2 id="mkisofs">
      <title>mkisofs</title>

      <para><command>mkisofs</command> erstellt ein ISO 9660-Dateisystem,
	das ein Abbild eines Verzeichnisbaumes des Unix-Dateisystems
	ist.  Die einfachste Anwendung ist wie folgt:</para>
    
      <screen>&prompt.root; <userinput>mkisofs <option>-o</option> <replaceable>Imagedatei.iso</replaceable> <replaceable>/path/to/tree</replaceable></userinput></screen>

      <para>Dieses Kommando erstellt eine <replaceable>Imagedatei</replaceable>,
        die ein ISO 9660-Dateisystem enth&auml;lt, das eine Kopie des
	Baumes unter <replaceable>/path/to/tree</replaceable> ist.
	Dabei werden die Dateinamen auf Namen abgebildet, die den
	Restriktionen des ISO 9660-Dateisystems entsprechen.  Dateien
	mit Namen, die im ISO 9660-Dateisystem nicht g&uuml;ltig sind,
	bleiben unber&uuml;cksichtigt.  Details zu diesem Vorgang und
	Optionen, die diesen Vorgang beeinflussen, sind in &man.mkisofs.8;
	beschrieben.</para>
    
      <para>Es einige Optionen, um diese Beschr&auml;nkungen
	zu &uuml;berwinden.  Die unter Unix-Systemen &uuml;blichen
	Rock Ridge Erweiterungen werden durch <option>-R</option>
	aktiviert, <option>-J</option> aktiviert die von Microsoft
	Systemen benutzten Joliet Erweiterungen und <option>-hfs</option>
	dient dazu, um das von Macs benutzte HFS zu erstellen.
	Unter &man.mkisofs.8; finden Sie weitere Informationen
	zu den letzten beiden Punkten.</para>
    
      <para>F&uuml;r CDs, die nur auf FreeBSD-Systemen verwendet werden
	sollen, kann <option>-U</option> genutzt werden, um alle
	Beschr&auml;nkungen f&uuml;r Dateinamen aufzuheben.  Zusammen
	mit <option>-R</option> wird ein identisches Abbild des
	Dateisystems, ausgehend von dem Startpunkt im FreeBSD-Dateibaum,
	erstellt, obwohl dies den ISO 9660 Standard
	verletzen kann.</para>
    
      <para>Die letzte &uuml;bliche Option ist <option>-b</option>.
	Sie wird benutzt, um den Ort eines Bootimages einer
	<quote>El Torito</quote> bootbaren CD anzugeben.  Das Argument
	zu dieser Option ist der Pfad zu einem Bootimage ausgehend
	von der Wurzel des Baumes, der auf die CD geschrieben werden
	soll.  Wenn <filename>/tmp/myboot</filename> ein bootbares
	FreeBSD-System enth&auml;lt, dessen Bootimage sich in
	<filename>/tmp/myboot/boot/cdboot</filename> befindet, k&ouml;nnen
	Sie ein Abbild eines ISO 9660-Dateisystems in
	<filename>/tmp/bootable.iso</filename> wie folgt
	erstellen:</para>

      <screen>&prompt.root; <userinput>mkisofs <option>-U</option> <option>-R</option> <option>-b</option> <filename>boot/cdboot</filename> <option>-o</option> <filename>/tmp/bootable.iso</filename> <filename>/tmp/myboot</filename></userinput></screen>

      <para>Wenn Sie <devicename>vn</devicename> in Ihrem Kernel 
	konfiguriert haben, k&ouml;nnen Sie danach das Dateisystem
	anh&auml;ngen:</para>

      <screen>&prompt.root; <userinput>vnconfig <option>-e</option> <filename>vn0c</filename> <filename>/tmp/bootable.iso</filename></userinput>
&prompt.root; <userinput>mount <option>-t</option> cd9660 <filename>/dev/vn0c</filename> <filename>/mnt</filename></userinput></screen>

      <para>Jetzt k&ouml;nnen Sie &uuml;berpr&uuml;fen, da&szlig
	<filename>/mnt</filename> und <filename>/tmp/myboot</filename>
	identisch sind.</para>

      <para>Sie k&ouml;nnen das Verhalten von <command>mkisofs</command>
	mit einer Vielzahl von Optionen, die in &man.mkisofs.8;
	beschrieben sind, beinflussen.</para>
    </sect2>

    <sect2 id="burncd">
      <title>burncd</title>

      <para>Wenn Sie einen ATAPI CD Brenner besitzen, k&ouml;nnen
	Sie <command>burncd</command> benutzen, um ein ISO-Image
	auf CD zu brennen.  <command>burncd</command> ist Teil
	des Basissystems und unter <filename>/usr/sbin/burncd</filename>
	installiert.  Da es nicht viele Optionen hat, ist es leicht
	zu benutzen:</para>
      
      <screen>&prompt.root; <userinput>burncd <option>-f</option> <replaceable>cddevice</replaceable> data <replaceable>imagefile.iso</replaceable> fixate</userinput></screen>

      <para>Dieses Kommando brennt eine Kopie von
	<replaceable>imagefile.iso</replaceable> auf das Ger&auml;t
	<replaceable>cddevice</replaceable>.  In der Grundeinstellung
	wird das Ger&auml;t <filename>/dev/acd0</filename> benutzt.
	&man.burncd.8; beschreibt, wie die Schreibgeschwindigkeit
	gesetzt wird, die CD ausgeworfen wird und Audio Daten
	geschrieben werden.</para>
    </sect2>

    <sect2 id="cdrecord">
      <title>cdrecord</title>

      <para>Wenn Sie keinen ATAPI CD Brenner besitzen, benutzen Sie
	<command>cdrecord</command>, um CDs zu brennen. 
	<command>cdrecord</command> ist nicht Bestandteil des Basissystems.
	Sie m&uuml;ssen es entweder aus den Ports in
	<filename>/usr/ports/sysutils/cdrecord</filename> oder dem
	passenden Paket installieren.  &Auml;nderungen im Basissystem
	k&ouml;nnen Fehler im bin&auml;ren Programm verursachen und
	f&uuml;hren m&ouml;glicherweise dazu, da&szlig; Sie einen
	<quote>Untersetzer</quote> brennen.  Sie sollten
	daher den Port aktualisieren, wenn Sie Ihr System aktualisieren
	bzw. wenn Sie Stable verfolgen,
        <!--
	<link linkend="stable">Stable verfolgen</link>,
	-->
	den Port aktualisieren, wenn es eine neue Version gibt.</para>
      
      <para>Obwohl <command>cdrecord</command> viele Optionen besitzt,
	ist die grundlegende Anwendung einfacher als <command>burncd</command>.
	Ein ISO 9660 Image erstellen Sie mit:</para>
      
      <screen>&prompt.root; <userinput>cdrecord <option>dev=</option><replaceable>device</replaceable> <replaceable>imagefile.iso</replaceable></userinput></screen>
      
      <para>Der Knackpunkt in der Benutzung von <command>cdrecord</command>
	besteht darin, das richtige Argument zu <option>dev</option> zu
	finden.  Benutzen Sie dazu den <option>-scanbus</option> Schalter
	von <command>cdrecord</command>, der eine &auml;hnliche Ausgabe
	wie die folgende produziert:</para>
      
      <screen>&prompt.root; <userinput>cdrecord <option>-scanbus</option></userinput>
Cdrecord 1.9 (i386-unknown-freebsd4.2) Copyright (C) 1995-2000 J&ouml;rg Schilling
Using libscg version 'schily-0.1'
scsibus0:
        0,0,0     0) 'SEAGATE ' 'ST39236LW       ' '0004' Disk
        0,1,0     1) 'SEAGATE ' 'ST39173W        ' '5958' Disk
        0,2,0     2) *
        0,3,0     3) 'iomega  ' 'jaz 1GB         ' 'J.86' Removable Disk
        0,4,0     4) 'NEC     ' 'CD-ROM DRIVE:466' '1.26' Removable CD-ROM
        0,5,0     5) *
        0,6,0     6) *
        0,7,0     7) *
scsibus1:
        1,0,0   100) *
        1,1,0   101) *
        1,2,0   102) *
        1,3,0   103) *
        1,4,0   104) *
        1,5,0   105) 'YAMAHA  ' 'CRW4260         ' '1.0q' Removable CD-ROM
        1,6,0   106) 'ARTEC   ' 'AM12S           ' '1.06' Scanner
        1,7,0   107) *</screen>

      <para>F&uuml;r die aufgef&uuml;hrten Ger&auml;te in der Liste
	wird das passende Argument zu <option>dev</option> gegeben.
        Benutzen Sie die drei Komma separierten Zahlen, die zu
	Ihrem CD Brenner angegeben sind, als Argument f&uuml;r
	<option>dev</option>.  Im Beispiel ist das CDRW Ger&auml;t
	1,5,0, so da&szlig; die passende Eingabe 
	<userinput><option>dev</option>=1,5,0</userinput> w&auml;re.
	Einfachere Wege das Argument anzugeben, sind in &man.cdrecord.1;
	beschrieben.  Dort sollten Sie auch nach 
	Informationen &uuml;ber Audio Spuren, das Einstellen der
	Geschwindigkeit und &auml;hnlichem suchen.</para>
    </sect2>
  </sect1>
</chapter>

<!-- 
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
