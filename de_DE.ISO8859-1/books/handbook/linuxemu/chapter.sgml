<!--
     The FreeBSD Documentation Project
     The FreeBSD German Documentation Project

     $FreeBSD$
     $FreeBSDde: de-docproj/books/handbook/linuxemu/chapter.sgml,v 1.94 2012/04/30 17:13:51 bcr Exp $
     basiert auf: 1.147
-->

<chapter id="linuxemu">
  <chapterinfo>
    <authorgroup>
      <author>
        <firstname>Jim</firstname>
	<surname>Mock</surname>
	<contrib>Restrukturiert und teilweise aktualisiert von </contrib>
     </author>
     <!-- 22 Mar 2000 -->
    </authorgroup>
    <authorgroup>
      <author>
	<firstname>Brian N.</firstname>
	<surname>Handy</surname>
	<contrib>Beigetragen von </contrib>
      </author>
      <author>
	<firstname>Rich</firstname>
	<surname>Murphey</surname>
      </author>
    </authorgroup>
    <authorgroup>
      <author>
	<firstname>Johann</firstname>
	<surname>Kois</surname>
	<contrib>&Uuml;bersetzt von </contrib>
	</author>
      </authorgroup>
  </chapterinfo>

  <title>Linux-Bin&auml;rkompatibilit&auml;t</title>

  <sect1 id="linuxemu-synopsis">
    <title>&Uuml;bersicht</title>
    <indexterm>
      <primary>Linux-Bin&auml;rkompatibilit&auml;t</primary>
    </indexterm>
    <indexterm>
      <primary>Bin&auml;rkompatibilit&auml;t</primary>
      <secondary>Linux</secondary>
    </indexterm>

    <para>FreeBSD bietet Bin&auml;rkompatibilit&auml;t zu verschiedenen
      anderen &unix; Betriebssystemen, darunter auch Linux.  Nun
      k&ouml;nnten Sie sich fragen, warum FreeBSD in der Lage sein
      muss, Linux-Bin&auml;rprogramme auszuf&uuml;hren?  Die Antwort
      auf diese Frage ist sehr einfach.  Viele Unternehmen und Entwickler
      programmieren bzw. entwickeln nur f&uuml;r Linux, da es
      <quote>das Neueste und Beste</quote> in der Computerwelt ist.
      F&uuml;r uns FreeBSD-Anwender hei&szlig;t dies, genau diese Unternehmen
      und Entwickler zu bitten, FreeBSD-Versionen ihrer Programme
      herauszubringen.  Das Problem dabei ist nur, dass die meisten dieser
      Firmen trotzdem nicht erkennen, wie viele zus&auml;tzliche
      Anwender ihre Produkte benutzen w&uuml;rden, wenn es auch
      FreeBSD-Versionen g&auml;be, und daher weiterhin
      ausschlie&szlig;lich f&uuml;r Linux entwickeln.  Was also kann ein
      FreeBSD-Anwender tun?  Genau an diesem Punkt kommt die Linux-
      Bin&auml;rkompatibilit&auml;t ins Spiel.</para>

    <para>Um es auf den Punkt zu bringen, genau diese Kompatibilit&auml;t
      erlaubt es FreeBSD-Anwendern, etwa 90 % aller Linux-Anwendungen
      ohne Code-&Auml;nderungen zu verwenden.  Dies schlie&szlig;t
      solche Anwendungen wie <application>&staroffice;</application>,
      <application>Open Office</application>, die Linux-Versionen von
      <application>&netscape;</application>,
      <application>&adobe;&nbsp;&acrobat;</application>,
      <application>&realplayer;</application>,
      <application>&oracle;</application>,
      <application>&wordperfect;</application>,
      <application>Doom</application>,
      <application>Quake</application> und viele andere ein.  Es wird
      sogar berichtet, dass diese Linux-Anwendungen in manchen
      F&auml;llen unter FreeBSD eine bessere Leistung als unter
      Linux aufweisen.</para>

    <para>Allerdings gibt es nach wie vor einige Linux-spezifische
      Betriebssystem-Eigenschaften, die unter FreeBSD nicht
      unterst&uuml;tzt werden.  Linux-Anwendungen, die
      &i386;-spezifische Aufrufe (wie die Aktivierung des
      virtuellen 8086-Modus) verwenden, funktionieren
      unter FreeBSD leider nicht.</para>

    <para>Nach dem Lesen dieses Kapitels werden Sie</para>
    <itemizedlist>
      <listitem>
	<para>wissen, wie Sie die Linux-Bin&auml;rkompatibilit&auml;t
	  installieren bzw. aktivieren.</para>
      </listitem>

      <listitem>
	<para>Wissen, wie man zus&auml;tzliche Linux-Systembibliotheken
	  unter FreeBSD installiert.</para>
      </listitem>

      <listitem>
	<para>Linux-Anwendungen unter FreeBSD installieren k&ouml;nnen.</para>
      </listitem>

      <listitem>
	<para>Wissen, wie die Linux-Bin&auml;rkompatibilit&auml;t
	  unter FreeBSD verwirklicht wurde.</para>
      </listitem>
    </itemizedlist>

    <para>Bevor Sie dieses Kapitel lesen, sollten Sie</para>

    <itemizedlist>
      <listitem>
	<para>wissen, wie man Software Dritter installiert
	  (<xref linkend="ports">).</para>
      </listitem>
    </itemizedlist>

  </sect1>

  <sect1 id="linuxemu-lbc-install">
    <title>Installation</title>

    <indexterm><primary>KLD (kernel loadable object)</primary></indexterm>

    <para>Die Linux-Bin&auml;rkompatibilit&auml;t ist per Voreinstellung
      nicht aktiviert.  Der einfachste Weg, dies zu tun, ist das
      <literal>Linux</literal> KLD (<quote>Kernel LoaDable object</quote>)
      zu laden.  Dies erreichen Sie durch die Eingabe des folgenden
      Befehls:</para>

    <screen>&prompt.root; <userinput>kldload linux</userinput></screen>

    <para>Wollen Sie die Linux-Bin&auml;rkompatibilit&auml;t dauerhaft
      aktivieren, sollten Sie die folgende Zeile in
      <filename>/etc/rc.conf</filename> einf&uuml;gen:</para>

    <programlisting>linux_enable="YES"</programlisting>

    <para>Der &man.kldstat.8;-Befehl kann benutzt werden, um
      festzustellen, ob KLD geladen wurde:</para>

    <screen>&prompt.user; <userinput>kldstat</userinput>
Id Refs Address    Size     Name
 1    2 0xc0100000 16bdb8   kernel
 7    1 0xc24db000 d000     linux.ko</screen>
    <indexterm>
      <primary>Kerneloptionen</primary>
      <secondary>COMPAT_LINUX</secondary>
    </indexterm>

    <para>Wenn Sie das KLD nicht laden k&ouml;nnen oder wollen, besteht
      auch die M&ouml;glichkeit, die Linux-Bin&auml;rkompatibilt&auml;t
      statisch in den Kernel einzubinden.  Dazu f&uuml;gen Sie Ihrer
      Kernelkonfigurationsdatei den Eintrag
      <literal>options COMPAT_LINUX</literal>
      hinzu.  Anschlie&szlig;end installieren Sie Ihren neuen Kernel
      wie in <xref linkend="kernelconfig"> beschrieben.</para>

    <sect2>
      <title>Linux-Laufzeitbibliotheken installieren</title>
      <indexterm>
	<primary>Linux</primary>
	<secondary>Linux-Laufzeitbibliotheken installieren</secondary>
      </indexterm>

      <para>Dies kann auf zwei Arten geschehen, entweder &uuml;ber den
	<link linkend="linuxemu-libs-port">linux_base</link>-Port
	oder durch <link linkend="linuxemu-libs-manually">manuelle
	Installation</link> der Bibliotheken.</para>

      <sect3 id="linuxemu-libs-port">
	<title>Installation unter Verwendung des linux_base-Ports</title>
	<indexterm><primary>Ports-Sammlung</primary></indexterm>

	<para>Dies ist die einfachste Methode, um die Laufzeitbibliotheken
	  zu installieren.  Sie funktioniert genauso wie die
	  Installation eines beliebigen anderen Ports aus der
          <ulink type="html"
	  url="file://localhost/usr/ports/">Ports-Sammlung</ulink>.
	  Dazu machen Sie einfach folgendes:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/emulators/linux_base-f10</userinput>
&prompt.root; <userinput>make install distclean</userinput></screen>

        <note>
          <para>Bei &os;-Systemen vor &os;&nbsp;8.0 m&uuml;ssen Sie den Port
            <filename role="package">emulators/linux_base-fc4</filename>
            anstatt <filename
            role="package">emulators/linux_base-f10</filename>
            installieren.</para>
        </note>

	<para>Sie sollten nun &uuml;ber eine funktionierende
	  Linux-Bin&auml;rkompatibilit&auml;t verf&uuml;gen.  Einige
	  Programme k&ouml;nnten sich zwar &uuml;ber falsche
	  Unterversionsnummern der Systembibliotheken beschweren, dies ist
	  im Allgemeinen aber kein Problem.</para>

	<note>
	  <para>Unter Umst&auml;nden gibt es mehrere Versionen des
	    Ports <filename role="package">emulators/linux_base</filename>.
	    Die Ports entsprechen unterschiedlichen Versionen
	    verschiedener Linux-Distributionen Sie sollten den
	    Port installieren, der am besten die Anforderungen
	    der Linux-Anwendung erf&uuml;llt.</para>
	</note>
      </sect3>

      <sect3 id="linuxemu-libs-manually">
	<title>Manuelle Installation der Bibliotheken</title>

	<para>Wenn Sie die <quote>Ports</quote>-Sammlung nicht installiert
	  haben, k&ouml;nnen Sie die Bibliotheken auch manuell
	  installieren.  Dazu brauchen Sie die jeweiligen
	  Linux-Systembibliotheken, die das zu installierende Programm
	  verwendet sowie den Laufzeit-Linker.  Zus&auml;tzlich m&uuml;ssen
	  Sie auf Ihrem FreeBSD-System einen
	  <quote>virtuellen</quote> Verzeichnisbaum f&uuml;r die
	  Linux-Bibliotheken einrichten.  Alle unter FreeBSD gestarteten
	  Linux-Programme suchen zuerst in diesem Verzeichnisbaum
	  nach Systembibliotheken.  Wenn also ein Linuxprogramm beispielsweise
	  <filename>/lib/libc.so</filename> l&auml;dt, versucht FreeBSD
	  zuerst, <filename>/compat/linux/lib/libc.so</filename> laden.
	  Ist diese Datei nicht vorhanden, wird
	  <filename>/lib/libc.so</filename> geladen.  Systembibliotheken
	  sollten daher besser in den <quote>virtuellen</quote> Verzeichnisbaum
	  <filename>/compat/linux/lib</filename> als in den vom
	  Linux-<command>ld.so</command> vorgeschlagenen installiert
	  werden.</para>

	<para>Im Allgemeinen m&uuml;ssen Sie nur zu Beginn nach den
	  Systembibliotheken suchen, die von Linuxprogrammen
	  ben&ouml;tigt werden.  Nach den ersten Installationen von
	  Linuxprogrammen auf Ihrem FreeBSD-System verf&uuml;gen Sie
	  &uuml;ber eine Sammlung von Linux-Systembibliotheken,
	  die es Ihnen erm&ouml;glichen wird, neue Linuxprogramme
	  ohne Zusatzarbeit zu installieren.</para>
      </sect3>

      <sect3>
	<title>Installation zus&auml;tzlicher Systembibliotheken</title>
	<indexterm><primary>Shared-Libraries</primary></indexterm>

	<para>Was passiert, wenn Sie den <filename>linux_base</filename>-Port
	  installieren, und Ihr Programm beschwert sich trotzdem
	  &uuml;ber fehlende Systembibliotheken?  Woher wissen Sie,
	  welche Systembibliotheken von Linux-Bin&auml;rprogrammen
	  ben&ouml;tigt werden, und wo Sie diese finden? Grunds&auml;tzlich
	  gibt es daf&uuml;r zwei M&ouml;glichkeiten (um dieser
	  Anleitung zu folgen, m&uuml;ssen Sie unter
	  FreeBSD als Benutzer <username>root</username> angemeldet
	  sein):</para>

	<para>Wenn Sie Zugriff auf ein Linux-System haben, k&ouml;nnen
	  Sie dort nachsehen, welche Systembibliotheken eine Anwendung
	  ben&ouml;tigt, und diese auf Ihr FreeBSD-System kopieren.
	  Dazu folgendes Beispiel:</para>

	<informalexample>
	  <para>Nehmen wir an, Sie haben FTP verwendet, um die
	    Linux-Bin&auml;rversion von <application>Doom</application>
	    zu bekommen und haben sie auf Ihrem Linux-System installiert.
	    Nun k&ouml;nnen Sie &uuml;berpr&uuml;fen, welche
	    Systembibliotheken das Programm ben&ouml;tigt, indem Sie
	    <command>ldd linuxdoom</command> eingeben.  Das Resultat
	    sieht dann so aus:</para>

	  <screen>&prompt.user; <userinput>ldd linuxdoom</userinput>
libXt.so.3 (DLL Jump 3.1) =&gt; /usr/X11/lib/libXt.so.3.1.0
libX11.so.3 (DLL Jump 3.1) =&gt; /usr/X11/lib/libX11.so.3.1.0
libc.so.4 (DLL Jump 4.5pl26) =&gt; /lib/libc.so.4.6.29</screen>

	  <indexterm><primary>symbolische Links</primary></indexterm>
	  <para>Sie m&uuml;ssten nun alle Dateien aus der
	    letzten Spalte kopieren und sie unter
	    <filename>/compat/linux</filename> speichern, wobei
	    die Namen der ersten Spalte als symbolische Links auf
	    diese Dateien zeigen.  Damit haben Sie schlie&szlig;lich
	    folgende Dateien auf Ihrem FreeBSD-System:</para>

	  <screen>/compat/linux/usr/X11/lib/libXt.so.3.1.0
/compat/linux/usr/X11/lib/libXt.so.3 -&gt; libXt.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3 -&gt; libX11.so.3.1.0
/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</screen>

	  <blockquote>
	    <note>
	      <para>Beachten Sie, dass wenn Sie bereits eine
		Linux-Systembibliothek einer zur ersten Spalte
		passenden Hauptversionsnummer (laut
		<command>ldd</command>-Ausgabe) besitzen, Sie die Datei
		aus der zweiten Spalte nicht mehr kopieren m&uuml;ssen,
		da die	bereits vorhandene Version funktionieren sollte.
		Hat die Systembibliothek jedoch eine neuere
		Versionsnummer, sollten Sie sie dennoch kopieren.
		Sie k&ouml;nnen die alte Version l&ouml;schen, solange
		Sie einen symbolischen Link auf die neue
		Version anlegen.  Wenn Sie also folgende Bibliotheken
		auf Ihrem System installiert haben:</para>

	      <screen>/compat/linux/lib/libc.so.4.6.27
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.27</screen>

	      <para>und Sie haben eine neue Bin&auml;rdatei, die
		laut <command>ldd</command>
		eine neuere Bibliothek ben&ouml;tigt:</para>

	      <screen>libc.so.4 (DLL Jump 4.5pl26) -&gt; libc.so.4.6.29</screen>

	      <para>Wenn diese sich nur  um ein oder zwei Stellen
		in der Unterversionsnummer unterscheiden, m&uuml;ssen
		Sie <filename>/lib/libc.so.4.6.29</filename>
		nicht auf Ihr System kopieren, da das Programm auch
		mit der etwas &auml;lteren Version ohne Probleme
		funktionieren sollte.  Wenn Sie wollen,
		k&ouml;nnen Sie <filename>libc.so</filename> aber
		dennoch ersetzen (das hei&szlig;t aktualisieren), was dann zu
		folgender Ausgabe f&uuml;hrt:</para>

	      <screen>/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</screen>
	    </note>
	  </blockquote>

	  <blockquote>
	    <note>
	      <para>Der Mechanismus der symbolischen Links wird
		<emphasis>nur</emphasis> f&uuml;r Linux-Bin&auml;rdateien
		ben&ouml;tigt.  Der FreeBSD-Laufzeitlinker sucht
		sich die passenden Hauptversionsnummern selbst,
		das hei&szlig;t Sie m&uuml;ssen sich nicht darum
		k&uuml;mmern.</para>
	    </note>
	  </blockquote>
	</informalexample>
      </sect3>
    </sect2>

    <sect2>
      <title>Linux ELF-Bin&auml;rdateien installieren</title>
      <indexterm>
	<primary>Linux</primary>
	<secondary>ELF-Bin&auml;rdatei</secondary>
      </indexterm>

      <para>ELF-Bin&auml;rdateien ben&ouml;tigen manchmal eine zus&auml;tzliche
	<quote>Kennzeichnung</quote>.  Wenn Sie versuchen, eine nicht
	gekennzeichnete ELF-Bin&auml;rdatei auszuf&uuml;hren,
	werden Sie eine Fehlermeldung &auml;hnlich der folgenden
	erhalten:</para>

      <screen>&prompt.user; <userinput>./my-linux-elf-binary</userinput>
ELF binary type not known
Abort</screen>

      <para>Damit der FreeBSD-Kernel eine Linux-ELF-Datei von einer
	FreeBSD-ELF-Datei unterscheiden kann, gibt es das Werkzeug
	&man.brandelf.1;.</para>

      <screen>&prompt.user; <userinput>brandelf -t Linux my-linux-elf-binary</userinput></screen>

      <indexterm><primary>GNU Werkzeuge</primary></indexterm>
      <para>Die GNU Werkzeuge schreiben nun automatisch die
	passende Kennzeichnungsinformation in die ELF-Bin&auml;rdateien,
	so dass Sie diesen Schritt in Zukunft nur noch selten ben&ouml;tigen
	werden.</para>
    </sect2>

    <sect2>
      <title>Installieren einer beliebigen RPM-basierten Linuxanwendung</title>

      <para>&os; besitzt seine eigene Paketdatenbank und diese wird dazu
        verwendet, um alle Ports (auch &linux;-Ports) zu verfolgen.  Deshalb
        wird die &linux; RPM-Datenbank nicht benutzt (fehlende
        Unterst&uuml;tzung).</para>

      <para>Falls Sie jedoch eine beliebige RPM-basierte &linux;-Anwendung
        installieren wollen, erreichen Sie das mittels:</para>

      <screen>&prompt.root; <userinput>cd /compat/linux</userinput>
&prompt.root; <userinput>rpm2cpio -q &lt; /path/to/linux.archive.rpm | cpio -id</userinput></screen>

      <para>Benutzen Sie dann brandelf auf die installierten
        ELF-Bin&auml;rdateien (nicht die Bibliotheken!).  Sie werden keine
        saubere Deinstallation hinbekommen, aber evtl. helfen ein paar Tests
        weiter.</para>
    </sect2>

    <sect2>
      <title>Namensaufl&ouml;sung konfigurieren</title>

      <para>Wenn DNS nicht funktioniert, oder Sie folgende Fehlermeldung
	erhalten:</para>

      <screen>resolv+: "bind" is an invalid keyword resolv+:
"hosts" is an invalid keyword</screen>

      <para>m&uuml;ssen sie <filename>/compat/linux/etc/host.conf</filename>
        wie folgt anlegen:</para>

      <programlisting>order hosts, bind
multi on</programlisting>

      <para>Diese Reihenfolge legt fest, dass zuerst
	<filename>/etc/hosts</filename> und anschlie&szlig;end DNS
	durchsucht werden.  Wenn
	<filename>/compat/linux/etc/host.conf</filename> nicht vorhanden
	ist, finden Linux-Anwendungen FreeBSD's
	<filename>/etc/host.conf</filename> und
	beschweren sich &uuml;ber die inkompatible FreeBSD-Syntax.  Wenn Sie
	keinen Nameserver (in <filename>/etc/resolv.conf</filename>)
	konfiguriert haben, sollten Sie den Eintrag
	<literal>bind</literal> entfernen.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-mathematica">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Boris</firstname>
	  <surname>Hollas</surname>
	  <contrib>F&uuml;r Mathematica 5.x aktualisiert von </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>&mathematica; installieren</title>

    <indexterm>
      <primary>Linux-Anwendungen</primary>
      <secondary><application>Mathematica</application></secondary>
    </indexterm>

    <para>Dieses Dokument beschreibt die Installation der Linux-Version von
      <application>&mathematica; 5.x</application> auf einem
      FreeBSD-System.</para>

    <para>Die Linux-Version von <application>&mathematica;</application>
      oder <application>&mathematica; f&uuml;r Studenten</application> kann
      direkt von Wolfram unter <ulink url="http://www.wolfram.com/"></ulink>
      bestellt werden.</para>

    <sect2>
      <title>Den &mathematica;-Installer starten</title>

      <para>Zuerst m&uuml;ssen Sie &os; mitteilen, dass die
	Linux-Bin&auml;rversion von
	<application>&mathematica;</application> die Linux-ABI
	verwendet.  Dies erreichen Sie am einfachsten, indem Sie die
	Standard-ELF-Kennzeichnung f&uuml;r alle ungekennzeichneten
	Bin&auml;rdateien auf Linux festlegen:</para>

      <screen>&prompt.root; <userinput>sysctl kern.fallback_elf_brand=3</userinput></screen>

      <para>Danach wird FreeBSD annehmen, dass alle ungekennzeichneten
	ELF-Bin&auml;rdateien die Linux-ABI verwenden und es w&auml;re
	nun m&ouml;glich, das Installationsprogramm direkt von der
	CD-ROM zu starten.</para>

      <para>Unter &os; m&uuml;ssen allerdings die Datei
	<filename>MathInstaller</filename> in ein lokales Verzeichnis
	Ihrer Festplatte kopieren:</para>

      <screen>&prompt.root; <userinput>mount /cdrom</userinput>
&prompt.root; <userinput>cp /cdrom/Unix/Installers/Linux/MathInstaller /LokalesVerzeichnis/</userinput></screen>

      <para>In dieser Datei ersetzen Sie in der ersten Zeile den Wert
	<literal>/bin/sh</literal> durch
	<literal>/compat/linux/bin/sh</literal>.  Dadurch wird
	sichergestellt, dass der Installer von der Linux-Version von
	&man.sh.1; aufgerufen wird.  Danach ersetzen Sie durch das
	im n&auml;chsten Abschnitt zu findende Skript oder &uuml;ber
	einen Texteditor alle Vorkommen von <literal>Linux)</literal>
	durch <literal>FreeBSD)</literal>.  Dadurch ist es dem
	<application>&mathematica;</application>-Installer m&ouml;glich,
	durch den Einsatz von <command>uname -s</command> das
	Betriebssystem zu bestimmen.  &os; wird dabei als
	Linux-artiges Betriebssystem behandelt.  Durch den Aufruf von
	<command>MathInstaller</command> kann
	<application>&mathematica;</application> anschlie&szlig;end
	installiert werden.</para>
    </sect2>

    <sect2>
      <title>Die &mathematica;-Programmdateien anpassen</title>

      <para>Das von <application>&mathematica;</application> w&auml;hrend
	der Installation erzeugte Shell-Skript muss angepasst werden,
	bevor Sie es einsetzen k&ouml;nnen.  Wenn Sie die
	<application>&mathematica;</application>-Programmdateien unter
	<filename class="directory">/usr/local/bin</filename> installieren,
	finden Sie in diesem Verzeichnis die symbolische Links
	<filename>math</filename>, <filename>mathematica</filename>,
	<filename>Mathematica</filename>, sowie
	<filename>MathKernel</filename>.  In jeder dieser Dateien
	m&uuml;ssen Sie jedes Vorkommen von <literal>Linux)</literal>
	durch <literal>FreeBSD)</literal> ersetzen (entweder &uuml;ber
	einen Texteditor oder durch das folgende Shellskript):</para>

      <programlisting>#!/bin/sh
cd /usr/local/bin
for i in math mathematica Mathematica MathKernel
  do sed 's/Linux)/FreeBSD)/g' $i &gt; $i.tmp
  sed 's/\/bin\/sh/\/compat\/linux\/bin\/sh/g' $i.tmp &gt; $i
  rm $i.tmp
  chmod a+x $i
done</programlisting>
    </sect2>

    <sect2>
      <title>Ihr &mathematica;-Passwort anfordern</title>

      <indexterm>
	<primary>Ethernet</primary>
	<secondary>MAC-Adresse</secondary>
      </indexterm>

      <para>Wenn Sie <application>&mathematica;</application> das erste
	Mal starten, werden Sie nach einem Passwort gefragt.  Haben Sie
	noch kein Passwort von Wolfram erhalten, m&uuml;ssen Sie zuerst
	im Installationsverzeichnis <command>mathinfo</command>
	aufrufen, um Ihre <quote>Rechner-ID</quote> zu bestimmen.  Diese
	Rechner-ID basiert ausschlie&szlig;lich auf der MAC-Adresse
	Ihrer ersten Netzwerkkarte.  Daher ist es nicht m&ouml;glich,
	Ihre <application>&mathematica;</application>-Kopie auf
	verschiedenen Rechnern zu installieren.</para>

      <para>Wenn Sie sich bei Wolfram registrieren (durch E-Mail,
	Telefon oder Fax), teilen Sie
	Ihre <quote>Rechner-ID</quote> mit und erhalten daf&uuml;r
	ein aus Zahlengruppen bestehendes Passwort.</para>
    </sect2>

    <sect2>
      <title>Das &mathematica;-Frontend &uuml;ber ein Netzwerk
	ausf&uuml;hren</title>

      <para><application>&mathematica;</application> verwendet einige
	spezielle Schriftarten, um Zeichen anzuzeigen, die in den
	Standardzeichens&auml;tzen nicht vorhanden
	sind (z.B. Integrale, Summen, griechische Buchstaben).  Das
	X-Protokoll verlangt allerdings, dass diese Schriftarten
	<emphasis>lokal</emphasis> installiert sind.
	Das bedeutet, dass Sie diese Schriftarten von der CD-ROM oder
	von einem Rechner, auf dem <application>&mathematica;</application>
	installiert ist, auf Ihren Rechner kopieren m&uuml;ssen.
	Diese Schriftarten befinden sich  normalerweise in
	<filename>/cdrom/Unix/Files/SystemFiles/Fonts</filename>
	(&mathematica;-CD) oder in
	<filename>/usr/local/mathematica/SystemFiles/Fonts</filename>
	(Festplatte).  Die aktuellen Schriftarten befinden sich dabei
	in den Unterverzeichnissen <filename>Type1</filename> und
	<filename>X</filename>.  Um diese Schriftarten zu verwenden,
	gibt es mehrere M&ouml;glichkeiten, die nun beschrieben werden:</para>

      <para>Die erste M&ouml;glichkeit besteht darin, die Schriftarten
	in eins der bereits existierenden Schriftartenverzeichnisse unter
	<filename>/usr/X11R6/lib/X11/fonts</filename> zu kopieren.
	Dies bedeutet, dass Sie <filename>fonts.dir</filename> editieren
	m&uuml;ssen, indem Sie die Schriftnamen hinzuf&uuml;gen und
	die Anzahl der Schriftarten in der ersten Zeile &auml;ndern.
	Alternativ ist es auch m&ouml;glich, im Verzeichnis, in das
	Sie die Schriftarten kopiert haben, das Kommando
	&man.mkfontdir.1; auszuf&uuml;hren.</para>

      <para>Die zweite M&ouml;glichkeit, besteht darin,
	die Verzeichnisse nach
	<filename>/usr/X11R6/lib/X11/fonts</filename> zu kopieren:</para>

      <screen>&prompt.root; <userinput>cd /usr/X11R6/lib/X11/fonts</userinput>
&prompt.root; <userinput>mkdir X</userinput>
&prompt.root; <userinput>mkdir MathType1</userinput>
&prompt.root; <userinput>cd /cdrom/Unix/Files/SystemFiles/Fonts</userinput>
&prompt.root; <userinput>cp X/* /usr/X11R6/lib/X11/fonts/X</userinput>
&prompt.root; <userinput>cp Type1/* /usr/X11R6/lib/X11/fonts/MathType1</userinput>
&prompt.root; <userinput>cd /usr/X11R6/lib/X11/fonts/X</userinput>
&prompt.root; <userinput>mkfontdir</userinput>
&prompt.root; <userinput>cd ../MathType1</userinput>
&prompt.root; <userinput>mkfontdir</userinput></screen>

      <para>Nun f&uuml;gen Sie die neuen Schriftartenverzeichnisse in
	Ihren Pfad ein:</para>

      <screen>&prompt.root; <userinput>xset fp+ /usr/X11R6/lib/X11/fonts/X</userinput>
&prompt.root; <userinput>xset fp+ /usr/X11R6/lib/X11/fonts/MathType1</userinput>
&prompt.root; <userinput>xset fp rehash</userinput></screen>

      <para>Wenn Sie den &xorg;-Server verwenden, k&ouml;nnen Sie die
	Schriftarten-Verzeichnisse automatisch laden lassen, wenn Sie sie
	in Ihrer <filename>xorg.conf</filename> angeben.</para>

      <indexterm><primary>Schriftarten</primary></indexterm>

      <para>Wenn Sie <emphasis>noch kein</emphasis>
	<filename>/usr/X11R6/lib/X11/fonts/Type1</filename>-Verzeichnis
	haben, k&ouml;nnen Sie das
	<filename>MathType1</filename>-Verzeichnis im vorherigen
	Beispiel in <filename>Type1</filename> umbenennen.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-maple">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Aaron</firstname>
	  <surname>Kaplan</surname>
<!--	  <address><email>aaron@lo-res.org</email></address>-->
	  <contrib>Beigetragen von </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <firstname>Robert</firstname>
	  <surname>Getschmann</surname>
<!--	  <address><email>rob@getschmann.org</email></address>-->
	  <contrib>Mit Unterst&uuml;tzung durch </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>&maple; installieren</title>

    <indexterm>
      <primary>Linux-Anwendungen</primary>
      <secondary><application>Maple</application></secondary>
    </indexterm>

    <para><application>&maple;</application> ist ein mit
      <application>&mathematica;</application> vergleichbares kommerzielles
      Mathematikprogramm.  Sie k&ouml;nnen dieses Programm unter
      <ulink url="http://www.maplesoft.com/"></ulink> kaufen und sich
      anschlie&szlig;end registrieren, um eine Lizenz zu erhalten.  Um
      dieses Programm unter FreeBSD zu installieren, gehen Sie wie
      folgt vor:</para>

    <procedure>
      <step><para>F&uuml;hren Sie das
	<filename>INSTALL</filename>-Shell-Skript
	der Softwaredistribution aus.  W&auml;hlen Sie die
	<quote>RedHat</quote>-Option aus, wenn Sie das
	Installationsprogramm danach fragt.  Ein typisches
	Installationsverzeichnis w&auml;re z.B.
	<filename class="directory">/usr/local/maple</filename>.</para></step>

      <step><para>Wenn Sie dies noch nicht gemacht haben, besorgen Sie
	sich nun eine <application>&maple;</application>-Lizenz von
	Maple Waterloo Software
	(<ulink url="http://register.maplesoft.com"></ulink>)
	und kopieren Sie diese nach
	<filename>/usr/local/maple/license/license.dat</filename>.</para></step>

      <step><para>Installieren Sie den
	<application>FLEXlm</application>-Lizenz-Manager, indem Sie
	das <filename>INSTALL_LIC</filename>-Installations-Shellskript
	ausf&uuml;hren, das mit <application>&maple;</application>
	ausgeliefert wird.  Geben Sie Ihren prim&auml;ren
	Rechnernamen f&uuml;r den Lizenz-Server an.</para></step>

      <step><para>Ver&auml;ndern Sie
	<filename>/usr/local/maple/bin/maple.system.type</filename>
	wie folgt:</para>

<programlisting>   ----- snip ------------------
*** maple.system.type.orig      Sun Jul  8 16:35:33 2001
--- maple.system.type   Sun Jul  8 16:35:51 2001
***************
*** 72,77 ****
--- 72,78 ----
          # the IBM RS/6000 AIX case
          MAPLE_BIN="bin.IBM_RISC_UNIX"
          ;;
+     "FreeBSD"|\
      "Linux")
          # the Linux/x86 case
        # We have two Linux implementations, one for Red Hat and
   ----- snip end of patch -----</programlisting>

	<para>Bitte beachten Sie, dass nach
	  <literal>"FreeBSD"|\</literal> kein anderes
	  Zeichen eingef&uuml;gt werden darf.</para>

	<para>Dieser Patch weist <application>&maple;</application> an,
	  FreeBSD als <quote>eine Art von Linux-System</quote> zu erkennen.
	  Das Shell-Skript <filename>bin/maple</filename> ruft das
	  Shell-Skript <filename>bin/maple.system.type</filename> auf,
	  welches wiederum <command>uname -a</command> verwendet,
	  um den Namen des Betriebssystems herauszufinden.
	  Abh&auml;ngig vom Betriebssystem wei&szlig; das System nun,
	  welche Bin&auml;rdateien verwendet werden sollen.</para></step>

      <step><para>Starten Sie den Lizenz-Server.</para>

	<para>Das folgende, als
	  <filename>/usr/local/etc/rc.d/lmgrd.sh</filename>
	  installierte Shell-Skript ist ein komfortabler Weg,
	  um <command>lmgrd</command> zu starten:</para>

	<programlisting>   ----- snip ------------

#! /bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin
PATH=${PATH}:/usr/local/maple/bin:/usr/local/maple/FLEXlm/UNIX/LINUX
export PATH

LICENSE_FILE=/usr/local/maple/license/license.dat
LOG=/var/log/lmgrd.log

case "$1" in
start)
	lmgrd -c ${LICENSE_FILE} 2&gt;&gt; ${LOG} 1&gt;&2
	echo -n " lmgrd"
	;;
stop)
	lmgrd -c ${LICENSE_FILE} -x lmdown 2&gt;&gt; ${LOG} 1&gt;&2
	;;
*)
	echo "Usage: `basename $0` {start|stop}" 1&gt;&2
	exit 64
	;;
esac

exit 0
   ----- snip ------------</programlisting></step>


      <step><para>Versuchen Sie, <application>&maple;</application>
	zu starten:</para>

        <screen>&prompt.user; <userinput>cd /usr/local/maple/bin</userinput>
&prompt.user; <userinput>./xmaple</userinput></screen>

	<para>Nun sollte das Programm laufen und alles funktionieren.
	    Falls ja, vergessen Sie nicht, an Maplesoft zu schreiben
	    und sie wissen zu lassen, dass Sie gerne eine native
	    FreeBSD-Version h&auml;tten.</para></step>
    </procedure>

    <sect2>
    <title>H&auml;ufige Fehlerquellen</title>

      <itemizedlist>
        <listitem><para>Der
	  <application>FLEXlm</application>-Lizenzmanager kann schwierig
	  zu bedienen sein.  Zus&auml;tzliche Dokumentation
	  zu diesem Thema finden Sie unter <ulink
	  url="http://www.globetrotter.com/"></ulink>.</para></listitem>

        <listitem><para>Es ist bekannt, dass <command>lmgrd</command>
	  sehr pingelig ist, wenn es um die Lizenzdatei geht.  Gibt
	  es Probleme, f&uuml;hrt dies zu einem Speicherauszug
	  (<foreignphrase>core dump</foreignphrase>).  Ein
	  korrekte Lizenzdatei sollte &auml;hnlich der
	  folgenden aussehen:</para>

<programlisting># =======================================================
# License File for UNIX Installations ("Pointer File")
# =======================================================
SERVER chillig ANY
#USE_SERVER
VENDOR maplelmg

FEATURE Maple maplelmg 2000.0831 permanent 1 XXXXXXXXXXXX \
         PLATFORMS=i86_r ISSUER="Waterloo Maple Inc." \
         ISSUED=11-may-2000 NOTICE=" Technische Universitat Wien" \
         SN=XXXXXXXXX</programlisting>

	  <note><para>Seriennummer und Schl&uuml;ssel wurden durch mehrere
	    <literal>X</literal> unkenntlich gemacht.  <hostid>chillig</hostid> ist ein
	    Rechnername.</para></note>

	  <para>Ver&auml;nderungen an der Lizenzdatei sind m&ouml;glich,
	    solange Sie die <literal>FEATURE</literal>-Zeile nicht
	    ver&auml;ndern (diese ist durch den Lizenzschl&uuml;ssel
	    gesch&uuml;tzt).</para></listitem>
      </itemizedlist>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-matlab">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Dan</firstname>
	  <surname>Pelleg</surname>
	  <contrib>Beigesteuert von </contrib>
	</author>
	<!-- daniel+handbook@pelleg.org -->
      </authorgroup>
    </sect1info>
    <title>&matlab; installieren</title>

    <indexterm>
      <primary>Linux-Anwendungen</primary>
      <secondary><application>MATLAB</application></secondary>
    </indexterm>

    <para>Im Folgenden wird die Installation der Linux-Anwendung
      <application>&matlab;</application> Version&nbsp;6.5 auf
      &os; beschrieben.  Mit Ausnahme der
      <application>&java.virtual.machine;</application> (siehe
      <xref linkend="matlab-jre">) l&auml;uft die Anwendung
      auch ganz gut.</para>

    <para>Die Linux-Version von <application>&matlab;</application>
      k&ouml;nnen Sie direkt bei <ulink
        url="http://www.mathworks.com">The MathWorks</ulink> bestellen.
      Vergewissern Sie sich, dass Sie die Lizenz-Datei
      oder eine Anleitung zum Erstellen der Lizenz-Datei erhalten
      haben.  Wenn Sie mit MathWorks in Kontakt stehen, weisen
      Sie bitte auf die fehlende &os;-Version der Software hin.</para>

    <sect2>
      <title>Das &matlab;-Installationsskript</title>

      <para>Um <application>&matlab;</application> zu installieren,
	gehen Sie wie folgt vor:</para>

      <procedure>
	<step>
	  <para>H&auml;ngen Sie die Installations-CD ein und
	    wechseln Sie zu <username>root</username>, wie im
	    Installations-Skript gefordert.  Starten Sie die
	    Installation mit dem folgenden Kommando:</para>

	  <screen>&prompt.root; <userinput>/compat/linux/bin/sh /cdrom/install</userinput></screen>

	  <tip>
	    <para>Die Installation erfordert eine graphische
	      Benutzeroberfl&auml;che.  Wenn Sie die Fehlermeldung
	      erhalten, dass das Display nicht ge&ouml;ffnet werden
	      konnte, f&uuml;hren Sie das folgende Kommando aus:</para>

	    <screen>&prompt.root; <userinput>setenv HOME ~<replaceable>USER</replaceable></userinput></screen>

	    <para>F&uuml;r <replaceable>USER</replaceable> setzen Sie
	      den Benutzer ein, von dem aus Sie <username>root</username>
	      geworden sind.</para>
	  </tip>
	</step>

	<step>
	  <para>Beantworten Sie die Frage nach dem
	    <application>&matlab;</application>-Root-Verzeichnis mit:
	    <userinput>/compat/linux/usr/local/matlab</userinput>.</para>

	  <tip>
	    <para>Den langen Pfad werden Sie noch &ouml;fter brauchen.
	      Die Tipparbeit k&ouml;nnen Sie sich mit dem folgenden
	      Befehl erleichtern:</para>

	    <screen>&prompt.root; <userinput>set MATLAB=/compat/linux/usr/local/matlab</userinput></screen>
	  </tip>
	</step>

	<step>
	  <para>Editieren Sie die Lizenz-Datei entsprechend der
	    Anweisung, die Sie beim Erwerb der Lizenz
	    erhalten haben.</para>

	  <tip>
	    <para>Sie k&ouml;nnen die Datei schon vorher mit Ihrem
	      Lieblingseditor bearbeiten.  Kopieren Sie die Lizenz-Datei
	      nach <filename>$MATLAB/license.dat</filename>
	      bevor das Installationsprogramm Sie auffordert, die
	      Datei zu editieren.</para>
	  </tip>
	</step>

	<step>
	  <para>Schlie&szlig;en Sie die Installation ab.</para>
	</step>
      </procedure>

      <para>Die <application>&matlab;</application>-Installation
	ist jetzt abgeschlossen.  Die folgenden Schritte passen
	<application>&matlab;</application> an &os; an.</para>
    </sect2>

    <sect2>
      <title>Den Lizenzmanager starten</title>
      <procedure>
	<step>
	  <para>Erstellen Sie symbolische Links zu den Startskripten
	    des Lizenzmanagers:</para>

	  <screen>&prompt.root; <userinput>ln -s $MATLAB/etc/lmboot /usr/local/etc/lmboot_TMW</userinput>
&prompt.root; <userinput>ln -s $MATLAB/etc/lmdown /usr/local/etc/lmdown_TMW</userinput></screen>
	</step>

	<step>
	  <para>Erstellen Sie das Startskript
	    <filename>/usr/local/etc/rc.d/flexlm.sh</filename>.  Das
	    folgende Beispiel ist eine ge&auml;nderte Version des
	    mitgelieferten Skripts
	    <filename>$MATLAB/etc/rc.lm.glnx86</filename>.
	    Angepasst wurden die Pfade zu den Dateien und der
	    Start des Lizenzmanagers unter der Linux-Emulation.</para>

	  <programlisting>#!/bin/sh
case "$1" in
  start)
        if [ -f /usr/local/etc/lmboot_TMW ]; then
              /compat/linux/bin/sh /usr/local/etc/lmboot_TMW -u <replaceable>username</replaceable> &amp;&amp; echo 'MATLAB_lmgrd'
        fi
        ;;
  stop)
	if [ -f /usr/local/etc/lmdown_TMW ]; then
            /compat/linux/bin/sh /usr/local/etc/lmdown_TMW  &gt; /dev/null 2&gt;&amp;1
	fi
        ;;
  *)
	echo "Usage: $0 {start|stop}"
	exit 1
	;;
esac

exit 0</programlisting>

	  <important>
	    <para>Machen Sie Datei ausf&uuml;hrbar:</para>

	    <screen>&prompt.root; <userinput>chmod +x /usr/local/etc/rc.d/flexlm.sh</userinput></screen>

	    <para>Ersetzen Sie im Skript <replaceable>username</replaceable>
	      durch einen existierenden Benutzer Ihres Systems
	      (bitte keinesfalls <username>root</username>).</para>
	  </important>
	</step>

	<step>
	  <para>Starten Sie den Lizenzmanager:</para>

	  <screen>&prompt.root; <userinput>/usr/local/etc/rc.d/flexlm.sh start</userinput></screen>
	</step>
      </procedure>
    </sect2>

    <sect2 id="matlab-jre">
      <title>Einrichten der &java;-Laufzeitumgebung</title>

      <para>Erstellen Sie einen symbolischen Link auf eine
	unter &os; laufende &java;-Laufzeitumgebung (JRE):</para>

      <screen>&prompt.root; <userinput>cd $MATLAB/sys/java/jre/glnx86/</userinput>
&prompt.root; <userinput>unlink jre; ln -s ./jre1.1.8 ./jre</userinput></screen>
    </sect2>

    <sect2>
      <title>Ein &matlab;-Startskript erstellen</title>

      <procedure>
	<step>
	  <para>Kopieren Sie das folgende Skript nach
	    <filename>/usr/local/bin/matlab</filename>:</para>

	  <programlisting>#!/bin/sh
/compat/linux/bin/sh /compat/linux/usr/local/matlab/bin/matlab "$@"</programlisting>
	</step>

	<step>
	  <para>Machen Sie das Skript ausf&uuml;hrbar:</para>

	  <screen>&prompt.root; <userinput>chmod +x /usr/local/bin/matlab</userinput></screen>
	</step>
      </procedure>

      <tip>
	<para>Abh&auml;ngig von der Version des Ports
	  <filename role="package">emulators/linux_base</filename>
	  kann das Skript auf Fehler laufen.  Die Fehler k&ouml;nnen
	  Sie vermeiden, indem Sie die Datei
	  <filename>/compat/linux/usr/local/matlab/bin/matlab</filename>
	  editieren.  &Auml;ndern Sie die nachstehende Zeile</para>

	<programlisting>if [ `expr "$lscmd" : '.*-&gt;.*'` -ne 0 ]; then</programlisting>
	<para>(mit Version&nbsp;13.0.1 in der Zeile&nbsp;410) in
	  die folgende um:</para>

	<programlisting>if test -L $newbase; then</programlisting>
      </tip>
    </sect2>

    <sect2>
      <title>Stopp-Skript f&uuml;r &matlab; erstellen</title>

      <para>Das nachstehende Skript beendet &matlab;
        ordnungsgem&auml;&szlig;.</para>

      <procedure>
	<step>
	  <para>Erstellen Sie die Datei
	    <filename>$MATLAB/toolbox/local/finish.m</filename> mit
	    dem nachstehenden Inhalt:</para>

	  <programlisting>! $MATLAB/bin/finish.sh</programlisting>

	  <note>
	    <para>&Uuml;bernehmen Sie die Zeichenkette
	      <literal>$MATLAB</literal> unver&auml;ndert.</para>
	  </note>

	  <tip>
	    <para>Im selben Verzeichnis befinden sich die
	      Dateien <filename>finishsav.m</filename> und
	      <filename>finishdlg.m</filename>.  Die Dateien
	      sichern die Einstellungen der Arbeitsfl&auml;che
	      bevor &matlab; beendet wird.  Wenn Sie eine
	      der beiden Dateien benutzen, f&uuml;gen Sie
	      die obige Zeile unmittelbar nach dem
	      <literal>save</literal>-Kommando ein.</para>
	  </tip>
	</step>

	<step>
	  <para>Erstellen Sie die Datei
	    <filename>$MATLAB/bin/finish.sh</filename> mit
	    nachstehendem Inhalt:</para>

	  <programlisting>#!/compat/linux/bin/sh
(sleep 5; killall -1 matlab_helper) &
exit 0</programlisting>
	</step>

	<step>
	  <para>Machen Sie die Datei ausf&uuml;hrbar:</para>

	  <screen>&prompt.root; <userinput>chmod +x $MATLAB/bin/finish.sh</userinput></screen>
	</step>
      </procedure>
    </sect2>

    <sect2 id="matlab-using">
      <title>&matlab; benutzen</title>

      <para>Jetzt k&ouml;nnen Sie <application>&matlab;</application>
	mit dem <command>matlab</command> starten.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-oracle">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Marcel</firstname>
	  <surname>Moolenaar</surname>
	  <contrib>Beigetragen von </contrib>
	</author>
	<!-- marcel@cup.hp.com -->
      </authorgroup>
    </sect1info>
    <title>&oracle; installieren</title>

    <indexterm>
      <primary>Linux-Anwendungen</primary>
      <secondary><application>Oracle</application></secondary>
    </indexterm>

    <sect2>
      <title>&Uuml;bersicht</title>
      <para>Dieses Dokument beschreibt die Installation von
	<application>&oracle; 8.0.5</application>
	und <application>&oracle; 8.0.5.1 Enterprise Edition</application>
	f&uuml;r Linux auf einem FreeBSD-Rechner.</para>
    </sect2>

    <sect2>
      <title>Installation der Linux-Umgebung</title>

      <para>Stellen Sie sicher, dass Sie sowohl
	<filename role="package">emulators/linux_base</filename> und
	<filename role="package">devel/linux_devtools</filename>
	aus der Ports-Sammlung installiert haben.  Wenn Sie mit
	diesen Ports Schwierigkeiten haben, m&uuml;ssen Sie
	vielleicht &auml;ltere Versionen der Linux-Umgebung aus
	der Ports-Sammlung installieren.</para>

      <para>Wenn Sie den Intelligent-Agent verwenden wollen,
	m&uuml;ssen Sie zus&auml;tzlich das RedHat Tcl-Paket
	installieren: <filename>tcl-8.0.3-20.i386.rpm</filename>.
	Zur Installation von RPM-Paketen wir der Port
	<filename role='package'>archivers/rpm</filename> ben&ouml;tigt.
	Ist der Port installiert, lassen sich RPM-Pakete
	anschlie&szlig;end mit dem nachstehenden Befehl
	installieren:</para>

      <screen>&prompt.root; <userinput>rpm -i --ignoreos --root /compat/linux --dbpath /var/lib/rpm <replaceable>package</replaceable></userinput></screen>

      <para>Die Installation der RPM-Pakete sollte ohne
	Fehlermeldung ablaufen.</para>
    </sect2>

    <sect2>
      <title>Die &oracle;-Umgebung erzeugen</title>

      <para>Bevor Sie <application>&oracle;</application> installieren
	k&ouml;nnen, m&uuml;ssen Sie eine entsprechende Umgebung erzeugen.
	Dieses Dokument beschreibt nur, was Sie
	<emphasis>im Speziellen</emphasis> tun m&uuml;ssen, um die
	Linux-Version von <application>&oracle;</application> unter FreeBSD
	zu installieren, nicht aber, was bereits in der Installationsanleitung
	von <application>&oracle;</application> beschrieben wird.</para>

      <sect3 id="linuxemu-kernel-tuning">
        <title>Kernel-Tuning</title>
	<indexterm><primary>Kernel Tuning</primary></indexterm>

	<para>Wie in der Installationsanleitung von
	  <application>&oracle;</application> beschrieben,
	  m&uuml;ssen Sie die maximale Shared-Memory Gr&ouml;&szlig;e
	  festlegen.  Verwenden Sie
	  <literal>SHMMAX</literal> nicht unter FreeBSD.
	  <literal>SHMMAX</literal> wird lediglich aus
	  <literal>SHMMAXPGS</literal> und <literal>PGSIZE</literal>
	  berechnet.  Definieren Sie stattdessen
	  <literal>SHMMAXPGS</literal>.  Alle anderen Optionen
	  k&ouml;nnen wie in der Anleitung beschrieben verwendet werden.
	  Zum Beispiel:</para>

	<programlisting>options SHMMAXPGS=10000
options SHMMNI=100
options SHMSEG=10
options SEMMNS=200
options SEMMNI=70
options SEMMSL=61</programlisting>

	<para>Passen Sie diese Optionen entsprechend dem von Ihnen
	  gew&uuml;nschten Einsatzzweck von
	  <application>&oracle;</application> an.</para>

	<para>Stellen Sie au&szlig;erdem sicher, dass Sie folgende
	  Optionen in Ihren Kernel kompilieren:</para>

<programlisting>options SYSVSHM #SysV shared memory
options SYSVSEM #SysV semaphores
options SYSVMSG #SysV interprocess communication</programlisting>
      </sect3>

      <sect3 id="linuxemu-oracle-account">

        <title>&oracle;-Benutzer anlegen</title>

	<para>Legen Sie den Account <username>oracle</username> an.
	  Der Account unterschiedet sich von normalen Accounts
	  dadurch, dass er eine Linux-Shell zugeordnet bekommen muss.
	  F&uuml;gen Sie <literal>/compat/linux/bin/bash</literal> in die
	  Datei <filename>/etc/shells</filename> ein und setzen Sie die
	  Shell f&uuml;r den <username>oracle</username>-Account auf
	  <filename>/compat/linux/bin/bash</filename>.</para>
      </sect3>

      <sect3 id="linuxemu-environment">
        <title>Umgebung</title>

	<para>Neben den normalen
	  <application>&oracle;</application>-Variablen, wie z.B.
	  <envar>ORACLE_HOME</envar> und <envar>ORACLE_SID</envar>
	  m&uuml;ssen Sie die folgenden Variablen setzen:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	  <colspec colwidth="1*">
	  <colspec colwidth="2*">
	    <thead>
	      <row>
		<entry>Variable</entry>

		<entry>Wert</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry><envar>LD_LIBRARY_PATH</envar></entry>

		<entry><literal>$ORACLE_HOME/lib</literal></entry>
	      </row>

	      <row>
		<entry><envar>CLASSPATH</envar></entry>

		<entry><literal>$ORACLE_HOME/jdbc/lib/classes111.zip</literal></entry>
	      </row>

	      <row>
		<entry><envar>PATH</envar></entry>

		<entry><literal>/compat/linux/bin
/compat/linux/sbin
/compat/linux/usr/bin
/compat/linux/usr/sbin
/bin
/sbin
/usr/bin
/usr/sbin
/usr/local/bin
$ORACLE_HOME/bin</literal></entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

        <para>Es ist empfehlenswert, alle Variablen in der Datei
	  <filename>.profile</filename> zu setzen.  Ein komplettes
	  Beispiel sieht folgenderma&szlig;en aus:</para>

        <programlisting>ORACLE_BASE=/oracle; export ORACLE_BASE
ORACLE_HOME=/oracle; export ORACLE_HOME
LD_LIBRARY_PATH=$ORACLE_HOME/lib
export LD_LIBRARY_PATH
ORACLE_SID=ORCL; export ORACLE_SID
ORACLE_TERM=386x; export ORACLE_TERM
CLASSPATH=$ORACLE_HOME/jdbc/lib/classes111.zip
export CLASSPATH
PATH=/compat/linux/bin:/compat/linux/sbin:/compat/linux/usr/bin
PATH=$PATH:/compat/linux/usr/sbin:/bin:/sbin:/usr/bin:/usr/sbin
PATH=$PATH:/usr/local/bin:$ORACLE_HOME/bin
export PATH</programlisting>
      </sect3>
    </sect2>

    <sect2>
      <title>&oracle; installieren</title>

      <para>Auf Grund einer kleinen Unregelm&auml;&szlig;igkeit
	im Linux-Emulator m&uuml;ssen Sie das Verzeichnis
	<filename>.oracle</filename> unter <filename>/var/tmp</filename>
	erzeugen, bevor Sie das Installationsprogramm starten.
	Das Verzeichnis muss dem Account <username>oracle</username>
	geh&ouml;ren.  Sie sollten <application>&oracle;</application> nun
	ohne Probleme installieren k&ouml;nnen.  Treten dennoch Probleme
	auf, &uuml;berpr&uuml;fen Sie zuerst Ihre
	<application>&oracle;</application>-Distribution und Ihre
	Konfiguration.  Nachdem Sie <application>&oracle;</application>
	erfolgreich installiert haben, installieren Sie die Patches
	wie in den zwei folgenden Abschnitten beschrieben:</para>

      <para>Ein h&auml;ufiges Problem ist, dass der
	TCP Protokoll-Adapter nicht korrekt installiert wird.
	Daraus folgt, dass Sie keine TCP-Listener starten k&ouml;nnen.
	Dieses Problem kann durch folgende Schritte behoben werden:</para>

      <screen>&prompt.root; <userinput>cd $ORACLE_HOME/network/lib</userinput>
&prompt.root; <userinput>make -f ins_network.mk ntcontab.o</userinput>
&prompt.root; <userinput>cd $ORACLE_HOME/lib</userinput>
&prompt.root; <userinput>ar r libnetwork.a ntcontab.o</userinput>
&prompt.root; <userinput>cd $ORACLE_HOME/network/lib</userinput>
&prompt.root; <userinput>make -f ins_network.mk install</userinput></screen>

      <para>Vergessen Sie nicht, <filename>root.sh</filename>
	nochmals auszuf&uuml;hren!</para>

      <sect3 id="linuxemu-patch-root">
        <title>root.sh patchen</title>

	<para>W&auml;hrend der
	  <application>&oracle;</application>-Installation werden einige
	  Aktionen, die als <username>root</username>
	  ausgef&uuml;hrt werden m&uuml;ssen, in ein Shell-Skript
	  mit dem Namen <filename>root.sh</filename> gespeichert.
	  Dieses Skript befindet sich im Verzeichnis
	  <filename>orainst</filename>.  Verwenden Sie folgenden
	  Patch f&uuml;r <filename>root.sh</filename>, damit es
	  das richtige <command>chown</command> Kommando
	  verwendet, oder lassen Sie das
	  Skript alternativ unter einer Linux-Shell ablaufen:</para>

	<programlisting>*** orainst/root.sh.orig Tue Oct 6 21:57:33 1998
--- orainst/root.sh Mon Dec 28 15:58:53 1998
***************
*** 31,37 ****
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/bin/chown
#
# Define variables to be used in this script
--- 31,37 ----
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/usr/sbin/chown
#
# Define variables to be used in this script</programlisting>

	<para>Wenn Sie <application>&oracle;</application> nicht
	  von CD-ROM installieren, k&ouml;nnen
	  Sie Quelldatei f&uuml;r <filename>root.sh</filename>
	  ver&auml;ndern.  Sie hei&szlig;t <filename>rthd.sh</filename>
	  und befindet sich im <filename>orainst</filename>-Verzeichnis
	  des Quellcodebaums.</para>
      </sect3>

      <sect3 id="linuxemu-patch-tcl">
	<title>genclntsh patchen</title>

	<para>Das Skript <command>genclntsh</command> wird verwendet,
	  um eine Shared-Library f&uuml;r Clients zu erzeugen.
	  Diese wird bei der Erzeugung der Demos verwendet.  Verwenden
	  Sie folgenden Patch, um die Definition von <envar>PATH</envar>
	  auszukommentieren:</para>

	<programlisting>*** bin/genclntsh.orig Wed Sep 30 07:37:19 1998
--- bin/genclntsh Tue Dec 22 15:36:49 1998
***************
*** 32,38 ****
#
# Explicit path to ensure that we're using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst
--- 32,38 ----
#
# Explicit path to ensure that we're using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! #PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst</programlisting>
      </sect3>
    </sect2>

    <sect2>
      <title>&oracle; starten</title>

      <para>Wenn Sie den Anweisungen gefolgt sind, sollten Sie nun
	in der Lage sein, <application>&oracle;</application> zu starten,
	genau so, wie Sie dies auch unter Linux tun w&uuml;rden.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-advanced">
    <title>Weiterf&uuml;hrende Themen</title>

    <para>Wenn Sie sich fragen, wie die Linux-Bin&auml;rkompatibilit&auml;t
      unter FreeBSD realisiert wurde, sollten Sie diesen Abschnitt lesen.
      Der Gro&szlig;teil der folgenden Informationen stammt aus einer
      E-Mail, die von Terry Lambert (<email>tlambert@primenet.com</email>)
      an die FreeBSD-Chat-Mailingliste
      (<email>freebsd-chat@FreeBSD.org</email>) geschrieben wurde
      (Message ID: <literal>&lt;199906020108.SAA07001@usr09.primenet.com&gt;</literal>).</para>

    <sect2>
      <title>Wie funktioniert es?</title>
      <indexterm><primary>execution class loader</primary></indexterm>

      <para>FreeBSD verf&uuml;gt &uuml;ber eine <quote>execution class
	loader</quote> genannte Abstraktion.  Dabei handelt es sich um einen
	Eingriff in den &man.execve.2; Systemaufruf.</para>

      <para>FreeBSD verf&uuml;gt &uuml;ber eine Liste von Ladern, anstelle
	eines einzigen, auf <literal>#!</literal>
	zur&uuml;ckgreifenden Laders, um Shell-Interpreter oder Shell-Skripte
	auszuf&uuml;hren.</para>

      <para>Historisch gesehen untersuchte der einzige, auf
	UNIX-Plattformen vorhandene Lader die "magische Zahl"
	(in der Regel die ersten 4 oder 8&nbsp;Bytes der Datei), um
	festzustellen, ob der Bin&auml;rtyp dem System bekannt war.
	War dies der Fall, wurde der Bin&auml;rlader aufgerufen.</para>

      <para>Wenn es sich nicht um den zum System geh&ouml;rigen Bin&auml;rtyp
        handelte, gab &man.execve.2; einen Fehler zur&uuml;ck,
	und die Shell versuchte stattdessen, die Datei als Shell-Befehl
	auszuf&uuml;hren.</para>

      <para>Dabei wurde als Standardeinstellung <quote>was auch immer die
        aktuelle Shell ist</quote> festgelegt.</para>

      <para>Sp&auml;ter wurde ein Hack in &man.sh.1; eingef&uuml;gt,
	der die zwei ersten Zeichen untersuchte.  Wenn diese
	<literal>:\n</literal> entsprachen,
	wurde stattdessen die &man.csh.1;-Shell aufgerufen
	(wir glauben, dass dies zuerst von SCO umgesetzt wurde).</para>

      <para>FreeBSD versucht heute eine Liste von Ladern, unter denen
	sich ein allgemeiner Lader f&uuml;r Interpreter befindet.  Der
	auszuf&uuml;hrende Interpreter wird im ersten, durch
	Leerzeichen getrennten Feld, der <literal>#!</literal>-Zeile
	angegeben.  L&auml;sst sich der Interpreter nicht ermitteln,
	wird auf <filename>/bin/sh</filename> zur&uuml;ckgegriffen.</para>

      <indexterm><primary>ELF</primary></indexterm>

      <para>F&uuml;r die Linux ABI-Unterst&uuml;tzung erkennt FreeBSD
        die magische Zahl als ELF-Bin&auml;rdatei (Zu diesem Zeitpunkt wird
	nicht zwischen FreeBSD, &solaris;, Linux oder anderen Systemen
	unterschieden, die &uuml;ber ELF-Bin&auml;rdateien
	verf&uuml;gen.).</para>

      <indexterm><primary>Solaris</primary></indexterm>

      <para>Der ELF-Lader sucht nach einer speziellen
	<emphasis>Kennzeichnung</emphasis>, die aus einem Kommentarabschnitt
	in der ELF-Datei besteht, und die in SVR4/&solaris; ELF
	Bin&auml;rdateien nicht vorhanden ist.</para>

      <para>Damit Linux-Bin&auml;rdateien (unter FreeBSD) funktionieren,
	m&uuml;ssen sie als <literal> Linux</literal>
	<emphasis>gekennzeichnet</emphasis> werden, und zwar durch
	&man.brandelf.1;:</para>

      <screen>&prompt.root; <userinput>brandelf -t Linux file</userinput></screen>

      <para>Nachdem dies geschehen ist, erkennt der ELF-Lader die
	<literal>Linux</literal>-Kennzeichnung der Datei.</para>
      <indexterm>
        <primary>ELF</primary>
	<secondary><command>brandelf</command></secondary>
      </indexterm>

      <para>Wenn der ELF-Lader die <literal>Linux</literal>-Kennzeichnung
	sieht, wird ein Zeiger in der <literal>proc</literal>-Struktur
	ersetzt.  Alle Systemaufrufe werden durch diesen Zeiger indiziert
	(in einem traditionellen &unix; System w&auml;re das ein
	<literal>sysent[]</literal>-Strukturfeld, das die Systemaufrufe
	enth&auml;lt).  Der Prozess wird weiterhin speziell gekennzeichnet,
	so dass der Trap-vector im Signal-trampoline-code eine spezielle
	Behandlung erf&auml;hrt und das Linux-Kernelmodul verschiedene
	kleinere Korrekturen vornehmen kann.</para>

      <para>Der Linux-Systemaufrufvektor enth&auml;lt neben anderen
	Dingen eine Liste der <literal>sysent[]</literal>-Eintr&auml;ge,
	deren Adressen sich im Kernelmodul befinden.</para>

      <para>Wenn ein Linux-Programm einen Systemaufruf ausf&uuml;hrt,
        dereferenziert die Trap-Behandlungsroutine den Zeiger auf die
	Eintrittspunkte f&uuml;r die Systemaufrufe und erh&auml;lt damit die
	Linux-Eintrittspunkte und nicht die FreeBSD-Eintrittspunkte.</para>

      <para>Zus&auml;tzlich <emphasis>ver&auml;ndert</emphasis> der
	Linuxmodus die Systempfade dynamisch; genauso, wie dies die
	Option <option>union</option> beim Einbinden von Dateisystemen
	macht (Achtung: <emphasis>nicht</emphasis> das Dateisystem unionfs!).
	Zuerst wird die Datei im Verzeichnis <filename>/compat/linux/<replaceable>Originalpfad</replaceable></filename>
	gesucht, <emphasis>danach</emphasis>, wenn sie dort nicht gefunden
	wurde, wird sie im FreeBSD-Verzeichnis
	<filename>/<replaceable>Originalpfad</replaceable></filename>
	gesucht.  Dadurch wird sichergestellt, dass
	Bin&auml;rdateien, die zur Ausf&uuml;hrung andere
	Bin&auml;rdateien ben&ouml;tigen, ausgef&uuml;hrt
	werden k&ouml;nnen (so dass alle Linux-Werkzeuge unter der
	ABI laufen).  Dies bedeutet auch,
	dass Linux-Bin&auml;rdateien FreeBSD-Bin&auml;rdateien
	laden und ausf&uuml;hren k&ouml;nnen, wenn keine passenden
	Linux-Bin&auml;rdateien vorhanden sind.  Ein in
	<filename>/compat/linux</filename> plaziertes &man.uname.1; kann
	damit Linux-Programmen vorgaukeln, dass sie auf einem Linux-System
	laufen.</para>

      <para>Im Endeffekt gibt es einen Linux-Kernel innerhalb des
        FreeBSD-Kernels.  Die Sprungtabellen f&uuml;r Linux-
	beziehungsweise FreeBSD-Systemaufrufe verweisen allerdings auf
	dieselben Funktionen, die Kerneldienste wie Dateisystemoperationen,
	Operationen f&uuml;r den virtuellen Speicher,
	Signal&uuml;bermittlung und System&nbsp;V&nbsp;IPC bereitstellen,
	Der einzige Unterschied ist, dass Bin&auml;rdateien unter FreeBSD
	FreeBSD-<emphasis>glue</emphasis>-Funktionen verwenden.
	Linux-Bin&auml;rdateien hingegen verwenden die
	Linux-<emphasis>glue</emphasis>-Funktionen. Die meisten
	&auml;lteren Betriebssysteme hatten ihre eigenen
	<emphasis>glue</emphasis>-Funktionen: Funktionsadressen
	in einem globalen, statischen <literal>sysent[]</literal>
	Strukturfeld an Stelle von Funktionsadressen,  die durch
	einen dynamisch initialisierten Zeiger aus der
	<literal>proc</literal> Struktur, die den Aufruf gemacht hatte,
	dereferenziert wurden.</para>

      <para>Welche ist die echte FreeBSD-ABI?  Das spielt keine Rolle.
	Grunds&auml;tzlich ist der einzige Unterschied (zurzeit
	ist das so; dies k&ouml;nnte sich in zuk&uuml;nftigen
	Versionen leicht &auml;ndern und wird sich wahrscheinlich
	auch &auml;ndern), dass die
	FreeBSD-<emphasis>glue</emphasis>-Funktionen statisch in
	den Kernel gelinkt sind, und dass die
	Linux-<emphasis>glue</emphasis>-Funktionen statisch gelinkt
	oder &uuml;ber ein Modul eingebunden werden k&ouml;nnen.</para>

      <para>Ja, aber ist das wirkliche eine Emulation? Nein.  Es ist eine
	Implementierung eines ABIs, keine Emulation.  Es ist kein Emulator
	(oder Simulator, um der n&auml;chsten Frage zuvorzukommen)
	beteiligt.</para>

      <para>Warum wird es manchmal <quote>Linux-Emulation</quote> genannt?
	Um es schwerer zu machen, FreeBSD zu verkaufen.  Wirklich, das kommt
	daher, weil dies zu einer Zeit implemtiert wurde,
	in der es kein anderes Wort
	(als Emulation) gab, das beschrieb, was vor sich ging.
	Wenn der Kernel nicht entsprechend konfiguriert wurde oder das
	Modul geladen wurde, war es falsch zu behaupten, FreeBSD w&uuml;rde
	Linux-Bin&auml;rprogramme ausf&uuml;hren.  Man ben&ouml;tigte
	ein Wort, das beschrieb, was da geladen
	wurde &ndash; daher <quote>Der Linux-Emulator</quote>.</para>
    </sect2>
  </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
