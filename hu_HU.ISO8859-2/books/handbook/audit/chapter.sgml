<!--
     The FreeBSD Documentation Project     
     $FreeBSD$
-->

<!-- The FreeBSD Hungarian Documentation Project
     Translated by: PALI, Gabor <pgj@FreeBSD.org>
     %SOURCE%	en_US.ISO8859-1/books/handbook/audit/chapter.sgml
     %SRCID%	1.34
-->

<chapter id="audit" lang="hu">
  <chapterinfo>
    <authorgroup>
      <author>
	<firstname>Tom</firstname>
	<surname>Rhodes</surname>
	<contrib>&Iacute;rta: </contrib>
      </author>
      <author>
	<firstname>Robert</firstname>
	<surname>Watson</surname>
      </author>
    </authorgroup>
  </chapterinfo>

  <title>Biztons&aacute;gi esem&eacute;nyek vizsg&aacute;lata</title>

  <sect1 id="audit-synopsis">
    <title>&Aacute;ttekint&eacute;s</title>

    <indexterm><primary>AUDIT</primary></indexterm>
    <indexterm>
      <primary>Biztons&aacute;gi esem&eacute;nyek
	vizsg&aacute;lata</primary>
      <see>MAC</see>
    </indexterm>

    <para>A &os; t&aacute;mogatja a biztons&aacute;gi esem&eacute;nyek
      apr&oacute;l&eacute;kos vizsg&aacute;lat&aacute;t.  Ezzel egy
      megb&iacute;zhat&oacute;, r&eacute;szletes &eacute;s j&oacute;l
      konfigur&aacute;lhat&oacute; napl&oacute;z&aacute;si rendszert
      ny&uacute;jtanak a rendszerben tal&aacute;lhat&oacute;
      biztons&aacute;got ig&eacute;nyl&#245; esem&eacute;nyek
      sz&eacute;les k&ouml;r&eacute;hez, bele&eacute;rtve a
      bejelentkez&eacute;seket, a konfigur&aacute;ci&oacute;s
      &aacute;llom&aacute;nyokban bek&ouml;vetkez&#245;
      v&aacute;ltoz&aacute;sokat, &aacute;llom&aacute;ny- &eacute;s
      h&aacute;l&oacute;zati hozz&aacute;f&eacute;r&eacute;seket.  Az
      &iacute;gy l&eacute;trehozott napl&oacute;bejegyz&eacute;sek
      felbecs&uuml;lhetetlen &eacute;rt&eacute;k&#251;nek bizonyulhatnak
      egy &eacute;l&#245; rendszer fel&uuml;gyelete sor&aacute;n, vagy
      egy h&aacute;l&oacute;zati t&aacute;mad&aacute;s
      &eacute;szlel&eacute;s&eacute;hez, esetleg egy
      &ouml;sszeoml&aacute;s okainak kielemez&eacute;s&eacute;hez.  A
      &os; ehhez a &sun; &aacute;ltal kifejlesztett
      <acronym>BSM</acronym> technol&oacute;gia API-j&aacute;t &eacute;s
      &aacute;llom&aacute;nyform&aacute;tum&aacute;t
      val&oacute;s&iacute;tja meg, &eacute;s &iacute;gy k&eacute;pes
      egy&uuml;ttm&#251;k&ouml;dni a &sun; &solaris; valamint az &apple;
      &macos;&nbsp;X bizons&aacute;gi rendszereivel
      egyar&aacute;nt.</para>

    <para>Ebben a fejezetben a biztons&aacute;gi esem&eacute;nyek
      vizsg&aacute;lat&aacute;nak telep&iacute;t&eacute;s&eacute;hez
      &eacute;s be&aacute;ll&iacute;t&aacute;s&aacute;hoz
      sz&uuml;ks&eacute;ges ismeretek tekintj&uuml;k &aacute;t.  Ennek
      keret&eacute;ben sz&oacute; esik a vizsg&aacute;lati
      h&aacute;zirendekr&#245;l, valamint mutatunk egy
      p&eacute;ld&aacute;t a vizsg&aacute;latok
      be&aacute;ll&iacute;t&aacute;s&aacute;ra.</para>

    <para>A fejezet elolvas&aacute;sa sor&aacute;n
      megismerj&uuml;k:</para>

    <itemizedlist>
      <listitem>
	<para>mit jelent az esem&eacute;nyek vizsg&aacute;lata &eacute;s
	  hogyan m&#251;k&ouml;dik;</para>
      </listitem>

      <listitem>
	<para>hogyan kell be&aacute;ll&iacute;tani az esem&eacute;nyek
	  vizsg&aacute;lat&aacute;t &os;-n a
	  k&uuml;l&ouml;nb&ouml;z&#245; felhaszn&aacute;l&oacute;k
	  &eacute;s programok eset&eacute;n;</para>
      </listitem>

      <listitem>
	<para>hogyan &eacute;rtelmezz&uuml;k a vizsg&aacute;lati
	  nyomokat a vizsg&aacute;latot sz&#251;k&iacute;t&#245;
	  &eacute;s -elemz&#245; seg&eacute;dprogramok
	  seg&iacute;ts&eacute;g&eacute;vel.</para>
      </listitem>
    </itemizedlist>

    <para>A fejezet elolvas&aacute;s&aacute;hoz aj&aacute;nlott:</para>

    <itemizedlist>
      <listitem>
	<para>alapvet&#245; &unix;-os &eacute;s &os;-s ismeretek (<xref
	  linkend="basics">);</para>
      </listitem>

      <listitem>
	<para>a rendszermag konfigur&aacute;l&aacute;s&aacute;val
	  &eacute;s ford&iacute;t&aacute;s&aacute;val kapcsolatos
	  tudnival&oacute;k alapszint&#251; ismerete (<xref
	  linkend="kernelconfig">);</para>
      </listitem>

      <listitem>
	<para>az informatikai biztons&aacute;g alapfogalmainak &eacute;s
	  annak a &os;-re vonatkoz&oacute; r&eacute;szleteinek
	  minim&aacute;lis ismerete (<xref linkend="security">).</para>
      </listitem>
    </itemizedlist>

    <warning>
      <para>Az esem&eacute;nyek vizsg&aacute;lat&aacute;val kapcsolatos
	ismert korl&aacute;toz&aacute;sok: nem mindegyik
	biztons&aacute;got &eacute;rint&#245; esem&eacute;ny
	vizsg&aacute;lhat&oacute;, mint p&eacute;ld&aacute;ul az egyes
	bejelentkez&eacute;si t&iacute;pusok, mivel azok nem
	megfelel&#245;en hiteles&iacute;tik a bel&eacute;p&#245;
	felhaszn&aacute;l&oacute;kat.  Ilyenek p&eacute;ld&aacute;ul az
	X11-alap&uacute; fel&uuml;letek &eacute;s az egy&eacute;b, erre
	a c&eacute;lra alkalmas, m&aacute;s &aacute;ltal fejlesztett
	d&eacute;monok.</para>

      <para>A biztons&aacute;gi esem&eacute;nyek vizsg&aacute;lata
	sor&aacute;n a rendszer k&eacute;pes nagyon r&eacute;szletes
	napl&oacute;kat k&eacute;sz&iacute;teni az &eacute;rintett
	tev&eacute;kenys&eacute;gekr&#245;l.  &Iacute;gy egy
	kell&#245;en forgalmas rendszeren az
	&aacute;llom&aacute;nymozg&aacute;sok alapos
	nyomonk&ouml;vet&eacute;se bizonyos
	konfigur&aacute;ci&oacute;kon ak&aacute;r gigabyte-okat is
	kitehet hetente.  A rendszergazd&aacute;knak ez&eacute;rt mindig
	javasolt sz&aacute;molniuk a nagy forgalm&uacute;
	esem&eacute;nyek biztons&aacute;gi vizsg&aacute;lat&aacute;nak
	t&aacute;rig&eacute;ny&eacute;vel.  P&eacute;ld&aacute;ul,
	emiatt &eacute;rdemes lehet egy eg&eacute;sz
	&aacute;llom&aacute;nyrendszert sz&aacute;nni erre a feladatra a
	<filename>/var/audit</filename> k&ouml;nyvt&aacute;rban,
	&eacute;s &iacute;gy a t&ouml;bbi &aacute;llom&aacute;nyrendszer
	nem l&aacute;tja k&aacute;r&aacute;t, ha v&eacute;letlen&uuml;l
	betelne ez a ter&uuml;let.</para>
    </warning>
  </sect1>

  <sect1 id="audit-inline-glossary">
    <title>A fejezet fontosabb fogalmai</title>

    <para>A fejezet elolvas&aacute;sa el&#245;tt meg kell ismern&uuml;nk
      n&eacute;h&aacute;ny fontos alapfogalmat:</para>

    <itemizedlist>
      <listitem>
	<para><emphasis>esem&eacute;ny:</emphasis>
	  Vizsg&aacute;lhat&oacute; esem&eacute;nynek azt az
	  esem&eacute;nyt nevezz&uuml;k, amely egy vizsg&aacute;lati
	  alrendszerben napl&oacute;zhat&oacute;.  Biztons&aacute;gi
	  esem&eacute;nyek lehetnek p&eacute;ld&aacute;ul: egy
	  &aacute;llom&aacute;ny l&eacute;trehoz&aacute;sa, egy
	  h&aacute;l&oacute;zati kapcsolat
	  fel&eacute;p&iacute;t&eacute;se, vagy egy
	  felhaszn&aacute;l&oacute; bejelentkez&eacute;se.  Egy
	  esem&eacute;ny <quote>jellegzetes</quote>, ha
	  visszak&ouml;vethet&#245; valamelyik hiteles&iacute;tett
	  felhaszn&aacute;l&oacute;hoz, vagy <quote>nem
	  jellegzetes</quote>, ha ez nem lehets&eacute;ges.  Nem
	  jellegzetes esem&eacute;ny lehet minden olyan esem&eacute;ny,
	  amely egy bejelentkez&eacute;si folyamat
	  hiteles&iacute;t&eacute;si l&eacute;p&eacute;se el&#245;tt
	  t&ouml;rt&eacute;nik, p&eacute;ld&aacute;ul egy
	  bel&eacute;p&eacute;si k&iacute;s&eacute;rlet hib&aacute;s
	  jelsz&oacute;val.</para>
      </listitem>

      <listitem>
	<para><emphasis>oszt&aacute;ly:</emphasis>
	  Esem&eacute;nyoszt&aacute;lynak az &ouml;sszef&uuml;gg&#245;
	  esem&eacute;nyek n&eacute;vvel ell&aacute;tott halmaz&aacute;t
	  tekintj&uuml;k, &eacute;s sz&#251;r&eacute;si
	  felt&eacute;telekben haszn&aacute;ljuk ezeket.
	  &Aacute;ltal&aacute;ban alkalmazott oszt&aacute;lyok:
	  <quote>file creation</quote> (fc,
	  &aacute;llom&aacute;nyl&eacute;trehoz&aacute;s),
	  <quote>exec</quote> (ex, programind&iacute;t&aacute;s),
	  &eacute;s <quote>login_logout</quote> (lo, ki- &eacute;s
	  bejelentkez&eacute;s).</para>
      </listitem>

      <listitem>
	<para><emphasis>rekord:</emphasis> Rekordnak nevezz&uuml;k a
	  biztons&aacute;gi esem&eacute;nyeket le&iacute;r&oacute;
	  biztons&aacute;gi napl&oacute;bejegyz&eacute;seket.  A
	  rekordok tartalmazhatj&aacute;k a feljegyzett esem&eacute;ny
	  t&iacute;pus&aacute;t, az esem&eacute;nyt
	  kiv&aacute;lt&oacute; tev&eacute;kenys&eacute;get
	  (felhaszn&aacute;l&oacute;t), a d&aacute;tumot &eacute;s az
	  id&#245;t, tetsz&#245;leges objektum vagy param&eacute;ter
	  &eacute;rt&eacute;k&eacute;t, felt&eacute;telek
	  teljes&uuml;l&eacute;s&eacute;t vagy
	  meghi&uacute;sul&aacute;s&aacute;t.</para>
      </listitem>

      <listitem>
	<para><emphasis>nyom:</emphasis> Vizsg&aacute;lati nyomnak vagy
	  napl&oacute;&aacute;llom&aacute;nynak nevezz&uuml;k a
	  k&uuml;l&ouml;nf&eacute;le biztons&aacute;gi
	  esem&eacute;nyeket le&iacute;r&oacute; vizsg&aacute;lati
	  rekordok sorozat&aacute;t.  A nyomok t&ouml;bbnyire
	  nagyj&aacute;b&oacute;l az esem&eacute;nyek
	  bek&ouml;vetkez&eacute;se szerinti id&#245;rendben
	  k&ouml;vetkeznek.  Csak &eacute;s kiz&aacute;r&oacute;lag az
	  erre felhatalmazott programok hozhatnak l&eacute;tre
	  rekordokat a vizsg&aacute;lati nyomban.</para>
      </listitem>

      <listitem>
	<para><emphasis>sz&#251;r&eacute;si felt&eacute;tel:</emphasis>
	  Sz&#251;r&eacute;si felt&eacute;telnek nevez&uuml;nk egy olyan
	  karakterl&aacute;ncot, amelyet esem&eacute;nyek
	  sz&#251;r&eacute;s&eacute;re haszn&aacute;lunk, &eacute;s
	  m&oacute;dos&iacute;t&oacute;kat valamint
	  esem&eacute;nyoszt&aacute;lyok neveit tartalmazza.</para>
      </listitem>

      <listitem>
	<para><emphasis>el&#245;v&aacute;logat&aacute;s:</emphasis>
	  El&#245;v&aacute;logat&aacute;snak nevezz&uuml;k a folyamatot,
	  amelynek sor&aacute;n a rendszer beazonos&iacute;tja azokat az
	  esem&eacute;nyeket, amelyek a rendszergazda
	  sz&aacute;m&aacute;ra fontosak.  Ez&aacute;ltal
	  elker&uuml;lhetj&uuml;k olyan vizsg&aacute;lati rekordok
	  gener&aacute;l&aacute;s&aacute;t, amelyek sz&aacute;munkra
	  &eacute;rdektelen esem&eacute;nyekr&#245;l sz&aacute;molnak
	  be.  Az el&#245;v&aacute;logat&aacute;s sz&#251;r&eacute;si
	  felt&eacute;telek sor&aacute;t haszn&aacute;lja az adott
	  felhaszn&aacute;l&oacute;khoz tartoz&oacute; adott
	  biztons&aacute;gi esem&eacute;nyek vizsg&aacute;lat&aacute;nak
	  be&aacute;ll&iacute;t&aacute;s&aacute;hoz, ak&aacute;rcsak a
	  hiteles&iacute;tett &eacute;s a nem hiteles&iacute;tett
	  programokat &eacute;rtint&#245; glob&aacute;lis
	  be&aacute;ll&iacute;t&aacute;sok
	  meghat&aacute;roz&aacute;s&aacute;hoz.</para>
      </listitem>

      <listitem>
	<para><emphasis>lesz&#251;k&iacute;t&eacute;s:</emphasis>
	  Lesz&#251;k&iacute;t&eacute;snek nevezz&uuml;k a folyamatot,
	  amelynek sor&aacute;n a m&aacute;r meglev&#245;
	  biztons&aacute;gi rekordokb&oacute;l v&aacute;logatunk le
	  t&aacute;rol&aacute;sra, nyomtat&aacute;sra vagy
	  elemz&eacute;sre.  Hasonl&oacute;an ez a folyamat, ahol a
	  sz&uuml;ks&eacute;gtelen rekordokat elt&aacute;vol&iacute;tjuk
	  a vizsg&aacute;latai nyomb&oacute;l.  A
	  lesz&#251;k&iacute;t&eacute;s
	  seg&iacute;ts&eacute;g&eacute;vel a rendszergazd&aacute;k a
	  vizsg&aacute;lati adatok elt&aacute;rol&aacute;s&aacute;ra
	  alak&iacute;thatnak ki h&aacute;zirendet.
	  P&eacute;ld&aacute;ul a r&eacute;szletesebb vizsg&aacute;lati
	  nyomokat &eacute;rdemes egy h&oacute;napig megtartani, ennek
	  lej&aacute;rt&aacute;val viszont m&aacute;r ink&aacute;bb
	  aj&aacute;nlott lesz&#251;k&iacute;teni ezeket &eacute;s
	  archiv&aacute;l&aacute;sra csak a bejelentkez&eacute;si
	  inform&aacute;ci&oacute;kat megtartani.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="audit-install">
    <title>A vizsg&aacute;lat t&aacute;mogat&aacute;s&aacute;nak
      telep&iacute;t&eacute;se</title>

    <para>A esem&eacute;nyvizsg&aacute;lathoz sz&uuml;ks&eacute;ges
      felhaszn&aacute;l&oacute;i programok a &os; alaprendszer
      r&eacute;sz&eacute;t k&eacute;pezik.  Az
      esem&eacute;nyvizsg&aacute;lat t&aacute;mogat&aacute;sa
      alap&eacute;rtelmez&eacute;s szerint megtal&aacute;lhat&oacute; a
      rendszermagban, azonban egy saj&aacute;t rendszermag eset&eacute;n
      m&aacute;r k&uuml;l&ouml;n be kell kapcsolnunk a megfelel&#245;
      t&aacute;mogat&aacute;st, m&eacute;gpedig a rendszermag
      konfigur&aacute;ci&oacute;s &aacute;llom&aacute;ny&aacute;ban az
      al&aacute;bbi sor hozz&aacute;ad&aacute;s&aacute;val:</para>

    <programlisting>options	AUDIT</programlisting>

    <para>Ford&iacute;tsuk &eacute;s telep&iacute;ts&uuml;k &uacute;jra
      a rendszermagot az <xref linkend="kernelconfig">ben ismertetett
      folyamat szerint.</para>

    <para>Ahogy a rendszermagot a bekapcsolt
      esem&eacute;nyvizsg&aacute;lati t&aacute;mogat&aacute;ssal
      siker&uuml;lt leford&iacute;tanunk &eacute;s
      telep&iacute;ten&uuml;nk, valamint a rendszer&uuml;nk is
      &uacute;jraindult, ind&iacute;tsuk el a vizsg&aacute;l&oacute;
      d&eacute;mont a k&ouml;vetkez&#245; sor
      hozz&aacute;ad&aacute;s&aacute;val az &man.rc.conf.5;
      &aacute;llom&aacute;nyban:</para>

    <programlisting>auditd_enable="YES"</programlisting>

    <para>A vizsg&aacute;latot innent&#245;l t&eacute;nylegesen egy
      ism&eacute;telt &uacute;jraind&iacute;t&aacute;ssal vagy pedig az
      el&#245;bb eml&iacute;tett d&eacute;mon manu&aacute;lis
      elind&iacute;t&aacute;s&aacute;val aktiv&aacute;lhatjuk:</para>

    <programlisting>/etc/rc.d/auditd start</programlisting>

  </sect1>

  <sect1 id="audit-config">
    <title>A vizsg&aacute;lat be&aacute;ll&iacute;t&aacute;sa</title>

    <para>A vizsg&aacute;latok be&aacute;ll&iacute;t&aacute;s&aacute;hoz
      sz&uuml;ks&eacute;ges &ouml;sszes konfigur&aacute;ci&oacute;s
      &aacute;llom&aacute;ny a <filename
      class="directory">/etc/security</filename> k&ouml;nyvt&aacute;rban
      tal&aacute;lhat&oacute;.  A k&ouml;vetkez&#245;
      &aacute;llom&aacute;nyok vannak itt a d&eacute;mon
      ind&iacute;t&aacute;sa el&#245;tt:</para>

    <itemizedlist>
      <listitem>
	<para><filename>audit_class</filename> - a vizsg&aacute;lati
	  oszt&aacute;lyok defin&iacute;ci&oacute;it tartalmazza.</para>
     </listitem>

      <listitem>
	<para><filename>audit_control</filename> - a vizsg&aacute;lati
	  alrendszer k&uuml;l&ouml;nb&ouml;z&#245; ter&uuml;leteit
	  vez&eacute;rli, t&ouml;bbek k&ouml;zt az
	  alap&eacute;rtelmezett vizsg&aacute;lati oszt&aacute;lyokat,
	  az vizsg&aacute;lati adatok t&aacute;rhely&eacute;n
	  fenntartand&oacute; minim&aacute;lis lemezter&uuml;letet, a
	  vizsg&aacute;lati nyom maxim&aacute;lis m&eacute;ret&eacute;t,
	  stb.</para>
      </listitem>

      <listitem>
	<para><filename>audit_event</filename> - a rendszerben
	  jelenlev&#245; vizsg&aacute;lati esem&eacute;nyek
	  sz&ouml;veges megnevez&eacute;se &eacute;s
	  le&iacute;r&aacute;sa, valamint a lista, hogy melyik&uuml;k
	  mely oszt&aacute;lyban tal&aacute;lhat&oacute;.</para>
      </listitem>

      <listitem>
	<para><filename>audit_user</filename> -
	  felhaszn&aacute;l&oacute;nk&eacute;nt v&aacute;ltoz&oacute;
	  vizsg&aacute;lati elv&aacute;r&aacute;sok, kombin&aacute;lva a
	  bejelentkez&eacute;skor &eacute;rv&eacute;nyes
	  glob&aacute;lisan alap&eacute;rtelmezett
	  be&aacute;ll&iacute;t&aacute;sokkal.</para>
      </listitem>

      <listitem>
	<para><filename>audit_warn</filename> - az
	  <application>auditd</application> &aacute;ltal haszn&aacute;lt
	  testreszabhat&oacute; shell szkript, aminek
	  seg&iacute;ts&eacute;g&eacute;vel a
	  sz&eacute;ls&#245;s&eacute;ges helyzetekben figyelmeztet&#245;
	  &uuml;zeneteket tudunk gener&aacute;lni, mint
	  p&eacute;ld&aacute;ul amikor a rekordok sz&aacute;m&aacute;ra
	  fenntartott hely hamarosan elfogy, vagy amikor a nyomokat
	  tartalmaz&oacute; &aacute;llom&aacute;nyt
	  archiv&aacute;ltuk.</para>
      </listitem>
    </itemizedlist>

    <warning>
      <para>Az esem&eacute;nyvizsg&aacute;lat
	konfigur&aacute;ci&oacute;s &aacute;llom&aacute;nyait alapos
	k&ouml;r&uuml;ltekint&eacute;s mellett szabad szerkeszteni
	&eacute;s karbantartani, mivel a benn&uuml;k keletkez&#245;
	hib&aacute;k az esem&eacute;nyek helytelen
	napl&oacute;z&aacute;s&aacute;t eredm&eacute;nyezhetik.</para>
    </warning>

    <sect2>
      <title>Esem&eacute;nysz&#251;r&eacute;si felt&eacute;telek</title>

      <para>Az esem&eacute;nyvizsg&aacute;lati
	be&aacute;ll&iacute;t&aacute;sok sor&aacute;n sz&aacute;mtalan
	helyen felbukkanak a vizsg&aacute;lni k&iacute;v&aacute;nt
	esem&eacute;nyeket meghat&aacute;roz&oacute; sz&#251;r&eacute;si
	felt&eacute;telek.  Ezen felt&eacute;telek
	esem&eacute;nyoszt&aacute;lyok felsorol&aacute;s&aacute;t
	tartalmazz&aacute;k, mindegyik&uuml;ket egy
	m&oacute;dos&iacute;t&oacute; vezeti be, ezzel jelezve, hogy az
	adott esem&eacute;nyoszt&aacute;lyba tartoz&oacute; rekordokat
	tartsuk meg vagy vess&uuml;k el.  Esetleg utalhatnak arra is,
	hogy vagy csak a sikeress&eacute;get jelz&#245; rekordokat, vagy
	csak a sikertelens&eacute;get jelz&#245; rekordokat
	sz&#251;rj&uuml;k ki.  A sz&#251;r&eacute;si felt&eacute;telek
	balr&oacute;l jobbra &eacute;rt&eacute;kel&#245;dnek ki,
	&eacute;s k&eacute;t kifejez&eacute;s
	&ouml;sszef&#251;z&eacute;ssel
	kombin&aacute;lhat&oacute;.</para>

      <para>A most k&ouml;vetkez&#245; lista tartalmazza a
	<filename>audit_class</filename> &aacute;llom&aacute;nyban
	tal&aacute;lhat&oacute; alap&eacute;rtelmezett
	esem&eacute;nyvizsg&aacute;lati oszt&aacute;lyokat:</para>

      <itemizedlist>
	<listitem>
	  <para><literal>all</literal> - <emphasis>all (mind)</emphasis>
	    - Minden esem&eacute;nyoszt&aacute;lyra vonatkozik.</para>
	</listitem>

	<listitem>
	  <para><literal>ad</literal> - <emphasis>administrive
	    (adminisztr&aacute;ci&oacute;s)</emphasis> - olyan
	    adminisztr&aacute;ci&oacute;s tev&eacute;kenys&eacute;gek,
	    amelyek egyben az eg&eacute;sz rendszeren
	    v&eacute;grehajt&oacute;dnak.</para>
	</listitem>

	<listitem>
	  <para><literal>ap</literal> - <emphasis>application
	    (alkalmaz&aacute;s)</emphasis> - az alkalmaz&aacute;sok
	    &aacute;ltal meghat&aacute;rozott
	    tev&eacute;kenys&eacute;g.</para>
	</listitem>

	<listitem>
	  <para><literal>cl</literal> - <emphasis>file close
	    (&aacute;llom&aacute;ny lez&aacute;r&aacute;sa)</emphasis> -
	    a <function>close</function> rendszerh&iacute;v&aacute;s
	    megh&iacute;v&aacute;s&aacute;nak vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>ex</literal> - <emphasis>exec
	    (programind&iacute;t&aacute;s)</emphasis> - egy program
	    ind&iacute;t&aacute;s&aacute;nak vizsg&aacute;lata.  A
	    parancssorban &aacute;tadott param&eacute;terek &eacute;s a
	    k&ouml;rnyezeti v&aacute;ltoz&oacute;k
	    vizsg&aacute;lat&aacute;t az &man.audit.control.5;
	    vez&eacute;rli a <literal>policy</literal>
	    be&aacute;ll&iacute;t&aacute;shoz tartoz&oacute;
	    <literal>argv</literal> &eacute;s <literal>envv</literal>
	    param&eacute;terek seg&iacute;ts&eacute;g&eacute;vel.</para>
	</listitem>

	<listitem>
	  <para><literal>fa</literal> - <emphasis>file attribute access
	    (&aacute;llom&aacute;nyjellemz&#245;k
	    hozz&aacute;f&eacute;r&eacute;se)</emphasis> - a
	    rendszerbeli objektumok jellemz&#245;inek
	    hozz&aacute;f&eacute;r&eacute;snek vizsg&aacute;lata, mint
	    p&eacute;ld&aacute;ul a &man.stat.1;, &man.pathconf.2;
	    &eacute;s ehhez hasonl&oacute; esem&eacute;nyek.</para>
	</listitem>

	<listitem>
	  <para><literal>fc</literal> - <emphasis>file create
	    (&aacute;llom&aacute;ny
	    l&eacute;trehoz&aacute;sa)</emphasis> -
	    &aacute;llom&aacute;nyt eredm&eacute;nyez&#245;
	    esem&eacute;nyek vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>fd</literal> - <emphasis>file delete
	    (&aacute;llom&aacute;ny t&ouml;rl&eacute;se)</emphasis> -
	    &aacute;llom&aacute;nyt t&ouml;rl&#245; esem&eacute;nyek
	    vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>fm</literal> - <emphasis>file attribute modify
	    (&aacute;llom&aacute;nyjellemz&#245;k
	    m&oacute;dos&iacute;t&aacute;sa)</emphasis> -
	    &aacute;llom&aacute;nyok jellemz&#245;it
	    megv&aacute;ltoztat&oacute; esem&eacute;nyek
	    vizsg&aacute;lata, mint p&eacute;ld&aacute;ul a
	    &man.chown.8;, &man.chflags.1;, &man.flock.2;, stb.</para>
	</listitem>

	<listitem>
	  <para><literal>fr</literal> - <emphasis>file read
	    (&aacute;llom&aacute;nyolvas&aacute;s)</emphasis> -
	    &aacute;llom&aacute;nyok megnyit&aacute;s&aacute;val
	    olvas&aacute;sra, olvas&aacute;s&aacute;val, stb.
	    kapcsolatos esem&eacute;nyek vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>fw</literal> - <emphasis>file write
	    (&aacute;llom&aacute;ny&iacute;r&aacute;s)</emphasis> -
	    &aacute;llom&aacute;nyok megnyit&aacute;s&aacute;val
	    &iacute;r&aacute;sra, &iacute;r&aacute;s&aacute;val,
	    m&oacute;dos&iacute;t&aacute;s&aacute;val, stb.  kapcsolatos
	    esem&eacute;nyek vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>io</literal> - <emphasis>ioctl</emphasis> - az
	    &man.ioctl.2; rendszerh&iacute;v&aacute;st
	    haszn&aacute;l&oacute; esem&eacute;nyek
	    vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>ip</literal> - <emphasis>ipc</emphasis> - a
	    folyamatok k&ouml;zti kommunik&aacute;ci&oacute;
	    k&uuml;l&ouml;nf&eacute;le form&aacute;inak,
	    bele&eacute;rtve a POSIX cs&ouml;vek &eacute;s System&nbsp;V
	    <acronym>IPC</acronym> m&#251;veleteinek
	    vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>lo</literal> - <emphasis>login_logout (ki-
	    &eacute;s bejelentkez&eacute;s)</emphasis> - a rendszerben
	    megjelen&#245; &man.login.1; &eacute;s &man.logout.1;
	    esem&eacute;nyek vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>na</literal> - <emphasis>non attributable (nem
	    jellegzetes)</emphasis> - a nem jellegzetes esem&eacute;nyek
	    vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>no</literal> - <emphasis>invalid class
	    (&eacute;rv&eacute;nytelen oszt&aacute;ly)</emphasis> -
	    egyetlen biztons&aacute;gi esem&eacute;nyt sem
	    tartalmaz.</para>
	</listitem>

	<listitem>
	  <para><literal>nt</literal> - <emphasis>network
	    (h&aacute;l&oacute;zat)</emphasis> - a
	    h&aacute;l&oacute;zathoz tartoz&oacute; esem&eacute;nyek
	    vizsg&aacute;lata, mint p&eacute;ld&aacute;ul a
	    &man.connect.2; &eacute;s az &man.accept.2;.</para>
	</listitem>

	<listitem>
	  <para><literal>ot</literal> - <emphasis>other
	    (egy&eacute;b)</emphasis> - m&aacute;s egy&eacute;b
	    esem&eacute;nyek vizsg&aacute;lata.</para>
	</listitem>

	<listitem>
	  <para><literal>pc</literal> - <emphasis>process
	    (folyamat)</emphasis> - a folyamatokkal kapcsolatos
	    m&#251;veletek, mint p&eacute;ld&aacute;ul az &man.exec.3;
	    &eacute;s az &man.exit.3; vizsg&aacute;lata.</para>
	</listitem>
      </itemizedlist>

      <para>Az im&eacute;nt felsorolt esem&eacute;nyoszt&aacute;lyok az
	<filename>audit_class</filename> &eacute;s az
	<filename>audit_event</filename> &aacute;llom&aacute;nyok
	m&oacute;dos&iacute;t&aacute;s&aacute;val ig&eacute;ny szerint
	testreszabhat&oacute;ak.</para>

      <para>A list&aacute;ban szerepl&#245; minden egyes
	esem&eacute;nyoszt&aacute;lyhoz tartozik m&eacute;g egy
	m&oacute;dos&iacute;t&oacute; is, amely jelzi, hogy a sikeres
	vagy a sikertelen m&#251;veleteket kell-e sz&#251;rn&uuml;nk,
	valamint hogy a bejegyz&eacute;s az adott t&iacute;pust vagy
	oszt&aacute;lyt hozz&aacute;adja vagy elveszi az adott
	sz&#251;r&eacute;sb&#245;l.</para>

      <itemizedlist>
	<listitem>
	  <para>(&uuml;res) az adott t&iacute;pusb&oacute;l mind a
	    sikereseket &eacute;s mind a sikerteleneket
	    feljegyzi.</para>
	</listitem>

	<listitem>
	  <para><literal>+</literal> az esem&eacute;nyoszt&aacute;lyba
	    tartoz&oacute; sikeres esem&eacute;nyeket vizsg&aacute;lja
	    csak.</para>
	</listitem>

	<listitem>
	  <para><literal>-</literal> az esem&eacute;nyoszt&aacute;lyba
	    tartoz&oacute; sikertelen esem&eacute;nyeket
	    vizsg&aacute;lja csak.</para>
	</listitem>

	<listitem>
	  <para><literal>^</literal> az
	    esem&eacute;nyoszt&aacute;lyb&oacute;l sem a sikereseket,
	    sem pedig a sikerteleneket nem vizsg&aacute;lja.</para>
	</listitem>

	<listitem>
	  <para><literal>^+</literal> az
	    esem&eacute;nyoszt&aacute;lyb&oacute;l nem vizsg&aacute;lja
	    a sikeres esem&eacute;nyeket.</para>
	</listitem>

	<listitem>
	  <para><literal>^-</literal> az
	    esem&eacute;nyoszt&aacute;lyb&oacute;l nem vizsg&aacute;lja
	    a sikertelen esem&eacute;nyeket.</para>
	</listitem>
      </itemizedlist>

      <para>Az al&aacute;bbi p&eacute;lda egy olyan sz&#251;r&eacute;si
	felt&eacute;telt mutat be, amely a ki- &eacute;s
	bejelentkez&eacute;sek k&ouml;z&uuml;l megadja a sikereset
	&eacute;s a sikerteleneket, viszont a
	programind&iacute;t&aacute;sok k&ouml;z&uuml;l csak a
	sikereseket:</para>

      <programlisting>lo,+ex</programlisting>

    </sect2>

    <sect2>
      <title>A konfigur&aacute;ci&oacute;s
	&aacute;llom&aacute;nyok</title>

      <para>A vizsg&aacute;lati rendszer
	be&aacute;ll&iacute;t&aacute;s&aacute;hoz az esetek
	t&uacute;lnyom&oacute; r&eacute;sz&eacute;ben a
	rendszergazd&aacute;knak csup&aacute;n k&eacute;t
	&aacute;llom&aacute;nyt kell m&oacute;dos&iacute;taniuk: ezek az
	<filename>audit_control</filename> &eacute;s az
	<filename>audit_user</filename>.  Az el&#245;bbi felel&#245;s a
	rendszerszint&#251; vizsg&aacute;lati jellemz&#245;k&eacute;rt
	&eacute;s h&aacute;zirendek&eacute;rt, m&iacute;g az
	ut&oacute;bbi az ig&eacute;nyek
	felhaszn&aacute;l&oacute;k&eacute;nti
	finomhangol&aacute;s&aacute;hoz
	haszn&aacute;lhat&oacute;.</para>

      <sect3 id="audit-auditcontrol">
	<title>Az <filename>audit_control</filename>
	  &aacute;llom&aacute;ny</title>

	<para>Az <filename>audit_control</filename>
	  &aacute;llom&aacute;ny hat&aacute;rozza meg a
	  vizsg&aacute;lati alrendszer alap&eacute;rtelmez&eacute;seit.
	  Ezt az &aacute;llom&aacute;nyt megnyitva a
	  k&ouml;vetkez&#245;ket l&aacute;thatjuk:</para>

	<programlisting>dir:/var/audit
flags:lo
minfree:20
naflags:lo
policy:cnt
filesz:0</programlisting>

	<para>A <option>dir</option> opci&oacute;t haszn&aacute;ljuk a
	  vizsg&aacute;lati napl&oacute;k
	  t&aacute;rol&aacute;s&aacute;ra szolg&aacute;l&oacute; egy
	  vagy t&ouml;bb k&ouml;nyvt&aacute;r megad&aacute;s&aacute;ra.
	  Ha egyn&eacute;l t&ouml;bb k&ouml;nyvt&aacute;rra
	  vonatkoz&oacute; bejegyz&eacute;s tal&aacute;lhat&oacute; az
	  &aacute;llom&aacute;nyban, akkor azok a megad&aacute;s
	  sorrendj&eacute;ben ker&uuml;lnek felt&ouml;lt&eacute;sre.
	  Nagyon gyakori az a be&aacute;ll&iacute;t&aacute;s, ahol a
	  vizsg&aacute;lati napl&oacute;kat egy erre a c&eacute;lra
	  k&uuml;l&ouml;n kialak&iacute;tott
	  &aacute;llom&aacute;nyrendszeren t&aacute;rolj&aacute;k,
	  megel&#245;zve ezzel az &aacute;llom&aacute;nyrendszer
	  betel&eacute;sekor keletkez&#245; probl&eacute;m&aacute;kat a
	  t&ouml;bbi alrendszerben.</para>

	<para>A <option>flags</option> mez&#245; egy rendszerszint&#251;
	  alap&eacute;rtelmezett el&#245;v&aacute;logat&aacute;si
	  maszkot hat&aacute;roz meg a jellegzetes esem&eacute;nyek
	  sz&aacute;m&aacute;ra.  A fenti p&eacute;ld&aacute;ban a
	  sikeres &eacute;s sikertelen ki- &eacute;s
	  bejelentkez&eacute;seket mindegyik felhaszn&aacute;l&oacute;
	  eset&eacute;n vizsg&aacute;ljuk.</para>

	<para>A <option>minfree</option> opci&oacute; megszabja a
	  vizsg&aacute;lati nyom t&aacute;rol&aacute;s&aacute;ra
	  sz&aacute;nt &aacute;llom&aacute;nyrendszeren a
	  minim&aacute;lis szabad helyet, a teljes kapacit&aacute;s
	  sz&aacute;zal&eacute;k&aacute;ban.  Amint ezt a
	  k&uuml;sz&ouml;b&ouml;t t&uacute;ll&eacute;pj&uuml;k, egy
	  figyelmeztet&eacute;s fog gener&aacute;l&oacute;dni.  A fenti
	  p&eacute;lda a minim&aacute;lisan sz&uuml;ks&eacute;ges
	  rendelkez&eacute;sre &aacute;ll&oacute; helyet h&uacute;sz
	  sz&aacute;zal&eacute;kra &aacute;ll&iacute;tja.</para>

	<para>A <option>naflags</option> opci&oacute; megadja azokat az
	  esem&eacute;nyoszt&aacute;lyokat, amelyeket vizsg&aacute;lni
	  kell a nem jellegzetes esem&eacute;nyek, mind
	  p&eacute;ld&aacute;ul a bejelentkez&eacute;si folyamatok vagy
	  rendszerd&eacute;monok eset&eacute;n.</para>

	<para>A <option>policy</option> opci&oacute; a vizsg&aacute;lat
	  k&uuml;l&ouml;nb&ouml;z&#245; szempontjait
	  ir&aacute;ny&iacute;t&oacute; h&aacute;zirendbeli
	  be&aacute;ll&iacute;t&aacute;sok vessz&#245;vel
	  elv&aacute;lasztott list&aacute;j&aacute;t tartalmazza.  Az
	  alap&eacute;rtelmezett <literal>cnt</literal>
	  be&aacute;ll&iacute;t&aacute;s azt adja meg, hogy a rendszer a
	  felmer&uuml;l&#245; vizsg&aacute;lati hib&aacute;k
	  ellen&eacute;re is folytassa tov&aacute;bb a
	  m&#251;k&ouml;d&eacute;s&eacute;t (er&#245;sen javasolt a
	  haszn&aacute;lata).  A m&aacute;sik gyakorta alkalmazott
	  be&aacute;ll&iacute;t&aacute;s az <literal>argv</literal>,
	  amellyel a rendszer a parancsv&eacute;grehajt&aacute;s
	  r&eacute;szek&eacute;nt az &man.execve.2;
	  rendszerh&iacute;v&aacute;s parancssori param&eacute;tereit is
	  megvizsg&aacute;lja.</para>

	<para>A <option>filesz</option> opci&oacute; hat&aacute;rozza
	  meg a vizsg&aacute;lati nyom automatikus
	  sz&eacute;tv&aacute;g&aacute;sa &eacute;s
	  archiv&aacute;l&aacute;sa el&#245;tti maxim&aacute;lis
	  m&eacute;ret&eacute;t, byte-ban.  Az alap&eacute;rtelmezett
	  &eacute;rt&eacute;ke a 0, amely kikapcsolja ezt az
	  archiv&aacute;l&aacute;st.  Ha az itt megadott
	  &aacute;llom&aacute;nym&eacute;ret nem nulla &eacute;s a
	  minim&aacute;lisan elv&aacute;rt 512&nbsp;KB alatt van, akkor
	  a rendszer figyelmen k&iacute;v&uuml;l hagyja &eacute;s
	  err&#245;l egy figyelmeztet&eacute;st ad.</para>

      </sect3>

      <sect3 id="audit-audituser">
	<title>Az <filename>audit_user</filename>
	  &aacute;llom&aacute;ny</title>

	<para>Az <filename>audit_user</filename> &aacute;llom&aacute;ny
	  lehet&#245;v&eacute; teszi a rendszergazda
	  sz&aacute;m&aacute;ra, hogy az egyes
	  felhaszn&aacute;l&oacute;k sz&aacute;m&aacute;ra
	  tov&aacute;bbi vizsg&aacute;lati szigor&iacute;t&aacute;sokat
	  hat&aacute;rozzon meg.  Minden sor egy-egy
	  felhaszn&aacute;l&oacute; vizsg&aacute;lat&aacute;nak
	  pontos&iacute;t&aacute;s&aacute;t adja meg k&eacute;t
	  mez&#245; seg&iacute;ts&eacute;g&eacute;vel: az els&#245;
	  k&ouml;z&uuml;l&uuml;k az <literal>alwaysaudit</literal>
	  mez&#245;, mely felsorolja azokat az esem&eacute;nyeket,
	  amelyeket minden esetben vizsg&aacute;ni kell az adott
	  felhaszn&aacute;l&oacute; eset&eacute;n, valamint a
	  m&aacute;sodik a <literal>neveraudit</literal> mez&#245;, mely
	  az adott felhaszn&aacute;l&oacute; eset&eacute;n a nem
	  vizsg&aacute;land&oacute; esem&eacute;nyeket adja meg.</para>

	<para>A most k&ouml;vetkez&#245; <filename>audit_user</filename>
	  p&eacute;ld&aacute;ban vizsg&aacute;ljuk a
	  <username>root</username> felhaszn&aacute;l&oacute; ki-
	  &eacute;s bejelentkez&eacute;seit &eacute;s sikeres
	  programind&iacute;t&aacute;sait, valamint a
	  <username>www</username> felhaszn&aacute;l&oacute;
	  &aacute;llom&aacute;nyl&eacute;trehoz&aacute;sait &eacute;s
	  sikeres programind&iacute;t&aacute;sait.  Ha a kor&aacute;bban
	  bemutatott <filename>audit_control</filename>
	  p&eacute;ld&aacute;val egy&uuml;tt haszn&aacute;ljuk, akkor
	  &eacute;szrevehetj&uuml;k, hogy a <literal>lo</literal>
	  bejegyz&eacute;s a <username>root</username>
	  felhaszn&aacute;l&oacute; eset&eacute;n redund&aacute;ns,
	  illetve ilyenkor a ki/bejelentkez&eacute;st a
	  <username>www</username> felhaszn&aacute;l&oacute;
	  eset&eacute;n is vizsg&aacute;ljuk.</para>

	<programlisting>root:lo,+ex:no
www:fc,+ex:no</programlisting>

      </sect3>
    </sect2>
  </sect1>

  <sect1 id="audit-administration">
    <title>A vizsg&aacute;lati alrendszer haszn&aacute;lata</title>

    <sect2>
      <title>A vizsg&aacute;lati nyomok megtekint&eacute;se</title>

      <para>A vizsg&aacute;lati nyomok a BSM bin&aacute;ris
	form&aacute;tumban t&aacute;rol&oacute;dnak, ez&eacute;rt a
	tartalm&aacute;nak konvert&aacute;l&aacute;s&aacute;hoz
	&eacute;s m&oacute;dos&iacute;t&aacute;s&aacute;hoz
	k&uuml;l&ouml;n seg&eacute;dprogramokra van sz&uuml;ks&eacute;g.
	A &man.praudit.1; parancs a nyom&aacute;llom&aacute;nyokat
	egyszer&#251; sz&ouml;veges form&aacute;tumra alak&iacute;tja,
	az &man.auditreduce.1; parancs pedig a nyomok
	elemz&eacute;s&eacute;hez, archiv&aacute;l&aacute;s&aacute;hoz
	vagy nyomtat&aacute;s&aacute;hoz sz&uuml;ks&eacute;ges
	lesz&#251;k&iacute;t&eacute;s&eacute;ket v&eacute;gzi el.  Az
	<command>auditreduce</command> a sz&#251;r&eacute;si
	felt&eacute;telek param&eacute;tereinek sz&eacute;les
	sk&aacute;l&aacute;j&aacute;t kezeli, bele&eacute;rtve az
	esem&eacute;nyt&iacute;pusokat, -oszt&aacute;lyokat,
	felhaszn&aacute;l&oacute;kat, esem&eacute;nyek
	d&aacute;tum&aacute;t vagy id&#245;pontj&aacute;t,
	&aacute;llom&aacute;nyok el&eacute;r&eacute;si
	&uacute;tvonal&aacute;t vagy az &aacute;ltaluk &eacute;rintett
	objektumokat.</para>

      <para>P&eacute;ld&aacute;ul a <command>praudit</command>
	seg&eacute;dprogram k&eacute;pes kilist&aacute;zni
	sz&ouml;vegesen egy adott vizsg&aacute;lati napl&oacute; teljes
	tartalm&aacute;t:</para>

      <screen>&prompt.root; <userinput>praudit /var/audit/<replaceable>AUDITFILE</replaceable></userinput></screen>

      <para>ahol az
	<filename><replaceable>AUDITFILE</replaceable></filename> a
	ki&iacute;rand&oacute; vizsg&aacute;lati napl&oacute;.</para>

      <para>A vizsg&aacute;lati nyomok tokenekb&#245;l
	&ouml;ssze&aacute;ll&iacute;tott vizsg&aacute;lati rekordok,
	amelyeket a <command>praudit</command> egym&aacute;s ut&aacute;n
	soronk&eacute;nt megjelen&iacute;t.  Minden token adott
	t&iacute;pus&uacute;, p&eacute;ld&aacute;ul a
	<literal>header</literal> egy vizsg&aacute;lati rekord
	fejl&eacute;c&eacute;t tartalmazza, vagy a
	<literal>path</literal>, amely a
	n&eacute;vfelold&aacute;sb&oacute;l sz&aacute;rmaz&oacute;
	el&eacute;r&eacute;si utat tartalmaz.  A k&ouml;vetkez&#245;
	p&eacute;lda egy <literal>execve</literal> esem&eacute;nyt mutat
	be:</para>

      <programlisting>header,133,10,execve(2),0,Mon Sep 25 15:58:03 2006, + 384 msec
exec arg,finger,doug
path,/usr/bin/finger
attribute,555,root,wheel,90,24918,104944
subject,robert,root,wheel,root,wheel,38439,38032,42086,128.232.9.100
return,success,0
trailer,133</programlisting>

      <para>Ez a vizsg&aacute;lat egy sikeres <literal>execve</literal>
	h&iacute;v&aacute;st r&ouml;gz&iacute;t, ahol a <literal>finger
	doug</literal> parancs futott le.  A param&eacute;tereket
	tartalmaz&oacute; token mag&aacute;ban foglalja a shell
	&aacute;ltal a rendszermag fel&eacute; jelzett parancsot
	&eacute;s annak param&eacute;ter&eacute;t egyar&aacute;nt.  A
	<literal>path</literal> token t&aacute;rolja a
	v&eacute;grehajtott &aacute;llom&aacute;ny rendszermag
	&aacute;ltal feloldott el&eacute;r&eacute;si
	&uacute;tj&aacute;t.  A <literal>attribute</literal> token
	err&#245;l a bin&aacute;risr&oacute;l ad tov&aacute;bbi
	inform&aacute;ci&oacute;kat, k&uuml;l&ouml;n&ouml;sen az
	&aacute;llom&aacute;ny m&oacute;dj&aacute;r&oacute;l, amely
	seg&iacute;t meg&aacute;llap&iacute;tani, hogy az adott
	alkalmaz&aacute;sn&aacute;l be volt-e &aacute;ll&iacute;tva a
	setuid bit.  A <literal>subject</literal> token le&iacute;rja az
	&eacute;rintett folyamatot &eacute;s rendre megjegyzi a
	vizsg&aacute;lt felhaszn&aacute;l&oacute;
	azonos&iacute;t&oacute;j&aacute;t, az aktu&aacute;lisan
	&eacute;rv&eacute;nyben lev&#245; felhaszn&aacute;l&oacute;
	&eacute;s csoport azonos&iacute;t&oacute;j&aacute;t, a
	val&oacute;s felhaszn&aacute;l&oacute;i &eacute;s csoport
	azonos&iacute;t&oacute;t, a folyamat
	azonos&iacute;t&oacute;j&aacute;t, a munkamenet
	azonos&iacute;t&oacute;j&aacute;t, a port
	azonos&iacute;t&oacute;j&aacute;t &eacute;s a
	bejelentkez&eacute;shez haszn&aacute;lt h&aacute;l&oacute;zati
	c&iacute;met.  Vegy&uuml;k &eacute;szre, hogy a vizsg&aacute;lt
	felhaszn&aacute;l&oacute; azonos&iacute;t&oacute;ja &eacute;s a
	val&oacute;di azonos&iacute;t&oacute;ja elt&eacute;r
	egym&aacute;st&oacute;l: a <username>robert</username> nev&#251;
	felhaszn&aacute;l&oacute; a <username>root</username>
	accountj&aacute;ra v&aacute;ltott a parancs futatt&aacute;sa
	el&#245;tt, de az eredetileg hiteles&iacute;tett
	felhaszn&aacute;l&oacute;jak&eacute;nt lett vizsg&aacute;lva.
	V&eacute;gezet&uuml;l a <literal>return</literal> token jelzi a
	sikeres v&eacute;grehajt&aacute;st, &eacute;s a
	<literal>trailer</literal> pedig z&aacute;rja a rekordot.</para>

    </sect2>

    <sect2>
      <title>A vizsg&aacute;lati nyomok
	lesz&#251;k&iacute;t&eacute;se</title>

      <para>Mivel a vizsg&aacute;latokhoz tartoz&oacute; napl&oacute;k
	ak&aacute;r eg&eacute;szen nagyok is lehetnek, ez&eacute;rt a
	rendszergazd&aacute;nak minden bizonnyal sz&uuml;ks&eacute;ge
	lehet a sz&aacute;m&aacute;ra fontos, p&eacute;ld&aacute;ul egy
	adott felhaszn&aacute;l&oacute;hoz tartoz&oacute; rekordok
	kiv&aacute;logat&aacute;s&aacute;ra:</para>

      <screen>&prompt.root; <userinput>auditreduce -u trhodes <replaceable>/var/audit/AUDITFILE</replaceable> | praudit</userinput></screen>

      <para>Ezzel ki tudjuk sz&#251;rni a <username>trhodes</username>
	nev&#251; felhaszn&aacute;l&oacute;hoz tartoz&oacute;
	&ouml;sszes vizsg&aacute;lati rekordot az
	<filename><replaceable>AUDITFILE</replaceable></filename>
	&aacute;llom&aacute;nyb&oacute;l.</para>

    </sect2>

    <sect2>
      <title>A napl&oacute;k megtekint&eacute;s&eacute;hez
	sz&uuml;ks&eacute;ges jogok tov&aacute;bbad&aacute;sa</title>

      <para>Az <groupname>audit</groupname> csoport tagjai
	olvashatj&aacute;k a <filename>/var/audit</filename>
	k&ouml;nyvt&aacute;rban tal&aacute;lhat&oacute;
	vizsg&aacute;lati nyomokat.  Alap&eacute;rtelmez&eacute;s
	szerint ez a csoport &uuml;res, ez&eacute;rt csak a
	<username>root</username> k&eacute;pes ekkor vizsg&aacute;lni a
	nyomokat.  A t&ouml;bbi felhaszn&aacute;l&oacute;
	sz&aacute;m&aacute;ra &uacute;gy tudunk olvas&aacute;si jogot
	biztos&iacute;tani, ha felvessz&uuml;k &#245;ket az
	<groupname>audit</groupname> csoportba.  Mivel a
	vizsg&aacute;lati napl&oacute;k tartalm&aacute;nak
	figyel&eacute;se jelent&#245;s r&aacute;l&aacute;t&aacute;st
	adhat a rendszerben jelenlev&#245; felhaszn&aacute;l&oacute;k
	&eacute;s folyamatok viselked&eacute;s&eacute;re,
	aj&aacute;nlott k&ouml;r&uuml;ltekint&#245;en kiosztani az
	olvas&aacute;si jogokat.</para>

    </sect2>

    <sect2>
      <title>&Eacute;l&#245; rendszerfel&uuml;gyelet a vizsg&aacute;lati
	cs&ouml;vekkel</title>

      <para>A vizsg&aacute;lati cs&ouml;vek az eszk&ouml;z&ouml;k
	&aacute;llom&aacute;nyabsztrakci&oacute;it
	kl&oacute;nozz&aacute;k le, &eacute;s ezzel teszik
	lehet&#245;v&eacute; az alkalmaz&aacute;sok
	sz&aacute;m&aacute;ra, hogy menet k&ouml;zben
	megcsapolhass&aacute;k a megfigyelt eszk&ouml;z&ouml;k adatait.
	Ez az els&#245;dleges c&eacute;lja a
	k&uuml;l&ouml;nb&ouml;z&#245; bet&ouml;r&eacute;sfigyel&#245;
	&eacute;s rendszerfel&uuml;gyeleti eszk&ouml;z&ouml;k
	k&eacute;sz&iacute;t&#245;inek.  A rendszergazda
	sz&aacute;m&aacute;ra azonban a vizsg&aacute;lati cs&ouml;vek
	megk&ouml;nny&iacute;tik az &eacute;l&#245; megfigyel&eacute;st,
	mert itt nem mer&uuml;lnek fel a nyomok
	jogosults&aacute;gaib&oacute;l vagy az archiv&aacute;l&aacute;s
	miatt megszakad&oacute; esem&eacute;nyfolyamokb&oacute;l
	ad&oacute;d&oacute; probl&eacute;m&aacute;k.  Az &eacute;l&#245;
	esem&eacute;nyfolyamra az al&aacute;bbi parancs
	kiad&aacute;s&aacute;val lehet r&aacute;csatlakozni:</para>

      <screen>&prompt.root; <userinput>praudit /dev/auditpipe</userinput></screen>

      <para>Alap&eacute;rtelmez&eacute;s szerint a vizsg&aacute;lati
	cs&#245;h&ouml;z tartoz&oacute; csom&oacute;pontok
	kiz&aacute;r&oacute;lag csak a <username>root</username>
	felhaszn&aacute;l&oacute; r&eacute;sz&eacute;re
	&eacute;rhet&#245;ek el.  Az <groupname>audit</groupname>
	csoport tagjai &uacute;gy tudnak majd hozz&aacute;f&eacute;rni,
	ha felvessz&uuml;k a k&ouml;vetkez&#245;
	<literal>devfs</literal> szab&aacute;lyt a
	<filename>devfs.rules</filename>
	&aacute;llom&aacute;nyba:</para>

      <programlisting>add path 'auditpipe*' mode 0440 group audit</programlisting>

      <para>A devfs &aacute;llom&aacute;nyrendszer
	be&aacute;ll&iacute;t&aacute;s&aacute;r&#245;l b&#245;vebben
	l&aacute;sd a &man.devfs.rules.5; oldalt.</para>

      <warning>
	<para>K&ouml;nnyen gerjed&eacute;st lehet el&#245;id&eacute;zni
	  a vizsg&aacute;lt esem&eacute;nyek
	  megfigyel&eacute;s&eacute;vel, amikor is az egyes
	  esem&eacute;nyek megtekint&eacute;se &uacute;jabb
	  vizsg&aacute;land&oacute; esem&eacute;nyek sorozat&aacute;t
	  ind&iacute;tj&aacute;k el.  P&eacute;ld&aacute;ul, ha az
	  &ouml;sszes h&aacute;l&oacute;zati forgalmat egyszerre
	  vizsg&aacute;ljuk &eacute;s a &man.praudit.1; egy
	  SSH-munkameneten kereszt&uuml;l fut, akkor a vizsg&aacute;lati
	  esem&eacute;nyek t&ouml;m&eacute;ntelen &aacute;radata indul
	  meg, mivel minden ki&iacute;rand&oacute; esem&eacute;ny egy
	  &uacute;jabb esem&eacute;nyt induk&aacute;l.  Ennek
	  elker&uuml;l&eacute;se &eacute;rdek&eacute;ben aj&aacute;nlott
	  a <command>praudit</command> parancsot r&eacute;szletes
	  forgalmat nem figyel&#245; vizsg&aacute;lati cs&#245;vel
	  ell&aacute;tott munkameneten kereszt&uuml;l
	  elind&iacute;tani.</para>
      </warning>

    </sect2>

    <sect2>
      <title>A vizsg&aacute;lati nyomok
	archiv&aacute;l&aacute;sa</title>

      <para>A vizsg&aacute;lati nyomokat egyed&uuml;l a rendszermag
	k&eacute;pes &iacute;rni, illetve csak a vizsg&aacute;lati
	d&eacute;mon, az <application>auditd</application> k&eacute;pes
	fel&uuml;gyelni.  A rendszergazd&aacute;knak ebben az esetben
	teh&aacute;t nem szabad haszn&aacute;lniuk a
	&man.newsyslog.conf.5; vagy a hozz&aacute; hasonl&oacute;
	eszk&ouml;z&ouml;k haszn&aacute;lat&aacute;t a vizsg&aacute;lati
	napl&oacute;k archiv&aacute;l&aacute;s&aacute;hoz.
	Helyett&uuml;k a <command>audit</command> seg&eacute;dprogramot
	javasolt haszn&aacute;lni a vizsg&aacute;latok
	le&aacute;ll&iacute;t&aacute;s&aacute;ra, a vizsg&aacute;lati
	rendszer &uacute;jrakonfigur&aacute;l&aacute;s&aacute;ra vagy a
	napl&oacute; archiv&aacute;l&aacute;s&aacute;nak
	elv&eacute;gz&eacute;s&eacute;re.  Az al&aacute;bbi parancs
	utas&iacute;tja a vizsg&aacute;lati d&eacute;mont, hogy hozzon
	l&eacute;tre egy &uacute;j vizsg&aacute;lati napl&oacute;t
	&eacute;s jelzi a rendszermagnak, hogy v&aacute;ltson erre az
	&uacute;j napl&oacute;ra.  Az eddig haszn&aacute;lt
	napl&oacute;t lez&aacute;rja &eacute;s &aacute;tnevezi, ami
	ezut&aacute;n a rendszergazda &aacute;ltal tetsz&#245;legesen
	feldolgozhat&oacute;.</para>

      <screen>&prompt.root; <userinput>audit -n</userinput></screen>

      <warning>
	<para>Ha az <application>auditd</application> d&eacute;mon a
	  parancs kiad&aacute;s&aacute;n&aacute;k pillanat&aacute;ban
	  nem futna, akkor hiba t&ouml;rt&eacute;nik &eacute;s
	  err&#245;l hiba&uuml;zenetet kapunk.</para>
      </warning>

      <para>A &man.cron.8; seg&iacute;ts&eacute;g&eacute;vel
	tizenk&eacute;nt &oacute;r&aacute;nk&eacute;nt
	kik&eacute;nyszer&iacute;thetj&uuml;k a napl&oacute;k
	v&aacute;lt&aacute;s&aacute;t, ha felvessz&uuml;k a
	<filename>/etc/crontab</filename> &aacute;llom&aacute;nyba az
	al&aacute;bbi sort:</para>

      <programlisting>0     */12       *       *       *       root    /usr/sbin/audit -n</programlisting>

      <para>Ez a v&aacute;ltoztat&aacute;s akkor fog
	&eacute;rv&eacute;nybe l&eacute;pni, ha elmentj&uuml;k az
	&uacute;j <filename>/etc/crontab</filename>
	&aacute;llom&aacute;nyt.</para>

      <para>A vizsg&aacute;lati nyomok m&eacute;rete szerinti
	automatikus v&aacute;lt&aacute;s is
	megval&oacute;s&iacute;that&oacute; az &man.audit.control.5;
	&aacute;llom&aacute;nyban szerepl&#245; <option>filesz</option>
	opci&oacute; be&aacute;ll&iacute;t&aacute;s&aacute;val, amit meg
	is tal&aacute;lhatunk ebben a fejezetben, a
	konfigur&aacute;ci&oacute;s &aacute;llom&aacute;nyok
	be&aacute;ll&iacute;t&aacute;s&aacute;n&aacute;l.</para>

    </sect2>

    <sect2>
      <title>A vizsg&aacute;lati nyomok
	t&ouml;m&ouml;r&iacute;t&eacute;se</title>

      <para>Mivel a vizsg&aacute;lati nyomok &oacute;ri&aacute;sira is
	megn&#245;hetnek, sokszor felmer&uuml;l az ig&eacute;ny, hogy
	lehessen &#245;ket t&ouml;m&ouml;r&iacute;teni vagy m&aacute;s
	egy&eacute;b m&oacute;don archiv&aacute;lni a vizsg&aacute;lati
	d&eacute;mon &aacute;ltal lez&aacute;rt nyomokat.  Az
	<filename>audit_warn</filename> szkript
	haszn&aacute;lhat&oacute; a k&uuml;l&ouml;nb&ouml;z&#245;
	vizsg&aacute;latokhoz kapcsol&oacute;d&oacute; esem&eacute;nyek
	eset&eacute;n elv&eacute;gzend&#245; m&#251;veletek
	megad&aacute;s&aacute;hoz, bele&eacute;rtve ebbe a
	vizsg&aacute;lati nyomok v&aacute;lt&aacute;sakor
	elv&eacute;gzett szab&aacute;lyos
	lez&aacute;r&aacute;s&aacute;t.  P&eacute;ld&aacute;ul a
	k&ouml;vetkez&#245;ket kell bele&iacute;rnunk az
	<filename>audit_warn</filename> szkriptbe a nyomok
	lez&aacute;r&aacute;s&aacute;t k&ouml;vet&#245;
	t&ouml;m&ouml;r&iacute;t&eacute;s&eacute;hez:</para>

      <programlisting>#
# Lez&aacute;r&aacute;skor t&ouml;m&ouml;r&iacute;ti a vizsg&aacute;lati nyomot.
#
if [ "$1" = closefile ]; then
        gzip -9 $2
fi</programlisting>

      <para>Egy&eacute;b archiv&aacute;l&aacute;si
	tev&eacute;kenys&eacute;gek lehetnek m&eacute;g: a nyomok
	felm&aacute;sol&aacute;sa egy k&ouml;zponti szerverre, a
	r&eacute;gebbi nyomok t&ouml;rl&eacute;se, vagy a meglev&#245;
	nyomok lesz&#251;k&iacute;t&eacute;se csak a fontos
	inform&aacute;ci&oacute;kra.  A szkript csak akkor fog lefutni,
	ha a vizsg&aacute;lati nyomot siker&uuml;lt szab&aacute;lyosan
	lez&aacute;rni, &iacute;gy teh&aacute;t a szab&aacute;lytalan
	le&aacute;ll&aacute;skor megmarad&oacute; nyomok eset&eacute;n
	nem.</para>

      <para>A &os;&nbsp;6.3 &eacute;s k&eacute;s&#245;bbi
	verzi&oacute;iban, a <command>praudit</command> XML kimeneti
	form&aacute;tumot is t&aacute;mogat, amely az
	<option>-x</option> kapcsol&oacute;val &eacute;rhet&#245;
	el.</para>

    </sect2>
  </sect1>
</chapter>

