<!--
     The FreeBSD Documentation Project

     $FreeBSD$
     Original revision: 1.259
-->

<chapter id="ports">
  <title>軟體套件管理篇：Packages 及 Ports 機制</title>

  <sect1 id="ports-synopsis">
    <title>概述</title>

    <indexterm><primary>ports</primary></indexterm>
    <indexterm><primary>packages</primary></indexterm>
    <para>儘管 FreeBSD 在 base system 已加了很多系統工具。
	然而，在實務運用上，您可能仍需要安裝額外的軟體。
	FreeBSD 提供了 2 種安裝應用程式的套件管理系統︰Ports Collection(以 soucre 來編譯、安裝) 和 
	package(預先編譯好的 binary 檔)。上述的方式，無論要用哪一種，都可以由像是 CDROM 
	等或網路上來安裝想裝的最新版軟體。</para>

    <para>讀完這章，您將了解：</para>

    <itemizedlist>
      <listitem>
	<para>如何以 packages 來安裝軟體。</para>
      </listitem>
      <listitem>
	<para>如何以 ports 來安裝軟體。</para>
      </listitem>
      <listitem>
	<para>已安裝的 packages 或 ports 要如何移除。</para>
      </listitem>
      <listitem>
	<para>如何更改(override) ports collection 所使用的預設值。</para>
      </listitem>
      <listitem>
	<para>如何在套件管理系統中，找出想裝的軟體。</para>
      </listitem>
      <listitem>
	<para>如何升級已安裝的軟體。</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="ports-overview">
    <title>安裝軟體的各種方式介紹</title>

    <para>通常要在 &unix; 系統上安裝軟體時，有幾個步驟要作：</para>

    <procedure>
      <step>
	<para>先下載該軟體壓縮檔(tarball)，有可能是原始碼或是 binary 執行檔。</para>
      </step>

      <step>
	<para>解開該壓縮檔。(通常是以 &man.compress.1; , &man.gzip.1; 或 &man.bzip2.1; 壓縮的)</para>
      </step>

      <step>
	<para>閱讀相關文件檔，以了解如何安裝。(通常檔名是 <filename>INSTALL</filename> 或
	 <filename>README</filename>， 或在 <filename>doc/</filename> 目錄下的一些文件)</para>
      </step>

      <step>
	<para>如果所下載的是原始碼，可能要先修改 <filename>Makefile</filename> 或是執行
	 <command>./configure</command> 之類的 script ，接著再編譯該軟體。</para>
      </step>

      <step>
	<para>最後測試再測試與安裝。</para>
      </step>
    </procedure>

    <para>如果一切順利的話，就這麼簡單。如果在安裝非專門設計(移植)給 FreeBSD 的軟體時出問題，
	那可能需要修改一下它的程式碼，才能正常使用。</para>

    <para>當然，我們可以在 FreeBSD 上使用上述的傳統方式來安裝軟體，但是，我們還有更簡單的選擇。
	FreeBSD 提供了兩種省事的軟體管理機制： packages 和 ports。就在寫這篇文章的時候，
	已經有超過 &os.numports; 個 port 軟體可以使用。</para>

    <para>所謂的 FreeBSD package 就是別人把該應用程式編譯、打包完畢。
      該 package 會包括該應用程式的所有執行檔、設定檔、文件等。
      而下載到硬碟上的 package 都可透過 FreeBSD 套件管理指令來進行管理，比如：
      &man.pkg.add.1;、&man.pkg.delete.1;、&man.pkg.info.1;等指令。
      所以，只需簡單打個指令就可輕鬆安裝新的應用程式了。</para>

    <para>而 FreeBSD port 則是用一些檔案，來自動處理應用程式的安裝流程。</para>

    <para>請記住：如果打算自己來編譯的話，需要執行很多操作步驟(下載、解壓、patch、編譯、安裝)。
      而 port 呢，則是涵蓋所有需要完成這些工作的必備步驟，
      所以只需打一些簡單的指令，那些原始程式碼就會自動下載、解壓、patch、編譯，直至安裝完畢。</para>

    <para>事實上，ports 機制還可以用來產生 packages，以便他人可以用 
      <command>pkg_add</command> 來安裝，或是稍後會介紹到的其他套件管理指令。</para>

    <para>而 packages 以及 ports 它們都是一樣會認 <emphasis>dependencies(軟體相依關係)</emphasis>。
      假設：您想安裝某程式，但它有相依另一個已裝的函式庫(library)，
      而在 FreeBSD 的 port 以及 package 都有這程式以及該函式庫了。
      所以無論是用 <command>pkg_add</command> 指令或者 port 方式來裝該程式，
      這兩者(package、port)都會先檢查有沒有裝該函式庫，若沒有就會自動先裝該函式庫了。</para>

    <para>這兩種技術都很相似，您可能會好奇為什麼 FreeBSD 會弄出這兩種技術來呢。
      其實，packages 和 ports 都有它們各自的長處，使用哪一種完全取決於您自己的喜好。</para>

    <itemizedlist>
      <title>Package 好處在於：</title>
      
      <listitem>
	<para>A compressed package tarball is typically smaller than
	  the compressed tarball containing the source code for the
	  application.</para>
      </listitem>

      <listitem>
	<para>Packages do not require any additional compilation.  For
	  large applications, such as
	  <application>Mozilla</application>,
	  <application>KDE</application>, or
	  <application>GNOME</application> this can be important,
	  particularly if you are on a slow system.</para>
      </listitem>

      <listitem>
	<para>Packages do not require any understanding of the process
	  involved in compiling software on FreeBSD.</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <title>Ports 好處在於：</title>
      
      <listitem>
	<para>Packages are normally compiled with conservative options,
	  because they have to run on the maximum number of systems.  By
	  installing from the port, you can tweak the compilation options to
	  (for example) generate code that is specific to a Pentium
	  IV or Athlon processor.</para>
      </listitem>

      <listitem>
	<para>Some applications have compile time options relating to
	  what they can and cannot do.  For example,
	  <application>Apache</application> can be configured with a
	  wide variety of different built-in options.  By building
	  from the port you do not have to accept the default options,
	  and can set them yourself.</para>

	<para>In some cases, multiple packages will exist for the same
	  application to specify certain settings.  For example,
	  <application>Ghostscript</application> is available as a
	  <filename>ghostscript</filename> package and a
	  <filename>ghostscript-nox11</filename> package, depending on
	  whether or not you have installed an X11 server.  This sort
	  of rough tweaking is possible with packages, but rapidly
	  becomes impossible if an application has more than one or
	  two different compile time options.</para>
      </listitem>

      <listitem>
	<para>The licensing conditions of some software distributions forbid
	  binary distribution.  They must be distributed as source
	  code.</para>
      </listitem>

      <listitem>
	<para>Some people do not trust binary distributions.  At least
	  with source code, you can (in theory) read through it and
	  look for potential problems yourself.</para>
      </listitem>

      <listitem>
	<para>If you have local patches, you will need the source in order to
	  apply them.</para>
      </listitem>

      <listitem>
	<para>Some people like having code around, so they can read it
	  if they get bored, hack it, borrow from it (license
	  permitting, of course), and so on.</para>
      </listitem>
    </itemizedlist>

    <para>To keep track of updated ports, subscribe to the
      &a.ports; and the &a.ports-bugs;.</para>

    <warning>
      <para>在安裝軟體前，最好先看 <ulink
	url="http://vuxml.freebsd.org/"></ulink> 內是否有該軟體的安全漏洞通報。
      </para>

      <para>此外，也可以裝 <filename
	role="package">security/portaudit</filename>，它會自動檢查所有已裝的
	的軟體是否有已知的安全漏洞，另外，它還會在裝軟體的編譯過程前先行檢查。
	也可以在裝了某些軟體之後，用 <command>portaudit -F -a</command> 
	來作全面強制安檢。</para>
    </warning>

    <para>The remainder of this chapter will explain how to use
      packages and ports to install and manage third party software on
      FreeBSD.</para>
  </sect1>

  <sect1 id="ports-finding-applications">
    <title>尋找想裝的軟體</title>

    <para>在安裝任何軟體之前，你必須先了解你想要什麼的軟體，以及該軟體叫做什麼名稱。</para>

    <para>FreeBSD 上可裝的軟體清單不斷在增加中，
      不過，我們很慶幸有幾種方式可以來找你想裝的軟體：</para>

    <itemizedlist>
      <listitem>
	<para>FreeBSD 網站上有更新頻繁的軟體清單，在
	  <ulink
	  url="&url.base;/ports/index.html">http://www.FreeBSD.org/ports/</ulink>。
	  各 ports 皆依其性質而分門別類，既可以透過軟體名稱來搜尋(如果知道名字的話)，
	  也可以在分類中列出所有可用的軟體。</para>
      </listitem>

      <indexterm><primary>FreshPorts</primary></indexterm>

      <listitem>
	<para>由 Dan Langille 所維護 FreshPorts 網站，網址在 <ulink
	  url="http://www.FreshPorts.org/"></ulink>。  
	  FreshPorts 會不斷追蹤 port tree 中的各種變化，
	  也可以針對某些 port 以列入 <quote>追蹤名單(watch)</quote> 內，
	  當有任何軟體升級時，就會發 email 提醒。</para>
      </listitem>

      <indexterm><primary>FreshMeat</primary></indexterm>

      <listitem>
	<para>如果不知道想裝的軟體名稱，那麼可透過像是 FreshMeat (<ulink
	  url="http://www.freshmeat.net/"></ulink>) 這類的網站來找，
	  如果找到了，可以回 FreeBSD 網站去看一下這個應用程式是否已經被 port 進去了。</para>
      </listitem>

      <listitem>
	<para>若知道該 port 的正確名稱，但不知道放在哪個分類目錄，
        可以用 &man.whereis.1; 指令來找出來。
	只要打 <command>whereis
        <replaceable>file</replaceable></command> 即可，而 
        <replaceable>file</replaceable> 的地方請改為想裝的軟體名稱。
        若找到該軟體，就會告訴你，就像下面這樣：</para>

      <screen>&prompt.root; <userinput>whereis lsof</userinput>
lsof: /usr/ports/sysutils/lsof</screen>

      <para>如此一來，就會知道 <command>lsof</command> (系統工具程式) 是放在 
	<filename>/usr/ports/sysutils/lsof</filename> 目錄。</para></listitem>

      <listitem>
	<para>還有另一招，就是用 Ports Collection 本身內建的搜尋機制。
        要用的時候，請先切換到 <filename>/usr/ports</filename> 目錄。
        然後，打 <command>make search 
	name=<replaceable>program-name</replaceable></command>，其中
        <replaceable>program-name</replaceable> 請改為想找的軟體名稱。
        舉例來說，若要找的是 <command>lsof</command> 的話，那麼就是：</para>

      <screen>&prompt.root; <userinput>cd /usr/ports</userinput>
&prompt.root; <userinput>make search name=lsof</userinput>
Port:   lsof-4.56.4
Path:   /usr/ports/sysutils/lsof
Info:   Lists information about open files (similar to fstat(1))
Maint:  obrien@FreeBSD.org
Index:  sysutils
B-deps: 
R-deps: </screen>

      <para>這些搜尋結果中，要注意的是 <quote>Path:</quote> 這行，
        因為這行會告訴你可以在哪邊找到該 port。
	而搜尋結果的其他部分，因為與 port 安裝較無關係，所以這裡就不講了。</para>

      <para>若要更徹底的搜尋，那麼可以改用 <command>make
        search key=<replaceable>string</replaceable></command>，其中 
        <replaceable>string</replaceable> 請改為想搜尋的關鍵字。
        如此一來會找 port 名稱、軟體簡介(comments)、軟體敘述檔(descriptions)
        以及軟體相依關係(dependencies)裡面是否有符合關鍵字，
        此外，不清楚軟體名稱的話，也可以拿來找有符合關鍵字主題的 port。</para>

      <para>剛講的這兩種方式，搜尋字眼都是 case-insensitive(不必區分大小寫)。
        比如，搜尋 <quote>LSOF</quote> 與 <quote>lsof</quote> 兩者結果都會是一樣的。</para>
      </listitem>

    </itemizedlist>
  </sect1>

  <sect1 id="packages-using">
    <sect1info>    
      <authorgroup>
        <author>
          <firstname>Chern</firstname>
	  <surname>Lee</surname>
	  <contrib>Contributed by </contrib>
        </author>
      </authorgroup>
    <!-- 30 Mar 2001 -->
    </sect1info>

    <title>使用 Packages 管理機制</title>

    <sect2>
      <title>Package 的安裝方式</title>
      <indexterm>
        <primary>packages</primary>
        <secondary>installing</secondary>
      </indexterm>
    
      <indexterm>
        <primary><command>pkg_add</command></primary>
      </indexterm>
      <para>可以用 &man.pkg.add.1; 從本機上或者透過網路來安裝任一 FreeBSD package。</para>

      <example>
        <title>手動下載、安裝 Package (譯者chinsan: 這方法比較不便，建議改用 pkg_add -r )</title>

        <screen>&prompt.root; <userinput>ftp -a <replaceable>ftp2.FreeBSD.org</replaceable></userinput>
Connected to ftp2.FreeBSD.org.
220 ftp2.FreeBSD.org FTP server (Version 6.00LS) ready.
331 Guest login ok, send your email address as password.
230-
230-     This machine is in Vienna, VA, USA, hosted by Verio.
230-         Questions? E-mail freebsd@vienna.verio.net.
230-
230-
230 Guest login ok, access restrictions apply.
Remote system type is UNIX.
Using binary mode to transfer files.
<prompt>ftp></prompt> <userinput>cd /pub/FreeBSD/ports/packages/sysutils/</userinput>
250 CWD command successful.
<prompt>ftp></prompt> <userinput>get lsof-4.56.4.tgz</userinput>
local: lsof-4.56.4.tgz remote: lsof-4.56.4.tgz
200 PORT command successful.
150 Opening BINARY mode data connection for 'lsof-4.56.4.tgz' (92375 bytes).
100% |**************************************************| 92375       00:00 ETA
226 Transfer complete.
92375 bytes received in 5.60 seconds (16.11 KB/s)
<prompt>ftp></prompt> <userinput>exit</userinput>
&prompt.root; <userinput>pkg_add <replaceable>lsof-4.56.4.tgz</replaceable></userinput></screen>
      </example>

      <para>若手邊沒有 package 來源(像是 FreeBSD 光碟)的話，
        那麼建議使用 &man.pkg.add.1; 時，加上 <option>-r</option> 
	選項來更輕鬆安裝 package。如此一來，就會自動判斷正確的 package 格式、
	以及所搭配的作業系統 release 版本，
	然後會自己從 FTP 站抓回、安裝相對應的 package。
      </para>

      <indexterm>
        <primary><command>pkg_add</command></primary></indexterm>
      <screen>&prompt.root; <userinput>pkg_add -r <replaceable>lsof</replaceable></userinput></screen>

      <para>上面這例子會自動下載正確的 package 並安裝。
	若想改換用其他 &os; Packages Mirror 站，那麼就要設定 <envar>PACKAGESITE</envar> 環境變數，
	如此一來才會取代預設設定。  &man.pkg.add.1;
	會用 &man.fetch.3; 指令來下載檔案，而 &man.fetch.3; 本身則會使用相關環境變數的設定，
	像是：
	<envar>FTP_PASSIVE_MODE</envar>、<envar>FTP_PROXY</envar> 以及 
	<envar>FTP_PASSWORD</envar>。  如果你網路環境處於 firewall 後面，或者需要用
	FTP/HTTP proxy 的話，那麼就需要設定。 設定細節請參閱 &man.fetch.3;。
	請注意：上面所說的例子是寫 <literal>lsof</literal> 而非 
	<literal>lsof-4.56.4</literal>。  當使用遠端抓取功能時，該 package 版號就不必加上去了。
	&man.pkg.add.1; 會自動下載該軟體的最新版回來安裝。</para>

      <note>
	<para>若用的是 &os.current; 或 &os.stable; 的話，&man.pkg.add.1; 
	  會自動下載該軟體最新版回來。
	  若用的是屬於 -RELEASE 版本，那麼他會抓回屬於該 release 上所編譯的 package。
	  也可以更改 <envar>PACKAGESITE</envar> 環境變數，以改變下載方式。
	  舉例來說，如果是 &os;&nbsp;5.4-RELEASE 的話，那麼 &man.pkg.add.1; 預設會從
	  <literal>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-5.4-release/Latest/</literal>
	  來抓 package。若要強制 &man.pkg.add.1; 下載 &os;&nbsp;5-STABLE 所用的 package
	  ，那麼就把 <envar>PACKAGESITE</envar> 改設為 
	  <literal>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-5-stable/Latest/</literal>即可。
	</para>
      </note>

      <para>Package 檔有 <filename>.tgz</filename> 以及 <filename>.tbz</filename> 兩種格式。
          這些都可透過 <ulink
          url="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/"></ulink>，或者 FreeBSd 光碟內取得。
          Every CD on the
          FreeBSD 4 光碟套件內以及 PowerPak(威力包) 等等..每一片光碟都會在 <filename>/packages</filename>
	  目錄內放 package。裡面的目錄架構類似 <filename>/usr/ports</filename> 的目錄架構。
          每個分類都各自有專屬目錄，且每份 package 都會放在 <filename>All</filename> 目錄內。
      </para>

      <para>package 目錄架構與 port 的都一致；它們共同構成整個 package/port 系統機制。</para>

    </sect2>

    <sect2>
      <title>管理 Packages</title>

      <indexterm>
        <primary>packages</primary>
        <secondary>managing</secondary>
      </indexterm>
      <para>&man.pkg.info.1; 可用來列出所有已安裝的軟體、軟體簡介。</para>

      <indexterm>
        <primary><command>pkg_info</command></primary>
      </indexterm>
      <screen>&prompt.root; <userinput>pkg_info</userinput>
cvsup-16.1          A general network file distribution system optimized for CV
docbook-1.2         Meta-port for the different versions of the DocBook DTD
...</screen>
      <para>&man.pkg.version.1; 則是列出所有已安裝的軟體版本。
        它會顯示已裝版本以及目前機器上 port tree 的版本差異。
      </para> 
      <indexterm>
        <primary><command>pkg_version</command></primary>
      </indexterm>
        <screen>&prompt.root; <userinput>pkg_version</userinput>
cvsup                       =
docbook                     =
...</screen>

      <para>第二欄的符號表示：已安裝的軟體版本與目前機器上 port tree 的版本差異。</para>

      <informaltable frame="none" pgwide="1">
        <tgroup cols="2">
	  <thead>
            <row>
              <entry>符號</entry>
              <entry>代表意義</entry>
            </row>
          </thead>

 	  <tbody>
  	    <row>
	    <entry>=</entry> <entry>已裝的版本與目前機器上 port tree 的版本是同一版的。
	    </entry>
  	    </row>
 
        <row><entry>&lt;</entry>
	<entry>與目前機器上 port tree 版本相比起來，已裝的版本較舊。</entry>
	</row>

        <row><entry>&gt;</entry><entry>與目前機器上 port tree 版本相比起來，
	  已裝的版本較新。(可能是目前機器上 port tree 尚未更新。)</entry></row>

        <row><entry>?</entry><entry>已裝的軟體在 ports 索引內找無相關資料。
	  (通常可能是，舉例來說：已安裝的該 port 已從 Ports Collection 中移除或改名了。)
	  </entry></row>

        <row><entry>*</entry><entry>該軟體同時有許多版本。</entry></row>

	</tbody>
	</tgroup>
    </informaltable>
    </sect2>

    <sect2>
      <title>移除已安裝的 Package</title>
      <indexterm>
        <primary><command>pkg_delete</command></primary>
      </indexterm>
      <indexterm>
        <primary>packages</primary>
        <secondary>deleting</secondary>
      </indexterm>
      <para>若要移除已裝的軟體，那麼請多利用 &man.pkg.delete.1; 工具，比如：
      </para>

      <screen>&prompt.root; <userinput>pkg_delete <replaceable>xchat-1.7.1</replaceable></userinput></screen>
    </sect2>

    <sect2>
      <title>其他細節部份</title>
      <para>所有已裝的 package 資訊都會存到 <filename>/var/db/pkg</filename> 目錄內，
        在該目錄下可以找到記載已裝的軟體檔案清單及該軟體簡介的檔案。
      </para>
    </sect2>
  </sect1>
  
  <sect1 id="ports-using">
    <title>使用 Ports 管理機制</title>

    <para>下面我們會介紹如何使用 Ports Collection 來安裝、移除軟體的基本用法。
      至於其他可用的 <command>make</command> 詳細用法與環境設定，可參閱 &man.ports.7;。</para>

    <sect2 id="ports-tree">
      <title>記得安裝 Ports Collection</title>

      <para>在安裝任一 ports  之前，必須先裝上
	Ports Collection —— 它主要是由 <filename>/usr/ports</filename> 內一堆
	<filename>Makefiles</filename>, patches 以及一些軟體簡介檔所組成的。
      </para>

      <para>在裝 FreeBSD 時，若忘了在 <application>sysinstall</application> 內勾選要裝 Ports Collection 的話，
        沒關係，可以照下列方式來安裝 ports collection：</para>

      <procedure>
	<title>CVSup 方式</title>

	<para>使用 <application>CVSup</application> 是安裝、更新 Ports Collection 的快速方法之一。
	  若想更瞭解 <application>CVSup</application> 用法的話，請參閱 <link linkend="cvsup">使用 CVSup</link>。</para>

	<para>第一次跑 <application>CVSup</application> 之前，請先確認 <filename role="directory">/usr/ports</filename>
	  是空的！ 若你已經裝了 Ports Collection ，但又自行加上其他 patch 檔，那麼 <application>CVSup</application>
	  並不會刪除你自行加上的 patch 檔，這樣可能會導致要安裝某些軟體時，發生 patch 失敗或編譯失敗。</para>

	<step>
	  <para>安裝 <filename role="package">net/cvsup-without-gui</filename> package：</para>

	  <screen>&prompt.root; <userinput>pkg_add -r cvsup-without-gui</userinput></screen>

	  <para>細節用法請參閱 <link linkend="cvsup-install">安裝 CVSup</link>(<xref
	      linkend="cvsup-install">)。</para>
	</step>

	<step>
	  <para>執行 <command>cvsup</command>：</para>

	  <screen>&prompt.root; <userinput>cvsup -L 2 -h <replaceable>cvsup.tw.FreeBSD.org</replaceable> /usr/share/examples/cvsup/ports-supfile</userinput></screen>

	  <para>請把
	    <replaceable>cvsup.tw.FreeBSD.org</replaceable> 請改成離你比較近(快)的 
	    <application>CVSup</application> 主機。
	    這部分可以參閱完整的 <link linkend="cvsup-mirrors">CVSup mirror</link> 站列表(<xref
	    linkend="cvsup-mirrors">)。</para>

	  <note>
	    <para>若想改用自己設的 
	      <filename>ports-supfile</filename>，比如說，不想每次都得打指令來指定所使用的 
	      <application>CVSup</application> 主機。</para>

	    <procedure>
	      <step>
		<para>這種情況下，請以 <username>root</username> 權限把 
		  <filename>/usr/share/examples/cvsup/ports-supfile</filename>
		  複製到其他位置，比如  
		  <filename>/root</filename> 或者自己帳號的家目錄。</para>
	      </step>

	      <step>
		<para>修改新的 <filename>ports-supfile</filename> 檔。</para>
	      </step>

	      <step>
		<para>把 
		  <replaceable>CHANGE_THIS.FreeBSD.org</replaceable>
		  改為離你比較近(快)的 <application>CVSup</application> 主機。
		  這部分可以參閱完整的 <link linkend="cvsup-mirrors">CVSup
		  Mirrors</link> (<xref linkend="cvsup-mirrors">) 站列表</para>
	      </step>

	      <step>
		<para>然後就開始以類似下列指令跑 <command>cvsup</command>：</para>

		<screen>&prompt.root; <userinput>cvsup -L 2 <replaceable>/root/ports-supfile</replaceable></userinput></screen>
	      </step>
	    </procedure>
	  </note>
	</step>

	<step>
	  <para>執行 &man.cvsup.1; 之後，就會開始更新 Ports Collection。
	    不過這動作只是『更新』並不是『升級』，不會把已裝的軟體重新編譯、升級。</para>
	</step>
      </procedure>

      <procedure>
	<title>Portsnap 方式</title>

	<para>&man.portsnap.8; 也是更新 Ports Collection 的方式之一。
	  &os;&nbsp;6.0 起開始內建 Portsnap 機制，而較舊的系統，則可透過 <filename
	  role="package">sysutils/portsnap</filename> port 來安裝：</para>

	<screen>&prompt.root; <userinput>pkg_add -r portsnap</userinput></screen>

	<para><application>Portsnap</application> 細節功能，請參閱 
	  <link linkend="portsnap">Portsnap 使用篇</link>。</para>

	<step>
	  <para>若 <filename
	    role="directory">/usr/ports</filename> 目錄不存在的話，就建立一下吧：</para>

	  <screen>&prompt.root; <userinput>mkdir /usr/ports</userinput></screen>
	</step>

	<step>
	  <para>接下來，下載壓縮的 Ports Collection 定期更新檔到 
	    <filename role="directory">/var/db/portsnap</filename> 目錄。
	    完成下載後，要斷線與否都可以。</para>

	  <screen>&prompt.root; <userinput>portsnap fetch</userinput></screen>
	</step>

	<step>
	  <para>若是第一次跑 <application>Portsnap</application> 的話，則需要先解壓到 <filename
	    role="directory">/usr/ports</filename>：
	  </para>

	  <screen>&prompt.root; <userinput>portsnap extract</userinput></screen>

	  <para>若已有 <filename
	    role="directory">/usr/ports</filename> 而且只是想更新而已，那麼就照下面作：</para>

	  <screen>&prompt.root; <userinput>portsnap update</userinput></screen>
	</step>

      </procedure>

      <procedure>
	<title>Sysinstall 方式</title>

	<para>這方式要用 <application>sysinstall</application> 透過安裝來源來裝 Ports Collection。
	  請注意：所安裝的 Ports Collection 版本只是該 release 發佈時的版本而已，而非最新。
	  若能上網(Internet)的話，請使用上述方式之一會比較好。</para>

	<step>
	  <para>以 <username>root</username> 權限執行
	    <command>sysinstall</command> 
	    (在 &os; 5.2 之前版本則是 <command>/stand/sysinstall</command>)，方式如下：</para>

	  <screen>&prompt.root; <userinput>sysinstall</userinput></screen>
	</step>

	<step>
	  <para>請以方向鍵移動選擇項目，選擇 <guimenuitem>Configure</guimenuitem>，然後按 
	    <keycap>Enter</keycap> 鍵。</para>
	</step>

	<step>
	  <para>選擇
	    <guimenuitem>Distributions</guimenuitem>，然後按 
	    <keycap>Enter</keycap> 鍵。</para>
	</step>

	<step>
	  <para>選擇 <guimenuitem>ports</guimenuitem>，然後按 
	    <keycap>Space</keycap> 鍵。</para>
	</step>

	<step>
	  <para>選 <guimenuitem>Exit</guimenuitem>，然後按 
	    <keycap>Enter</keycap> 鍵。</para>
	</step>

	<step>
	  <para>選擇要用的安裝來源，比如：CDROM(光碟)、FTP 等方式。</para>
	</step>

	<step>
	  <para>選 <guimenuitem>Exit</guimenuitem>，然後按
	    <keycap>Enter</keycap> 鍵。</para>
	</step>

	<step>
	  <para>按下 <keycap>X</keycap> 鍵就可離開
	    <application>sysinstall</application> 程式。</para>
	</step>
      </procedure>
    </sect2>

    <sect2 id="ports-skeleton">
      <title>Ports 的安裝方式</title>

      <indexterm>
        <primary>ports</primary>
        <secondary>installing</secondary>
      </indexterm>
      <para>提到 Ports Collection，首先要先說明的是：何謂 <quote>skeleton</quote>。
        簡單來講，port skeleton 就是讓軟體如何在 FreeBSD 順利編譯、安裝的最基本檔案組合。
        每份 port skeleton 基本上會有：</para>

      <itemizedlist>
	<listitem>
	  <para><filename>Makefile</filename> 檔。
	    這個 <filename>Makefile</filename> 內容有分許多部分，
	    是用來指定要如何編譯，以及該裝在系統的何處。</para>
	</listitem>

	<listitem>
	  <para><filename>distinfo</filename> 檔。  
	    編譯該軟體所需下載的檔案、checksum(檢驗檔案用)都會記錄在這檔，
	    並會用 &man.md5.1; 相關工具來確保所下載的檔案是正確無誤的。</para>
	</listitem>
	
	<listitem>
	  <para><filename>files</filename> 目錄。 這目錄放的是讓軟體正常編譯、安裝的 patch 檔。
	    Patches 檔基本上是一些小檔案，並針對特定檔案來做修改，且是純文字檔格式，
	    基本上內容通常會像是 <quote>Remove line 10(刪除第 10 行)</quote> 或
	    <quote>Change line 26 to this ...(把第 26 行改為...)</quote> 之類的。
	    這些 Patches 通常也稱為 <quote>diffs</quote>
	    ，因為都是由 &man.diff.1; 程式所產生的。</para>

	  <para>此外，本目錄也可能會放一些協助編譯該 port 的檔案。</para>
	</listitem>

	<listitem>
	  <para><filename>pkg-descr</filename> 檔，內容是比較詳細的軟體介紹，通常會寫得比較多行。</para>
	</listitem>
	
	<listitem>
	  <para><filename>pkg-plist</filename> 檔，該 port 會安裝的所有檔案清單。
	    也是告訴系統在移除該 port 時，需要刪除哪些檔案。</para>
	</listitem>
      </itemizedlist>

      <para>有些 port 還會有其他檔案，像是 <filename>pkg-message</filename> 檔。
        port 系統在一些情況時，會用這些檔案。
        如果想知道這些檔案的更多細節用途，以及 port 一般用法，請參閱 <ulink
        url="&url.books.porters-handbook;/index.html">FreeBSD Porter's
        Handbook</ulink>。</para>

      <para>port 內寫的是告訴系統如何編譯 source code 的相關指令，但並不是真正的 source code。
        而 source code 可以從光碟或網路(Internet)來取得，
        該軟體開發者可能會把 source code 以各種格式來發佈。
        通常是以 tar 以及 gzip 這兩者工具一起壓縮的檔案，也有可能是以其他工具壓縮，或根本沒壓縮。
	而軟體的 source code 無論是以哪一種壓縮檔型態，我們都稱之為 <quote>distfile</quote>。
        下面將介紹兩種安裝 &os; port 的方式。</para>

      <note>
        <para>要安裝 port 的話，請務必切為 <username>root</username> 身份。</para>
      </note>

      <warning>
	<para>在安裝任何 port 之前，請務必確認有更新 Ports Collection 到最新版，
	  此外請檢閱 <ulink
	  url="http://vuxml.freebsd.org/"></ulink> 來檢查所要裝的 port 
	  是否有相關安全漏洞議題需要注意的。</para>

	<para><application>portaudit</application> 會在安裝任何 port 之前，
	  先自動檢查是否有相關已知的安全漏洞。這個工具在 Ports Collection 內有
	  (<filename role="package">security/portaudit</filename>)。
	  在安裝 port 之前，可以先跑 <command>portaudit -F</command> 指令，
	  如此一來就會抓最新的資安漏洞資料庫回來核對。
	  每天的系統定期安檢會自動更新資料庫，並作安全稽核。
	  詳情請參閱 &man.portaudit.1; 以及 &man.periodic.8; 的線上說明。</para>
      </warning>

      <para>Ports Collection 會假設你的網路是可正常連線的。
        如果沒有的話，那麼需手動把所需的 distfile 檔複製到 
	<filename>/usr/ports/distfiles</filename> 才行。</para>

	<para>開始操作之前，要先進入打算安裝的 port 目錄內：</para>

        <screen>&prompt.root; <userinput>cd /usr/ports/sysutils/lsof</userinput></screen>

        <para>一旦進入 <filename>lsof</filename> 目錄後，就可以看到這個 port 的 skeleton 結構。
	  接下來，就是編譯，也就是 <quote>build</quote> 這個 port。
	  只需簡單輸入 <command>make</command> 指令，就可輕鬆完成編譯。
	  完成後，應該可以看到類似下面訊息：</para>

        <screen>&prompt.root; <userinput>make</userinput>
&gt;&gt; lsof_4.57D.freebsd.tar.gz doesn't seem to exist in /usr/ports/distfiles/.
&gt;&gt; Attempting to fetch from ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/.
===&gt;  Extracting for lsof-4.57
...
[extraction output snipped]
...
&gt;&gt; Checksum OK for lsof_4.57D.freebsd.tar.gz.
===&gt;  Patching for lsof-4.57
===&gt;  Applying FreeBSD patches for lsof-4.57
===&gt;  Configuring for lsof-4.57
...
[configure output snipped]
...
===&gt;  Building for lsof-4.57
...
[compilation output snipped]
...
&prompt.root;</screen>

        <para>請注意：編譯完成後，就會回到提示列(prompt)。接下來就是安裝該 port 了，
	  要裝的話，只需在原本的 <command>make</command> 指令後面再加上一個字即可，
	  那個字就是 <command>install</command>：</para>

        <screen>&prompt.root; <userinput>make install</userinput>
===&gt;  Installing for lsof-4.57
...
[installation output snipped]
...
===&gt;   Generating temporary packing list
===&gt;   Compressing manual pages for lsof-4.57
===&gt;   Registering installation for lsof-4.57
===&gt;  SECURITY NOTE: 
      This port has installed the following binaries which execute with
      increased privileges.
&prompt.root;</screen>

        <para>一旦回到提示列(prompt)，就可以執行剛裝的程式了。
	  另外，因為 <command>lsof</command> 這程式執行時會有額外權限，
	  所以會出現安全警告。在編譯、安裝 port 的時候，
	  請留意任何出現的警告。</para>

	<para>此外，建議刪除編譯用的工作目錄(預設是 <filename>work</filename>)，
	  這目錄內為在編譯過程中所用到的一些臨時檔案，
	  這些檔案不只佔硬碟空間，而且也可能會在該 port 升級新版時，
	  造成不必要的困擾。</para>

	<screen>&prompt.root; <userinput>make clean</userinput>
===&gt;  Cleaning for lsof-4.57
&prompt.root;</screen>

        <note>
          <para>用 <command>make install clean</command> 就可以一口氣完成剛所說 
	    <command>make</command>、<command>make install</command>、
	    <command>make clean</command> 這三個步驟了。</para>
	</note>

	<note>
	  <para>有些 shell 會依據 <envar>PATH</envar> 環境變數的路徑，
	    把那些路徑的執行檔 cache 起來，來加速搜尋執行檔。
	    如果你用的是這類的 shell，那麼在裝完 port 後需要打 
	    <command>rehash</command> 指令，才能執行新裝的執行檔，而 
	    <command>rehash</command> 指令可以在 <command>tcsh</command> 
	    之類的 shell 上使用，若是 <command>sh</command> 的話，則是 
	    <command>hash -r</command>。
	    詳情請參閱你所使用的 shell 相關文件。</para>
	</note>

	<para>Some third party DVD-ROM products such as the FreeBSD Toolkit
	  from the <ulink url="http://www.freebsdmall.com/">FreeBSD
	  Mall</ulink> contain distfiles.  They can be used with the Ports
	  Collection.  Mount the DVD-ROM on <filename>/cdrom</filename>.  If
	  you use a different mount point, set <makevar>CD_MOUNTPTS</makevar>
	  make variable.  The needed distfiles will be automatically used
	  if they are present on the disk.</para>

	<note>
	  <para>Please be aware that the licenses of a few ports do
	    not allow for inclusion on the CD-ROM.  This could be
	    because a registration form needs to be filled out before
	    downloading or redistribution is not allowed, or for
	    another reason.  If you wish to install a port not
	    included on the CD-ROM, you will need to be online in
	    order to do so.</para>
	</note>

	<para>The ports system uses &man.fetch.1; to download the
	  files, which honors various environment variables, including
	  <envar>FTP_PASSIVE_MODE</envar>, <envar>FTP_PROXY</envar>,
	  and <envar>FTP_PASSWORD</envar>.  You may need to set one or
	  more of these if you are behind a firewall, or need to use
	  an FTP/HTTP proxy.  See &man.fetch.3; for the complete
	  list.</para>

	<para>For users which cannot be connected all the time, the
	  <command>make <maketarget>fetch</maketarget></command> option is
	  provided.  Just run this command at the top level directory
	  (<filename>/usr/ports</filename>) and the required files
	  will be downloaded for you.  This command will also work in
	  the lower level categories, for example:
	  <filename>/usr/ports/net</filename>.
	  Note that if a port depends on libraries or other ports this will
	  <emphasis>not</emphasis> fetch the distfiles of those ports too.
	  Replace <maketarget>fetch</maketarget> with
	  <maketarget>fetch-recursive</maketarget>
	  if you want to fetch all the dependencies of a port too.</para>

	<note><para>You can build all the ports in a category or as a
	  whole by running <command>make</command> in the top level
	  directory, just like the aforementioned <command>make
	  <makevar>fetch</makevar></command> method.  This is
	  dangerous, however, as some ports cannot co-exist.  In other
	  cases, some ports can install two different files with the
	  same filename.</para></note>

	<para>In some rare cases, users may need to acquire the
	  tarballs from a site other than the
	  <makevar>MASTER_SITES</makevar> (the location where files
	  are downloaded from).  You can override the
	  <makevar>MASTER_SITES</makevar> option with the following
	  command:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/<replaceable>directory</replaceable></userinput>
&prompt.root; <userinput>make MASTER_SITE_OVERRIDE= \
ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/ fetch</userinput></screen>

	<para>In this example we change the
	  <makevar>MASTER_SITES</makevar> option to <hostid
	  role="fqdn">ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</hostid>.</para>

	<note><para>Some ports allow (or even require) you to provide
	  build options which can enable/disable parts of the
	  application which are unneeded, certain security options,
	  and other customizations.  A few which come to mind are
	  <filename role="package">www/mozilla</filename>, <filename
	  role="package">security/gpgme</filename>, and <filename
	  role="package">mail/sylpheed-claws</filename>.  A message
	  will be displayed when options such as these are
	  available.</para></note>

      <sect3>
        <title>更改(Override)預設的 Ports 目錄</title>

	<para>Sometimes it is useful (or mandatory) to use a different
	  distfiles and ports directory.  The
	  <makevar>PORTSDIR</makevar> and <makevar>PREFIX</makevar>
	  variables can override the default directories.  For
	  example:</para>

	<screen>&prompt.root; <userinput>make PORTSDIR=/usr/home/example/ports install</userinput></screen>

	<para>will compile the port in
	    <filename>/usr/home/example/ports</filename> and install
	    everything under <filename>/usr/local</filename>.</para>

	<screen>&prompt.root; <userinput>make PREFIX=/usr/home/example/local install</userinput></screen>

	<para>will compile it in <filename>/usr/ports</filename> and
	  install it in
	  <filename>/usr/home/example/local</filename>.</para>

	<para>And of course,</para>

	<screen>&prompt.root; <userinput>make PORTSDIR=../ports PREFIX=../local install</userinput></screen>

	<para>will combine the two (it is too long to completely write
	  on this page, but it should give you the general
	  idea).</para>

	<para>Alternatively, these variables can also be set as part
	  of your environment.  Read the manual page for your shell
	  for instructions on doing so.</para>
      </sect3>

      <sect3>
	<title>Dealing with <command>imake</command></title>

	<para>Some ports that use <command>imake</command> (a part of
	  the X Window System) do not work well with
	  <makevar>PREFIX</makevar>, and will insist on installing
	  under <filename>/usr/X11R6</filename>.  Similarly, some Perl
	  ports ignore <makevar>PREFIX</makevar> and install in the
	  Perl tree.  Making these ports respect
	  <makevar>PREFIX</makevar> is a difficult or impossible
	  job.</para>

      </sect3>
    </sect2>

    <sect2 id="ports-removing">
      <title>移除已安裝的 Ports</title>

      <indexterm>
        <primary>ports</primary>
        <secondary>removing</secondary>
      </indexterm>
      <para>Now that you know how to install ports, you are probably
        wondering how to remove them, just in case you install one and
	later on decide that you installed the wrong port.  
        We will remove our previous example (which was 
	<command>lsof</command> for
	those of you not paying attention).  Ports are being removed exactly
	the same as the packages (discussed in the <link
	linkend="packages-using">Packages section</link>), using the
	&man.pkg.delete.1; command:</para>

      <screen>&prompt.root; <userinput>pkg_delete lsof-4.57</userinput></screen>

    </sect2>

    <sect2 id="ports-upgrading">
      <title>升級已安裝的 Ports</title>

      <indexterm>
	<primary>ports</primary>
	<secondary>upgrading</secondary>
      </indexterm>
      <para>首先，用 &man.pkg.version.1; 指令來列出目前 Ports Collection 中提供了那些可升級的 port 版本：</para>

      <screen>&prompt.root; <userinput>pkg_version -v</userinput></screen>

      <sect3 id="ports-file-updating">
	<title><filename>/usr/ports/UPDATING</filename></title>

        <para>每次更新完 Ports Collection 之後，請務必記得在升級 port 前，
	  先看看 <filename>/usr/ports/UPDATING</filename>，
	  這裡會寫升級方面的各式問題，比如：檔案格式改變、變更設定檔位置、與舊版不相容的問題等，
	  以及怎麼解決的完整步驟。</para>

        <para>若 <filename>UPDATING</filename> 內容與你看到的其他文件有些不同、相衝的話，
	  那麼以 <filename>UPDATING</filename> 為主。</para>
      </sect3>

      <sect3 id="portupgrade">
	<title>以 Portupgrade 來升級已安裝的 Ports</title>

	<indexterm>
	  <primary>portupgrade</primary>
	</indexterm>

      <para><application>portupgrade</application> 可以輕鬆升級已裝的軟體。
	該工具可從 <filename role="package">sysutils/portupgrade</filename> port 安裝，
	安裝方式就如同其他 port 一樣，用 <command>make <makevar>install	clean</makevar></command> 指令就可以了：</para>

      <screen>&prompt.root; <userinput>cd /usr/ports/sysutils/portupgrade</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

      <para>首先最好先以 <command>pkgdb -F</command> 來掃瞄已裝的 ports 資料庫是否有誤，並修正有問題的地方。
	在每次做升級之前，最好定期做一下 <command>pkgdb -F</command> 動作會較為妥當。</para>

      <para>When you run <command>portupgrade -a</command>,
	<application>portupgrade</application> will begin to upgrade all the
	outdated ports installed on your system.  Use the <option>-i</option>
	flag if you want to be asked for confirmation of every individual
	upgrade.</para>

      <screen>&prompt.root; <userinput>portupgrade -ai</userinput></screen>

      <para>If you want to upgrade only a
	certain application, not all available ports, use <command>portupgrade
	<replaceable>pkgname</replaceable></command>.  Include the
	<option>-R</option> flag if <application>portupgrade</application>
	should first upgrade all the ports required by the given
	application.</para>

      <screen>&prompt.root; <userinput>portupgrade -R firefox</userinput></screen>

      <para>To use packages instead of ports for installation, provide
	<option>-P</option> flag.  With this option
	<application>portupgrade</application> searches
	the local directories listed in <envar>PKG_PATH</envar>, or
	fetches packages from remote site if it is not found locally.
	If packages can not be found locally or fetched remotely,
	<application>portupgrade</application> will use ports.
	To avoid using ports, specify <option>-PP</option>.</para>

      <screen>&prompt.root; <userinput>portupgrade -PR gnome2</userinput></screen>

      <para>To just fetch distfiles (or packages, if
	<option>-P</option> is specified) without building or
	installing anything, use <option>-F</option>.
	For further information see &man.portupgrade.1;.</para>
      </sect3>

      <sect3 id="portmanager">
	<title>以 Portmanager 來升級已安裝的 Ports</title>

	<indexterm>
	  <primary>portmanager</primary>
	</indexterm>

	<para><application>Portmanager</application> 也可以用來輕鬆升級已裝的軟體。
	  該工具可從 <filename role="package">sysutils/portmanager</filename> port 安裝：</para>

	<screen>&prompt.root; <userinput>cd <filename role="directory">/usr/ports/sysutils/portmanager</filename></userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

	<para>所有已裝的軟體，都可以輕鬆用類似下列指令來升級：</para>

	<screen>&prompt.root; <userinput>portmanager -u</userinput></screen>

	<para>此外，使用參數可以改為 <option>-ui</option>，如此一來 <application>Portmanager</application>
	  在升級一些有特殊選項的軟體時，就會詢問該如何升級。
	  <application>Portmanager</application> 也可以用來裝新 port。與以往常用的 
	  <command>make install clean</command> 指令不同之處在於：它會先升級你要裝的 port 所相依的所有 ports，
	  然後才開始編譯、安裝要裝的 port。</para>

	<screen>&prompt.root; <userinput>portmanager <replaceable>x11/gnome2</replaceable></userinput></screen>

	<para>若要裝的 port 之軟體相依關係有問題時，也可以用 <application>Portmanager</application> 
	  使它們重歸正軌。而 <application>Portmanager</application> 解決相依問題完畢之後，該 port 
	  也會重新編譯，以因應正確的相依關係。</para>

	<screen>&prompt.root; <userinput>portmanager <replaceable>graphics/gimp</replaceable> -f</userinput></screen>

	<para>其他運用方式，請參閱 
	  <application>Portmanager</application> 的線上手冊。</para>
      </sect3>
    </sect2>

    <sect2 id="ports-disk-space">
      <title>Ports 與硬碟空間</title>

      <indexterm>
	<primary>ports</primary>
	<secondary>disk-space</secondary>
      </indexterm>
      <para>因為使用 Ports Collection 遲早可能會用光硬碟空間，
	所以在裝完軟體後，記得要以 <command>make <makevar>clean</makevar></command> 
	指令來清除臨時的 <filename class="directory">work</filename> 目錄。
	此外，可以用下列指令來清除整個 Ports Collection 內的臨時目錄：</para>

      <screen>&prompt.root; <userinput>portsclean -C</userinput></screen>

      <para>You will accumulate a lot of old source distribution files in the
	<filename class="directory">distfiles</filename> directory over time.
	You can remove them by hand, or you can use the following command to
	delete all the distfiles that are no longer referenced by any
	ports:</para>

      <screen>&prompt.root; <userinput>portsclean -D</userinput></screen>

      <note>
	<para>The <command>portsclean</command> utility is part of the
	  <application>portupgrade</application> suite.</para>
      </note>

      <para>Do not forget to remove the installed ports once you no longer need
	them.  A nice tool to help automate this task is available from the
	<filename role="package">sysutils/pkg_cutleaves</filename> port.</para>
    </sect2>

  </sect1>

  <sect1 id="ports-nextsteps">
    <title>安裝之後，有什麼後續注意事項嗎？</title>

    <para>通常，安裝完軟體後，我們可以閱讀所附的一些文件，或需要編輯設定檔，
	來確保這個軟體能順利運作，或在機器開機的時候啟動(如果是 daemon 的話)等等。</para>

    <para>不同的軟體會有不同的設定步驟。不管怎樣，如果裝好了軟體，
	但是不知道下一步怎麼辦的時候， 可以試試看這些小技巧：</para>

    <itemizedlist>
      <listitem>
	<para>善用 &man.pkg.info.1; ，這指令可以顯示：透過套件管理系統(Packages/Ports)裝了哪些軟體、檔案裝在哪邊。舉例來說，若剛裝了 FooPackage (版本 1.0.0)，那麼下面這指令：</para>

	<screen>&prompt.root; <userinput>pkg_info -L foopackage-1.0.0 | less</userinput></screen>

	<para>就會顯示這軟體所安裝的檔案清單。 Pay
	  special attention to files in <filename>man/</filename>
	  directories, which will be manual pages,
	  <filename>etc/</filename> directories, which will be
	  configuration files, and <filename>doc/</filename>, which
	  will be more comprehensive documentation.</para>

	<para>If you are not sure which version of the application was
	  just installed, a command like this</para>

	<screen>&prompt.root; <userinput>pkg_info | grep -i <replaceable>foopackage</replaceable></userinput></screen>

	<para>will find all the installed packages that have
	  <replaceable>foopackage</replaceable> in the package name.
	  Replace <replaceable>foopackage</replaceable> in your
	  command line as necessary.</para>
      </listitem>

      <listitem>
	<para>Once you have identified where the application's manual
	  pages have been installed, review them using &man.man.1;.
	  Similarly, look over the sample configuration files, and any
	  additional documentation that may have been provided.</para>
      </listitem>

      <listitem>
	<para>If the application has a web site, check it for
	  additional documentation, frequently asked questions, and so
	  forth.  If you are not sure of the web site address it may
	  be listed in the output from</para>

	<screen>&prompt.root; <userinput>pkg_info <replaceable>foopackage-1.0.0</replaceable></userinput></screen>
	
	<para>A <literal>WWW:</literal> line, if present, should provide a URL
	  for the application's web site.</para>
      </listitem>

      <listitem>
	<para>Ports that should start at boot (such as Internet
	  servers) will usually install a sample script in
	  <filename>/usr/local/etc/rc.d</filename>.  You should
	  review this script for correctness and edit or rename it if
	  needed.  See <link
	  linkend="configtuning-starting-services">Starting
	  Services</link> for more information.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="ports-broken">
    <title>如何處理爛掉(Broken)的 Ports？</title>

      <para>如果發現某個 port 無法順利安裝、運作， 有幾種方法可以試試看：</para>

      <orderedlist>
	<listitem>
	  <para>從 <ulink url="&url.base;/support.html#gnats">Problem Report
	    資料庫</ulink> 中挖寶看看，說不定已經有人送可用的 patch 上去囉，
	    那麼或許就可以順利解決問題哩。</para>
	</listitem>

	<listitem>
	  <para>向該 port 的 maintainer 尋求協助：請打
	    <command>make maintainer</command> 或翻閱
	    <filename>Makefile</filename> 以查詢 maintainer 的
	    email address。記得寄信給 maintainer 時，要附註該 port 的名稱、版本(或是把 <filename>Makefile</filename> 內的 <literal>&dollar;FreeBSD:</literal> 那一整行附上) 以及相關錯誤訊息。</para>

	  <note>
	    <para>有些 port 不是由專門的單一 maintainer 負責，而是透過 <ulink
	      url="&url.articles.mailing-list-faq;/article.html">mailing
	      list</ulink> 的專題討論。許多(但非全部)的聯絡 email 格式通常是
	      <email role="nolink">freebsd-list名稱@FreeBSD.org</email>。發問時，請記得把『freebsd-list名稱』改為相關討論的 mailing list 名稱。</para>

	    <para>尤其當 port 的 maintainer 欄位是
	      <email role="nolink">freebsd-ports@FreeBSD.org</email> 
	        時，事實上已經沒人當該 port maintainer 了。
	        因此若該 port 仍有修正或其他技術支援的話，相關討論都會在 freebsd-ports 郵遞論壇上出現。
	        喔，對了，如果有熟悉該軟體者，志願當該 port maintainer 的話，我們也都很歡迎您的加入喔。</para>
	  </note>

	  <para>若 port maintainer 沒有回覆您的信件， 則可以用 &man.send-pr.1; 
	    來提交問題報告 PR。(請參閱 <ulink
	    url="&url.articles.problem-reports;/article.html">Writing
	    FreeBSD Problem Reports</ulink>)。</para>
	</listitem>

        <listitem>
	  <para>試試看修正它吧!  <ulink
	    url="&url.books.porters-handbook;/index.html">Porter's
	    Handbook</ulink> 包括了 <quote>Ports</quote> 
	    架構的細節部份，這些書中內容有助您修好有問題的 port 甚至提交自己的 port﹗</para>
	</listitem>

	<listitem>
	  <para>從較近的 FTP 站點下載編譯好的 package。
	    package collection 的最上游站是在 <hostid
	    role="fqdn">ftp.FreeBSD.org</hostid> 上的 <ulink
	    url="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/">packages
	    目錄</ulink>內，但請記得先檢查是否已有 <ulink
	    url="http://mirrorlist.FreeBSD.org/">local mirror</ulink>
	    站!  通常情況下這些 package 都可以直接使用，而且應該比自行編譯快一些。
	    用 &man.pkg.add.1; 即可順利安裝 package 。</para>
	</listitem>
      </orderedlist>
  </sect1>

</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
