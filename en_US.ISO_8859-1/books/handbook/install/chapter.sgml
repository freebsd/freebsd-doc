<!--
     The FreeBSD Documentation Project

     $Id: chapter.sgml,v 1.19 1999-07-19 22:16:32 nik Exp $
-->

<chapter id="install">
  <title>Installing FreeBSD</title>
  
  <para>So, you would like to try out FreeBSD on your system? This section is
    a quick-start guide for what you need to do.  FreeBSD can be installed
    from a variety of media including CD-ROM, floppy disk, magnetic tape, an
    MS-DOS partition and, if you have a network connection, via anonymous ftp
    or NFS.</para>
      
  <para>Regardless of the installation media you choose, you can get started
    by creating the <emphasis>installation disks</emphasis> as described
    below.  Booting your computer into the FreeBSD installer, even if you
    are not planning on installing FreeBSD right away, will provide important
    information about compatibility between FreeBSD and your hardware which
    may, in turn, dictate which installation options are even possible.  It
    can also provide early clues to any compatibility problems which could
    prevent FreeBSD running on your system at all.</para>

  <para>If you plan on installing via anonymous FTP then the installation
    floppies are all you need to download and create&mdash;the installation
    program itself will handle any further required downloading directly
    (using an ethernet connection, a modem and ppp dialip #, etc).</para>
      
  <para>For more information on obtaining the latest FreeBSD distributions,
    please see <link linkend="mirrors">Obtaining FreeBSD</link> in the
    Appendix.</para>
      
  <para>So, to get the show on the road, follow these steps:</para>
      
  <procedure>
    <step>
      <para>Review the <link linkend="install-hw">supported
	  configurations</link> section of this installation guide to be sure
	that your hardware is supported by FreeBSD.  It may be helpful to make
	a list of any special cards you have installed, such as SCSI
	controllers, Ethernet adapters or sound cards.  This list should
	include relevant configuration parameters such as interrupts (IRQ) and
	IO port addresses.</para>
    </step>
	  
    <step>
      <para>If you are installing FreeBSD from CDROM media then you have
	several different installation options:</para>

      <itemizedlist>
	<listitem>
	  <para>If the CD has been mastered with El Torrito boot support and
	    your system supports direct booting from CDROM (and many older
	    systems do <emphasis>not</emphasis>), simply insert the CD into
	    the drive and boot directly from it.</para>
	</listitem>
		
	<listitem>
	  <para>If you are running DOS and have the proper drivers to access
	    your CD, run the install.bat script provided on the CD.  This will
	    attempt to boot into the FreeBSD installation straight from
	    DOS.</para>

	  <note>
	    <para>You must do this from actual DOS and not a Windows DOS
	      box.</para>
	  </note>
	  
	  <para>If you also want to install FreeBSD from your DOS partition
	    (perhaps because your CDROM drive is completely unsupported by
	    FreeBSD) then run the setup program first to copy the appropriate
	    files from the CD to your DOS partition, afterwards running
	    install.</para>
	</listitem>
		
	<listitem>
	  <para>If either of the two proceeding methods work then you can
	    simply skip the rest of this section, otherwise your final option
	    is to create a set of boot floppies from the
	    <filename>floppies\kern.flp</filename> and
	    <filename>floppies\mfsroot.flp</filename> images&mdash;proceed to
	    step 4 for instructions on how to do this.</para>
	</listitem>
      </itemizedlist>
    </step>
	  
    <step>
      <para>If you do not have a CDROM distribution then simply read the <ulink
	  url="ftp://ftp.FreeBSD.ORG/pub/FreeBSD/&rel.current;-RELEASE/floppies/README.TXT">installation
	  boot image information</ulink> to find out what files you need to
	download first.</para>
    </step>
	  
    <step>
      <para>Make the installation boot disks from the image files:</para>

      <itemizedlist>
	<listitem>
	  <para>If you are using MS-DOS then download  <ulink
	      URL="ftp://ftp.FreeBSD.ORG/pub/FreeBSD/tools/fdimage.exe">fdimage.exe</ulink>
	    or get it from <filename>tools\fdimage.exe</filename> on the CDROM
	    and then run it like so:</para>
		    
	  <screen><prompt>E:\&gt;</prompt> <userinput>tools\fdimage floppies\kern.flp a:</userinput></screen>
		    
	  <para>The <emphasis>fdimage</emphasis> program will format the
	    <devicename>A:</devicename> drive and then copy the
	    <filename>kern.flp</filename> image onto it (assuming that you are
	    at the top level of a FreeBSD distribution and the floppy images
	    live in the <filename>floppies</filename> subdirectory, as is
	    typically the case).</para>
	</listitem>
	
	<listitem>
	  <para>If you are using a UNIX system to create the floppy
	    images:</para>
		    
	  <screen>&prompt.root; <userinput>dd if=kern.flp of=<replaceable>disk_device</replaceable></userinput></screen>
		    
	  <para><replaceable>disk_device</replaceable> is the
	    <filename>/dev</filename> entry for the floppy drive. On FreeBSD
	    systems, this is <filename>/dev/rfd0</filename> for the
	    <devicename>A:</devicename> drive and
	    <filename>/dev/rfd1</filename> for the <devicename>B:</devicename>
	    drive.</para>
	</listitem>
      </itemizedlist>
    </step>
    
    <step>
      <para>With the <filename>kern.flp</filename> in the
	<devicename>A:</devicename> drive, reboot your computer.  The next
	request you should get is for the <filename>mfsroot.flp</filename>
	floppy, after which the installation will proceed normally.</para>

      <para>If you do <emphasis>not</emphasis> type anything at the boot
	prompt which appears during this process, FreeBSD will automatically
	boot with its default configuration after a delay of about five
	seconds.  As FreeBSD boots, it probes your computer to determine what
	hardware is installed.  The results of this probing is displayed on
	the screen.</para>
    </step>
	  
    <step>
      <para>When the booting process is finished, The main FreeBSD
	installation menu will be displayed.</para>
    </step>
  </procedure>
      
  <para><emphasis>If something goes wrong&hellip;</emphasis></para>
  
  <para>Due to limitations of the PC architecture, it is impossible for
    probing to be 100 percent reliable.  In the event that your hardware is
    incorrectly identified, or that the probing causes your computer to lock
    up, first check the <link linkend="install-hw">supported
      configurations</link> section of this installation guide to be sure that
    your hardware is indeed supported by FreeBSD.</para>
      
  <para>If your hardware is supported, reset the computer and when the visual
    kernel configuration choice is presented, take it.  This puts FreeBSD into
    a configuration mode where you can supply hints about your hardware.  The
    FreeBSD kernel on the installation disk is configured assuming that most
    hardware devices are in their factory default configuration in terms of
    IRQs, IO addresses and DMA channels.  If your hardware has been
    reconfigured, you will most likely need to use the configuration editor to
    tell FreeBSD where things are.</para>
      
  <para>It is also possible that a probe for a device not present will cause a
    later probe for another device that is present to fail.  In that case, the
    probes for the conflicting driver(s) should be disabled.</para>

  <warning>
    <para>Do not disable any device you will need during installation, such as
      your screen (<devicename>sc0</devicename>).  If the installation wedges
      or fails mysteriously after leaving the configuration editor, you have
      probably removed or changed something that you should not have.  Simply
      reboot and try again.</para>
  </warning>
      
  <para>In the configuration mode, you can:</para>
            
  <itemizedlist>
    <listitem>
      <para>List the device drivers installed in the kernel.</para>
    </listitem>
    
    <listitem>
      <para>Disable device drivers for hardware not present in your
	system.</para>
    </listitem>
    
    <listitem>
      <para>Change the IRQ, DRQ, and IO port addresses used by a device
	driver.</para>
    </listitem>
  </itemizedlist>
  
  <para>After adjusting the kernel to match how you have your hardware
    configured, type <command>Q</command> to continue booting with the new
    settings.</para>
	
  <para>After FreeBSD has been installed, changes made in the configuration
    mode will be permanent so you do not have to reconfigure every time you
    boot.  Even so, it is likely that you will want to build a custom kernel
    to optimize the performance of your system.  See <link
      linkend="kernelconfig" >Kernel configuration</link> for more information
    on creating custom kernels.</para>
      
  <sect1 id="install-hw">
    <title>Supported Configurations</title>
    
    <para>FreeBSD currently runs on a wide variety of ISA, VLB, EISA and PCI
      bus based PC's, ranging from 386sx to Pentium class machines (though the
      386sx is not recommended).  Support for generic IDE or ESDI drive
      configurations, various SCSI controller, network and serial cards is
      also provided.</para>
	
    <para>A minimum of four megabytes of RAM is required to run FreeBSD. To
      run the X Window System, eight megabytes of RAM is the recommended
      minimum.</para>
	
    <para>Following is a list of all disk controllers and Ethernet cards
      currently known to work with FreeBSD.  Other configurations may very
      well work, and we have simply not received any indication of
      this.</para>
	
    <sect2>
      <title>Disk Controllers</title>
      
      <itemizedlist>
	<listitem>
	  <para>WD1003 (any generic MFM/RLL)</para>
	</listitem>
	
	<listitem>
	  <para>WD1007 (any generic IDE/ESDI)</para>
	</listitem>
	
	<listitem>
	  <para>IDE</para>
	</listitem>
	
	<listitem>
	  <para>ATA</para>
	</listitem>

	<listitem>
	  <para>Adaptec 1535 ISA SCSI controllers</para>
	</listitem>

	<listitem>
	  <para>Adaptec 154x series ISA SCSI controllers</para>
	</listitem>

	<listitem>
	  <para>Adaptec 174x series EISA SCSI controller in standard and
	    enhanced mode.</para>
	</listitem>

	<listitem>
	  <para>Adaptec 274X/284X/2920C/2930U2/294x/2950/3940/3950
	    (Narrow/Wide/Twin) series EISA/VLB/PCI SCSI controllers.</para>
	</listitem>

	<listitem>
	  <para>Adaptec AIC7850, AIC7860, AIC7880, AIC789x, on-board SCSI
	    controllers.</para>
	</listitem>

	<listitem>
	  <para>AdvanSys SCSI controllers (all models).</para>
	</listitem>

	<listitem>
	  <para>BusLogic MultiMaster controllers:</para>

	  <note>
            <para>BusLogic/Mylex "Flashpoint" adapters are NOT yet
	      supported.</para>
          </note>
	  
	  <itemizedlist>
	    <listitem>
	      <para>BusLogic MultiMaster "W" Series Host Adapters:</para>

    	      <itemizedlist>
		<listitem> 
                  <para>BT-948</para>
                </listitem>

		<listitem> 
                  <para>BT-958</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-958D</para> 
                </listitem>
	      </itemizedlist>
	    </listitem>
	    
	    <listitem>
	      <para>BusLogic MultiMaster "C" Series Host Adapters:</para>
	      
	      <itemizedlist>
		<listitem> 
                  <para>BT-946C</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-956C</para>
                </listitem>
		
		<listitem> 
                  <para>BT-956CD</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-445C</para>
                </listitem>
		
		<listitem> 
                  <para>BT-747C</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-757C</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-757CD</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-545C</para> 
                </listitem>
		
		<listitem> 
                  <para>BT-540CF</para> 
                </listitem>
	      </itemizedlist>
	    </listitem>
	    
	    <listitem>
	      <para>BusLogic MultiMaster "S" Series Host Adapters:</para>
	      
 	      <itemizedlist>    
		<listitem> 
                  <para>BT-445S</para> 
                </listitem>

		<listitem> 
                  <para>BT-747S</para> 
                </listitem>

		<listitem> 
                  <para>BT-747D</para>
                </listitem>

		<listitem> 
                  <para>BT-757S</para>
                </listitem>

		<listitem> 
                  <para>BT-757D</para>
                </listitem>

		<listitem> 
                  <para>BT-545S</para> 
                </listitem>

		<listitem> 
                  <para>BT-542D</para> 
                </listitem>

		<listitem> 
                  <para>BT-742A</para> 
                </listitem>

		<listitem> 
                  <para>BT-542B</para>
                </listitem>
	      </itemizedlist>
	    </listitem>
	    
	    <listitem>
	      <para>BusLogic MultiMaster "A" Series Host Adapters:</para>
	      
	      <itemizedlist>
		<listitem> 
                  <para>BT-742A</para> 
                </listitem>

		<listitem> 
                  <para>BT-542B</para>
                </listitem>
	      </itemizedlist>
	    </listitem>
	    
	    <listitem>
	      <para>AMI FastDisk controllers that are true BusLogic
		MultiMaster clones are also supported.</para>
	    </listitem>
	  </itemizedlist>
	</listitem>
	
	<listitem>
	  <para>DPT SmartCACHE Plus, SmartCACHE III, SmartRAID III, SmartCACHE
	    IV and SmartRAID IV SCSI/RAID controllers are supported.  The DPT
	    SmartRAID/CACHE V is not yet supported.</para>
	</listitem>

	<listitem>
	  <para>Compaq Intelligent Disk Array Controllers: IDA, IDA-2, IAES,
	    SMART, SMART-2/E, Smart-2/P, SMART-2SL, Smart Array 3200,
	    Smart Array 3100ES and Smart Array 221.</para>
	</listitem>
	
	<listitem>
	  <para>SymBios (formerly NCR) 53C810, 53C810a, 53C815, 53C820,
	    53C825a, 53C860, 53C875, 53C875j, 53C885, 53C895 and 53C896 PCI
	    SCSI controllers:</para>
	  
	  <itemizedlist>
	    <listitem>
	      <para>ASUS SC-200</para>
	    </listitem>
	    
	    <listitem>
	      <para>Data Technology DTC3130 (all variants)</para>
	    </listitem>
	    
	    <listitem>
	      <para>Diamond FirePort (all)</para>
	    </listitem>
	    
	    <listitem>
	      <para>NCR cards (all)</para>
	    </listitem>
	    
	    <listitem>
	      <para>Symbios cards (all)</para>
	    </listitem>
	    
	    <listitem>
	      <para>Tekram DC390W, 390U and 390F</para>
	    </listitem>
	    
	    <listitem>
	      <para>Tyan S1365</para>
	    </listitem>
	  </itemizedlist>
	</listitem>
	
	<listitem>
	  <para>QLogic 1020, 1040, 1040B, 1080, 1240 and 2100 SCSI and Fibre
	    Channel Adapters</para>
	</listitem>
	
	<listitem>
	  <para>DTC 3290 EISA SCSI controller in 1542 emulation mode.</para>
	</listitem>
      </itemizedlist>
	  
      <para>With all supported SCSI controllers, full support is provided for
	SCSI-I &amp SCSI-II peripherals, including hard disks, optical disks,
	tape drives (including DAT and 8mm Exabyte), medium changers,
	processor target devices and CDROM drives.  WORM devices that support
	CDROM commands are supported for read-only access by the CDROM driver.
	WORM/CD-R/CD-RW writing support is provided by cdrecord, which is in
	the ports tree.</para>
      
      <para>The following CD-ROM type systems are supported at this
	time:</para>
	  
      <itemizedlist>
	<listitem>
	  <para>SoundBlaster SCSI and ProAudio Spectrum SCSI
	    (<literal>cd</literal>)</para>
	</listitem>
	
	<listitem>
	  <para>Mitsumi (all models) proprietary interface
	    (<literal>mcd</literal>)</para>
	</listitem>
	
	<listitem>
	  <para>Matsushita/Panasonic (Creative) CR-562/CR-563 proprietary
	    interface (<literal>matcd</literal>)</para>
	</listitem>
	
	<listitem>
	  <para>Sony proprietary interface (<literal>scd</literal>)</para>
	</listitem>
	
	<listitem>
	  <para>ATAPI IDE interface (<literal>wcd</literal>)</para>
	</listitem>
      </itemizedlist>
      
      <para>The following drivers were supported under the old SCSI subsystem,
	but are NOT YET supported under the new CAM SCSI subsystem:</para>
      
      <itemizedlist>
	<listitem>
	  <para>Tekram DC390 and DC390T controllers (maybe other cards based
	    on the AMD 53c974 as well).</para>
	</listitem>
	
	<listitem>
	  <para>NCR5380/NCR53400 ("ProAudio Spectrum") SCSI controller.</para>
	</listitem>
	
	<listitem>
	  <para>UltraStor 14F, 24F and 34F SCSI controllers.</para>
	</listitem>
	
	<listitem>
	  <para>Seagate ST01/02 SCSI controllers.</para>
	</listitem>

	<listitem>
	  <para>Future Domain 8xx/950 series SCSI controllers.</para>
	</listitem>
	
	<listitem>
	  <para>WD7000 SCSI controller.</para>
	</listitem>

	<listitem>
	  <para>Adaptec 1510 series ISA SCSI controllers (not for bootable
	    devices)</para>
	</listitem>
	
	<listitem>
	  <para>Adaptec 152x series ISA SCSI controllers</para>
	</listitem>
	
	<listitem>
	  <para>Adaptec AIC-6260 and AIC-6360 based boards, which includes the
	    AHA-152x and SoundBlaster SCSI cards.</para>
	</listitem>
      </itemizedlist>
    </sect2>
    
    <sect2 id="install-nics">
      <title>Ethernet cards</title>
      
      <itemizedlist>
	<listitem>
	  <para>Allied-Telesis AT1700 and RE2000 cards</para>
	</listitem>
	
	<listitem>
	  <para>SMC Elite 16 WD8013 Ethernet interface, and most other
	    WD8003E, WD8003EBT, WD8003W, WD8013W, WD8003S, WD8003SBT and
	    WD8013EBT based clones.  SMC Elite Ultra and 9432TX based cards
	    are also supported.</para>
	</listitem>
	
	<listitem>
	  <para>DEC EtherWORKS III NICs (DE203, DE204, and DE205)</para>
	</listitem>
	
	<listitem>
	  <para>DEC EtherWORKS II NICs (DE200, DE201, DE202, and DE422)</para>
	</listitem>
	
	<listitem>
	  <para>DEC DC21040/DC21041/DC21140 based NICs:</para>

	  <itemizedlist>
	    <listitem>
	      <para>ASUS PCI-L101-TB</para>
	    </listitem>
	    
	    <listitem>
	      <para>Accton ENI1203</para>
	    </listitem>
	    
	    <listitem>
	      <para>Cogent EM960PCI</para>
	    </listitem>
	    
	    <listitem>
	      <para>Compex CPXPCI/32C</para>
	    </listitem>
	    
	    <listitem>
	      <para>D-Link DE-530</para>
	    </listitem>
	    
	    <listitem>
	      <para>DEC DE435</para>
	    </listitem>

            <listitem>
              <para>DEC DE450</para>
            </listitem>
	    
	    <listitem>
	      <para>Danpex EN-9400P3</para>
	    </listitem>
	    
	    <listitem>
	      <para>JCIS Condor JC1260</para>
	    </listitem>
	    
	    <listitem>
	      <para>Kingston KNE100TX</para>
	    </listitem>
	    
	    <listitem>
	      <para>Linksys EtherPCI</para>
	    </listitem>
	    
	    <listitem>
	      <para>Mylex LNP101</para>
	    </listitem>
	    
	    <listitem>
	      <para>SMC EtherPower 10/100 (Model 9332)</para>
	    </listitem>
	    
	    <listitem>
	      <para>SMC EtherPower (Model 8432)</para>
	    </listitem>
	    
	    <listitem>
	      <para>SMC EtherPower (2)</para>
	    </listitem>
	    
	    <listitem>
	      <para>Zynx ZX314</para>
	    </listitem>
	    
	    <listitem>
	      <para>Zynx ZX342</para>
	    </listitem>
	  </itemizedlist>
	</listitem>
	      
	<listitem>
	  <para>DEC FDDI (DEFPA/DEFEA) NICs</para>
	</listitem>
	
	<listitem>
	  <para>Fujitsu FMV-181 and FMV-182</para>
	</listitem>
	
	<listitem>
	  <para>Fujitsu MB86960A/MB86965A</para>
	</listitem>
	
	<listitem>
	  <para>Intel EtherExpress</para>
	</listitem>
	
	<listitem>
	  <para>Intel EtherExpress Pro/100B 100Mbit.</para>
	</listitem>
	
	<listitem>
	  <para>Isolan AT 4141-0 (16 bit)</para>
	</listitem>
	
	<listitem>
	  <para>Isolink 4110 (8 bit)</para>
	</listitem>
	
	<listitem>
	  <para>Lucent WaveLAN wireless networking interface.</para>
	</listitem>
	
	<listitem>
	  <para>Novell NE1000, NE2000, and NE2100 ethernet interface.</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3C501 cards</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3C503 Etherlink II</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3c505 Etherlink/+</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3C507 Etherlink 16/TP</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3C509, 3C579, 3C589 (PCMCIA) Etherlink III</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3C590, 3C595 Etherlink III</para>
	</listitem>
	
	<listitem>
	  <para>3Com 3C90x cards.</para>
	</listitem>
	
	<listitem>
	  <para>HP PC Lan Plus (27247B and 27252A)</para>
	</listitem>
	
	<listitem>
	  <para>Toshiba ethernet cards</para>
	</listitem>
	
	<listitem>
	  <para>PCMCIA ethernet cards from IBM and National Semiconductor are
	    also supported.</para>
	</listitem>
      </itemizedlist>
      
      <note>
	<para>FreeBSD does not currently support PnP (plug-n-play) features
	  present on some ethernet cards.  If your card has PnP and is giving
	  you problems, try disabling its PnP features.</para>
      </note>
    </sect2>
    
    <sect2 id="install-misc">
      <title>Miscellaneous devices</title>

      <itemizedlist>
	<listitem>
	  <para>AST 4 port serial card using shared IRQ.</para>
	</listitem>
	
	<listitem>
	  <para>ARNET 8 port serial card using shared IRQ.</para>
	</listitem>
	
	<listitem>
	  <para>BOCA IOAT66 6 port serial card using shared IRQ.</para>
	</listitem>
	
	<listitem>
	  <para>BOCA 2016 16 port serial card using shared IRQ.</para>
	</listitem>
	
	<listitem>
	  <para>Cyclades Cyclom-y Serial Board.</para>
	</listitem>
	
	<listitem>
	  <para>STB 4 port card using shared IRQ.</para>
	</listitem>
	
	<listitem>
	  <para>SDL Communications Riscom/8 Serial Board.</para>
	</listitem>
	
	<listitem>
	  <para>SDL Communications RISCom/N2 and N2pci sync serial
	    cards.</para>
	</listitem>
	
	<listitem>
	  <para>Digiboard Sync/570i high-speed sync serial card.</para>
	</listitem>
	
	<listitem>
	  <para>Decision-Computer Intl. &ldquo;Eight-Serial&rdquo; 8 port
	    serial cards  using shared IRQ.</para>
	</listitem>
	
	<listitem>
	  <para>Adlib, SoundBlaster, SoundBlaster Pro, ProAudioSpectrum,
	    Gravis UltraSound, Gravis UltraSound MAX and Roland MPU-401 sound
	    cards.</para>
	</listitem>
	
	<listitem>
	  <para>Matrox Meteor video frame grabber.</para>
	</listitem>
	
	<listitem>
	  <para>Creative Labs Video spigot frame grabber.</para>
	</listitem>
	
	<listitem>
	  <para>Omnimedia Talisman frame grabber.</para>
	</listitem>
	
	<listitem>
	  <para>Brooktree BT848 chip based frame grabbers.</para>
	</listitem>
	
	<listitem>
	  <para>X-10 power controllers.</para>
	</listitem>
	
	<listitem>
	  <para>PC joystick and speaker.</para>
	</listitem>
      </itemizedlist>
	  
      <para>FreeBSD does not currently support IBM's microchannel (MCA)
	bus.</para>
    </sect2>
  </sect1>
  
  <sect1>
    <title>Preparing for the Installation</title>
    
    <para>There are a number of different methods by which FreeBSD can be
      installed.  The following describes what preparation needs to be done
      for each type.</para>
    
    <sect2>
      <title>Before installing from CDROM</title>
      
      <para>If your CDROM is of an unsupported type, then please skip to <link
	  linkend="install-msdos">MS-DOS Preparation</link>.</para>
	  
      <para>There is not a lot of preparatory work that needs to be done to
	successfully install from one of Walnut Creek's FreeBSD CDROMs (other
	CDROM distributions may work as well, though we cannot say for certain
	as we have no hand or say in how they are created). You can either
	boot into the CD installation directly from DOS using Walnut Creek's
	supplied <command>install.bat</command> batch file or you can make
	boot floppies with the <command>makeflp.bat</command> command.</para>

      <para>For the easiest interface of all (from DOS), type
	<command>view</command>. This will bring up a DOS menu utility that
	leads you through all the available options.</para>
	  
      <para>If you are creating the boot floppies from a UNIX machine, see
	<link linkend="install">the beginning of this guide</link> for
	examples of how to create the boot floppies.</para>
	  
      <para>Once you have booted from DOS or floppy, you should then be able
	to select CDROM as the media type in the Media menu and load the
	entire distribution from CDROM.  No other types of installation media
	should be required.</para>
      
      <para>After your system is fully installed and you have rebooted from
	the hard disk, you can mount the CDROM at any time by typing:
	<command>mount /cdrom</command></para>
	  
      <para>Before removing the CD again, also note that it is necessary to
	first type: <command>umount /cdrom</command>.  Do not just remove it
	from the drive!</para>
	  
      <note>
	<para>Before invoking the installation, be sure that the CDROM is in
	  the drive so that the install probe can find it.  This is also true
	  if you wish the CDROM to be added to the default system
	  configuration automatically during the install (whether or not you
	  actually use it as the installation media).</para>
      </note>
	  
      <para>Finally, if you would like people to be able to FTP install
	FreeBSD directly from the CDROM in your machine, you will find it
	quite easy.  After the machine is fully installed, you simply need to
	add the following line to the password file (using the vipw
	command):</para>
	  
      <programlisting>
ftp:*:99:99::0:0:FTP:/cdrom:/nonexistent</programlisting>
	  
      <para>Anyone with network connectivity to your machine (and permission
	to log into it) can now chose a Media type of FTP and type in:
	<userinput>ftp://<replaceable>your machine</replaceable></userinput>
	after picking &ldquo;Other&rdquo; in the ftp sites menu.</para>
    </sect2>
    
    <sect2>
      <title>Before installing from Floppy</title>
      
      <para>If you must install from floppy disks, either due to unsupported
	hardware or simply because you enjoy doing things the hard way, you
	must first prepare some floppies for the install.</para>
	  
      <para>You will need, at minimum, as many 1.44MB or 1.2MB floppies as it
	takes to hold all files in the bin (binary distribution) directory.
	If you are preparing these floppies under DOS, then THESE floppies
	<emphasis>must</emphasis> be formatted using the MS-DOS FORMAT
	command.  If you are using Windows, use the Windows File Manager
	format command.</para>
      
      <para>Do <emphasis>not</emphasis> trust Factory Preformatted floppies!
	Format them again yourself, just to make sure.  Many problems reported
	by our users in the past have resulted from the use of improperly
	formatted media, which is why I am taking such special care to mention
	it here!</para>
	  
      <para>If you are creating the floppies from another FreeBSD machine, a
	format is still not a bad idea though you do not need to put a DOS
	filesystem on each floppy.  You can use the
	<command>disklabel</command> and <command>newfs</command> commands to
	put a UFS filesystem on them instead, as the following sequence of
	commands (for a 3.5" 1.44MB floppy disk) illustrates:</para>
	  
      <screen>&prompt.root; <userinput>fdformat -f 1440 fd0.1440</userinput>
&prompt.root; <userinput>disklabel -w -r fd0.1440 floppy3</userinput>
&prompt.root; <userinput>newfs -t 2 -u 18 -l 1 -i 65536 /dev/rfd0</userinput></screen>
	    
      <note>
	<para>Use <literal>fd0.1200</literal> and <literal>floppy5</literal>
	  for 5.25" 1.2MB disks.</para>
      </note>
      
      <para>Then you can mount and write to them like any other file
	system.</para>
	  
      <para>After you have formatted the floppies, you will need to copy the
	files onto them.  The distribution files are split into chunks
	conveniently sized so that 5 of them will fit on a conventional 1.44MB
	floppy.  Go through all your floppies, packing as many files as will
	fit on each one, until you have got all the distributions you want
	packed up in this fashion.  Each distribution should go into a
	subdirectory on the floppy, e.g.: <filename>a:\bin\bin.aa</filename>,
	<filename>a:\bin\bin.ab</filename>, and so on.</para>
	  
      <para>Once you come to the Media screen of the install, select
	&ldquo;Floppy&rdquo; and you will be prompted for the rest.</para>
    </sect2>
    
    <sect2 id="install-msdos">
      <title>Before installing from a MS-DOS partition</title>
      
      <para>To prepare for installation from an MS-DOS partition, copy the
	files from the distribution into a directory called
	<filename>c:\freebsd</filename>.  The directory tree structure of the
	CDROM must be partially reproduced within this directory so we suggest
	using the DOS <command>xcopy</command> command. For example, to
	prepare for a minimal installation of FreeBSD:</para>

      <screen><prompt>C:\&gt;</prompt> <userinput>md c:\freebsd</userinput>
<prompt>C:\&gt;</prompt> <userinput>xcopy /s e:\bin c:\freebsd\bin\</userinput>
<prompt>C:\&gt;</prompt> <userinput>xcopy /s e:\manpages c:\freebsd\manpages\</userinput></screen>
	    
      <para>Assuming that <devicename>C:</devicename> is where you have free
	space and <devicename>E:</devicename> is where your CDROM is
	mounted.</para>
	  
      <para>For as many <abbrev>DISTS</abbrev> you wish to install from MS-DOS
	(and you have free space for), install each one under
	<filename>c:\freebsd</filename> &mdash; the <literal>BIN</literal> dist
	is only the minimal requirement.</para>
    </sect2>
	
    <sect2>
      <title>Before installing from QIC/SCSI Tape</title>
      
      <para>Installing from tape is probably the easiest method, short of an
	on-line install using FTP or a CDROM install.  The installation
	program expects the files to be simply tar'ed onto the tape, so after
	getting all of the files for distribution you are interested in,
	simply tar them onto the tape with a command like:</para>
      
      <screen>&prompt.root; <userinput>cd /freebsd/distdir</userinput>
&prompt.root; <userinput>tar cvf /dev/rwt0 dist1 ... dist2</userinput></screen>
	    
      <para>When you go to do the installation, you should also make sure that
	you leave enough room in some temporary directory (which you will be
	allowed to choose) to accommodate the <emphasis>full</emphasis>
	contents of the tape you have created. Due to the non-random access
	nature of tapes, this method of installation requires quite a bit of
	temporary storage.  You should expect to require as much temporary
	storage as you have stuff written on tape.</para>
	  
      <note>
	<para>When going to do the installation, the tape must be in the drive
	  <emphasis>before</emphasis> booting from the boot floppy. The
	  installation probe may otherwise fail to find it.</para>
      </note>
    </sect2>
	
    <sect2>
      <title>Before installing over a network</title>
      
      <para>You can do network installations over 3 types of communications
	links:</para>
	  
      <variablelist>
	<varlistentry>
	  <term>Serial port</term>

	  <listitem>
	    <para>SLIP or PPP</para>
	  </listitem>
	</varlistentry>
	
	<varlistentry>
	  <term>Parallel port</term>
	  
	  <listitem>
	    <para>PLIP (laplink cable)</para>
	  </listitem>
	</varlistentry>
	
	<varlistentry>
	  <term>Ethernet</term>
	  
	  <listitem>
	    <para>A standard ethernet controller (includes some
	      PCMCIA).</para>
	  </listitem>
	</varlistentry>
      </variablelist>
      
      <para>SLIP support is rather primitive, and limited primarily to
	hard-wired links, such as a serial cable running between a laptop
	computer and another computer.  The link should be hard-wired as the
	SLIP installation does not currently offer a dialing capability; that
	facility is provided with the PPP utility, which should be used in
	preference to SLIP whenever possible.</para>
	  
      <para>If you are using a modem, then PPP is almost certainly your only
	choice.  Make sure that you have your service provider's information
	handy as you will need to know it fairly soon in the installation
	process.  You will need to know how to dial your ISP using the
	&ldquo;AT commands&rdquo; specific to your modem, as the PPP dialer
	provides only a very simple terminal emulator.  If you are using PAP or
	CHAP, you will need to type the necessary <command>set
	  authname</command> and <command>set authkey</command> commands
	before typing <command>term</command>. Refer to the user-ppp <link
	  linkend="userppp">handbook</link> and <ulink
	  URL="../FAQ/userppp.html">FAQ</ulink> entries for further
	information.  If you have problems, logging can be directed to the
	screen using the command <command>set log local ...</command>.</para>
	  
      <para>If a hard-wired connection to another FreeBSD (2.0R or later)
	machine is available, you might also consider installing over a
	&ldquo;laplink&rdquo; parallel port cable.  The data rate over the
	parallel port is much higher than what is typically possible over a
	serial line (up to 50k/sec), thus resulting in a quicker
	installation.</para>
      
      <para>Finally, for the fastest possible network installation, an
	ethernet adaptor is always a good choice! FreeBSD supports most common
	PC ethernet cards, a table of supported cards (and their required
	settings) is provided in <link linkend="install-hw" >Supported
	  Hardware</link>.  If you are using one of the supported PCMCIA
	ethernet cards, also be sure that it is plugged in
	<emphasis>before</emphasis> the laptop is powered on! FreeBSD does
	not, unfortunately, currently support hot insertion of PCMCIA cards
	during installation.</para>
	  
      <para>You will also need to know your IP address on the network, the
	netmask value for your address class, and the name of your machine.
	Your system administrator can tell you which values to use for your
	particular network setup.  If you will be referring to other hosts by
	name rather than IP address, you will also need a name server and
	possibly the address of a gateway (if you are using PPP, it is your
	provider's IP address) to use in talking to it.  If you do not know
	the answers to all or most of these questions, then you should really
	probably talk to your system administrator <emphasis>first</emphasis>
	before trying this type of installation.</para>
	  
      <para>Once you have a network link of some sort working, the
	installation can continue over NFS or FTP.</para>
	  
      <sect3>
	<title>Preparing for NFS installation</title>
	
	<para>NFS installation is fairly straight-forward: Simply copy the
	  FreeBSD distribution files you want onto a server somewhere and then
	  point the NFS media selection at it.</para>
	    
	<para>If this server supports only &ldquo;privileged port&rdquo;
	  access (as is generally the default for Sun workstations), you will
	  need to set this option in the Options menu before installation can
	  proceed.</para>
	    
	<para>If you have a poor quality ethernet card which suffers from very
	  slow transfer rates, you may also wish to toggle the appropriate
	  Options flag.</para>
	    
	<para>In order for NFS installation to work, the server must support
	  subdir mounts, e.g., if your FreeBSD &rel.current; distribution
	  directory lives on:
	  <filename>ziggy:/usr/archive/stuff/FreeBSD</filename> Then
	  <hostid>ziggy</hostid> will have to allow the direct mounting of
	  <filename>/usr/archive/stuff/FreeBSD</filename>, not just
	  <filename>/usr</filename> or
	  <filename>/usr/archive/stuff</filename>.</para>
	    
	<para>In FreeBSD's <filename>/etc/exports</filename> file, this is
	  controlled by the <option>-alldirs</option> option.  Other NFS
	  servers may have different conventions.  If you are getting
	  <errortype>Permission Denied</errortype> messages from the server
	  then it is likely that you do not have this enabled properly.</para>
      </sect3>
      
      <sect3>
	<title>Preparing for FTP Installation</title>
	
	<para>FTP installation may be done from any mirror site containing a
	  reasonably up-to-date version of FreeBSD &rel.current;.  A full menu
	  of reasonable choices from almost anywhere in the world is provided
	  by the FTP site menu.</para>
	    
	<para>If you are installing from some other FTP site not listed in
	  this menu, or you are having troubles getting your name server
	  configured properly, you can also specify your own URL by selecting
	  the &ldquo;Other&rdquo; choice in that menu.  A URL can also be a
	  direct IP address, so the following would work in the absence of a
	  name server:</para>
	    
	<screen><userinput>ftp://165.113.121.81/pub/FreeBSD/&rel.current;-RELEASE</userinput></screen>
	      
	<para>There are two FTP installation modes you can use:</para>
		    
	<variablelist>
	  <varlistentry>
	    <term>FTP Active</term>

	    <listitem>
	      <para>For all FTP transfers, use &ldquo;Active&rdquo; mode.
		This will not work through firewalls, but will often work with
		older ftp servers that do not support passive mode. If your
		connection hangs with passive mode (the default), try
		active!</para>
	    </listitem>
	  </varlistentry>
	  
	  <varlistentry>
	    <term>FTP Passive</term>
	    
	    <listitem>
	      <para>For all FTP transfers, use &ldquo;Passive&rdquo; mode.
		This allows the user to pass through firewalls that do not
		allow incoming connections on random port addresses.</para>
	    </listitem>
	  </varlistentry>
	</variablelist>
	
	<note>
	  <para>Active and passive modes are not the same as a
	    &ldquo;proxy&rdquo; connection, where a proxy FTP server is
	    listening and forwarding FTP requests!</para>
	</note>
	
	<para>For a proxy FTP server, you should usually give name of the
	  server you really want as a part of the username, after an @-sign.
	  The proxy server then 'fakes' the real server.  An example: Say you
	  want to install from <hostid role="fqdn">ftp.FreeBSD.org</hostid>,
	  using the proxy FTP server <hostid role="fqdn">foo.bar.com</hostid>,
	  listening on port 1234.</para>
	    
	<para>In this case, you go to the options menu, set the FTP username
	  to ftp@ftp.FreeBSD.org, and the password to your e-mail address.  As
	  your installation media, you specify FTP (or passive FTP, if the
	  proxy support it), and the URL
	  <literal>ftp://foo.bar.com:1234/pub/FreeBSD </literal></para>

	<para><filename>/pub/FreeBSD</filename> from <hostid
	    role="fqdn">ftp.FreeBSD.org</hostid> is proxied under <hostid
	    role="fqdn">foo.bar.com</hostid>, allowing you to install from
	  <emphasis>that</emphasis> machine (which fetch the files from
	  <hostid role="fqdn">ftp.FreeBSD.org</hostid> as your installation
	  requests them).</para>
      </sect3>
    </sect2>
  </sect1>
  
  <sect1>
    <title>Installing FreeBSD</title>
    
    <para>Once you have taken note of the appropriate preinstallation steps,
      you should be able to install FreeBSD without any further
      trouble.</para>
	
    <para>Should this not be true, then you may wish to go back and re-read
      the relevant preparation section above for the installation media type
      you are trying to use, perhaps there is a helpful hint there that you
      missed the first time? If you are having hardware trouble, or FreeBSD
      refuses to boot at all, read the Hardware Guide provided on the boot
      floppy for a list of possible solutions.</para>
	
    <para>The FreeBSD boot floppies contain all the on-line documentation you
      should need to be able to navigate through an installation and if it
      does not then we would like to know what you found most confusing.  Send
      your comments to the &a.doc;.  It is the objective of the FreeBSD
      installation program (sysinstall) to be self-documenting enough that
      painful &ldquo;step-by-step&rdquo; guides are no longer necessary.  It
      may take us a little while to reach that objective, but that is the
      objective!</para>
	
    <para>Meanwhile, you may also find the following &ldquo;typical
      installation sequence&rdquo; to be helpful:</para>
	
    <orderedlist>
      <listitem>
	<para>Boot the <filename>kern.flp</filename> floppy and, when asked,
	  remove it and insert the <filename>mfsroot.flp</filename> floppy and
	  hit return.  After a boot sequence which can take anywhere from 30
	  seconds to 3 minutes, depending on your hardware, you should be
	  presented with a menu of initial choices.  If the
	  <filename>kern.flp</filename> floppy does not boot at all, or the
	  boot hangs at some stage, go read the Q&amp;A section of the
	  Hardware Guide for possible causes.</para>
      </listitem>
	    
      <listitem>
	<para>Press F1.  You should see some basic usage instructions on the
	  menu system and general navigation.  If you have not used this menu
	  system before then <emphasis>please</emphasis> read this
	  thoroughly!</para>
      </listitem>
	    
      <listitem>
	<para>Select the Options item and set any special preferences you may
	  have.</para>
      </listitem>
	    
      <listitem>
	<para>Select a Novice, Custom or Express install, depending on whether
	  or not you would like the installation to help you through a typical
	  installation, give you a high degree of control over each step of
	  the installation or simply whizz through it (using reasonable
	  defaults when possible) as fast as possible.  If you have never used
	  FreeBSD before then the Novice installation method is most
	  recommended.</para>
      </listitem>
	    
      <listitem>
	<para>The final configuration menu choice allows you to further
	  configure your FreeBSD installation by giving you menu-driven access
	  to various system defaults.  Some items, like networking, may be
	  especially important if you did a CDROM/Tape/Floppy installation and
	  have not yet configured your network interfaces (assuming you have
	  any).  Properly configuring such interfaces here will allow FreeBSD
	  to come up on the network when you first reboot from the hard
	  disk.</para>
      </listitem>
    </orderedlist>
  </sect1>
  
  <sect1>
    <title>MS-DOS User's Questions and Answers</title>
    
    <para>Many FreeBSD users wish to install FreeBSD on PCs inhabited by
      MS-DOS.  Here are some commonly asked questions about installing FreeBSD
      on such systems.</para>
	
    <para><emphasis>Help! I have no space! Do I need to delete everything
	first?</emphasis></para>
    
    <para>If your machine is already running MS-DOS and has little or no free
      space available for FreeBSD's installation, all is not lost! You may
      find the FIPS utility, provided in the <filename>tools</filename>
      directory on the FreeBSD CDROM or on the various FreeBSD ftp sites, to
      be quite useful.</para>
	
    <para>FIPS allows you to split an existing MS-DOS partition into two
      pieces, preserving the original partition and allowing you to install
      onto the second free piece.  You first defragment your MS-DOS partition,
      using the DOS 6.xx DEFRAG utility or the Norton Disk tools, then run
      FIPS.  It will prompt you for the rest of the information it needs.
      Afterwards, you can reboot and install FreeBSD on the new free slice.
      See the <emphasis>Distributions</emphasis> menu for an estimation of how
      much free space you will need for the kind of installation you
      want.</para>
	
    <para><emphasis>Can I use compressed MS-DOS filesystems from
	FreeBSD?</emphasis></para>
	
    <para>No.  If you are using a utility such as Stacker(tm) or
      DoubleSpace(tm), FreeBSD will only be able to use whatever portion of
      the filesystem you leave uncompressed.  The rest of the filesystem will
      show up as one large file (the stacked/dblspaced file!).  <emphasis>Do
	not remove that file!</emphasis> You will probably regret it
      greatly!</para>
	
    <para>It is probably better to create another uncompressed MS-DOS primary
      partition and use this for communications between MS-DOS and
      FreeBSD.</para>
	
    <para><emphasis>Can I mount my MS-DOS extended
	partitions?</emphasis></para>
	
    <para>Yes.  DOS extended partitions are mapped in at the end of the other
      &ldquo;slices&rdquo; in FreeBSD, e.g.  your <devicename>D:</devicename>
      drive might be <filename>/dev/da0s5</filename>, your
      <devicename>E:</devicename> drive <filename>/dev/da0s6</filename>, and
      so on.  This example assumes, of course, that your extended partition is
      on SCSI drive 0.  For IDE drives, substitute <filename>wd</filename> for
      <filename>da</filename> appropriately.  You otherwise mount extended
      partitions exactly like you would mount any other DOS drive,
      e.g.:</para>
	
    <screen>&prompt.root; <userinput>mount -t msdos /dev/da0s5 /dos_d</userinput></screen>
  </sect1>
</chapter>

<!-- 
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../handbook.sgml" "part" "chapter")
     End:
-->

