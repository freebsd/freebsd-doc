# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR The FreeBSD Project
# This file is distributed under the same license as the FreeBSD Documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: FreeBSD Documentation VERSION\n"
"POT-Creation-Date: 2024-09-14 14:59-0300\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: YAML Front Matter: description
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1
#, no-wrap
msgid "Virtualization software allows multiple operating systems to run simultaneously on the same computer"
msgstr ""

#. type: YAML Front Matter: part
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1
#, no-wrap
msgid "Part III. System Administration"
msgstr ""

#. type: YAML Front Matter: title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1
#, no-wrap
msgid "Chapter 24. Virtualization"
msgstr ""

#. type: Title =
#: documentation/content/en/books/handbook/virtualization/_index.adoc:14
#, no-wrap
msgid "Virtualization"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:52
#, no-wrap
msgid "Synopsis"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:56
msgid ""
"Virtualization software allows multiple operating systems to run "
"simultaneously on the same computer.  Such software systems for PCs often "
"involve a host operating system which runs the virtualization software and "
"supports any number of guest operating systems."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:58
msgid "After reading this chapter, you will know:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:60
msgid ""
"The difference between a host operating system and a guest operating system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:61
msgid "How to install FreeBSD on the following virtualization platforms:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:62
msgid "Parallels Desktop(Apple(R) macOS(R))"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:63
msgid "VMware Fusion(Apple(R) macOS(R))"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:64
msgid ""
"VirtualBox(TM)(Microsoft(R) Windows(R), Intel(R)-based Apple(R) macOS(R), "
"Linux)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:65
msgid "bhyve(FreeBSD)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:66
msgid "How to tune a FreeBSD system for best performance under virtualization."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:68
msgid "Before reading this chapter, you should:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:70
msgid "Understand the crossref:basics[basics,basics of UNIX(R) and FreeBSD]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:71
msgid "Know how to crossref:bsdinstall[bsdinstall,install FreeBSD]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:72
msgid ""
"Know how to crossref:advanced-networking[advanced-networking,set up a "
"network connection]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:73
msgid ""
"Know how to crossref:ports[ports,install additional third-party software]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:75
#, no-wrap
msgid "FreeBSD as a Guest on Parallels Desktop for macOS(R)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:80
msgid ""
"Parallels Desktop for Mac(R) is a commercial software product available for "
"Apple(R) Mac(R) computers running macOS(R) 10.14.6 or higher.  FreeBSD is a "
"fully supported guest operating system.  Once Parallels has been installed "
"on macOS(R), the user must configure a virtual machine and then install the "
"desired guest operating system."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:82
#, no-wrap
msgid "Installing FreeBSD on Parallels Desktop on Mac(R)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:85
msgid ""
"The first step in installing FreeBSD on Parallels is to create a new virtual "
"machine for installing FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:87
msgid ""
"Choose menu:Install Windows or another OS from a DVD or image file[] and "
"proceed."
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:88
#, no-wrap
msgid "Parallels setup wizard showing Install Windows or another OS from a DVD or image file chosen"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:88
#, no-wrap
msgid "parallels-freebsd1.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:91
msgid "Select the FreeBSD image file."
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:92
#, no-wrap
msgid "Parallels setup wizard showing FreeBSD image file selected"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:92
#, no-wrap
msgid "parallels-freebsd2.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:95
msgid "Choose menu:Other as operating system[]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:99
msgid "Choosing FreeBSD will cause boot error on startup."
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:101
#, no-wrap
msgid "Parallels setup wizard showing Other selected as operating system"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:101
#, no-wrap
msgid "parallels-freebsd3.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:104
msgid ""
"Name the virtual machine and check menu:Customize settings before "
"installation[]"
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:105
#, no-wrap
msgid "Parallels setup wizard showing the checkbox checked for customizing settings before installation"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:105
#, no-wrap
msgid "parallels-freebsd4.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:109
msgid ""
"When the configuration window pops up, go to menu:Hardware[] tab, choose "
"menu:Boot order[], and click menu:Advanced[].  Then, choose *EFI 64-bit* as "
"menu:BIOS[]."
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:110
#, no-wrap
msgid "Parallels setup wizard showing EFI 64-bit chosen as BIOS"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:110
#, no-wrap
msgid "parallels-freebsd5.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:113
msgid ""
"Click menu:OK[], close the configuration window, and click menu:Continue[]."
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:114
#, no-wrap
msgid "Parallels setup wizard showing the summary of the new virtual machine"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:114
#, no-wrap
msgid "parallels-freebsd6.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:118
msgid ""
"The virtual machine will automatically boot.  Install FreeBSD following the "
"general steps."
msgstr ""

#. type: Positional ($1) AttributeList argument for macro 'image'
#: documentation/content/en/books/handbook/virtualization/_index.adoc:119
#, no-wrap
msgid "FreeBSD booted on Parallels"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:119
#, no-wrap
msgid "parallels-freebsd7.png"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:122
#, no-wrap
msgid "Configuring FreeBSD on Parallels"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:125
msgid ""
"After FreeBSD has been successfully installed on macOS(R) X with Parallels, "
"there are a number of configuration steps that can be taken to optimize the "
"system for virtualized operation."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:128
#: documentation/content/en/books/handbook/virtualization/_index.adoc:241
msgid "Set Boot Loader Variables"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:131
msgid ""
"The most important step is to reduce the `kern.hz` tunable to reduce the CPU "
"utilization of FreeBSD under the Parallels environment.  This is "
"accomplished by adding the following line to [.filename]#/boot/loader.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:135
#: documentation/content/en/books/handbook/virtualization/_index.adoc:248
#, no-wrap
msgid "kern.hz=100\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:139
msgid ""
"Without this setting, an idle FreeBSD Parallels guest will use roughly 15% "
"of the CPU of a single processor iMac(R).  After this change the usage will "
"be closer to 5%."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:141
msgid ""
"If installing FreeBSD 14.0 or later, and CPU utilization is still high, add "
"the following additional line to [.filename]#/boot/loader.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:145
#, no-wrap
msgid "debug.acpi.disabled=\"ged\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:147
#: documentation/content/en/books/handbook/virtualization/_index.adoc:253
msgid "Create a New Kernel Configuration File"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:150
msgid ""
"All SCSI, FireWire, and USB device drivers can be removed from a custom "
"kernel configuration file.  Parallels provides a virtual network adapter "
"used by the man:ed[4] driver, so all network devices except for man:ed[4] "
"and man:miibus[4] can be removed from the kernel."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:151
#: documentation/content/en/books/handbook/virtualization/_index.adoc:257
msgid "Configure Networking"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:155
msgid ""
"The most basic networking setup uses DHCP to connect the virtual machine to "
"the same local area network as the host Mac(R).  This can be accomplished by "
"adding `ifconfig_ed0=\"DHCP\"` to [.filename]#/etc/rc.conf#.  More advanced "
"networking setups are described in crossref:advanced-networking[advanced-"
"networking,Advanced Networking]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:157
#, no-wrap
msgid "FreeBSD as a Guest on VMware Fusion for macOS(R)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:162
msgid ""
"VMware Fusion for Mac(R) is a commercial software product available for "
"Apple(R) Mac(R) computers running macOS(R) 12 or higher.  FreeBSD is a fully "
"supported guest operating system.  Once VMware Fusion has been installed on "
"macOS(R), the user can configure a virtual machine and then install the "
"desired guest operating system."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:164
#, no-wrap
msgid "Installing FreeBSD on VMware Fusion"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:168
msgid ""
"The first step is to start VMware Fusion which will load the Virtual Machine "
"Library.  Click [.guimenuitem]#+->New# to create the virtual machine:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:169
#, no-wrap
msgid "vmware-freebsd01.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:173
msgid ""
"This will load the New Virtual Machine Assistant.  Choose [."
"guimenuitem]#Create a custom virtual machine# and click [."
"guimenuitem]#Continue# to proceed:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:174
#, no-wrap
msgid "vmware-freebsd02.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:177
msgid ""
"Select [.guimenuitem]#Other# as the [.guimenuitem]#Operating System# and "
"either [.guimenuitem]#FreeBSD X# or [.guimenuitem]#FreeBSD X 64-bit#, as the "
"menu:Version[] when prompted:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:178
#, no-wrap
msgid "vmware-freebsd03.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:181
msgid "Choose the firmware(UEFI is recommended):"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:182
#, no-wrap
msgid "vmware-freebsd04.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:185
msgid ""
"Choose [.guimenuitem]#Create a new virtual disk# and click [."
"guimenuitem]#Continue#:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:186
#, no-wrap
msgid "vmware-freebsd05.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:189
msgid "Check the configuration and click [.guimenuitem]#Finish#:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:190
#, no-wrap
msgid "vmware-freebsd06.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:193
msgid ""
"Choose the name of the virtual machine and the directory where it should be "
"saved:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:194
#, no-wrap
msgid "vmware-freebsd07.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:197
msgid ""
"Press command+E to open virtual machine settings and click [.guimenuitem]#CD/"
"DVD#:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:198
#, no-wrap
msgid "vmware-freebsd08.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:201
msgid "Choose FreeBSD ISO image or from a CD/DVD:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:202
#: documentation/content/en/books/handbook/virtualization/_index.adoc:224
#, no-wrap
msgid "vmware-freebsd09.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:205
msgid "Start the virtual machine:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:206
#, no-wrap
msgid "vmware-freebsd10.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:209
msgid "Install FreeBSD as usual:"
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:210
#, no-wrap
msgid "vmware-freebsd11.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:213
msgid ""
"Once the install is complete, the settings of the virtual machine can be "
"modified, such as memory usage and the number of CPUs the virtual machine "
"will have access to:"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:217
msgid ""
"The System Hardware settings of the virtual machine cannot be modified while "
"the virtual machine is running."
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:219
#, no-wrap
msgid "vmware-freebsd12.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:223
msgid ""
"The status of the CD-ROM device.  Normally the CD/DVD/ISO is disconnected "
"from the virtual machine when it is no longer needed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:229
msgid ""
"The last thing to change is how the virtual machine will connect to the "
"network.  To allow connections to the virtual machine from other machines "
"besides the host, choose [.guimenuitem]#Connect directly to the physical "
"network (Bridged)#.  Otherwise, [.guimenuitem]#Share the host's internet "
"connection (NAT)# is preferred so that the virtual machine can have access "
"to the Internet, but the network cannot access the virtual machine."
msgstr ""

#. type: Target for macro image
#: documentation/content/en/books/handbook/virtualization/_index.adoc:230
#, no-wrap
msgid "vmware-freebsd13.png"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:233
msgid ""
"After modifying the settings, boot the newly installed FreeBSD virtual "
"machine."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:235
#, no-wrap
msgid "Configuring FreeBSD on VMware Fusion"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:238
msgid ""
"After FreeBSD has been successfully installed on macOS(R) X with VMware "
"Fusion, there are a number of configuration steps that can be taken to "
"optimize the system for virtualized operation."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:244
msgid ""
"The most important step is to reduce the `kern.hz` tunable to reduce the CPU "
"utilization of FreeBSD under the VMware Fusion environment.  This is "
"accomplished by adding the following line to [.filename]#/boot/loader.conf#:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:252
msgid ""
"Without this setting, an idle FreeBSD VMware Fusion guest will use roughly "
"15% of the CPU of a single processor iMac(R).  After this change, the usage "
"will be closer to 5%."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:256
msgid ""
"All FireWire, and USB device drivers can be removed from a custom kernel "
"configuration file.  VMware Fusion provides a virtual network adapter used "
"by the man:em[4] driver, so all network devices except for man:em[4] can be "
"removed from the kernel."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:261
msgid ""
"The most basic networking setup uses DHCP to connect the virtual machine to "
"the same local area network as the host Mac(R).  This can be accomplished by "
"adding `ifconfig_em0=\"DHCP\"` to [.filename]#/etc/rc.conf#.  More advanced "
"networking setups are described in crossref:advanced-networking[advanced-"
"networking,Advanced Networking]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:263
msgid "Install drivers and open-vm-tools"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:265
msgid "To run FreeBSD smoothly on VMWare, drivers should be installed:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:269
#, no-wrap
msgid "# pkg install xf86-video-vmware xf86-input-vmmouse open-vm-tools\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:272
#, no-wrap
msgid "FreeBSD as a Guest on VirtualBox(TM)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:276
msgid ""
"FreeBSD works well as a guest in VirtualBox(TM).  The virtualization "
"software is available for most common operating systems, including FreeBSD "
"itself."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:278
msgid "The VirtualBox(TM) guest additions provide support for:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:280
msgid "Clipboard sharing."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:281
msgid "Mouse pointer integration."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:282
msgid "Host time synchronization."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:283
msgid "Window scaling."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:284
msgid "Seamless mode."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:288
msgid "These commands are run in the FreeBSD guest."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:292
msgid ""
"First, install the package:emulators/virtualbox-ose-additions[] package or "
"port in the FreeBSD guest.  This will install the port:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:296
#, no-wrap
msgid "# cd /usr/ports/emulators/virtualbox-ose-additions && make install clean\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:299
msgid "Add these lines to [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:304
#, no-wrap
msgid ""
"vboxguest_enable=\"YES\"\n"
"vboxservice_enable=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:307
msgid ""
"If man:ntpd[8] or man:ntpdate[8] is used, disable host time synchronization:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:311
#, no-wrap
msgid "vboxservice_flags=\"--disable-timesync\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:315
msgid ""
"Xorg will automatically recognize the `vboxvideo` driver.  It can also be "
"manually entered in [.filename]#/etc/X11/xorg.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:324
#, no-wrap
msgid ""
"Section \"Device\"\n"
"\tIdentifier \"Card0\"\n"
"\tDriver \"vboxvideo\"\n"
"\tVendorName \"InnoTek Systemberatung GmbH\"\n"
"\tBoardName \"VirtualBox Graphics Adapter\"\n"
"EndSection\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:327
msgid ""
"To use the `vboxmouse` driver, adjust the mouse section in [.filename]#/etc/"
"X11/xorg.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:334
#, no-wrap
msgid ""
"Section \"InputDevice\"\n"
"\tIdentifier \"Mouse0\"\n"
"\tDriver \"vboxmouse\"\n"
"EndSection\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:339
msgid ""
"Shared folders for file transfers between host and VM are accessible by "
"mounting them using `mount_vboxvfs`.  A shared folder can be created on the "
"host using the VirtualBox GUI or via `vboxmanage`.  For example, to create a "
"shared folder called _myshare_ under [.filename]#/mnt/bsdboxshare# for the "
"VM named _BSDBox_, run:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:343
#, no-wrap
msgid "# vboxmanage sharedfolder add 'BSDBox' --name myshare --hostpath /mnt/bsdboxshare\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:347
msgid ""
"Note that the shared folder name must not contain spaces.  Mount the shared "
"folder from within the guest system like this:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:351
#, no-wrap
msgid "# mount_vboxvfs -w myshare /mnt\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:354
#, no-wrap
msgid "FreeBSD as a Host with VirtualBox(TM)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:362
msgid ""
"VirtualBox(TM) is an actively developed, complete virtualization package, "
"that is available for most operating systems including Windows(R), macOS(R), "
"Linux(R) and FreeBSD.  It is equally capable of running Windows(R) or "
"UNIX(R)-like guests.  It is released as open source software, but with "
"closed-source components available in a separate extension pack.  These "
"components include support for USB 2.0 devices.  More information may be "
"found on the http://www.virtualbox.org/wiki/Downloads[Downloads page of the "
"VirtualBox(TM) wiki].  Currently, these extensions are not available for "
"FreeBSD."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:364
#, no-wrap
msgid "Installing VirtualBox(TM)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:368
msgid ""
"VirtualBox(TM) is available as a FreeBSD package or port in package:"
"emulators/virtualbox-ose[].  The port can be installed using these commands:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:373
#, no-wrap
msgid ""
"# cd /usr/ports/emulators/virtualbox-ose\n"
"# make install clean\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:378
msgid ""
"One useful option in the port's configuration menu is the `GuestAdditions` "
"suite of programs.  These provide a number of useful features in guest "
"operating systems, like mouse pointer integration (allowing the mouse to be "
"shared between host and guest without the need to press a special keyboard "
"shortcut to switch) and faster video rendering, especially in Windows(R) "
"guests.  The guest additions are available in the menu:Devices[] menu, after "
"the installation of the guest is finished."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:381
msgid ""
"A few configuration changes are needed before VirtualBox(TM) is started for "
"the first time.  The port installs a kernel module in [.filename]#/boot/"
"modules# which must be loaded into the running kernel:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:385
#, no-wrap
msgid "# kldload vboxdrv\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:388
msgid ""
"To ensure the module is always loaded after a reboot, add this line to [."
"filename]#/boot/loader.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:392
#, no-wrap
msgid "vboxdrv_load=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:395
msgid ""
"To use the kernel modules that allow bridged or host-only networking, add "
"this line to [.filename]#/etc/rc.conf# and reboot the computer:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:399
#, no-wrap
msgid "vboxnet_enable=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:404
msgid ""
"The `vboxusers` group is created during installation of VirtualBox(TM).  All "
"users that need access to VirtualBox(TM) will have to be added as members of "
"this group.  `pw` can be used to add new members:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:408
#, no-wrap
msgid "# pw groupmod vboxusers -m yourusername\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:411
msgid ""
"The default permissions for [.filename]#/dev/vboxnetctl# are restrictive and "
"need to be changed for bridged networking:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:416
#, no-wrap
msgid ""
"# chown root:vboxusers /dev/vboxnetctl\n"
"# chmod 0660 /dev/vboxnetctl\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:419
msgid ""
"To make this permissions change permanent, add these lines to [.filename]#/"
"etc/devfs.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:424
#, no-wrap
msgid ""
"own     vboxnetctl root:vboxusers\n"
"perm    vboxnetctl 0660\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:427
msgid "To launch VirtualBox(TM), type from an Xorg session:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:431
#, no-wrap
msgid "% VirtualBox\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:435
msgid ""
"For more information on configuring and using VirtualBox(TM), refer to the "
"http://www.virtualbox.org[official website].  For FreeBSD-specific "
"information and troubleshooting instructions, refer to the http://wiki."
"FreeBSD.org/VirtualBox[relevant page in the FreeBSD wiki]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:437
#, no-wrap
msgid "VirtualBox(TM) USB Support"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:441
msgid ""
"VirtualBox(TM) can be configured to pass USB devices through to the guest "
"operating system.  The host controller of the OSE version is limited to "
"emulating USB 1.1 devices until the extension pack supporting USB 2.0 and "
"3.0 devices becomes available on FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:443
msgid ""
"For VirtualBox(TM) to be aware of USB devices attached to the machine, the "
"user needs to be a member of the `operator` group."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:447
#, no-wrap
msgid "# pw groupmod operator -m yourusername\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:450
msgid ""
"Then, add the following to [.filename]#/etc/devfs.rules#, or create this "
"file if it does not exist yet:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:455
#, no-wrap
msgid ""
"[system=10]\n"
"add path 'usb/*' mode 0660 group operator\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:458
msgid ""
"To load these new rules, add the following to [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:462
#, no-wrap
msgid "devfs_system_ruleset=\"system\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:465
msgid "Then, restart devfs:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:469
#: documentation/content/en/books/handbook/virtualization/_index.adoc:497
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1108
#, no-wrap
msgid "# service devfs restart\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:472
msgid ""
"Restart the login session and VirtualBox(TM) for these changes to take "
"effect, and create USB filters as necessary."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:474
#, no-wrap
msgid "VirtualBox(TM) Host DVD/CD Access"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:482
msgid ""
"Access to the host DVD/CD drives from guests is achieved through the sharing "
"of the physical drives.  Within VirtualBox(TM), this is set up from the "
"Storage window in the Settings of the virtual machine.  If needed, create an "
"empty IDECD/DVD device first.  Then choose the Host Drive from the popup "
"menu for the virtual CD/DVD drive selection.  A checkbox labeled "
"`Passthrough` will appear. This allows the virtual machine to use the "
"hardware directly.  For example, audio CDs or the burner will only function "
"if this option is selected."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:486
msgid ""
"In order for users to be able to use VirtualBox(TM)DVD/CD functions, they "
"need access to [.filename]#/dev/xpt0#, [.filename]#/dev/cdN#, and [."
"filename]#/dev/passN#.  This is usually achieved by making the user a member "
"of `operator`.  Permissions to these devices have to be corrected by adding "
"these lines to [.filename]#/etc/devfs.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:492
#, no-wrap
msgid ""
"perm cd* 0660\n"
"perm xpt0 0660\n"
"perm pass* 0660\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:500
#, no-wrap
msgid "FreeBSD as a Host with bhyve"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:506
msgid ""
"The bhyve BSD-licensed hypervisor became part of the base system with "
"FreeBSD 10.0-RELEASE.  This hypervisor supports several guests, including "
"FreeBSD, OpenBSD, many Linux(R) distributions, and Microsoft Windows(R).  By "
"default, bhyve provides access to a serial console and does not emulate a "
"graphical console.  Virtualization offload features of newer CPUs are used "
"to avoid the legacy methods of translating instructions and manually "
"managing memory mappings."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:508
msgid "The bhyve design requires"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:510
msgid "an Intel(R) processor that supports Intel Extended Page Tables (EPT),"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:511
msgid ""
"or an AMD(R) processor that supports AMD Rapid Virtualization Indexing "
"(RVI), or Nested Page Tables (NPT),"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:512
msgid "or an ARM(R) aarch64 CPU."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:515
msgid ""
"Only pure ARMv8.0 virtualization is supported on ARM, the Virtualization "
"Host Extensions are not currently used.  Hosting Linux(R) guests or FreeBSD "
"guests with more than one vCPU requires VMX unrestricted mode support (UG)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:517
msgid ""
"The easiest way to tell if an Intel or AMD processor supports bhyve is to "
"run `dmesg` or look in [.filename]#/var/run/dmesg.boot# for the `POPCNT` "
"processor feature flag on the `Features2` line for AMD(R) processors or "
"`EPT` and `UG` on the `VT-x` line for Intel(R) processors."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:519
#, no-wrap
msgid "Preparing the Host"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:523
msgid ""
"The first step to creating a virtual machine in bhyve is configuring the "
"host system.  First, load the bhyve kernel module:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:527
#, no-wrap
msgid "# kldload vmm\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:532
msgid ""
"There are several ways to connect a virtual machine guest to a host's "
"network; one straightforward way to accomplish this is to create a [."
"filename]#tap# interface for the network device in the virtual machine to "
"attach to.  For the network device to participate in the network, also "
"create a bridge interface containing the [.filename]#tap# interface and the "
"physical interface as members.  In this example, the physical interface is "
"_igb0_:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:541
#, no-wrap
msgid ""
"# ifconfig tap0 create\n"
"# sysctl net.link.tap.up_on_open=1\n"
"net.link.tap.up_on_open: 0 -> 1\n"
"# ifconfig bridge0 create\n"
"# ifconfig bridge0 addm igb0 addm tap0\n"
"# ifconfig bridge0 up\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:544
#, no-wrap
msgid "Creating a FreeBSD Guest"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:548
msgid ""
"Create a file to use as the virtual disk for the guest machine.  Specify the "
"size and name of the virtual disk:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:552
#, no-wrap
msgid "# truncate -s 16G guest.img\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:555
msgid "Download an installation image of FreeBSD to install:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:560
#, no-wrap
msgid ""
"# fetch https://download.freebsd.org/releases/ISO-IMAGES/14.0/FreeBSD-14.0-RELEASE-amd64-bootonly.iso\n"
"FreeBSD-14.0-RELEASE-amd64-bootonly.iso                426 MB   16 MBps    22s\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:565
msgid ""
"FreeBSD comes with an example script `vmrun.sh` for running a virtual "
"machine in bhyve.  It will start the virtual machine and run it in a loop, "
"so it will automatically restart if it crashes.  `vmrun.sh` takes several "
"options to control the configuration of the machine, including:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:567
msgid "`-c` controls the number of virtual CPUs,"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:568
msgid "`-m` limits the amount of memory available to the guest,"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:569
msgid "`-t` defines which [.filename]#tap# device to use,"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:570
msgid "`-d` indicates which disk image to use,"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:571
msgid "`-i` tells bhyve to boot from the CD image instead of the disk, and"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:572
msgid "`-I` defines which CD image to use."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:575
msgid ""
"The last parameter is the name of the virtual machine and is used to track "
"the running machines.  The following command lists all available program "
"argument options:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:579
#, no-wrap
msgid "# sh /usr/share/examples/bhyve/vmrun.sh -h\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:582
msgid "This example starts the virtual machine in installation mode:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:587
#, no-wrap
msgid ""
"# sh /usr/share/examples/bhyve/vmrun.sh -c 1 -m 1024M -t tap0 -d guest.img \\\n"
"     -i -I FreeBSD-14.0-RELEASE-amd64-bootonly.iso guestname\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:591
msgid ""
"The virtual machine will boot and start the installer.  After installing a "
"system in the virtual machine, when the system asks about dropping into a "
"shell at the end of the installation, choose btn:[Yes]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:596
msgid ""
"Reboot the virtual machine.  While rebooting the virtual machine causes "
"bhyve to exit, the [.filename]#vmrun.sh# script runs `bhyve` in a loop and "
"will automatically restart it.  When this happens, choose the reboot option "
"from the boot loader menu to escape the loop.  Now the guest can be started "
"from the virtual disk:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:600
#, no-wrap
msgid "# sh /usr/share/examples/bhyve/vmrun.sh -c 4 -m 1024M -t tap0 -d guest.img guestname\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:603
#, no-wrap
msgid "Creating a Linux(R) Guest"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:606
msgid ""
"Linux guests can be booted either like any other regular crossref:"
"virtualization[virtualization-bhyve-uefi,\"UEFI-based guest\"] virtual "
"machine, or alternatively, you can make use of the package:sysutils/grub2-"
"bhyve[] port."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:608
msgid ""
"To do this, first ensure that the port is installed, then create a file to "
"use as the virtual disk for the guest machine:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:612
#, no-wrap
msgid "# truncate -s 16G linux.img\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:615
msgid ""
"Starting a Linux virtual machine with `grub2-bhyve` is a two-step process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:617
msgid "First a kernel must be loaded, then the guest can be started."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:618
msgid "The Linux(R) kernel is loaded with package:sysutils/grub2-bhyve[]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:620
msgid ""
"Create a [.filename]#device.map# that grub will use to map the virtual "
"devices to the files on the host system:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:625
#, no-wrap
msgid ""
"(hd0) ./linux.img\n"
"(cd0) ./somelinux.iso\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:628
msgid ""
"Use package:sysutils/grub2-bhyve[] to load the Linux(R) kernel from the ISO "
"image:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:632
#, no-wrap
msgid "# grub-bhyve -m device.map -r cd0 -M 1024M linuxguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:637
msgid ""
"This will start grub.  If the installation CD contains a [.filename]#grub."
"cfg#, a menu will be displayed.  If not, the `vmlinuz` and `initrd` files "
"must be located and loaded manually:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:648
#, no-wrap
msgid ""
"grub> ls\n"
"(hd0) (cd0) (cd0,msdos1) (host)\n"
"grub> ls (cd0)/isolinux\n"
"boot.cat boot.msg grub.conf initrd.img isolinux.bin isolinux.cfg memtest\n"
"splash.jpg TRANS.TBL vesamenu.c32 vmlinuz\n"
"grub> linux (cd0)/isolinux/vmlinuz\n"
"grub> initrd (cd0)/isolinux/initrd.img\n"
"grub> boot\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:651
msgid "Now that the Linux(R) kernel is loaded, the guest can be started:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:657
#, no-wrap
msgid ""
"# bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,tap0 \\\n"
"    -s 3:0,virtio-blk,./linux.img -s 4:0,ahci-cd,./somelinux.iso \\\n"
"    -l com1,stdio -c 4 -m 1024M linuxguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:663
msgid ""
"The system will boot and start the installer.  After installing a system in "
"the virtual machine, reboot the virtual machine.  This will cause bhyve to "
"exit.  The instance of the virtual machine needs to be destroyed before it "
"can be started again:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:667
#: documentation/content/en/books/handbook/virtualization/_index.adoc:703
#, no-wrap
msgid "# bhyvectl --destroy --vm=linuxguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:671
msgid ""
"Now the guest can be started directly from the virtual disk.  Load the "
"kernel:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:685
#, no-wrap
msgid ""
"# grub-bhyve -m device.map -r hd0,msdos1 -M 1024M linuxguest\n"
"grub> ls\n"
"(hd0) (hd0,msdos2) (hd0,msdos1) (cd0) (cd0,msdos1) (host)\n"
"(lvm/VolGroup-lv_swap) (lvm/VolGroup-lv_root)\n"
"grub> ls (hd0,msdos1)/\n"
"lost+found/ grub/ efi/ System.map-2.6.32-431.el6.x86_64 config-2.6.32-431.el6.x\n"
"86_64 symvers-2.6.32-431.el6.x86_64.gz vmlinuz-2.6.32-431.el6.x86_64\n"
"initramfs-2.6.32-431.el6.x86_64.img\n"
"grub> linux (hd0,msdos1)/vmlinuz-2.6.32-431.el6.x86_64 root=/dev/mapper/VolGroup-lv_root\n"
"grub> initrd (hd0,msdos1)/initramfs-2.6.32-431.el6.x86_64.img\n"
"grub> boot\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:688
msgid "Boot the virtual machine:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:693
#, no-wrap
msgid ""
"# bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,tap0 \\\n"
"    -s 3:0,virtio-blk,./linux.img -l com1,stdio -c 4 -m 1024M linuxguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:699
msgid ""
"Linux(R) will now boot in the virtual machine and eventually present you "
"with the login prompt.  Login and use the virtual machine.  When you are "
"finished, reboot the virtual machine to exit bhyve.  Destroy the virtual "
"machine instance:"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:706
#, no-wrap
msgid "Booting bhyve Virtual Machines with UEFI Firmware"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:710
msgid ""
"In addition to `bhyveload` and `grub-bhyve`, the bhyve hypervisor can also "
"boot virtual machines using the UEFI firmware.  This option may support "
"guest operating systems that are not supported by the other loaders."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:713
msgid ""
"To make use of the UEFI support in bhyve, first obtain the UEFI firmware "
"images.  This can be done by installing package:sysutils/bhyve-firmware[] "
"port or package."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:716
msgid ""
"With the firmware in place, add the flags `-l bootrom,_/path/to/firmware_` "
"to your bhyve command line.  The actual bhyve command may look like this:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:724
#, no-wrap
msgid ""
"# bhyve -AHP -s 0:0,hostbridge -s 1:0,lpc \\\n"
"  \t-s 2:0,virtio-net,tap1 -s 3:0,virtio-blk,./disk.img \\\n"
"\t-s 4:0,ahci-cd,./install.iso -c 4 -m 1024M \\\n"
"\t-l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \\\n"
"\tguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:729
msgid ""
"To allow a guest to store UEFI variables, you can use a variables file "
"appended to the `-l` flag.  Note that bhyve will write guest modifications "
"to the given variables file.  Therefore, be sure to first create a per-guest-"
"copy of the variables template file:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:733
#, no-wrap
msgid "# cp /usr/local/share/uefi-firmware/BHYVE_UEFI_VARS.fd /path/to/vm-image/BHYVE_UEFI_VARS.fd\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:736
msgid "Then, add that variables file into your bhyve arguments:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:744
#, no-wrap
msgid ""
"# bhyve -AHP -s 0:0,hostbridge -s 1:0,lpc \\\n"
"  \t-s 2:0,virtio-net,tap1 -s 3:0,virtio-blk,./disk.img \\\n"
"\t-s 4:0,ahci-cd,./install.iso -c 4 -m 1024M \\\n"
"\t-l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd,/path/to/vm-image/BHYVE_UEFI_VARS.fd \\\n"
"\tguest\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:750
msgid ""
"Some Linux distributions require the use of UEFI variables to store the path "
"for their UEFI boot file (using `linux64.efi` or `grubx64.efi` instead of "
"`bootx64.efi`, for example).  It is therefore recommended to use a variables "
"file for Linux virtual machines to avoid having to manually alter the boot "
"partition files."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:753
msgid ""
"To view or modify the variables file contents, use man:efivar[8] from the "
"host."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:755
msgid ""
"package:sysutils/bhyve-firmware[] also contains a CSM-enabled firmware, to "
"boot guests with no UEFI support in legacy BIOS mode:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:763
#, no-wrap
msgid ""
"# bhyve -AHP -s 0:0,hostbridge -s 1:0,lpc \\\n"
"  \t-s 2:0,virtio-net,tap1 -s 3:0,virtio-blk,./disk.img \\\n"
"\t-s 4:0,ahci-cd,./install.iso -c 4 -m 1024M \\\n"
"\t-l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI_CSM.fd \\\n"
"\tguest\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:766
#, no-wrap
msgid "Graphical UEFI Framebuffer for bhyve Guests"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:769
msgid ""
"The UEFI firmware support is particularly useful with predominantly "
"graphical guest operating systems such as Microsoft Windows(R)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:774
msgid ""
"Support for the UEFI-GOP framebuffer may also be enabled with the `-s 29,"
"fbuf,tcp=_0.0.0.0:5900_` flags.  The framebuffer resolution may be "
"configured with `w=_800_` and `h=_600_`, and bhyve can be instructed to wait "
"for a VNC connection before booting the guest by adding `wait`.  The "
"framebuffer may be accessed from the host or over the network via the VNC "
"protocol.  Additionally, `-s 30,xhci,tablet` can be added to achieve precise "
"mouse cursor synchronization with the host."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:776
msgid "The resulting bhyve command would look like this:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:786
#, no-wrap
msgid ""
"# bhyve -AHP -s 0:0,hostbridge -s 31:0,lpc \\\n"
"  \t-s 2:0,virtio-net,tap1 -s 3:0,virtio-blk,./disk.img \\\n"
"\t-s 4:0,ahci-cd,./install.iso -c 4 -m 1024M \\\n"
"\t-s 29,fbuf,tcp=0.0.0.0:5900,w=800,h=600,wait \\\n"
"\t-s 30,xhci,tablet \\\n"
"\t-l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \\\n"
"\tguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:789
msgid ""
"Note, in BIOS emulation mode, the framebuffer will cease receiving updates "
"once control is passed from firmware to guest operating system."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:791
#, no-wrap
msgid "Creating a Microsoft Windows(R) Guest"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:795
msgid ""
"Setting up a guest for Windows versions 10 or earlier can be done directly "
"from the original installation media and is a relatively straightforward "
"process.  Aside from minimum resource requirements, running Windows as guest "
"requires"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:797
msgid "wiring virtual machine memory (flag `-w`) and"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:798
msgid "booting with an UEFI bootrom."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:800
msgid ""
"An example for booting a virtual machine guest with a Windows installation "
"ISO:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:814
#, no-wrap
msgid ""
"bhyve \\\n"
"      -c 2 \\\n"
"      -s 0,hostbridge \\\n"
"      -s 3,nvme,windows2016.img \\\n"
"      -s 4,ahci-cd,install.iso \\\n"
"      -s 10,virtio-net,tap0 \\\n"
"      -s 31,lpc \\\n"
"      -s 30,xhci,tablet \\\n"
"      -l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \\\n"
"      -m 8G -H -w \\\n"
"      windows2016\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:817
msgid ""
"Only one or two VCPUs should be used during installation but this number can "
"be increased once Windows is installed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:821
msgid ""
"link:https://github.com/virtio-win/virtio-win-pkg-scripts/blob/master/README."
"md[VirtIO drivers] must be installed to use the defined `virtio-net` network "
"interface.  An alternative is to switch to E1000 (Intel E82545) emulation by "
"changing `virtio-net` to `e1000` in the above command line.  However, "
"performance will be impacted."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:823
#, no-wrap
msgid "Creating a Windows 11 Guest"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:829
msgid ""
"Beginning with Windows 11, Microsoft introduced a hardware requirement for a "
"TPM 2 module.  bhyve supports passing a hardware TPM through to a guest.  "
"The installation media can be modified to disable the relevant hardware "
"checks.  A detailed description for this process can be found on the link:"
"https://wiki.freebsd.org/bhyve/Windows#iso-remaster[FreeBSD Wiki]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:834
msgid ""
"Modifying Windows installation media and running Windows guests without a "
"TPM module are unsupported by the manufacturer.  Consider your application "
"and use case before implementing such approaches."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:837
#, no-wrap
msgid "Using ZFS with bhyve Guests"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:841
msgid ""
"If ZFS is available on the host machine, using ZFS volumes instead of disk "
"image files can provide significant performance benefits for the guest VMs.  "
"A ZFS volume can be created by:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:845
#, no-wrap
msgid "# zfs create -V16G -o volmode=dev zroot/linuxdisk0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:848
msgid "When starting the VM, specify the ZFS volume as the disk drive:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:854
#, no-wrap
msgid ""
"# bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,tap0 \\\n"
"  \t-s3:0,virtio-blk,/dev/zvol/zroot/linuxdisk0 \\\n"
"\t-l com1,stdio -c 4 -m 1024M linuxguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:859
msgid ""
"If you are using ZFS for the host as well as inside a guest, keep in mind "
"the competing memory pressure of both systems caching the virtual machine's "
"contents.  To alleviate this, consider setting the host's ZFS filesystems to "
"use metadata-only cache.  To do this, apply the following settings to ZFS "
"filesystems on the host, replacing `<name>` with the name of the specific "
"zvol dataset name of the virtual machine."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:863
#, no-wrap
msgid "# zfs set primarycache=metadata <name>\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:866
#, no-wrap
msgid "Creating a Virtual Machine Snapshot"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:872
msgid ""
"Modern hypervisors allow their users to create \"snapshots\" of their state; "
"such a snapshot includes a guest's disk, CPU, and memory contents.  A "
"snapshot can usually be taken independent of whether the guest is running or "
"shut down.  One can then reset and return the virtual machine to the precise "
"state when the snapshot was taken."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:874
#, no-wrap
msgid "ZFS Snapshots"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:877
msgid ""
"Using ZFS volumes as the backing storage for a virtual machine enables the "
"snapshotting of the guest's disk. For example:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:881
#, no-wrap
msgid "zfs snapshot zroot/path/to/zvol@snapshot_name\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:886
msgid ""
"Though it is possible to snapshot a ZFS volume this way while the guest is "
"running, keep in mind that the contents of the virtual disk may be in an "
"inconsistent state while the guest is active.  It is therefore recommended "
"to first shutdown or pause the guest before executing this command.  Pausing "
"a guest is not supported by default and needs to be enabled first (see "
"crossref:virtualization[virtualization-bhyve-snapshot-builtin,Memory and CPU "
"Snapshots])"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:891
msgid ""
"Rolling back a ZFS zvol to a snapshot while a virtual machine is using it "
"may corrupt the file system contents and crash the guest.  All unsaved data "
"in the guest will be lost and modifications since the last snapshot may get "
"destroyed."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:894
msgid ""
"A second rollback may be required once the virtual machine is shut down to "
"restore the file system to a useable state.  This in turn will ultimately "
"destroy any changes made after the snapshot."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:897
#, no-wrap
msgid "Memory and CPU Snapshots (Experimental Feature)"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:901
msgid ""
"As of FreeBSD 13, bhyve has an experimental \"snapshot\" feature for dumping "
"a guest's memory and CPU state to a file and then halting the virtual "
"machine.  The guest can be resumed from the snapshot file contents later."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:904
msgid ""
"However, this feature is not enabled by default and requires the system to "
"be rebuilt from source.  See crossref:cutting-edge[updating-src-building, "
"Building from Source] for an in-depth description on the process of "
"compiling the kernel with custom options."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:909
msgid ""
"The functionality is not ready for production use and limited to work for "
"specific virtual machine configurations.  There are multiple limitations:"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:911
msgid "`nvme` and `virtio-blk` storage backends do not work yet"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:912
msgid ""
"snapshots are only supported when the guest uses a single kind of each "
"device, i.e. if there is more than one `ahci-hd` disk attached, snapshot "
"creation will fail"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:913
msgid ""
"additionally, the feature may be reasonably stable on Intel, but it probably "
"won't work on AMD CPUs."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:918
msgid ""
"Make sure the [.filename]#/usr/src# directory is up-to date before taking "
"the following steps. See crossref:cutting-edge[updating-src-obtaining-src, "
"Updating the Source] for the detailed procedure how to do this."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:921
msgid "First, add the following to [.filename]#/etc/src.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:927
#, no-wrap
msgid ""
"WITH_BHYVE_SNAPHOT=yes\n"
"BHYVE_SNAPSHOT=1\n"
"MK_BHYVE_SNAPSHOT=yes\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:932
msgid "If the system was partially or wholly rebuilt, it is recommended to run"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:937
#, no-wrap
msgid ""
"# cd /usr/src\n"
"# make cleanworld\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:940
msgid "before proceeding."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:943
msgid ""
"Then follow the steps outlined in the crossref:cutting-edge[updating-src-"
"quick-start,\"Quick Start section of the Updating FreeBSD from Source\"] "
"chapter to build and install world and kernel."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:945
msgid "To verify successful activation of the snapshot feature, enter"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:949
#, no-wrap
msgid "# bhyvectl --usage\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:953
msgid ""
"and check if the output lists a `--suspend` flag.  If the flag is missing, "
"the feature did not activate correctly."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:955
msgid ""
"Then, you can snapshot and suspend a running virtual machine of your choice:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:959
#, no-wrap
msgid "# bhyvectl --vm=vmname --suspend=/path/to/snapshot/filename\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:965
msgid ""
"Provide an absolute path and filename to `--suspend`.  Otherwise, bhyve will "
"write snapshot data to whichever directory bhyve was started from."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:968
msgid ""
"Make sure to write the snapshot data to a secure directory.  The generated "
"output contains a full memory dump of the guest and may thus contain "
"sensitive data (i.e. passwords)!"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:971
msgid "This creates three files:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:973
msgid "memory snapshot - named like the input to `--suspend`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:974
msgid ""
"kernel file - name like the input to `--suspend` with the suffix [."
"filename]#.kern#"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:975
msgid ""
"metadata - contains meta data about the system state, named with the suffix "
"[.filename]#.meta#"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:977
msgid "To restore a guest from a snapshot, use the `-r` flag with `bhyve`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:981
#, no-wrap
msgid "# bhyve -r /path/to/snapshot/filename\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:985
msgid ""
"Restoring a guest snapshot on a different CPU architecture will not work.  "
"Generally, attempting to restore on a system not identical to the snapshot "
"creator will likely fail."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:987
#, no-wrap
msgid "Jailing bhyve"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:991
msgid ""
"For improved security and separation of virtual machines from the host "
"operating system, it is possible to run bhyve in a jail.  See crossref:"
"jails[,Jails] for an in-depth description of jails and their security "
"benefits."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:993
#, no-wrap
msgid "Creating a Jail for bhyve"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:996
msgid ""
"First, create a jail environment. If using a UFS file system, simply run:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1000
#, no-wrap
msgid "# mkdir -p /jails/bhyve\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1003
msgid "If using a crossref:zfs[,ZFS filesystem], use the following commands:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1008
#, no-wrap
msgid ""
"# zfs create zroot/jails\n"
"# zfs create zroot/jails/bhyve\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1011
msgid "Then create a ZFS zvol for the virtual machine `bhyvevm0`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1016
#, no-wrap
msgid ""
"# zfs create zroot/vms\n"
"# zfs create -V 20G zroot/vms/bhyvevm0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1019
msgid ""
"If not using ZFS, use the following commands to create a disk image file "
"directly in the jail directory structure:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1024
#, no-wrap
msgid ""
"# mkdir /jails/bhyve/vms\n"
"# truncate -s 20G /jails/bhyve/vms/bhyvevm0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1027
msgid ""
"Download a FreeBSD image, preferably a version equal to or older than the "
"host and extract it into the jail directory:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1033
#, no-wrap
msgid ""
"# cd /jails\n"
"# fetch -o base.txz http://ftp.freebsd.org/pub/FreeBSD/releases/amd64/13.2-RELEASE/base.txz\n"
"# tar -C /jails/bhyve -xvf base.txz\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1038
msgid ""
"Running a higher FreeBSD version in a jail than the host is unsupported (i."
"e. running 14.0-RELEASE in a jail, embedded in a 13.2-RELEASE host)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1041
msgid "Next, add a devfs ruleset to [.filename]#/etc/devfs.rules#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1065
#, no-wrap
msgid ""
"[devfsrules_jail_bhyve=100]\n"
"add include $devfsrules_hide_all\n"
"add include $devfsrules_unhide_login\n"
"add path 'urandom' unhide\n"
"add path 'random' unhide\n"
"add path 'crypto' unhide\n"
"add path 'shm' unhide\n"
"add path 'zero' unhide\n"
"add path 'null' unhide\n"
"add path 'mem' unhide\n"
"add path 'vmm' unhide\n"
"add path 'vmm/*' unhide\n"
"add path 'vmm.io' unhide\n"
"add path 'vmm.io/*' unhide\n"
"add path 'nmdmbhyve*' unhide\n"
"add path 'zvol' unhide\n"
"add path 'zvol/zroot' unhide\n"
"add path 'zvol/zroot/vms' unhide\n"
"add path 'zvol/zroot/vms/bhyvevm0' unhide\n"
"add path 'zvol/zroot/vms/bhyvevm1' unhide\n"
"add path 'tap10*' unhide\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1070
msgid ""
"If there's another devfs rule with the numeric ID 100 in your [.filename]#/"
"etc/devfs.rules# file, replace the one in the listing with another yet "
"unused ID number."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1075
msgid ""
"If not using a ZFS filesystem, skip the related zvol rules in [.filename]#/"
"etc/devfs.rules#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1083
#, no-wrap
msgid ""
"add path 'zvol' unhide\n"
"add path 'zvol/zroot' unhide\n"
"add path 'zvol/zroot/vms' unhide\n"
"add path 'zvol/zroot/vms/bhyvevm0' unhide\n"
"add path 'zvol/zroot/vms/bhyvevm1' unhide\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1087
msgid "These rules will cause bhyve to"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1089
msgid ""
"create a virtual machine with disk volumes called `bhyvevm0` and `bhyvevm1`,"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1091
msgid ""
"use [.filename]#tap# network interfaces with the name prefix `tap10`.  That "
"means, valid interface names will be `tap10`, `tap100`, `tap101`, ... "
"`tap109`, `tap1000` and so on."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1093
msgid ""
"Limiting the access to a subset of possible [.filename]#tap# interface names "
"will prevent the jail (and thus bhyve) from seeing [.filename]#tap# "
"interfaces of the host and other jails."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1094
msgid ""
"use [.filename]#nmdm# devices prefixed with \"bhyve\", i.e. [.filename]#/dev/"
"nmdmbhyve0#."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1096
msgid ""
"Those rules can be expanded and varied with different guest and interface "
"names as desired."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1101
msgid ""
"If you intend to use bhyve on the host as well as in a one or more jails, "
"remember that [.filename]#tap# and [.filename]#nmdm# interface names will "
"operate in a shared environment.  For example, you can use [.filename]#/dev/"
"nmdmbhyve0# only either for bhyve on the host or in a jail."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1104
msgid "Restart devfs for the changes to be loaded:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1112
msgid ""
"Then add a definition for your new jail into [.filename]#/etc/jail.conf# or "
"[.filename]#/etc/jail.conf.d#.  Replace the interface number [."
"filename]#$if# and IP address with your personal variations."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1113
#, no-wrap
msgid "Using NAT or routed traffic with a firewall"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1126
#, no-wrap
msgid ""
"bhyve {\n"
"        $if = 0;\n"
"        exec.prestart = \"/sbin/ifconfig epair${if} create up\";\n"
"        exec.prestart += \"/sbin/ifconfig epair${if}a up\";\n"
"        exec.prestart += \"/sbin/ifconfig epair${if}a name ${name}0\";\n"
"        exec.prestart += \"/sbin/ifconfig epair${if}b name jail${if}\";\n"
"        exec.prestart += \"/sbin/ifconfig ${name}0 inet 192.168.168.1/27\";\n"
"        exec.prestart += \"/sbin/sysctl net.inet.ip.forwarding=1\";\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1128
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1165
#, no-wrap
msgid "        exec.clean;\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1137
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1174
#, no-wrap
msgid ""
"        host.hostname = \"your-hostname-here\";\n"
"        vnet;\n"
"        vnet.interface = \"em${if}\";\n"
"        path = \"/jails/${name}\";\n"
"        persist;\n"
"        securelevel = 3;\n"
"        devfs_ruleset = 100;\n"
"        mount.devfs;\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1139
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1176
#, no-wrap
msgid "        allow.vmm;\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1142
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1179
#, no-wrap
msgid ""
"        exec.start += \"/bin/sh /etc/rc\";\n"
"        exec.stop = \"/bin/sh /etc/rc.shutdown\";\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1145
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1182
#, no-wrap
msgid ""
"        exec.poststop += \"/sbin/ifconfig ${name}0 destroy\";\n"
"}\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1149
msgid ""
"This example assumes use of a firewall like `pf` or `ipfw` to NAT your jail "
"traffic.  See the crossref:firewalls[,Firewalls] chapter for more details on "
"the available options to implement this."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1150
#, no-wrap
msgid "Using a bridged network connection"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1163
#, no-wrap
msgid ""
"bhyve {\n"
"        $if = 0;\n"
"        exec.prestart = \"/sbin/ifconfig epair${if} create up\";\n"
"        exec.prestart += \"/sbin/ifconfig epair${if}a up\";\n"
"        exec.prestart += \"/sbin/ifconfig epair${if}a name ${name}0\";\n"
"        exec.prestart += \"/sbin/ifconfig epair${if}b name jail${if}\";\n"
"        exec.prestart += \"/sbin/ifconfig bridge0 addm ${name}0\";\n"
"        exec.prestart += \"/sbin/sysctl net.inet.ip.forwarding=1\";\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1188
msgid ""
"If you previously replaced the devfs ruleset ID 100 in [.filename]#/etc/"
"devfs.rules# with your own unique number, remember to replace the numeric ID "
"also in your [.filename]#jails.conf# too."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1191
#, no-wrap
msgid "Configuring the Jail"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1194
msgid ""
"To start the jail for the first time and do some additional configuration "
"work, enter:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1205
#, no-wrap
msgid ""
"# cp /etc/resolv.conf /jails/bhyve/etc\n"
"# service jail onestart bhyve\n"
"# jexec bhyve\n"
"# sysrc ifconfig_jail0=\"inet 192.168.168.2/27\"\n"
"# sysrc defaultrouter=\"192.168.168.1\"\n"
"# sysrc sendmail_enable=NONE\n"
"# sysrc cloned_interfaces=\"tap100\"\n"
"# exit\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1208
msgid "Restart and enable the jail:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1213
#, no-wrap
msgid ""
"# sysrc jail_enable=YES\n"
"# service jail restart bhyve\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1217
msgid ""
"Afterwards, you can create a virtual machine within the jail.  For a FreeBSD "
"guest, download an installation ISO first:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1223
#, no-wrap
msgid ""
"# jexec bhyve\n"
"# cd /vms\n"
"# fetch -o freebsd.iso https://download.freebsd.org/releases/ISO-IMAGES/14.0/FreeBSD-14.0-RELEASE-amd64-bootonly.iso\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1226
#, no-wrap
msgid "Creating a Virtual Machine Inside the Jail"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1229
msgid "To create a virtual machine, use `bhyvectl` to initialize it first:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1234
#, no-wrap
msgid ""
"# jexec bhyve\n"
"# bhyvectl --create --vm=bhyvevm0\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1240
msgid ""
"Creating the guest with `bhyvectl` may be required when initiating the "
"virtual machine from a jail.  Skipping this step may cause the following "
"error message when starting `bhyve`:"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1242
msgid "`vm_open: vm-name could not be opened. No such file or directory`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1245
msgid "Finally, use your preferred way of starting the guest."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1246
#, no-wrap
msgid "Starting with `vmrun.sh` and ZFS"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1250
msgid "Using `vmrun.sh` on a ZFS filesystems:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1256
#, no-wrap
msgid ""
"# jexec bhyve\n"
"# sh /usr/share/examples/bhyve/vmrun.sh -c 1 -m 1024M \\\n"
"     -t tap100 -d /dev/zvols/zroot/vms/bhyvevm0 -i -I /vms/FreeBSD-14.0-RELEASE-amd64-bootonly.iso bhyvevm0\n"
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1259
#, no-wrap
msgid "Starting with `vmrun.sh` and UFS"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1263
msgid "Using `vmrun.sh` on a UFS filesystem:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1269
#, no-wrap
msgid ""
"# jexec bhyve\n"
"# sh /usr/share/examples/bhyve/vmrun.sh -c 1 -m 1024M \\\n"
"     -t tap100 -d /vms/bhyvevm0 -i -I /vms/FreeBSD-14.0-RELEASE-amd64-bootonly.iso bhyvevm0\n"
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1272
#, no-wrap
msgid "Starting bhyve for an UEFI guest with ZFS"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1276
msgid ""
"If instead you want to use an UEFI guest, remember to first install the "
"required firmware package package:sysutils/bhyve-firmware[] in the jail:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1280
#, no-wrap
msgid "# pkg -j bhyve install bhyve-firmware\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1283
msgid "Then use `bhyve` directly:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1296
#, no-wrap
msgid ""
"# bhyve -A -c 4 -D -H -m 2G \\\n"
"        -s 0,hostbridge \\\n"
"        -s 1,lpc \\\n"
"        -s 2,virtio-net,tap100 \\\n"
"        -s 3,virtio-blk,/dev/zvol/zroot/vms/bhyvevm0 \\\n"
"\t-s 4,ahci-cd,/vms/FreeBSD-14.0-RELEASE-amd64-bootonly.iso \\\n"
"        -s 31,fbuf,tcp=127.0.0.1:5900,w=1024,h=800,tablet \\\n"
"        -l bootrom,/usr/local/share/uefi-firmware/BHYVE_UEFI.fd \\\n"
"        -l com1,/dev/nmdbbhyve0A \\\n"
"        bhyvevm0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1299
msgid ""
"This will allow you to connect to your virtual machine `bhyvevm0` through "
"VNC as well as a serial console at [.filename]#/dev/nmdbbhyve0B#."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1302
#, no-wrap
msgid "Virtual Machine Consoles"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1309
msgid ""
"It is advantageous to wrap the bhyve console in a session management tool "
"such as package:sysutils/tmux[] or package:sysutils/screen[] in order to "
"detach and reattach to the console.  It is also possible to have the console "
"of bhyve be a null modem device that can be accessed with `cu`.  To do this, "
"load the [.filename]#nmdm# kernel module and replace `-l com1,stdio` with `-"
"l com1,/dev/nmdm0A`.  The [.filename]#/dev/nmdm# devices are created "
"automatically as needed, where each is a pair, corresponding to the two ends "
"of the null modem cable ([.filename]#/dev/nmdm0A# and [.filename]#/dev/"
"nmdm0B#).  See man:nmdm[4] for more information."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1317
#, no-wrap
msgid ""
"# kldload nmdm\n"
"# bhyve -A -H -P -s 0:0,hostbridge -s 1:0,lpc -s 2:0,virtio-net,tap0 -s 3:0,virtio-blk,./linux.img \\\n"
"    -l com1,/dev/nmdm0A -c 4 -m 1024M linuxguest\n"
"# cu -l /dev/nmdm0B\n"
"Connected\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1319
#, no-wrap
msgid "Ubuntu 13.10 handbook ttyS0\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1321
#, no-wrap
msgid "handbook login:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1327
msgid ""
"To disconnect from a console, enter a newline (i.e. press `RETURN`) followed "
"by tilde (`~`), and finally dot (`.`).  Keep in mind that only the "
"connection is dropped while the login session remains active.  Another user "
"connecting to the same console could therefore make use of any active "
"sessions without having to first authenticate.  For security reasons, it's "
"therefore recommended to logout before disconnecting."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1332
msgid ""
"The number in the [.filename]#nmdm# device path must be unique for each "
"virtual machine and must not be used by any other processes before bhyve "
"starts.  The number can be chosen arbitrarily and does not need to be taken "
"from a consecutive sequence of numbers.  The device node pair (i.e. [."
"filename]#/dev/nmdm0a# and [.filename]#/dev/nmdm0b#) are created dynamically "
"when bhyve connects its console and destroyed when it shuts down.  Keep this "
"in mind when creating scripts to start your virtual machines: you need to "
"make sure that all virtual machines are assigned unique [.filename]#nmdm# "
"devices."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1334
#, no-wrap
msgid "Managing Virtual Machines"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1338
msgid ""
"A device node is created in [.filename]#/dev/vmm# for each virtual machine.  "
"This allows the administrator to easily see a list of the running virtual "
"machines:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1348
#, no-wrap
msgid ""
"# ls -al /dev/vmm\n"
"total 1\n"
"dr-xr-xr-x   2 root  wheel    512 Mar 17 12:19 ./\n"
"dr-xr-xr-x  14 root  wheel    512 Mar 17 06:38 ../\n"
"crw-------   1 root  wheel  0x1a2 Mar 17 12:20 guestname\n"
"crw-------   1 root  wheel  0x19f Mar 17 12:19 linuxguest\n"
"crw-------   1 root  wheel  0x1a1 Mar 17 12:19 otherguest\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1351
msgid "A specified virtual machine can be destroyed using `bhyvectl`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1355
#, no-wrap
msgid "# bhyvectl --destroy --vm=guestname\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1359
msgid ""
"Destroying a virtual machine this way means killing it immediately. Any "
"unsaved data will be lost, open files and filesystems may get corrupted.  To "
"gracefully shut down a virtual machine, send a `TERM` signal to its bhyve "
"process instead. This triggers an ACPI shutdown event for the guest:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1365
#, no-wrap
msgid ""
"# ps ax | grep bhyve\n"
"17424  -  SC      56:48.27 bhyve: guestvm (bhyve)\n"
"# kill 17424\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1368
#, no-wrap
msgid "Tools and Utilities"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1371
msgid ""
"There are numerous utilities and applications available in ports to help "
"simplify setting up and managing bhyve virtual machines:"
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1372
#, no-wrap
msgid "bhyve Managers"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1375
#, no-wrap
msgid "Name"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1375
#, no-wrap
msgid "License"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1375
#, no-wrap
msgid "Package"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1377
#, no-wrap
msgid "Documentation"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1378
#, no-wrap
msgid "vm-bhyve"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1379
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1384
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1404
#, no-wrap
msgid "BSD-2"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1380
#, no-wrap
msgid "package:sysutils/vm-bhyve[]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1382
#, no-wrap
msgid "link:https://github.com/churchers/vm-bhyve[Documentation]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1383
#, no-wrap
msgid "CBSD"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1385
#, no-wrap
msgid "package:sysutils/cbsd[]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1387
#, no-wrap
msgid "link:https://www.bsdstore.ru[Documentation]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1388
#, no-wrap
msgid "Virt-Manager"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1389
#, no-wrap
msgid "LGPL-3"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1390
#, no-wrap
msgid "package:deskutils/virt-manager[]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1392
#, no-wrap
msgid "link:https://virt-manager.org/[Documentation]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1393
#, no-wrap
msgid "Bhyve RC Script"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1394
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1399
#, no-wrap
msgid "Unknown"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1395
#, no-wrap
msgid "package:sysutils/bhyve-rc[]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1397
#, no-wrap
msgid "link:https://www.freshports.org/sysutils/bhyve-rc/[Documentation]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1398
#, no-wrap
msgid "bmd"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1400
#, no-wrap
msgid "package:sysutils/bmd[]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1402
#, no-wrap
msgid "link:https://github.com/yuichiro-naito/bmd[Documentation]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1403
#, no-wrap
msgid "vmstated"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1405
#, no-wrap
msgid "package:sysutils/vmstated[]"
msgstr ""

#. type: Table
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1407
#, no-wrap
msgid "link:https://github.com/christian-moerz/vmstated[Documentation]"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1410
#, no-wrap
msgid "Persistent Configuration"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1413
msgid ""
"In order to configure the system to start bhyve guests at boot time, some "
"configuration file changes are required."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1416
msgid "[.filename]#/etc/sysctl.conf#"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1418
msgid ""
"When using [.filename]#tap# interfaces as network backend, you either need "
"to manually set each used [.filename]#tap# interface to UP or simply set the "
"following sysctl:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1422
#, no-wrap
msgid "net.link.tap.up_on_open=1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1425
msgid "[.filename]#/etc/rc.conf#"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1429
msgid ""
"To connect your virtual machine's [.filename]#tap# device to the network via "
"a [.filename]#bridge#, you need to persist the device settings in [."
"filename]#/etc/rc.conf#.  Additionally, you can load the necessary kernel "
"modules `vmm` for bhyve and `nmdm` for [.filename]#nmdm# devices through the "
"`kld_list` configuration variable.  When configuring `ifconfig_bridge0`, "
"make sure to replace `<ipaddr>/<netmask>` with the actual IP address of your "
"physical interface ([.filename]#igb0# in this example) and remove IP "
"settings from your physical device."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1436
#, no-wrap
msgid ""
"# sysrc cloned_interfaces+=\"bridge0 tap0\"\n"
"# sysrc ifconfig_bridge0=\"inet <ipaddr>/<netmask> addm igb0 addm tap0\"\n"
"# sysrc kld_list+=\"nmdm vmm\"\n"
"# sysrc ifconfig_igb0=\"up\"\n"
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1439
#, no-wrap
msgid "Setting the IP for a bridge device"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1443
msgid ""
"For a host with an _igb0_ interface connected to the network with IP "
"`10.10.10.1` and netmask `255.255.255.0`, you would use the following "
"commands:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1450
#, no-wrap
msgid ""
"# sysrc ifconfig_igb0=\"up\"\n"
"# sysrc ifconfig_bridge0=\"inet 10.10.10.1/24 addm igb0 addm tap0\"\n"
"# sysrc kld_list+=\"nmdm vmm\"\n"
"# sysrc cloned_interfaces+=\"bridge0 tap0\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1457
msgid ""
"Modifying the IP address configuration of a system may lock you out if you "
"are executing these commands while you are connected remotely (i.e. via "
"SSH)! Take precautions to maintain system access or make those modifications "
"while logged in on a local terminal session."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1460
#, no-wrap
msgid "FreeBSD as a Xen(TM)-Host"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1465
msgid ""
"Xen is a GPLv2-licensed https://en.wikipedia.org/wiki/"
"Hypervisor#Classification[type 1 hypervisor] for Intel(R) and ARM(R) "
"architectures.  FreeBSD has included i386(TM) and AMD(R) 64-Bit https://wiki."
"xenproject.org/wiki/DomU[DomU] and https://en.wikipedia.org/wiki/"
"Amazon_Elastic_Compute_Cloud[Amazon EC2] unprivileged domain (virtual "
"machine) support since FreeBSD 8.0 and includes Dom0 control domain (host) "
"support in FreeBSD 11.0.  Support for para-virtualized (PV) domains has been "
"removed from FreeBSD 11 in favor of hardware virtualized (HVM) domains, "
"which provides better performance."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1473
msgid ""
"Xen(TM) is a bare-metal hypervisor, which means that it is the first program "
"loaded after the BIOS.  A special privileged guest called the Domain-0 "
"(`Dom0` for short) is then started.  The Dom0 uses its special privileges to "
"directly access the underlying physical hardware, making it a high-"
"performance solution.  It is able to access the disk controllers and network "
"adapters directly.  The Xen(TM) management tools to manage and control the "
"Xen(TM) hypervisor are also used by the Dom0 to create, list, and destroy "
"VMs.  Dom0 provides virtual disks and networking for unprivileged domains, "
"often called `DomU`.  Xen(TM) Dom0 can be compared to the service console of "
"other hypervisor solutions, while the DomU is where individual guest VMs are "
"run."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1480
msgid ""
"Xen(TM) can migrate VMs between different Xen(TM) servers.  When the two xen "
"hosts share the same underlying storage, the migration can be done without "
"having to shut the VM down first.  Instead, the migration is performed live "
"while the DomU is running and there is no need to restart it or plan a "
"downtime.  This is useful in maintenance scenarios or upgrade windows to "
"ensure that the services provided by the DomU are still provided.  Many more "
"features of Xen(TM) are listed on the https://wiki.xenproject.org/wiki/"
"Category:Overview[Xen Wiki Overview page].  Note that not all features are "
"supported on FreeBSD yet."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1482
#, no-wrap
msgid "Hardware Requirements for Xen(TM) Dom0"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1486
msgid ""
"To run the Xen(TM) hypervisor on a host, certain hardware functionality is "
"required.  Hardware virtualized domains require Extended Page Table (http://"
"en.wikipedia.org/wiki/Extended_Page_Table[EPT]) and Input/Output Memory "
"Management Unit (http://en.wikipedia.org/wiki/List_of_IOMMU-"
"supporting_hardware[IOMMU]) support in the host processor."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1490
msgid ""
"In order to run a FreeBSD Xen(TM) Dom0 the box must be booted using legacy "
"boot (BIOS)."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1493
#, no-wrap
msgid "Xen(TM) Dom0 Control Domain Setup"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1496
msgid ""
"Users should install the package:emulators/xen-kernel[] and package:sysutils/"
"xen-tools[] packages, based on Xen(TM) 4.18."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1500
msgid ""
"Configuration files must be edited to prepare the host for the Dom0 "
"integration after the Xen packages are installed.  An entry to [.filename]#/"
"etc/sysctl.conf# disables the limit on how many pages of memory are allowed "
"to be wired.  Otherwise, DomU VMs with higher memory requirements will not "
"run."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1504
#, no-wrap
msgid "# echo 'vm.max_wired=-1' >> /etc/sysctl.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1510
msgid ""
"Another memory-related setting involves changing [.filename]#/etc/login."
"conf#, setting the `memorylocked` option to `unlimited`.  Otherwise, "
"creating DomU domains may fail with `Cannot allocate memory` errors.  After "
"making the change to [.filename]#/etc/login.conf#, run `cap_mkdb` to update "
"the capability database.  See crossref:security[security-resourcelimits,"
"\"Resource Limits\"] for details."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1515
#, no-wrap
msgid ""
"# sed -i '' -e 's/memorylocked=64K/memorylocked=unlimited/' /etc/login.conf\n"
"# cap_mkdb /etc/login.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1518
msgid "Add an entry for the Xen(TM) console to [.filename]#/etc/ttys#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1522
#, no-wrap
msgid "# echo 'xc0     \"/usr/libexec/getty Pc\"         xterm   onifconsole  secure' >> /etc/ttys\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1529
msgid ""
"Selecting a Xen(TM) kernel in [.filename]#/boot/loader.conf# activates the "
"Dom0.  Xen(TM) also requires resources like CPU and memory from the host "
"machine for itself and other DomU domains.  How much CPU and memory depends "
"on the individual requirements and hardware capabilities.  In this example, "
"8 GB of memory and 4 virtual CPUs are made available for the Dom0.  The "
"serial console is also activated, and logging options are defined."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1531
msgid "The following command is used for Xen 4.7 packages:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1538
#, no-wrap
msgid ""
"# echo 'hw.pci.mcfg=0' >> /boot/loader.conf\n"
"# echo 'if_tap_load=\"YES\"' >> /boot/loader.conf\n"
"# echo 'xen_kernel=\"/boot/xen\"' >> /boot/loader.conf\n"
"# echo 'xen_cmdline=\"dom0_mem=8192M dom0_max_vcpus=4 dom0pvh=1 console=com1,vga com1=115200,8n1 guest_loglvl=all loglvl=all\"' >> /boot/loader.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1541
msgid ""
"For Xen versions 4.11 and higher, the following command should be used "
"instead:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1547
#, no-wrap
msgid ""
"# echo 'if_tap_load=\"YES\"' >> /boot/loader.conf\n"
"# echo 'xen_kernel=\"/boot/xen\"' >> /boot/loader.conf\n"
"# echo 'xen_cmdline=\"dom0_mem=8192M dom0_max_vcpus=4 dom0=pvh console=com1,vga com1=115200,8n1 guest_loglvl=all loglvl=all\"' >> /boot/loader.conf\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1554
msgid ""
"Log files that Xen(TM) creates for the DomU VMs are stored in [.filename]#/"
"var/log/xen#.  Please be sure to check the contents of that directory if "
"experiencing issues."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1557
msgid "Activate the xencommons service during system startup:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1561
#, no-wrap
msgid "# sysrc xencommons_enable=yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1567
msgid ""
"These settings are enough to start a Dom0-enabled system.  However, it lacks "
"network functionality for the DomU machines.  To fix that, define a bridged "
"interface with the main NIC of the system which the DomU VMs can use to "
"connect to the network.  Replace _em0_ with the host network interface name."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1573
#, no-wrap
msgid ""
"# sysrc cloned_interfaces=\"bridge0\"\n"
"# sysrc ifconfig_bridge0=\"addm em0 SYNCDHCP\"\n"
"# sysrc ifconfig_em0=\"up\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1576
msgid "Restart the host to load the Xen(TM) kernel and start the Dom0."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1580
#, no-wrap
msgid "# reboot\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1583
msgid ""
"After successfully booting the Xen(TM) kernel and logging into the system "
"again, the Xen(TM) management tool `xl` is used to show information about "
"the domains."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1589
#, no-wrap
msgid ""
"# xl list\n"
"Name                                        ID   Mem VCPUs      State   Time(s)\n"
"Domain-0                                     0  8192     4     r-----     962.0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1595
msgid ""
"The output confirms that the Dom0 (called `Domain-0`) has the ID `0` and is "
"running.  It also has the memory and virtual CPUs that were defined in [."
"filename]#/boot/loader.conf# earlier.  More information can be found in the "
"https://www.xenproject.org/help/documentation.html[Xen(TM) Documentation].  "
"DomU guest VMs can now be created."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1597
#, no-wrap
msgid "Xen(TM) DomU Guest VM Configuration"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1604
msgid ""
"Unprivileged domains consist of a configuration file and virtual or physical "
"hard disks.  Virtual disk storage for the DomU can be files created by man:"
"truncate[1] or ZFS volumes as described in crossref:zfs[zfs-zfs-"
"volume,Creating and Destroying Volumes].  In this example, a 20 GB volume "
"is used.  A VM is created with the ZFS volume, a FreeBSD ISO image, 1 GB of "
"RAM and two virtual CPUs.  The ISO installation file is retrieved with man:"
"fetch[1] and saved locally in a file called [.filename]#freebsd.iso#."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1608
#, no-wrap
msgid "# fetch https://download.freebsd.org/releases/ISO-IMAGES/14.0/FreeBSD-14.0-RELEASE-amd64-bootonly.iso -o freebsd.iso\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1611
msgid ""
"A ZFS volume of 20 GB called [.filename]#xendisk0# is created to serve as "
"the disk space for the VM."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1615
#, no-wrap
msgid "# zfs create -V20G -o volmode=dev zroot/xendisk0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1620
msgid ""
"The new DomU guest VM is defined in a file.  Some specific definitions like "
"name, keymap, and VNC connection details are also defined.  The following [."
"filename]#freebsd.cfg# contains a minimum DomU configuration for this "
"example:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1637
#, no-wrap
msgid ""
"# cat freebsd.cfg\n"
"builder = \"hvm\" <.>\n"
"name = \"freebsd\" <.>\n"
"memory = 1024 <.>\n"
"vcpus = 2 <.>\n"
"vif = [ 'mac=00:16:3E:74:34:32,bridge=bridge0' ] <.>\n"
"disk = [\n"
"'/dev/zvol/tank/xendisk0,raw,hda,rw', <.>\n"
"'/root/freebsd.iso,raw,hdc:cdrom,r' <.>\n"
"  ]\n"
"vnc = 1 <.>\n"
"vnclisten = \"0.0.0.0\"\n"
"serial = \"pty\"\n"
"usbdevice = \"tablet\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1640
msgid "These lines are explained in more detail:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1642
msgid ""
"This defines what kind of virtualization to use. `hvm` refers to hardware-"
"assisted virtualization or hardware virtual machine. Guest operating systems "
"can run unmodified on CPUs with virtualization extensions, providing nearly "
"the same performance as running on physical hardware. `generic` is the "
"default value and creates a PV domain."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1643
msgid ""
"Name of this virtual machine to distinguish it from others running on the "
"same Dom0. Required."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1644
msgid ""
"Quantity of RAM in megabytes to make available to the VM. This amount is "
"subtracted from the hypervisor's total available memory, not the memory of "
"the Dom0."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1645
msgid ""
"Number of virtual CPUs available to the guest VM. For best performance, do "
"not create guests with more virtual CPUs than the number of physical CPUs on "
"the host."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1646
msgid ""
"Virtual network adapter. This is the bridge connected to the network "
"interface of the host. The `mac` parameter is the MAC address set on the "
"virtual network interface. This parameter is optional, if no MAC is provided "
"Xen(TM) will generate a random one."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1647
msgid ""
"Full path to the disk, file, or ZFS volume of the disk storage for this VM. "
"Options and multiple disk definitions are separated by commas."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1648
msgid ""
"Defines the Boot medium from which the initial operating system is "
"installed. In this example, it is the ISO image downloaded earlier. Consult "
"the Xen(TM) documentation for other kinds of devices and options to set."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1649
msgid ""
"Options controlling VNC connectivity to the serial console of the DomU. In "
"order, these are: active VNC support, define IP address on which to listen, "
"device node for the serial console, and the input method for precise "
"positioning of the mouse and other input methods. `keymap` defines which "
"keymap to use, and is `english` by default."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1651
msgid ""
"After the file has been created with all the necessary options, the DomU is "
"created by passing it to `xl create` as a parameter."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1655
#, no-wrap
msgid "# xl create freebsd.cfg\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1664
msgid ""
"Each time the Dom0 is restarted, the configuration file must be passed to "
"`xl create` again to re-create the DomU.  By default, only the Dom0 is "
"created after a reboot, not the individual VMs.  The VMs can continue where "
"they left off as they stored the operating system on the virtual disk.  The "
"virtual machine configuration can change over time (for example, when adding "
"more memory).  The virtual machine configuration files must be properly "
"backed up and kept available to be able to re-create the guest VM when "
"needed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1667
msgid "The output of `xl list` confirms that the DomU has been created."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1674
#, no-wrap
msgid ""
"# xl list\n"
"Name                                        ID   Mem VCPUs      State   Time(s)\n"
"Domain-0                                     0  8192     4     r-----  1653.4\n"
"freebsd                                      1  1024     1     -b----   663.9\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1681
msgid ""
"To begin the installation of the base operating system, start the VNC "
"client, directing it to the main network address of the host or to the IP "
"address defined on the `vnclisten` line of [.filename]#freebsd.cfg#.  After "
"the operating system has been installed, shut down the DomU and disconnect "
"the VNC viewer.  Edit [.filename]#freebsd.cfg#, removing the line with the "
"`cdrom` definition or commenting it out by inserting a `+#+` character at "
"the beginning of the line.  To load this new configuration, it is necessary "
"to remove the old DomU with `xl destroy`, passing either the name or the id "
"as the parameter.  Afterwards, recreate it using the modified [."
"filename]*freebsd.cfg*."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1686
#, no-wrap
msgid ""
"# xl destroy freebsd\n"
"# xl create freebsd.cfg\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1690
msgid ""
"The machine can then be accessed again using the VNC viewer.  This time, it "
"will boot from the virtual disk where the operating system has been "
"installed and can be used as a virtual machine."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1692
#, no-wrap
msgid "Troubleshooting"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1695
msgid ""
"This section contains basic information in order to help troubleshoot issues "
"found when using FreeBSD as a Xen(TM) host or guest."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1697
#, no-wrap
msgid "Host Boot Troubleshooting"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1701
msgid ""
"Please note that the following troubleshooting tips are intended for Xen(TM) "
"4.11 or newer.  If you are still using Xen(TM) 4.7 and having issues, "
"consider migrating to a newer version of Xen(TM)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1705
msgid ""
"In order to troubleshoot host boot issues, you will likely need a serial "
"cable, or a debug USB cable.  Verbose Xen(TM) boot output can be obtained by "
"adding options to the `xen_cmdline` option found in [.filename]#loader."
"conf#.  A couple of relevant debug options are:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1707
msgid ""
"`iommu=debug`: can be used to print additional diagnostic information about "
"the iommu."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1708
msgid ""
"`dom0=verbose`: can be used to print additional diagnostic information about "
"the dom0 build process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1709
msgid ""
"`sync_console`: flag to force synchronous console output. Useful for "
"debugging to avoid losing messages due to rate limiting. Never use this "
"option in production environments since it can allow malicious guests to "
"perform DoS attacks against Xen(TM) using the console."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1712
msgid ""
"FreeBSD should also be booted in verbose mode in order to identify any "
"issues.  To activate verbose booting, run this command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1716
#, no-wrap
msgid "# echo 'boot_verbose=\"YES\"' >> /boot/loader.conf\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1719
msgid ""
"If none of these options help solving the problem, please send the serial "
"boot log to mailto:freebsd-xen@FreeBSD.org[freebsd-xen@FreeBSD.org] and "
"mailto:xen-devel@lists.xenproject.org[xen-devel@lists.xenproject.org] for "
"further analysis."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1721
#, no-wrap
msgid "Guest Creation Troubleshooting"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1724
msgid ""
"Issues can also arise when creating guests, the following attempts to "
"provide some help for those trying to diagnose guest creation issues."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1727
msgid ""
"The most common cause of guest creation failures is the `xl` command "
"spitting some error and exiting with a return code different than 0.  If the "
"error provided is not enough to help identify the issue, more verbose output "
"can also be obtained from `xl` by using the `v` option repeatedly."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1743
#, no-wrap
msgid ""
"# xl -vvv create freebsd.cfg\n"
"Parsing config from freebsd.cfg\n"
"libxl: debug: libxl_create.c:1693:do_domain_create: Domain 0:ao 0x800d750a0: create: how=0x0 callback=0x0 poller=0x800d6f0f0\n"
"libxl: debug: libxl_device.c:397:libxl__device_disk_set_backend: Disk vdev=xvda spec.backend=unknown\n"
"libxl: debug: libxl_device.c:432:libxl__device_disk_set_backend: Disk vdev=xvda, using backend phy\n"
"libxl: debug: libxl_create.c:1018:initiate_domain_create: Domain 1:running bootloader\n"
"libxl: debug: libxl_bootloader.c:328:libxl__bootloader_run: Domain 1:not a PV/PVH domain, skipping bootloader\n"
"libxl: debug: libxl_event.c:689:libxl__ev_xswatch_deregister: watch w=0x800d96b98: deregister unregistered\n"
"domainbuilder: detail: xc_dom_allocate: cmdline=\"\", features=\"\"\n"
"domainbuilder: detail: xc_dom_kernel_file: filename=\"/usr/local/lib/xen/boot/hvmloader\"\n"
"domainbuilder: detail: xc_dom_malloc_filemap    : 326 kB\n"
"libxl: debug: libxl_dom.c:988:libxl__load_hvm_firmware_module: Loading BIOS: /usr/local/share/seabios/bios.bin\n"
"...\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/virtualization/_index.adoc:1748
msgid ""
"If the verbose output does not help diagnose the issue, there are also QEMU "
"and Xen(TM) toolstack logs in [.filename]#/var/log/xen#.  Note that the name "
"of the domain is appended to the log name, so if the domain is named "
"`freebsd` you should find a [.filename]#/var/log/xen/xl-freebsd.log# and "
"likely a [.filename]#/var/log/xen/qemu-dm-freebsd.log#.  Both log files can "
"contain useful information for debugging.  If none of this helps solve the "
"issue, please send the description of the issue you are facing and as much "
"information as possible to mailto:freebsd-xen@FreeBSD.org[freebsd-"
"xen@FreeBSD.org] and mailto:xen-devel@lists.xenproject.org[xen-devel@lists."
"xenproject.org] in order to get help."
msgstr ""
