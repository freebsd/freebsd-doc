---
title: 第2章 FreeBSD のインストール
part: パートI. 導入
prev: books/handbook/introduction
next: books/handbook/basics
---

[[bsdinstall]]
= FreeBSD のインストール
:doctype: book
:toc: macro
:toclevels: 1
:icons: font
:sectnums:
:sectnumlevels: 6
:source-highlighter: rouge
:experimental:
:skip-front-matter:
:toc-title: 目次
:table-caption: 表
:figure-caption: 図
:example-caption: 例 
:xrefstyle: basic
:relfileprefix: ../
:outfilesuffix:
:sectnumoffset: 2

ifeval::["{backend}" == "html5"]
:imagesdir: ../../../../images/books/handbook/bsdinstall/
endif::[]

ifeval::["{backend}" == "pdf"]
:imagesdir: ../../../../static/images/books/handbook/bsdinstall/
endif::[]

ifeval::["{backend}" == "epub3"]
:imagesdir: ../../../../static/images/books/handbook/bsdinstall/
endif::[]

include::shared/authors.adoc[]
include::shared/releases.adoc[]
include::shared/ja/mailing-lists.adoc[]
include::shared/ja/teams.adoc[]
include::shared/ja/urls.adoc[]

toc::[]

[[bsdinstall-synopsis]]
== この章では

FreeBSD を入手して実行する方法は、環境に依存します。 以下のようにさまざま方法が用意されています。

* ダウンロードして仮想環境にインストールするための仮想マシンイメージ。 これらのイメージは、link:https://www.freebsd.org/ja/where/[FreeBSD を入手する] ページからダウンロードできます。 仮想マシンのイメージとして KVM ("qcow2"), VMWare ("vmdk"), Hyper-V ("vhd") および広くサポートされている raw デバイスイメージが用意されています。 これらはインストール用のイメージではなく、 すでに設定済みの ("すでにインストールされた") インスタンスで、すぐに起動して、 インストール後の作業を行うことができます。
* Amazon https://aws.amazon.com/marketplace/pp/B07L6QV354[AWS Marketplace], https://azuremarketplace.microsoft.com/en-us/marketplace/apps?search=freebsd&page=1[Microsoft Azure Marketplace] および https://console.cloud.google.com/marketplace/details/freebsd-cloud/freebsd-12[Google Cloud Platform] において、 それぞれのホスティングサービスで実行可能な仮想マシンイメージを利用できます。 Azure での FreeBSD のデプロイについての詳細な情報については、 https://docs.microsoft.com/en-us/azure/virtual-machines/linux/freebsd-intro-on-azure[Azure Documentation] の関連する章をご覧ください。
* Raspberry Pi または BeagleBone Black といった組み込みシステム用に、SD カードイメージが用意されています。 これらのイメージは、 https://www.freebsd.org/where/[FreeBSD を入手する] ページからダウンロードしてください。 これらのファイルをダウンロードしたら、展開し、 ボードが起動するように raw イメージとして SD カードに書き込んでください。
* FreeBSD を通常のデスクトップ、ラップトップ、 サーバシステムのハードディスク上にインストールするためのインストールイメージ。

この章では、4 番目のケースに関連して、 テキストベースの bsdinstall と呼ばれるインストールプログラムの使い方について説明します。

この章で記載されているインストールの手順は、 i386(TM) および AMD64 アーキテクチャを対象にしています。 必要に応じて、他のプラットフォームに特有の手順についても明記しています。 インストーラとこの文書で記載している内容には、 いくらかズレがあることがありますので、 この章を正確で忠実な手順書としてではなく、 一般的なガイドとしてご利用ください。

[NOTE]
====
グラフィカルなインストーラで FreeBSD をインストールしたいと考えているユーザは、 TrueOS プロジェクトのインストーラである pc-sysinstall に興味を持たれるかもしれません。 このインストーラは、グラフィカルなデスクトップ (TrueOS) や、コマンドラインの FreeBSD のインストールに利用できます。 詳細については、TrueOS のユーザハンドブック (https://www.trueos.org/handbook/trueos.html[https://www.trueos.org/handbook/trueos.html]) をご覧ください。
====

この章では、以下について説明します。

* 最小ハードウェア要件、および FreeBSD が対応しているアーキテクチャについて。
* FreeBSD インストールメディアの作り方。
* bsdinstall の起動方法。
* bsdinstall が聞いてくる質問がどのような意味であり、 またどのように答えれば良いか。
* インストールに失敗した時の問題の解決方法。
* インストールを確定する前に、 FreeBSD の live 版へアクセスする方法。

この章を読む前に、以下のことを確認して下さい。

* インストールしようとしているバージョンに付属しているサポートハードウェア一覧を読み、 システムのハードウェアがサポートされているかどうかを確認して下さい。

[[bsdinstall-hardware]]
== 最小ハードウェア要件

FreeBSD をインストールするために必要なハードウェア要件は、 アーキテクチャごとに異なります。FreeBSD の各リリースが対応しているハードウェアアーキテクチャおよびデバイスの一覧は、 link:https://www.FreeBSD.org/ja/releases/[FreeBSD リリース情報] のページにまとめられています。 アーキテクチャごとのイメージの選択に関しては、 link:https://www.FreeBSD.org/ja/where/[FreeBSD ダウンロードページ] でも説明されています。

FreeBSD をインストールするためには、 少なくとも 96 MB の RAM および 1.5 GB のハードディスクの空き容量が必要です。 しかしながら、このような少ないメモリやディスク容量のシステムは、 組み込みアプライアンスのような、 カスタムアプリケーションでのみ適しており、 一般使用のデスクトップのシステムでは、 より多くのリソースが必要となります。 2-4 GB RAM そして少なくとも 8 GB のハードディスク容量を検討してください。

以下は、各アーキテクチャごとのプロセッサの必要要件です。

amd64::
デスクトップおよびラップトップのプロセッサとしては最も一般的で、 最近のほとんどのシステムで使われています。 Intel(R) は Intel64 と呼び、 他の製造ベンダはしばしば x86-64 と呼びます。
+
amd64 互換のプロセッサの例は、 AMD Athlon(TM)64, AMD Opteron(TM), マルチコアの Intel(R) Xeon(TM) および Intel(R) Core(TM) 2 以降のプロセッサです。

i386::
古いデスクトップおよびラップトップでは、 この 32 ビットの X86 アーキテクチャが用いられています。
+
浮動小数点演算ユニットを持つ i386 互換のほとんどのプロセッサに対応しています。 486 以上のすべての Intel(R) プロセッサに対応しています。
+
FreeBSD は、Physical Address Extensions (PAE) に対応した CPU でこの機能を利用可能です。 PAE 機能を有効にしたカーネルでは、 4 ギガバイト以上のメモリを認識し、システムが利用できます。 しかしながら、PAE を使うと、 デバイスドライバや FreeBSD の他の機能に制限を課してしまいます。

powerpc::
USB 内蔵のすべての New World ROM Apple(R) Mac(R) システムに対応しています。 複数の CPU を持つコンピュータは SMP に対応しています。
+
32-bit カーネルは、RAM の最初の 2 GB だけを利用できます。

sparc64::
FreeBSD/sparc64 が対応しているハードウェアの一覧については、 link:https://www.FreeBSD.org/ja/platforms/sparc/[ FreeBSD/sparc64 プロジェクト] をご覧ください。
+
複数のプロセッサを搭載するすべてのシステムにおいて、 SMP に対応しています。現時点では、 他のオペレーティングシステムとディスクの共有ができないので、 FreeBSD/sparc64 専用のディスクが必要です。

[[bsdinstall-pre]]
== インストール前に行う作業

システムが FreeBSD のインストールにおける最小ハードウェア要件を満たしていることを確認したら、 インストールファイルをダウンロードして、 インストール用のメディアを用意してください。 その前に、以下のチェックリストを確認して、 システムをインストールする準備ができていることを確認してください。

[.procedure]
====
. 重要なデータのバックアップ
+ 
オペレーティングシステムをインストールする前に、 _常に_ 価値のあるすべてのデータを最初にバックアップしてください。 インストールしようとしているシステムにはバックをとらないでください。 そのかわり、USB ドライブ、 ネットワーク上の他のシステム、 もしくはオンラインのバックアップサービスといったリムーバルディスクにデータを保存してください。 インストールを始める前に、バックアップを調べて、 必要なすべてのファイルがバックアップに含まれていることを確認してください。 インストーラがシステムのディスクをフォーマットしてしまうと、 ディスクに保存されていたすべてのデータは失われます。
. FreeBSD をインストールする場所の決定
+ 
インストールするオペレーティングシステムが FreeBSD のみであれば、 このステップは飛ばすことができます。 しかし、ディスクに FreeBSD と 他のオペレーティングシステムを共存させる必要がある場合には、FreeBSD が利用するディスクおよびパーティションを決める必要があります。
+ 
i386 および amd64 アーキテクチャでは、 二つのパーティションスキームのどちらかを使って、 ハードディスクを複数の塊に分割することができます。 伝統的な _Master Boot Record_ (MBR) では、 ディスク 1 台あたり最大 4 つの _プライマリパーティション_ をパーティションテーブルに持つことができます 歴史的な理由により、FreeBSD では、これらのパーティションのことを _スライス_ と呼びます。 プライマリパーティションの 1 つに、 複数の _論理パーティション_ を含む _拡張パーティション_ を作成できます。 _GUID Partition Table_ (GPT) は、 ディスクをパーティションに分ける簡単で新しい方法です。 一般的な GPT の実装では、 1 つのディスクに 128 個までのパーティションの作成が可能であり、 論理パーティションは必要ありません。
+ 
FreeBSD のブートローダは、プライマリまたは GPT パーティションのどちらかを必要とします。 ディスク上のプライマリ、もしくは GPT パーティションがすべて使われているのであれば、 そのひとつを FreeBSD のために開放してください。 ディスクにあるデータを消去せずにパーティションを作成するには、 パーティションサイズを変更するツールを使って今あるパーティションのサイズを小さくし、 空いたスペースに新しいパーティションを作成してください。
+ 
パーティションサイズを変更するフリーや商用のツールは、 http://en.wikipedia.org/wiki/List_of_disk_partitioning_software[http://en.wikipedia.org/wiki/List_of_disk_partitioning_software] にまとめられています。 GParted Live (http://gparted.sourceforge.net/livecd.php[http://gparted.sourceforge.net/livecd.php]) は、GParted パーティションエディタを含む完全なライブ CD です。 多くの Linux Live CD ディストリビューションでも GParted を利用できます。
+
[WARNING]
======

ディスクパーティションを縮小するユーティリティは、 適切に用いるとパーティション用の空き容量を新しく安全に作成できます。 すでにあるパーティションを間違って選択してしまう可能性があるので、 ディスクのパーティションを変更する前に、 必ず重要なデータのバックアップをとり、 バックアップが正しくとれていることを検証してください。
======
+ 
ディスクパーティションごとに異なるオペレーティングシステムをインストールすることで、 一つのコンピュータに複数のオペレーティングシステムをインストールできます。 crossref:virtualization[virtualization,仮想化技術] を用いると、ディスクパーティションを変更することなく、 複数のオペレーティングシステムを同時に起動できます。
. ネットワーク情報の収集
+ 
FreeBSD のインストール方法によっては、ネットワークに接続し、 インストールファイルをダウンロードする必要があります。 インストールする方法に関わらず、インストール後に、 インストーラはシステムのネットワークインタフェースの設定をする機会を提供します。
+ 
ネットワークに DHCP サーバがあると、 自動的にネットワークの設定情報を取得できます。 DHCP を利用できない環境では、 システムの以下のネットワーク情報について、 システム管理者かプロバイダにネットワーク情報を問い合わせる必要があります。
.. IP アドレス
.. サブネットマスク
.. デフォルトゲートウェイの IP アドレス
.. ネットワークのドメイン名
.. ネットワークの DNS サーバの IP アドレス

. FreeBSD Errata の確認
+ 
FreeBSD プロジェクトでは FreeBSD の各リリースができる限り安定するよう努力していますが、 時々バグが発生してしまうことがあります。極まれに、 発生したバグがインストールプロセスに影響を与えることがあります。 これらの問題は発見され解決されると、 FreeBSD のウェブサイトの FreeBSD Errata (link:https://www.FreeBSD.org/releases/{rel121-current}r/errata/[https://www.freebsd.org/releases/{rel121-current}r/errata/]) に記載されます。 インストールに影響するような既知の問題が無いことを、 インストールする前に Errata で確認してください。
+ 
すべてのリリースに関する情報や Errata は、FreeBSD のウェブサイトの リリース情報の項 (link:https://www.FreeBSD.org/ja/releases/[https://www.freebsd.org/ja/releases/]) で確認できます。
====

[[bsdinstall-installation-media]]
=== インストールメディアの準備

FreeBSD のインストーラは、 他のオペレーティングシステムで実行できるようなプログラムではありません。 そのかわり、FreeBSD インストールファイルをダウンロードしたら、 ファイルタイプやサイズに合わせてメディア (CD, DVD または USB) に焼いてください。そして、挿入したメディアからインストールするように、 システムを起動してください。

FreeBSD のインストールファイルは link:https://www.FreeBSD.org/ja/where/[www.freebsd.org/ja/where/] から入手できます。 各インストールファイルの名前は、FreeBSD のリリースバージョンおよびアーキテクチャ、ファイルタイプからなります。 たとえば、amd64 システムに DVD から FreeBSD 12.1 をインストールするには、 [.filename]#FreeBSD-12.1-RELEASE-amd64-dvd1.iso# をダウンロードして、ファイルを DVD に焼き、DVD を挿入してからシステムを起動してください。

インストールファイルは、さまざまな形式で用意されています。 用意されているフォーマットは、 コンピュータのアーキテクチャやメディアのタイプによって異なります。

[[bsdinstall-installation-media-uefi]]
UEFI (Unified Extensible Firmware Interface) で起動するコンピュータのために、 追加のインストールファイルも用意されています。 これらのファイルの名前には、[.filename]#uefi# という文字列が含まれています。

ファイルの形式

* `-bootonly.iso`: インストーラのみを含む最小のインストールファイルです。 インストールを行う間、インストーラは FreeBSD をインストールするために必要なファイルをダウンロードするため、 ネットワーク接続が必要です。 このファイルは、CD を焼くためのアプリケーションを用いて、 CD に書き込む必要があります。
* `-disc1.iso`: FreeBSD のインストールに必要となる、ソースおよび Ports Collection といったすべてのファイルが含まれています。 このファイルは、CD を焼くためのアプリケーションを用いて、 CD に書き込む必要があります。
* `-dvd1.iso`: FreeBSD のインストールに必要となる、ソースおよび Ports Collection といったすべてのファイルが含まれています。 インターネットに接続することなく、 メディアのみでシステムのインストールを完了できるように、 良く使われるウィンドウマネージャおよびアプリケーションをインストールするためのバイナリ package も含まれています。 DVD を焼くためのアプリケーションを使って、 DVD に書き込む必要があります。
* `-memstick.img`: FreeBSD のインストールに必要となる、ソースおよび Ports Collection といったすべてのファイルが含まれています。 以下の手順に従って、USB スティックに書き込んでください。
* `-mini-memstick.img`: `-bootonly.iso` と同じく、 インストールファイルは含まれていないため、 必要に応じてダウンロードする必要があります。 インストールを行う間、ネットワーク接続が必要です。 <<bsdinstall-usb>> の説明に従って、 USB スティックに書き込んでください。

イメージファイルをダウンロードしたら、同じディレクトリから [.filename]#CHECKSUM.SHA256# をダウンロードしてください。 その後、イメージファイルの _チェックサム_ を計算してください。 FreeBSD では、この計算のために man:sha256[1] を提供しています。 `sha256 _イメージファイルの名前_` のように使用してください。 他のオペレーティングシステムでも同じようなプログラムを利用できます。

計算したチェックサムと [.filename]#CHECKSUM.SHA256# に示されている値を比較してください。 チェックサムは完全に一致している必要があります。 もしチェックサムが一致しなければ、 イメージファイルは壊れているので、もう一度ダウンロードしてください。

[[bsdinstall-usb]]
==== イメージファイルを USB に書き込む

[.filename]#\*.img# ファイルは、 完全なメモリスティックの内容の _イメージ_ です。これは、 通常のファイルのように対象のデバイスにコピーすることは _できません_。 USB スティックへ [.filename]#*.img# を書き込むためのアプリケーションは複数あります。 この節ではこのうちの二つのユーティリティについて説明します。

[IMPORTANT]
====
先に進む前に、USB スティックに存在する重要なデータをバックアップしてください。 以下の手順を実行すると、 スティックに存在するデータは削除されます。
====

[[bsdinstall-usb-dd]]
[.procedure]
====
*Procedure: `dd` を使ってイメージを書き込む*

[WARNING]
======

この例では、イメージの書き込み先のターゲットデバイスとして、 [.filename]#/dev/da0# が使われています。 ここで使われるコマンドは、 指定したターゲットデバイスに存在しているデータを破壊してしまうので、 正しいデバイスが指定されていることに _細心の注意を払ってください_。
======
. man:dd[1] コマンドユーティリティは、 BSD, Linux(R), および Mac OS(R) システムで利用できます。 `dd` を使ってイメージを焼くには、 USB スティックを挿入して、 デバイス名を確定してください。 その後、ダウンロードしたインストールファイルおよび、 USB スティックのデバイス名を指定してください。 この例では、amd64 インストールイメージを FreeBSD システムの最初の USB デバイスに書き込みます。
+
[source,bash]
....
# dd if=FreeBSD-12.1-RELEASE-amd64-memstick.img of=/dev/da0 bs=1M conv=sync
....
+ 
もし上記のコマンドに失敗するようでしたら、 USB スティックがマウントされていないことや、 デバイス名がディスクに対してのものであり、 パーティションではないことを確認してください。 オペレーティングシステムによっては、このコマンドを man:sudo[8] で実行することが求められる場合があります。 man:dd[1] の書式は、プラットフォームによって少し変わります。 たとえば Mac OS(R) では、小文字の `bs=1m` を使う必要があります。 Linux(R) のようなシステムでは、書き込みをバッファします。 すべての書き込みを完了させるには、 man:sync[8] を使用してください。
====

[.procedure]
====
*Procedure: Windows(R) を使ってイメージを書き込む*

[WARNING]
======

適切なドライブレターを出力先に設定していることを十分に確認してください。 さもなければ、現在あるデータは上書きされ、 破壊されてしまうでしょう。
======
. Image Writer for Windows(R) を入手する
+ 
Image Writer for Windows(R) は、 イメージファイルをメモリスティックに正しく書き込むことのできるフリーのアプリケーションです。 https://sourceforge.net/projects/win32diskimager/[https://sourceforge.net/projects/win32diskimager/] からダウンロードして、フォルダに展開してください。
. イメージライタを使ってイメージを書き込む
+ 
Win32DiskImager アイコンをダブルクリックして、プログラムを起動してください。 `Device` の下に表示されるデバイスレターが、 メモリスティックのドライブであることを確認してください。 フォルダのアイコンをクリックして、 メモリスティックに書き込むイメージファイルを選択します。 btn:[Save] をクリックして、 イメージファイルの名前を確定してください。 すべてが正しく行われたかどうか、また、 他のウィンドウでメモリスティックのフォルダが開かれていないことを確認してください。 準備ができたら、btn:[Write] をクリックして、 メモリスティックにイメージファイルを書き込んでください。
====

これで FreeBSD をインストールする用意ができました。

[[bsdinstall-start]]
== インストールの開始

[IMPORTANT]
====
デフォルトでは、次のメッセージが表示されるまで インストーラはディスクに何の変更も加えません。

[.programlisting]
....
Your changes will now be written to disk. If you
have chosen to overwrite existing data, it will
be PERMANENTLY ERASED. Are you sure you want to
commit your changes?
....

この警告の前であれば、いつでもインストールを中断できます。 もし、何かを間違って設定してしまったことが心配ならば、 最後の警告の前に単にコンピュータをオフにしてください。 システムのハードディスクを変更せずに済みます。
====

この章では、<<bsdinstall-installation-media>> で説明されている手順によって準備されたインストールメディアから、 システムを起動する方法について説明します。 起動可能な USB スティックを使用する場合には、 コンピュータを立ち上げる前に、 USB スティックを挿入してください。 CD もしくは DVD から起動する場合には、 コンピュータを立ち上げ、 すぐにメディアを挿入してください。 挿入したメディアからシステムを起動するように設定する方法は、 アーキテクチャによって異なります。

[[bsdinstall-starting-i386]]
=== i386(TM) および amd64 での起動

これらのアーキテクチャでは、 BIOS メニューが用意されており、 ブートデバイスを選択できます。 利用するインストールメディアに合わせて、 最初のブートデバイスに、 CD/DVD または USB を選択してください。 ほとんどのシステムでは、BIOS に入らずとも、起動時に特定のキーを押すことで、 起動するデバイスを選択できます。 通常、このキーは、 kbd:[F10], kbd:[F11], kbd:[F12] または kbd:[Escape] のどれかです。

もし、コンピュータが FreeBSD のインストーラではなく、 すでに存在しているオペレーティングシステムで起動してしまったのであれば、 以下の原因が考えられます。

. インストールメディアが起動プロセスにおいて十分早いタイミングで挿入されていません。 メディアをそのままにしてコンピュータを再起動してください。
. BIOS の変更が適切に行われていなかったり、 変更が保存されていません。 最初のブートデバイスに正しいブートデバイスが設定されていることを確認してください。
. システムが古く、 希望しているメディアからの起動に対応していません。 この場合には、Plop Boot Manager (http://www.plop.at/en/bootmanagers.html[]) を使うと、選択したメディアからシステムを起動できます。

=== PowerPC(R) での起動

ほとんどのコンピュータでは、 起動中にキーボードの kbd:[C] を押しておくと、CD から起動します。 別の方法では kbd:[Command+Option+O+F]、 または non-Apple(R) キーボードでは kbd:[Windows+Alt+O+F] を押してください。`0 >` プロンプトで

[source,bash]
....
 boot cd:,\ppc\loader cd:0
....

と入力してください。

=== sparc64 での起動

ほとんどの sparc64 システムは、 ディスクから自動的に起動するように設定されています。 FreeBSD を CD からインストールするには、 PROM に入る必要があります。

PROM に入るにはシステムを再起動し、 ブートメッセージが表示されるまで待ってください。 モデルによりますが、以下のようなメッセージが表示されます。

[source,bash]
....
Sun Blade 100 (UltraSPARC-IIe), Keyboard Present
Copyright 1998-2001 Sun Microsystems, Inc.  All rights reserved.
OpenBoot 4.2, 128 MB memory installed, Serial 51090132.
Ethernet address 0:3:ba:b:92:d4, Host ID: 830b92d4.
....

もしシステムがこの時点でディスクから起動するようでしたら、 キーボードから kbd:[L1+A] または kbd:[Stop+A] を押すか、シリアルコンソールから `BREAK` を送信してください。 tip または cu を使用する場合には、`~#` によって BREAK を送ることができます。 単一の CPU を持つシステムでの PROM プロンプトは、`ok` で、 SMP システムのプロンプトは、 `ok {0}` です。 数字はアクティブな CPU の数を表しています。

ここで、CD をドライブに挿入し、 PROM プロンプトで `boot cdrom` と入力してください。

[[bsdinstall-view-probe]]
=== FreeBSD ブートメニュー

インストールメディアからシステムが起動すると、 以下のようなメニューが表示されます。

[[bsdinstall-newboot-loader-menu]]
.FreeBSD ブートローダメニュー
image::bsdinstall-newboot-loader-menu.png[]

デフォルトでは、メニューは、FreeBSD インストーラが起動するまで (FreeBSD がインストールされているシステムでは、FreeBSD が起動するまで)、 ユーザからの入力を 10 秒間受け付けます。 タイマーを停止してオプションを確認には、 kbd:[Space] を押してください。オプションを選択するには、 ハイライトされている番号、文字、もしくはキーを押してください。 以下のオプションが利用可能です。

* `Boot Multi User`: FreeBSD の起動プロセスを続けます。 ブートタイマが停止しているのであれば kbd:[1]、 大文字もしくは小文字の kbd:[B] または、 kbd:[Enter] を押してください。
* `Boot Single User`: このモードは、 すでにインストールされている FreeBSD を修復するために利用できます。 　シングルユーザモードについては、 crossref:boot[boot-singleuser,「シングルユーザモード」] で説明されています。 kbd:[2] もしくは、小文字もしくは、大文字の kbd:[S] を押すとこのモードに入ることができます。 
* `Escape to loader prompt`: 制限された低レベルのコマンドのみが利用可能な修復用プロンプトでシステムを起動します。 このプロンプトについては、 crossref:boot[boot-loader,「起動ステージ 3」] で説明されています。 kbd:[3] または kbd:[Esc] を押すとこのプロンプトで起動します。
* `Reboot`: システムを再起動します。
* `Kernel`: 別のカーネルを読み込みます。
* `Configure Boot Options`: <<bsdinstall-boot-options-menu>> で示されるメニューを開きます。

[[bsdinstall-boot-options-menu]]
.FreeBSD ブートオプションメニュー
image::bsdinstall-boot-options-menu.png[]

この起動オプションメニューは、 2 つのセクションから構成されています。 最初のセクションは、メインのブートメニューに戻ったり、 オプションをデフォルト値に戻すために利用できます。

次のセクションでは、変更可能なオプションついて、 選択されている番号や文字を、`On` や `Off` に変更できます。 システムは、これらのオプションが変更されない限り、 常に変更されたオプションで起動します。 このメニューで変更可能なオプションは以下の通りです。

* `ACPI Support`: 起動中にシステムが固まるようでしたら、このオプションを `Off` にしてください。
* `Safe Mode`: 上記のオプションの対応を行ってもシステムが起動時に固まるようでしたら、 `ACPI Support` を `Off` にし、このオプションを `On` に設定してください。
* `Single User`: シングルユーザモードでインストールされている FreeBSD を修復には、 `On` にしてください。 シングルユーザモードについては、 crossref:boot[boot-singleuser,「シングルユーザモード」] で説明されています。 問題が修正された後は、`Off` に戻してください。
* `Verbose`: 起動プロセスの表示をより詳細に表示したい場合には、 このオプションを `On` にしてください。 ハードウェアの問題を解決する際には有効です。

設定が終わったら、 kbd:[1] または kbd:[Backspace] を押してメインブートメニューに戻り、 kbd:[Enter] を押して FreeBSD の起動を続けてください。 FreeBSD がハードウェアの検出を行い、 インストールプログラムをロードしている間、 ブートメッセージが表示されます。 起動後、<<bsdinstall-choose-mode>> が表示されます。

[[bsdinstall-choose-mode]]
.ウェルカムメニュー
image::bsdinstall-choose-mode.png[]

kbd:[Enter] を押して、デフォルトの btn:[Install] を選択すると、インストール作業が始まります。 この章の残りの部分では、このインストーラの使い方について説明します。 メニュー項目を選択する他の方法としては、 左右の矢印キーを使ったり、色が変わっている文字を使ってください。 btn:[Shell] を選択すると、 インストールの前に、FreeBSD シェルからコマンドラインユーティリティでディスクを準備できます。 btn:[Live CD] オプションを選択すると、 インストール前に FreeBSD を試すことができます。 live 版については、<<using-live-cd>> で説明されています。

[TIP]
====

ハードウェアの検出などのブートメッセージを見るには 大文字または小文字の kbd:[S] を押してください。 その後、kbd:[Enter] を押して、 シェルにアクセスしてください。 シェルプロンプトから、`more /var/run/dmesg.boot` を入力してください。 メッセージのスクロールには、スペースバーを使ってってください。 終わったら、`exit` を押して、 ウェルカムメニューに戻ってください。
====

[[using-bsdinstall]]
== bsdinstall の使用

この章では、 bsdinstall メニューの順番と、 システムがインストールされる前に、 尋ねられる情報の形式について紹介します。 メニューオプションの選択には、矢印キーを使い、 メニューの項目の選択や解除する場合には、kbd:[Space] キーを使ってください。 設定が終わったら、kbd:[Enter] を押して設定を保存し、次の画面へ移動してください。

[[bsdinstall-keymap]]
=== キー配列メニューの選択

このプロセスが始まると、 bsdinstall は <<bsdinstall-keymap-loading>> のようにキーマップファイルを読み込みます。

[[bsdinstall-keymap-loading]]
.キーマップの読み込み
image::bsdinstall-keymap-loading.png[]

キーマップが読み込まれると、 bsdinstall は <<bsdinstall-keymap-10>> を表示します。 上下の矢印キーを使って、 システムのキーボードに最も近いキーマップを選択してください。 選択を保存するには、kbd:[Enter] キーを押してください。

[[bsdinstall-keymap-10]]
.キーマップ選択メニュー
image::bsdinstall-keymap-10.png[]

[NOTE]
====
kbd:[Esc] を押すと、メニューは終了し、 デフォルトのキーボードマップを使うようになります。 どのキーボードマップを選べばよいかわからない場合は、 [.guimenuitem]#United States of America ISO-8859-1# を選ぶとよいでしょう。
====

デフォルトとは異なるキーマップを選択した場合には、 <<bsdinstall-keymap-testing>> でキーマップのテストを行い、 インストールを先に進む前に正しく動くかどうかを確認できます。

[[bsdinstall-keymap-testing]]
.キーマップテストメニュー
image::bsdinstall-keymap-testing.png[]

[[bsdinstall-hostname]]
=== ホスト名の設定

次の bsdinstall のメニューでは、 新しくインストールするシステムに与えるホスト名を設定します。

[[bsdinstall-config-hostname]]
.ホスト名の設定
image::bsdinstall-config-hostname.png[]

ネットワーク上でユニークなホスト名を入力してください。 入力するホスト名は、`machine3.example.com` のように完全修飾のホスト名で入力してください。

[[bsdinstall-components]]
=== インストールするコンポーネントの設定

次に、 bsdinstall は、インストールするオプションのコンポーネントの選択に移ります。

[[bsdinstall-config-components]]
.インストールするコンポーネントの設定
image::bsdinstall-config-components.png[]

どのコンポーネントをインストールするかは、 システムの用途と用意されているディスク容量に依存します。 _base system_ として知られている FreeBSD カーネルとユーザランドは、 常にインストールされます。 アーキテクチャによっては、表示されないコンポーネントもあります。

* `base-dbg` - デバッグシンボルを有効にしたベースツール (cat, ls や他の多くのツール)。
* `kernel-dbg` - デバッグシンボルを有効にしたカーネルおよびモジュール。
* `lib32-dbg` - 32-bit のアプリケーションを 64-bit 版の FreeBSD で実行する際に必要となる互換ライブラリ (デバッグシンボルは有効)。
* `lib32` - 32-bit のアプリケーションを 64-bit 版の FreeBSD で実行する際に必要となる互換ライブラリ。
* `ports` - FreeBSD Ports Collection は、 サードパーティ製ソフトウェアパッケージのダウンロード、 コンパイル、 インストールを自動化するように設計されたファイルの集まりです。 Ports Collection の使い方については、 crossref:ports[ports,アプリケーションのインストール - packages と ports] で説明します。
+
[WARNING]
====

インストールプログラムは、 システムのディスクに十分な空き容量があるかどうかを確認しないので、 ハードディスクに十分な容量があるときだけ、 このオプションを選択するしてください。 FreeBSD 9.0 では、Ports Collection が必要とする容量は、 約 {ports-size} です。
====

* `src` - FreeBSD のカーネルおよびユーザランド両方の完全なソースコードです。 ほとんどのアプリケーションは必要としませんが、 デバイスドライバやカーネルモジュール、 Ports Collection のアプリケーションによってはコンパイル時に必要となります。 このソースは、FreeBSD そのものの開発に使うこともできます。 すべてのソースツリーをインストールするには 1 GB のディスク容量を必要とします。 また、FreeBSD システム全体のコンパイルには、 さらに 5 GB の容量が必要です。
* `tests` - FreeBSD テストスイート。

[[bsdinstall-netinstall]]
=== ネットワークからのインストール

<<bsdinstall-netinstall-notify>> で示されているメニューは、 [.filename]##-bootonly.iso##CD からインストールする時のみ表示されます。この インストールメディアは、インストールファイルを含んでいません。 ネットワーク経由でインストールファイルをダウンロードする必要があるため、 このメニューは、ネットワークインタフェースを最初に設定する必要があることを示しています。

[[bsdinstall-netinstall-notify]]
.ネットワークからのインストール
image::bsdinstall-netinstall-files.png[]

ネットワーク接続の設定を行うには、 kbd:[Enter] を押して、 <<bsdinstall-config-network-dev>> に示されている手順に従ってください。 ネットワーク接続の設定が終わったら、 FreeBSD をインストールするコンピュータと同じ地域のミラーサイトを選んでください。 ターゲットコンピュータの近くにミラーサイトがあると、 ファイルのダウンロードは早く終わるので、 インストールの時間は短くなります。

[[bsdinstall-netinstall-mirror]]
.ミラーサイトの選択
image::bsdinstall-netinstall-mirrorselect.png[]

ローカルメディアにインストールファイルが用意されているように、 インストールは先に進みます。

[[bsdinstall-partitioning]]
== ディスク領域の割り当て

次のメニューでは、ディスク領域を割り当てる方法を選択します。

[[bsdinstall-zfs-partmenu]]
.パーティション分割の選択
image::bsdinstall-zfs-partmenu.png[]

bsdinstall では、ディスク領域の割り当てのために 4 つの方法が用意されています。

* `Auto (UFS)` によるパーティションの分割では、 `UFS` ファイルシステムを使ってディスクパーティションを自動的に分割します。
* `Manual` によるパーティションの分割は、 高度な知識を持つユーザ向けで、 メニューオプションからカスタマイズしたパーティションを作成できます。
* `Shell` では、シェルプロンプトを起動し、 高度な知識を持つユーザが、 man:gpart[8], man:fdisk[8], man:bsdlabel[8] のようなコマンドラインのプログラムを実行して、 カスタマイズしたパーティションを作成できます。
* `Auto (ZFS)` によるパーティションの分割では、 root-on-ZFS システムを構築します。 GELI 暗号に対応した _ブート環境_ を構築することもできます。

この章では、 ディスクパーティションをレイアウトする際の検討事項を説明します。 その後、各パーティションの作成方法について説明します。

[[configtuning-initial]]
=== パーティションレイアウトのデザイン

ファイルシステムのレイアウトを行う際には、 ハードディスクの外周部は内周部よりもデータ転送が速いということを思い出してください。 これに従えば、 小さくて激しくアクセスされるファイルシステムを外周付近に、 [.filename]#/usr# のようなより大きなパーティションはディスクの内側に配置すべきでしょう。 そのため、パーティションを作成する際には、[.filename]#/#、 スワップ、[.filename]#/var#, [.filename]#/usr# のような順で作ってゆくのがよいでしょう。

[.filename]#/var# パーティションのサイズは、 あなたが計算機をどのように使おうとしているかを反映します。 このパーティションには主としてメールボックスやログファイル、 プリンタスプールが置かれます。 メールボックスとログファイルは、 システムのユーザ数やログの保持期間に依存して予期し得ぬサイズにまで成長する可能性があります。 概して、ほとんどのユーザは、[.filename]#/var# にギガバイト以上の空き容量を必要とはしないでしょう。

[NOTE]
====
時には、たくさんのディスク容量が [.filename]#/var/tmp# に必要になるときがあります。 新しいソフトウェアをインストールする際、 package のツールは、package の一時的なコピーを [.filename]#/var/tmp# 以下に展開します。 [.filename]#/var/tmp# 以下に十分なディスク容量が用意されていないと、 Firefox や LibreOffice のような、 大きなソフトウェア package のインストールが、 困難になることがあります。
====

[.filename]#/usr# パーティションには、 FreeBSD Ports Collection およびシステムのソースコードを含む、 システムをサポートするのに必要な多くのファイル群が置かれます。 このパーティションには、 少なくとも 2 ギガバイトの容量を用意することをおすすめします。

パーティションのサイズを考える時、 必要量を念頭に置いてください。 別のパーティションには潤沢にスペースが余っているのに、 あるパーティションでスペースが足らないままというのは、 フラストレーションがたまるものです。

経験からスワップパーティションのサイズは物理メモリ (RAM) の 2 倍というのが一般的です。 RAM の少ないシステムでは、 もっとスワップを増した方が性能がよくなります。 スワップが少なすぎる設定は、 あなたが後にメモリを増設したときに問題を起すばかりではなく、 VM ページスキャニングコードの能率を落します。

複数の SCSI ディスクや異なるコントローラで操作される複数の IDE ディスクを持つ大規模なシステムでは、 それぞれのドライブ (4 台まで) にスワップを設定することを推奨します。 各ドライブのスワップパーティションはほぼ同一サイズであるべきです。 カーネルは任意のサイズを扱うことができますが、 内部のデータ構造は最大のスワップパーティションの 4 倍に調節されます。 スワップパーティションをほぼ同一のサイズにしておくことで、 カーネルはスワップスペースを最適なかたちでディスクをまたいでストライプさせることができます。 あなたが通常スワップをたくさん使わないとしても、 多くのスワップサイズを用意しておくと良いでしょう。 プログラムが暴走しても再起動させられる前に回復することが容易になります。

システムを適切にパーティション化することで、 小さいが書き込みの激しいパーティションによって引き起こされるフラグメント化を、 読み出し専門のパーティションにまで波及させずにすみます。 また、書き込みの激しいパーティションをディスクの周辺部に配置することで、 I/O パフォーマンスを増大させることができます。 大きなパーティション内の I/O パフォーマンスもまた必要とされているでしょうが、 ディスク周辺部へ移動させたとしても、 [.filename]#/var# を周辺部に移動させることによって大きな効果が得られたのとは対照的に、 意味のあるパフォーマンスの増加は見込めないでしょう。

[[bsdinstall-part-guided]]
=== UFS を用いた Guided によるパーティションの分割

この方法を選択すると、 メニューには利用可能なディスクが表示されます。 複数のディスクが接続されている場合には、 FreeBSD をインストールするディスクを選択してください。

[[bsdinstall-part-guided-disk]]
.複数のディスクから選択する
image::bsdinstall-part-guided-disk.png[]

ディスクを選択したら、次のメニューでは、 ディスクのすべてにインストールを行うか、 または空き容量にパーティションを作成してインストールを行うかを設定します。 btn:[Entire Disk] を選択すると、 一般的なパーティションレイアウトが自動的に作成されます。 btn:[Partition] を選択すると、 ディスクの使用していない領域にパーティションレイアウトを作成します。

[[bsdinstall-part-entire-part]]
.Entire Disk または Partition の選択
image::bsdinstall-part-entire-part.png[]

btn:[Entire Disk] を選択すると、 bsdinstall は、 ディスクの内容が消去されることを確認するダイアログを表示します。

[[bsdinstall-ufs-warning]]
.確認
image::bsdinstall-ufs-warning.png[]

次のメニューでは、 パーティションスキームタイプの一覧が表示されます。 amd64 コンピュータでは、通常 GPT が最も適切な選択となります。 GPT に対応していないような古いコンピュータでは、 MBR を使う必要があります。 他のパーティションスキームは、使うことがまれであったり、 古いコンピュータで用いられるものです。 <<partition-schemes>> に詳細があります。

[[bsdinstall-ufs-scheme]]
.パーティションスキームの選択
image::bsdinstall-part-manual-partscheme.png[]

パーティションのレイアウトを作成したら、 インストールの条件を満たしているかどうかを深く確認してください。 btn:[Revert] を選択すると、 パーティションをオリジナルの値にリセットします。 また、btn:[Auto] を選択すると、 FreeBSD パーティションを自動的に作成します。 パーティションを手動で作成、変更、削除することもできます。 正しくパーティションを作成出来たら、 btn:[Finish] を選択し、 インストールを進めてください。

[[bsdinstall-part-review]]
.作成されたパーティションの確認
image::bsdinstall-part-review.png[]

ディスクを一度設定すると、次のメニューは、 選択したハードドライブをフォーマットする前に、 設定を変更する最後のチャンスです。 もし変更が必要であれば、 btn:[Back] を選択してメインのパーティションエディタまで戻ってください。 btn:[Revert & Exit] を選択すると、 ハードドライブへの変更なしにインストールを終了します。 インストールプロセスを開始するのには、 btn:[Commit] を選択してしてください。

[[bsdinstall-ufs-final-confirmation]]
.最後の確認
image::bsdinstall-final-confirmation.png[]

<<bsdinstall-fetching-distribution>> に進んで、インストールプロセスを続けてください。

[[bsdinstall-part-manual]]
=== Manual によるパーティションの分割

この方法を選択すると、 パーティションエディタが起動します。

[[bsdinstall-part-manual-create]]
.Manual によるパーティションの分割
image::bsdinstall-part-manual-create.png[]

インストール先のドライブ (この例では [.filename]#ada0#) を選び、 btn:[Create] を選択すると、 利用可能なパーティションスキームの一覧が表示されます。

[[bsdinstall-part-manual-partscheme]]
.手動でパーティションを作成する
image::bsdinstall-part-manual-partscheme.png[]

amd64 コンピュータでは、通常 GPT が最も適切な選択となります。 GPT に対応していないような古いコンピュータでは、 MBR を使う必要があります。 他のパーティションスキームは、使うことがまれであったり、 古いコンピュータで用いられるものです。

[[partition-schemes]]
.パーティションスキーム
[cols="1,1", frame="none", options="header"]
|===
<| 省略形
<| 説明

|APM
|PowerPC(R) で使われている Apple Partition Map

|BSD
|MBR を用いない BSD ラベル。 BSD 以外のディスクユーティリティは認識しないため、しばしば _dangerously dedicated mode_ と呼ばれます。

|GPT
|GUID Partition Table (http://en.wikipedia.org/wiki/GUID_Partition_Table[http://en.wikipedia.org/wiki/GUID_Partition_Table])

|MBR
|Master Boot Record (http://en.wikipedia.org/wiki/Master_boot_record[http://en.wikipedia.org/wiki/Master_boot_record])

|VTOC8
|Volume Table Of Contents。 Sun SPARC64 および UltraSPARC コンピュータで使われます。
|===

パーティションスキームを選択して作成した後で、 もう一度 btn:[Create] を選択すると、 パーティションが作成されます。kbd:[Tab] キーを使ってカーソルをフィールド間で移動できます。

[[bsdinstall-part-manual-addpart]]
.手動でパーティションを作成する
image::bsdinstall-part-manual-addpart.png[]

標準の FreeBSD GPT のインストールでは、 少なくとも 3 つのパーティションが使われます。

* `freebsd-boot` - FreeBSD ブートコードを含んでいます。
* `freebsd-ufs` - FreeBSD UFS ファイルシステム。
* `freebsd-zfs` - FreeBSD ZFS ファイルシステム。 詳細については、 (crossref:zfs[filesystems-zfs,The Z File System (ZFS)]) をご覧ください。
* `freebsd-swap` - FreeBSD スワップ空間。

利用可能な GPT パーティションタイプについては、man:gpart[8] をご覧ください。

複数のファイルシステムのパーティションを作成できます。 [.filename]#/#, [.filename]#/var#, [.filename]#/tmp# そして [.filename]#/usr# といった伝統的なパーティション分割のレイアウトを好む人もいます。 レイアウトの例が <<bsdinstall-part-manual-splitfs>> にあります。

`Size` には、 _K_ (キロバイト)、 _M_ (メガバイト)、 _G_ (ギガバイト) といった通常の省略形を使用出来ます。

[TIP]
====

セクタを適切に配置することで、 最良のパフォーマンスを得ることができます。 また、パーティションサイズを 4K バイトの偶数倍にすると、 512 バイトまたは 4K バイトのセクタでドライブが配置しやすくなります。 一般的に、 4K の偶数倍の場所からパーティションが開始するように設定する簡単な方法は、 1M または 1G の偶数倍のパーティションサイズを用いることです。 ただし、例外があります。 _freebsd-boot_ パーティションは、 ブートコードの制限により 512K 以下である必要があります。
====

ファイルシステムを持つパーティションでは、 `Mountpoint` が必要となります。 1 つの UFS パーティションだけを作成したのであれば、 マウントポイントは [.filename]#/# となります。

`Label` は作成したパーティションを認識するための名前です。 ドライブ名や番号は、 ドライブが別のコントローラやポートに接続されると変わることがありますが、 パーティションラベルは変わりません。 [.filename]#/etc/fstab# のようなファイルの中で、 ドライブ名やパーティション番号ではなく、ラベルを参照することにより、 システムがハードウェアの変更に対して、より寛容になります。 GPT ラベルは、 ディスクが接続されると [.filename]#/dev/gpt/# に現れます。他のパーティションスキームでは別のラベルとなり、 [.filename]#/dev/# 以下の異なるディレクトリにラベルが現れます。

[TIP]
====

名前の衝突を避けるため、 各パーティションには、一意的な名前使ってください。 コンピュータ名、使用、位置情報を表す単語をラベルに追加できます。 たとえば、`lab` という名前のコンピュータの UFS の root パーティションには、 `labroot` または `rootfs-lab` といった名前を使ってください。
====

[[bsdinstall-part-manual-splitfs]]
.伝統的なファイルシステムのパーティションを作成する。
[example]
====
伝統的なパーティションレイアウト ([.filename]#/#, [.filename]#/var#, [.filename]#/tmp# および [.filename]#/usr# ディレクトリが各パーティションの別のファイルシステム) を作成するには、 GPT パーティションスキームを作成し、 その後、示されているようにパーティションを作成してください。 示されているパーティションサイズは 20G のディスク用です。 ディスクにより多くの容量があれば、swap または [.filename]#/var# パーティションを大きく取ると良いでしょう。 ここで示されているラベルには、 `example` を意味する `ex` が付けられていますが、 実際には上で説明したように、 これとは別のユニークなラベルをつけてください。

FreeBSD の [.filename]#gptboot# は、 デフォルトでは最初に見つかった UFS パーティションが、 [.filename]#/# パーティションであることを前提としています。

[.informaltable]
[cols="1,1,1,1", frame="none", options="header"]
|===
| パーティションタイプ
| サイズ
| マウントポイント
| ラベル

|`freebsd-boot`
|`512K`

|`freebsd-ufs`
|`2G`
|[.filename]#/#
|`exrootfs`

|`freebsd-swap`
|`4G`
|
|`exswap`

|`freebsd-ufs`
|`2G`
|[.filename]#/var#
|`exvarfs`

|`freebsd-ufs`
|`1G`
|[.filename]#/tmp#
|`extmpfs`

|`freebsd-ufs`
|デフォルト (ディスクの残りのすべての容量)
|[.filename]#/usr#
|`exusrfs`
|===
====

カスタムパーティションを作成したら、 btn:[Finish] を選択して <<bsdinstall-fetching-distribution>> に進み、インストールを先に進めてください。

[[bsdinstall-part-zfs]]
=== Root-on-ZFS を用いた Guided によるパーティションの作成

root-on-ZFS のインストール時の自動作成は、 FreeBSD 10.0-RELEASE から対応しました。 このパーティションのモードは、 ディスクのすべての領域に対して機能するので、 ディスク上にあるすべての内容を消去してしまいます。 インストーラは ZFS が 4k セクタを使うように、 自動的に 4k の境界にアラインするようパーティションを作成します。 512 バイトセクタのディスクでも利用できます。 512 バイトのディスクで作成されたプールに、 将来ストレージ空間を追加したり、壊れたディスクの置き換えにおいて、4k セクタのディスクを追加できるようにしておくことにはメリットがあります。 インストーラはオプションとして、 GELI ディスクの暗号化にも対応しています。  暗号化を有効にすると、[.filename]#/boot# ディレクトリを含む 2 GB の暗号化されていないブートプールが作成されます。 ここには、カーネルとシステムを起動するのに必要なファイルが含まれます。 ユーザがサイズを選択可能な swap パーティションも作成され、 残りのスペースが ZFS プールとして使われます。

インストーラの ZFS 設定メニューには、 プールの作成をコントロールする数多くのオプションが用意されています。

[[bsdinstall-zfs-menu]]
.ZFS パーティションメニュー
image::bsdinstall-zfs-menu.png[]

kbd:[T] を選択して、`Pool Type` およびプールに対応するディスクを選択してください。 現在のところ、自動の ZFS インストーラは、 ストライプモードを除き、 単一のトップレベルの仮想デバイスの作成のみに対応しています。 より複雑なプールを作成するには、<<bsdinstall-part-shell>> で説明されている方法で作成してください。 インストーラは、ストライプ (推奨されません。冗長性なし)、ミラー (ベストなパフォーマンス。使用できる容量は最小) および RAID-Z 1, 2 および 3 (それぞれ 1, 2 および 3 ディスクの同時障害へ対応)、 といったさまざまなタイプのプールの作成に対応しています。 選択されているプールタイプに対しては、スクリーンの下に、 必要なディスク数、RAID-Z の場合には、 各設定に対して最適なディスクの数についてのアドバイスが表示されます。

[[bsdinstall-zfs-vdev_type]]
.ZFS プールタイプ
image::bsdinstall-zfs-vdev_type.png[]

`Pool Type` を選択したら、 利用可能なディスクの一覧が表示されます。 その後、プールを構成するディスクを、1 つまたは複数選択してください。 十分なディスクが選択されているかどうかについて検証が行われます。 もし、問題があるようでしたら、 btn:[<Change Selection>] を選択して、ィスクの一覧に戻ってください。 もしくは、 btn:[<Cancel>] を選択して、 プールのタイプを変更してください。

[[bsdinstall-zfs-disk_select]]
.ディスクの選択
image::bsdinstall-zfs-disk_select.png[]

[[bsdinstall-zfs-vdev_invalid]]
.問題のある選択
image::bsdinstall-zfs-vdev_invalid.png[]

この一覧の中に抜けているディスクがある時や、 インストーラが立ち上がった後にディスクを接続した場合に、 最新の利用可能なディスクの一覧を見るには、 btn:[- Rescan Devices] を選択してください。 アクシデントで間違ったディスクを削除してしまわないように、 btn:[- Disk Info] メニュー選択して、 各ディスクのパーティションテーブル、および、 デバイスモデル番号およびシリアル番号などのさまざまな情報を確認してください。

[[bsdinstall-zfs-disk_info]]
.ディスクの解析
image::bsdinstall-zfs-disk_info.png[]

メインの ZFS 設定メニューでは、 pool 名の入力、4k セクタ制限の設定の無効化、 暗号化の有効 / 無効の設定、パーティションテーブルタイプの GPT (推奨) と MBR の切り替え、 そしてスワップ領域の容量を設定できます。 すべてのオプションが適切な値に設定されたら、 メニューのトップにある btn:[>>> Install] オプションを選択してください。

GELI ディスク暗号化を有効にしていたら、 ディスクを暗号化するために用いるパスフレーズを 2 度求められます。

[[bsdinstall-zfs-geli_password]]
.ディスク暗号化パスワード
image::bsdinstall-zfs-geli_password.png[]

インストーラは、選択されたドライブの中身が ZFS プールを作成することで破棄されることをキャンセルするかどうかの最終確認を行います。

[[bsdinstall-zfs-warning]]
.最終確認
image::bsdinstall-zfs-warning.png[]

その後のインストールの過程は、通常通りに進みます。

[[bsdinstall-part-shell]]
=== シェルモードによるパーティションの作成

高度なインストールを行うには、bsdinstall が提供するパーティション分割のメニューは柔軟性にかけることがあります。 高度な技術を持つユーザは、パーティションメニューで btn:[Shell] オプションを選択することで、 手動でドライブを分割して、ファイルシステムを作成し、 [.filename]#/tmp/bsdinstall_etc/fstab# を作成し、 [.filename]#/mnt# 以下にファイルシステムをマウントできます。 以上を実行したら、 `exit` を実行して bsdinstall に戻り、 インストールを続けてください。

[[bsdinstall-fetching-distribution]]
== 配布ファイルのダウンロード

インストールにかかる時間は、どのディストリビューションを選んだか、 どのインストールメディアを使ったか、 そしてコンピュータの速度にも依存します。 進行状況を表すメッセージが逐次表示されます。

まず最初に、インストーラは選択されているディスクをフォーマットし、 パーティションを初期化します。 `bootonly media` または `mini memstick` メディアを用いたインストールでは、 選択されたコンポーネントがダウンロードされます。

[[bsdinstall-distfile-fetching]]
.配布ファイルのダウンロード
image::bsdinstall-distfile-fetching.png[]

次に、ダウンロードの際にエラーが含まれなかったか、 インストールメディアからの読み取り中に読み間違いが起きなかったかどうか等、 配布ファイルの完全性の検証が行われます。

[[bsdinstall-distfile-verify]]
.配布ファイルの検証
image::bsdinstall-distfile-verifying.png[]

最後に、検証された配布ファイルがディスクへ展開されます。

[[bsdinstall-distfile-extract]]
.配布ファイルの展開
image::bsdinstall-distfile-extracting.png[]

必要な配布ファイルがすべて展開されると、 bsdinstall は、 インストール後の設定画面を表示します。 利用可能なインストール後のオプションについては次の章で説明します。

[[bsdinstall-post]]
== インストール後の作業

FreeBSD のインストールが完了したら、 新しくインストールしたシステムで起動する前に、 bsdinstall は、 さまざまなオプションの設定に移ります。 この章では、これらのオプションについて説明します。

[TIP]
====

一度システムを起動した後は、 `bsdconfig` を使うと、 ここで説明するオプションや追加のオプションによるシステムの設定を、 メニュー形式で行えます。
====

[[bsdinstall-post-root]]
=== `root` パスワードの設定

最初に `root` のパスワードを設定する必要があります。 パスワードを入力している際には、 入力している文字は画面に表示されません。 パスワードの入力後、もう一度入力する必要があります。 これは入力ミスを防ぐためです。

[[bsdinstall-post-set-root-passwd]]
.`root` パスワードの設定
image::bsdinstall-post-root-passwd.png[]

[[bsdinstall-config-network-dev]]
=== ネットワークインタフェースの設定

次に、 コンピュータが認識したすべてのネットワークインタフェースが表示されます。 設定するネットワークインタフェースを選んでください。

[NOTE]
====
_bootonly_ によるインストールの一部として、 すでにネットワークの設定を終えているのであれば、 このネットワークの設定メニューは飛ばしてください。
====

[[bsdinstall-configure-net-interface]]
.イーサネットインタフェースの選択
image::bsdinstall-configure-network-interface.png[]

イーサネットインタフェースを選択したのであれば、<<bsdinstall-configure-net-ipv4>> で表示されるメニューまで飛びます。 ワイヤレスネットワークを選択したのであれば、 システムはワイヤレスアクセスポイントをスキャンします。

[[bsdinstall-wireless-scan]]
.ワイヤレスアクセスポイントのスキャン
image::bsdinstall-configure-wireless-scan.png[]

ワイヤレスネットワークは Service Set Identifier (SSID) によって識別されます。 SSID は、それぞれのネットワークに与えられる、 短く、一意的な名前です。 スキャンで見つかった SSID の一覧は、 そのネットワークで利用できる暗号化のタイプの説明とともに表示されます。 もし、期待した SSID が一覧に表示されていなければ、 btn:[Rescan] を選択してもう一度スキャンしてください。 もし、期待したネットワークが表示されなければ、 接続のためのアンテナを確認したり、 コンピュータをアクセスポイントの近くに移動させてみてください。 その後もう一度スキャンしてください。

[[bsdinstall-wireless-accesspoints]]
.ワイヤレスネットワークの選択
image::bsdinstall-configure-wireless-accesspoints.png[]

次に、 ワイヤレスネットワークに接続するための暗号情報を入力してください。 WEP のような古い暗号の安全性は低いので、 WPA2 暗号が強く推奨されます。 WPA2 を使用してるネットワークでは、 Pre-Shared Key (PSK) と呼ばれるパスワードを入力してください。 セキュリティ上の観点から、 入力ボックスに入力した文字はアスタリスクで表示されます。

[[bsdinstall-wireless-wpa2]]
.WPA2 のセットアップ
image::bsdinstall-configure-wireless-wpa2setup.png[]

次は、イーサネットもしくはワイヤレスインタフェースに対して、 IPv4 を設定するかどうかを選択します。

[[bsdinstall-configure-net-ipv4]]
.IPv4 ネットワークの選択
image::bsdinstall-configure-network-interface-ipv4.png[]

IPv4 の設定方法は 2 通りあります。 _DHCP_ はネットワークインタフェースを自動的に適切に設定する方法で、 DHCP サーバのあるネットワークでは使用すべきです。 もし、DHCP を利用できない環境では、 静的な設定として、 ネットワークのアドレス情報を手動で入力する必要があります。

[NOTE]
====
適当なネットワーク情報を入力しても動かないので、 DHCP サーバが利用できなのであれば、 ネットワーク管理者またはサービスプロバイダから <<bsdinstall-collect-network-information,必要となるネットワーク情報>> に示されている情報を入手してください。
====

DHCP サーバを利用できるのであれば、 次のメニューで btn:[Yes] を選択して、 ネットワークインタフェースの設定を自動的に行ってください。 インストーラは DHCP サーバを検索し、 システムに対するアドレス情報を入手するために、 少しの間停止しているように表示されます。

[[bsdinstall-net-ipv4-dhcp]]
.IPv4DHCP 設定の選択
image::bsdinstall-configure-network-interface-ipv4-dhcp.png[]

DHCP サーバを利用できない環境では、 btn:[No] を選択し、 このメニューにおいて以下のアドレス情報を入力してください。

[[bsdinstall-net-ipv4-static]]
.IPv4 の静的な設定
image::bsdinstall-configure-network-interface-ipv4-static.png[]

[[bsdinstall-collect-network-information]]
* `IP Address` - コンピュータに手動で与える IPv4 アドレスです。 このアドレスは一意的なものである必要があり、 すでにローカルネットワーク上の他のネットワーク機器で使われているものではいけません。
* `Subnet Mask` - ネットワークのサブネットマスクです。
* `Default Router` - このネットワークのデフォルトゲートウェイの IP アドレスです。

次の画面では、インタフェースを IPv6 で設定すべきかを選択します。 IPv6 が利用でき、希望するのであれば、 btn:[Yes] を選択してください。

[[bsdinstall-net-ipv6]]
.IPv6 ネットワークの選択
image::bsdinstall-configure-network-interface-ipv6.png[]

IPv6 の設定に関しても 2 つの方法があります。 StateLess Address AutoConfiguration (_SLAAC_) は、ローカルルータから適切なネットワーク設定情報を入手するように、 自動的にリクエストします。 詳細については http://tools.ietf.org/html/rfc4862[http://tools.ietf.org/html/rfc4862] を参照してください。静的な設定では、 ネットワーク情報を手動で入力する必要があります。

IPv6 ルータを利用できるのであれば、 次のメニューで btn:[Yes] を選択し、 ネットワークインタフェースの設定を自動的に行ってください。 インストーラはルータを見つけ出し、 システムに対するアドレス情報を入手するために、 少しの間停止しているように表示されます。

[[bsdinstall-net-ipv6-slaac]]
.IPv6 SLAAC 設定の選択
image::bsdinstall-configure-network-interface-slaac.png[]

IPv6 ルータが利用できない環境では、 btn:[No] を選択して、 表示されるメニューで以下のアドレス情報を入力する必要があります。

[[bsdinstall-net-ipv6-static]]
.IPv6 の静的な設定
image::bsdinstall-configure-network-interface-ipv6-static.png[]

* `IPv6 Address` - このコンピュータに割り当てられた IPv6 アドレスです。 このアドレスは一意的なものである必要があり、 すでにローカルネットワーク上の他のネットワーク機器で使われているものではいけません。
* `Default Router` - このネットワークのデフォルトゲートウェイの IPv6 アドレスです。

最後のネットワークメニューでは、 Domain Name System (DNS) リゾルバを設定します。 これは、ホスト名とネットワークアドレスを変換します。 すでに DHCP または SLAAC を使って自動的にネットワークインタフェースを設定したのであれば、 `Resolver Configuration` には値がすでに入っているでしょう。 そうでなければ、`Search` フィールドにローカルネットワークのドメイン名を入力してください。 `DNS` #1 および `DNS` #2 は、 ローカル DNS サーバの IPv4 または IPv6 アドレスです。 少なくとも、1 つの DNS サーバは必要です。

[[bsdinstall-net-dns-config]]
.DNS の設定
image::bsdinstall-configure-network-ipv4-dns.png[]

[[bsdinstall-timezone]]
=== タイムゾーンの設定

次のメニューでは、地域、国、タイムゾーンを指定します。 使用しているシステムのタイムゾーンを設定することで、 夏時間などの地域による時刻の違いが自動的に調整され、 タイムゾーンに関連した機能が適切に取り扱われます。

ここでの例は、 欧州スペインのメインランドタイムゾーンにあるコンピュータに対するものです。 実際の地理的位置に対応するタイムゾーンを設定してください。

[[bsdinstall-timezone-region]]
.地域の選択
image::bsdinstall-timezone-region.png[]

矢印キーを使って、適切な地域を選択し、 kbd:[Enter] を押してください。

[[bsdinstall-timezone-country]]
.国名の選択
image::bsdinstall-timezone-country.png[]

矢印キーを使って、適切に国名を選び、 kbd:[Enter] を押してください。

[[bsdinstall-timezone-zone]]
.タイムゾーンの選択
image::bsdinstall-timezone-zone.png[]

矢印キーを使って適切なタイムゾーンを選択し、 kbd:[Enter] を押してください。

[[bsdinstall-timezone-confirmation]]
.タイムゾーンの確定
image::bsdinstall-timezone-confirm.png[]

タイムゾーンの省略形が正しいかどうかを確認してください。

[[bsdinstall-timezone-date]]
.日付の設定
image::bsdinstall-timezone-date.png[]

矢印キーを使って適切な日付を選択したら、 btn:[Set Date] を押してください。 btn:[Skip] を押すと日付の設定をスキップできます。

[[bsdinstall-timezone-time]]
.時刻の設定
image::bsdinstall-timezone-time.png[]

矢印キーを使って適切な時刻に設定したら、 btn:[Set Time] を押してください。 btn:[Skip] を押すと時刻の設定をスキップできます。

[[bsdinstall-sysconf]]
=== サービスを有効にする

次のメニューでは、システムが起動した時に、 起動するシステムサービスを設定します。 これらのサービスはすべてオプションです。 システムの機能として必要なサービスだけを起動するようにしてください。

[[bsdinstall-config-serv]]
.追加で有効にするサービスの選択
image::bsdinstall-config-services.png[]

このメニューで有効にできるサービスは以下の通りです。

* `local_unbound` - DNS のローカル unbound を有効にします。 この設定はベースシステムの unbound に対するもので、 ローカルキャッシュフォワードリゾルバとしての利用のみを想定しています。 ネットワーク全体のリゾルバを設定したいのであれば、 package:dns/unbound[] をインストールしてください。
* `sshd` - セキュアシェル (SSH) デーモンは、 暗号化された接続上でリモートアクセスするために使われます。 システムがリモートログインを必要とする場合のみ、 このサービスを有効にしてください。
* `moused` - システムのコンソールで、 マウスを利用する時に、このサービスを有効にしてください。
* `ntpdate` - 起動時の自動時刻同期を有効にします。 この機能は、現在 man:ntpd[8] デーモンでも利用できます。 猶予期間が経過したら、man:ntpdate[8] ユーティリティはその役目を終える予定です。
* `ntpd` - 自動時刻同期のための The Network Time Protocol (NTP) デーモン。 ネットワーク上に、 Windows(R), Kerberos または LDAP サーバがあるときには、このサービスを有効にしてください。
* `powerd` - 電源の管理およびエネルギーを節約するための電源コントロールユーティリティ
* `dumpdev` - システムのデバッグを行う上で、 クラッシュダンプを有効にすることは有用です。 可能であればクラッシュダンプを有効にすると良いでしょう。

[[bsdinstall-hardening]]
=== セキュリティを強化するオプションを有効にする

次のメニューでは、 有効にするセキュリティオプションを設定します。 すべてはオプションですが、有効にすることが推奨されます。

[[bsdinstall-hardening-options]]
.セキュリティを強化するオプションの設定
image::bsdinstall-hardening.png[]

このメニューで有効にできるのは、以下のオプションです。

* `hide_uids` - 情報漏洩防止のため、特権のないユーザが、他のユーザ (UID) により実行されているプロセスを見れないように、 他のユーザが実行しているプロセスを隠します。
* `hide_gids` - 情報漏洩防止のため、特権のないユーザが、他のグループ (GID) により実行されているプロセスを見れないように、 他のユーザが実行しているプロセスを隠します。
* `hide_jail` - 特権のないユーザが、jail の中で実行されているプロセスを見れないように、 jail で実行中のプロセスを隠します。
* `read_msgbuf` - 権限のないユーザが、man:dmesg[8] を使ってカーネルログバッファのメッセージを見ることで、 カーネルメッセージバッファを読むことを無効にします。 
* `proc_debug` - ptrace() および ktrace() といった procfs 機能を含む、 さまざまな特権のないプロセス間のデバッキングサービスを、 特権のないユーザが無効にしないように、 プロセスデバッキング機能を無効にします。 このオプションによって、PHP などのスクリプト言語に対する組み込みのデバッキング機能と同様に、 たとえば man:lldb[1], man:truss[1], man:procstat[1] などの特権のないユーザによるデバッキングツールも無効になります。
* `random_pid` - 新しく生成されるプロセスの PID をランダム化します。
* `clear_tmp` - システムの起動時に [.filename]#/tmp# を空にします。
* `disable_syslogd` - syslogd ネットワークソケットを閉じます。 デフォルトでは、FreeBSD は syslogd を `-s` を使った安全な方法で実行します。 これは、外からのポート 514 に対する UDP リクエストを待機しません。 このオプションを有効にすると、 syslogd を `-ss` フラグで実行します。 このフラグにより、syslogd は空いているどのポートからも受け付けません。 詳細は、man:syslogd[8] をご覧ください。
* `disable_sendmail` - sendmail MTA を無効にします。
* `secure_console` - このオプションを有効にすると、シングルユーザモードに入る際に、 プロンプトに対して root パスワードが必要となります。
* `disable_ddtrace` - DTrace は、 実行中のカーネルに実際に影響を及ぼすモードで実行できます。 破壊的なアクションは、明示的に有効にしない限りは利用できません。 破壊的なアクションを実行できるようにするには、 `-w` を使って DTrace を実行する必要があります。 詳細については man:dtrace[1] をご覧ください。

[[bsdinstall-addusers]]
=== ユーザの追加

次のメニューでは、少なくとも一人のユーザを追加してください。 システムには `root` ではなく、ユーザアカウントでログインすることが推奨されています。 `root` 権限でログインすると、実行に対して制限がなく、また、保護されません。 通常のユーザでログインすることにより、 安全でセキュリティ的に危険が少なくなります。

btn:[Yes] を選択し、 新しいユーザを追加してください。

[[bsdinstall-add-user1]]
.新しいユーザのアカウントの作成
image::bsdinstall-adduser1.png[]

プロンプトに従い、 ユーザアカウントの作成で必要となる情報を入力してください。 <<bsdinstall-add-user2>> で示されている例では、`asample` ユーザアカウントを作成します。

[[bsdinstall-add-user2]]
.ユーザ情報の入力
image::bsdinstall-adduser2.png[]

以下は、入力情報のまとめです。

* `Username` - ログイン時のユーザ名を入力します。一般的な慣習では、 ファーストネームの最初の文字とラストネームを、 ユーザ名がシステムで一意的になる長さで組み合わせます。 ユーザ名は、大文字と小文字を区別し、 空白を含んではいけません。
* `Full name` - ユーザのフルネーム。 空白を含むことは可能です。 また、この情報はユーザアカウントの説明の記述に使われます。
* `Uid` - ユーザ ID 番号。 通常は、システムが自動的に割り当てるように、 空欄のままにします。
* `Login group` - 新しいユーザのログイングループ。 空欄のままにすると、デフォルトに割り当てられます
* `Invite _user_ into other groups?` - ユーザを別のグループのメンバーとして追加するかどうか。 ユーザが管理者としてのアクセス必要であれば、 ここで ``wheel`` を入力してください。
* `Login class` - 空欄にするとデフォルトの設定になります。
* `Shell` - 一覧の中から、ユーザのシェルを入力してください。 シェルに関する詳細については crossref:basics[shells,「シェル」] をご覧ください。
* `Home directory` - ユーザのホームディレクトリ。 通常は、デフォルトの場所が適切です。
* `Home directory permissions` - ユーザのホームディレクトリの権限。 通常は、デフォルトが適切です。
* `Use password-based authentication?` - 通常は、ユーザがログイン時にパスワードの入力が要求されるように `yes` と入力してください。
* `Use an empty password?` - 通常は、パスワードがないと安全ではなくなるので、 `no` です。
* `Use a random password?` - 通常は、次のプロンプトでユーザ自身のパスワードを入力できるように、 `no` です。
* `Enter password` - ユーザのパスワードです。 入力している文字は画面に表示されません。
* `Enter password again` - 確認のため、パスワードをもう一度入力します。
* `Lock out the account after creation?` - 通常は、ユーザがログインできるようにするため、 `no` です。

すべてを入力したら、サマリが表示され、 正しいかどうかの確認を求められます。 入力した情報に間違いがあれば、 `no` を入力してもう一度作業を行なってください。 すべてが正しく入力されていれば、 `yes` を入力して、 新しいユーザを作成してください。

[[bsdinstall-add-user3]]
.ユーザおよびグループの管理を終了する
image::bsdinstall-adduser3.png[]

さらにユーザを追加するのであれば、 `Add another user?` の質問に対し、 `yes` を入力してください。 `no` を入力すると、ユーザの追加が終わり、次に進みます。

ユーザの追加や、ユーザ管理の詳細については、 crossref:users[users-synopsis,「この章では」] を参照してください。

[[bsdinstall-final-conf]]
=== 最後の設定

すべてをインストールし、設定が終わった後に、 最後に設定を修正する機会が与えられます。

[[bsdinstall-final-config]]

image::bsdinstall-finalconfiguration.png[]

インストールを完了する前に、 このメニューを使って変更、または、追加の設定を行なってください。

.最終の設定オプション
* `Add User` - <<bsdinstall-addusers>> で説明しています。
* `Root Password` - <<bsdinstall-post-root>> で説明しています。
* `Hostname` - <<bsdinstall-hostname>> で説明しています。
* `Network` - <<bsdinstall-config-network-dev>> で説明しています。
* `Services` - <<bsdinstall-sysconf>> で説明しています。
* `System Hardening` - <<bsdinstall-hardening>> で説明しています。
* `Time Zone` - <<bsdinstall-timezone>> で説明しています。
* `Handbook` - FreeBSD ハンドブックのダウンロードとインストール。

最後の設定が完了したら、btn:[Exit] を選んでください。

[[bsdinstall-final-modification-shell]]
.Manual Configuration
image::bsdinstall-final-modification-shell.png[]

新しいシステムを再起動する前に、 bsdinstall は追加の設定が必要かどうかを尋ねてきます。 btn:[Yes] を選択して新しいシステムのシェルに入るか、または btn:[No] を選択して、インストールの最後のステップに進んでください。

[[bsdinstall-final-main]]
.インストールの終了
image::bsdinstall-mainexit.png[]

追加の設定や、特別なセットアップが必要であれば、 btn:[Live CD] を選んでインストールメディアを Live CD で起動してください。

インストールが終わったら、 btn:[Reboot] を選んで、 コンピュータを再起動し、新しい FreeBSD システムで起動してください。 再起動する前には、忘れずに FreeBSD インストールメディアを外してください。 さもないと、もう一度インストールメディアから起動してしまいます。

FreeBSD の起動時には、多くのメッセージが画面に表示されます。 システムの起動後には、ログインプロンプトが表示されます。 `login:` プロンプトで、 インストール時に追加したユーザ名を入力してください。 `root` でのログインは避けてください。管理者の権限が必要となった時に、 スーパユーザになる方法については、crossref:users[users-superuser,「スーパーユーザアカウント」] を参照してください。

起動時に表示されていたメッセージは、 kbd:[Scroll-Lock] を押し、 scroll-back buffer で見ることができます。 kbd:[PgUp], kbd:[PgDn] そして矢印キーでメッセージをスクロールバックできます。 メッセージの確認が終わったら、kbd:[Scroll-Lock] をもう一度押すと、ディスプレイのロックを外し、 コンソールに戻ることができます。 何度かシステムを起動した後で、これらのメッセージを見るには、 コマンドプロンプトから `less /var/run/dmesg.boot` と入力してください。 確認後に kbd:[q] を押すと、 コマンドラインに戻ります。

<<bsdinstall-config-serv>> にて、 sshd を有効に設定した場合には、 最初の起動時にシステムが RSA および DSA キーを生成するため、 少々時間がかかるかもしれません。 その後の起動はより速くなるでしょう。 鍵のフィンガープリントは、以下の例のように表示されます。

[source,bash]
....
Generating public/private rsa1 key pair.
Your identification has been saved in /etc/ssh/ssh_host_key.
Your public key has been saved in /etc/ssh/ssh_host_key.pub.
The key fingerprint is:
10:a0:f5:af:93:ae:a3:1a:b2:bb:3c:35:d9:5a:b3:f3 root@machine3.example.com
The key's randomart image is:
+--[RSA1 1024]----+
|    o..          |
|   o . .         |
|  .   o          |
|       o         |
|    o   S        |
|   + + o         |
|o . + *          |
|o+ ..+ .         |
|==o..o+E         |
+-----------------+
Generating public/private dsa key pair.
Your identification has been saved in /etc/ssh/ssh_host_dsa_key.
Your public key has been saved in /etc/ssh/ssh_host_dsa_key.pub.
The key fingerprint is:
7e:1c:ce:dc:8a:3a:18:13:5b:34:b5:cf:d9:d1:47:b2 root@machine3.example.com
The key's randomart image is:
+--[ DSA 1024]----+
|       ..     . .|
|      o  .   . + |
|     . ..   . E .|
|    . .  o o . . |
|     +  S = .    |
|    +  . = o     |
|     +  . * .    |
|    . .  o .     |
|      .o. .      |
+-----------------+
Starting sshd.
....

フィンガープリントおよび SSH についての詳細については、crossref:security[openssh,OpenSSH] をご覧ください。

FreeBSD はデフォルトでは、グラフィカルな環境をインストールしません。 グラフィカルなウィンドウマネージャのインストール、 および設定に関するより多くの情報については、 crossref:x11[x11,X Window System] をご覧ください。

適切に FreeBSD をシャットダウンすることは、 ハードウェアをダメージから守ったり、データの保護につながります。 _システムを適切にシャットダウンする前に、 電源を落すということはしないでください!_``wheel`` グループのメンバとなっているユーザは、 コマンドラインから `su` と入力し、 `root` のパスワードを入力してスーパユーザとなってください。 その後、`shutdown -p now` と入力すると、システムは正しくシャットダウンし、 ハードウェアが対応していれば、電源が落ちます。

[[bsdinstall-install-trouble]]
== トラブルシューティング

この章では、インストールの際の、 これまで報告された共通の問題に対する解決のための情報が書いてあります。

インストールする FreeBSD のバージョンのハードウェアノート (link:https://www.FreeBSD.org/ja/releases/[https://www.freebsd.org/ja/releases/]) を調べて、 使用しているハードウェアに対応しているかどうかを確認してください。 もしハードウェアがサポートされているにもかかわらず、 動作しなかったり他の問題点がある時は、 crossref:kernelconfig[kernelconfig,FreeBSD カーネルのコンフィグレーション] で説明されている方法で カスタムカーネルを構築して、[.filename]#GENERIC# カーネルに含まれていないデバイスへのサポートを追加してください。 起動ディスクのカーネルでは、ほとんどのハードウェアデバイスの IRQ, I/O アドレス、 DMA チャネルが工場出荷時の状態であると設定されています。 もしハードウェアの設定が変更されている場合には、 カーネルコンフィグレーションファイルを編集することにより、 FreeBSD に設定することが可能です。

[NOTE]
====
いくつかのインストール上の問題は、さまざまなハードウェア装置、 特にマザーボードのファームウェアのアップデートで回避または緩和することができます。 マザーボードのファームウェアは、通常 BIOS と呼ばれます。 多くのマザーボードまたはコンピュータ製造メーカーは、 アップデートやアップグレード情報を載せているウェブサイトを用意しています。

通常、製造メーカーは、 重要な更新のようなそれなりの理由がない限り、マザーボードの BIOS のアップグレードは行わないよう推奨しています。 アップデートの過程で失敗する__可能性があり__、 その場合 BIOS が不完全な状態になり、 コンピュータが動作しない原因となり得るからです。
====

システムの起動時に、ハードウェアの検出中にシステムが固まったり、 インストール中におかしな振る舞いをする場合には、 ACPI が原因の可能性があります。 i386 および amd64 プラットフォームにおいて、 FreeBSD はシステムの設定を手助けするシステム ACPI サービスを、 起動時に検出された場合に広く使います。 残念ながら、まだいくつかの不具合が、 ACPI ドライバとシステムのマザーボードおよび BIOS ファームウェア両方に存在しています。 起動ステージ 3 において、ヒント情報 `hint.acpi.0.disabled` を以下のように設定すると ACPI を無効にできます。

[source,bash]
....
 set hint.acpi.0.disabled="1"
....

この設定はシステムが起動するたびにリセットされるので、 [.filename]#/boot/loader.conf# ファイルに `hint.acpi.0.disabled="1"` を追加する必要があります。 ブートローダのより詳しい情報については crossref:boot[boot-synopsis,「この章では」] で説明します。

[[using-live-cd]]
== Live CD を使う

<<bsdinstall-choose-mode>> で示されている bsdinstall のウェルカムメニューは、 btn:[Live CD] オプションを提供します。 これは、 オペレーティングシステムに FreeBSD を使うべきかどうか迷っていて、 インストール前に機能を試して見たいと思っている方に有用です。

btn:[Live CD] を使う際は、以下のことに気をつけてください。

* システムにアクセスする際には、認証を求められます。 ユーザ名は `root`、 パスワードは空欄としてください。
* システムはインストールメディアから直接起動するので、 ハードディスクにインストールされたシステムに比べ、 パフォーマンスはかなり遅い可能性があります。
* このオプションのユーザインタフェースは、 コマンドプロンプトのみです。 グラフィカルなユーザインタフェースではありません。
