---
title: Глава 2. Установка FreeBSD версий 8.X и более ранних
part: Часть I. В начале
prev: books/handbook/introduction
next: books/handbook/bsdinstall
---

[[install]]
= Установка FreeBSD версий 8.X и более ранних
:doctype: book
:toc: macro
:toclevels: 1
:icons: font
:sectnums:
:sectnumlevels: 6
:source-highlighter: rouge
:experimental:
:skip-front-matter:
:toc-title: Содержание
:table-caption: Таблица
:figure-caption: Рисунок
:example-caption: Пример
:xrefstyle: basic
:relfileprefix: ../
:outfilesuffix:
:sectnumoffset: 2

ifeval::["{backend}" == "html5"]
:imagesdir: ../../../../images/books/handbook/install/
endif::[]

ifeval::["{backend}" == "pdf"]
:imagesdir: ../../../../static/images/books/handbook/install/
endif::[]

ifeval::["{backend}" == "epub3"]
:imagesdir: ../../../../static/images/books/handbook/install/
endif::[]

include::shared/authors.adoc[]
include::shared/releases.adoc[]
include::shared/ru/mailing-lists.adoc[]
include::shared/ru/teams.adoc[]
include::shared/ru/urls.adoc[]

toc::[]

[[install-synopsis]]
== Краткий обзор

FreeBSD поставляется простой в использовании текстовой программой установки. FreeBSD 9.0-RELEASE и более поздние укомплектованы установщиком, называемым bsdinstall, в то время как в релизах, предшествующих 9.0-RELEASE, для установки применяется sysinstall. В этой главе описывается использование sysinstall для установки FreeBSD. Работа с установщиком bsdinstall описана в crossref:bsdinstall[bsdinstall,Установка FreeBSD версий 9.X и более поздних].

Прочтя эту главу, вы узнаете:

* Как создать дискеты для установки FreeBSD.
* Как FreeBSD видит и делит на разделы жесткие диски.
* Как запустить sysinstall.
* Вопросы, которые sysinstall задаст вам, что имеется ввиду, и как ответить на эти вопросы.

Перед прочтением этой главы вам потребуется:

* Прочитать информацию о поддерживаемом оборудовании, поставляемую с устанавливаемой версией FreeBSD, и убедиться, что ваше оборудование поддерживается.

[NOTE]
====
Как правило, эти инструкции по установке написаны для i386(TM) ("PC совместимых") компьютеров. Когда это возможно, приводятся инструкции, специфичные для других платформ. Хотя это руководство поддерживается в актуальном состоянии настолько, насколько это возможно, вы можете обнаружить небольшие различия между программой установки и тем, что показано здесь. Предполагается, что вы будете использовать эту главу в качестве общего руководства, а не как пошаговую инструкцию по установке.
====

[[install-hardware]]
== Аппаратные требования

[[install-hardware-minimal]]
=== Минимальная конфигурация

Минимальная конфигурация для установки FreeBSD зависит от версии FreeBSD и аппаратной архитектуры.

Краткое изложение этой информации дается в последующих разделах. В зависимости от метода, выбранного для установки FreeBSD, вам может потребоваться поддерживаемый дисковод или привод CDROM, а в некоторых случаях и сетевой адаптер. Эта ситуация будет описана в <<install-boot-media>>.

==== Архитектуры FreeBSD/i386 и FreeBSD/pc98

Для версий FreeBSD/i386 и FreeBSD/pc98 требуется 486 процессор или выше, а также как минимум 24 MB памяти. Вам потребуется как минимум 150 MB свободного места на диске для самой минимальной установки.

[NOTE]
====
Для старых конфигураций, как правило, больший объем памяти и больший объем диска более важен, чем более быстрый процессор.
====

==== FreeBSD/amd64

Существует два класса процессоров, на которых может работать FreeBSD/amd64. К первому принадлежат процессоры AMD64, включая AMD Athlon(TM)64, AMD Athlon(TM)64-FX, AMD Opteron(TM) и более новые.

Ко второму классу принадлежат процессоры архитектуры Intel(R) EM64T. Среди них можно назвать семейства Intel(R) Core(TM) 2 Duo, Quad, Extreme, а также Intel(R) Xeon(TM) 3000, 5000 и 7000 серии.

Если ваша система основана на nVidia nForce3 Pro-150, _необходимо_ отключить IO APIC в BIOS. Если для этого нет необходимой опции, отключите ACPI в операционной системе. В чипсете Pro-150 содержатся ошибки, для которых пока не существует исправлений.

==== FreeBSD/sparc64

Для установки FreeBSD/sparc64, вам потребуется поддерживаемая платформа (обратитесь к <<install-hardware-supported>>).

Для FreeBSD/sparc64 потребуется отдельный диск. В настоящее время диск невозможно совместно использовать с другой операционной системой.

[[install-hardware-supported]]
=== Поддерживаемое оборудование

Список поддерживаемого оборудования поставляется с каждым релизом в FreeBSD в информации о релизе. Этот документ обычно находится в файле [.filename]#HARDWARE.TXT#, в корневом каталоге CDROM или FTP дистрибутива, или меню документации sysinstall. Для данной архитектуры в нем перечислены аппаратные устройства, поддерживаемые данным релизом FreeBSD. Копии списков поддерживаемого оборудования для различных релизов и архитектур также можно просмотреть на странице http://www.FreeBSD.org/ru/releases/[Информации о релизе] веб сайта FreeBSD.

[[install-pre]]
== Перед установкой

[[install-inventory]]
=== Соберите информацию о компьютере

Перед установкой FreeBSD попытайтесь собрать информацию об устройствах компьютера. Во время установки FreeBSD покажет информацию об устройствах (жестких дисках, сетевых картах, CDROM и т.д.) с номером модели и производителем. FreeBSD также попытается определить правильную конфигурацию для этих устройств, включая информацию об IRQ и портах ввода-вывода. Из-за возможных проблем с оборудованием этот процесс не всегда завершается успешно, и возможно вам придется исправлять определенную FreeBSD конфигурацию.

Если у вас уже есть установленная операционная система, например Windows(R) или Linux, неплохо будет использовать ее возможности для просмотра настроек оборудования. Если вы не уверены, какие настройки карты расширения использовать, можете найти их на самой карте. Часто используемые номера прерываний 3, 5 и 7, порты ввода- вывода обычно пишутся в шестнадцатеричном виде, например 0x330.

Мы рекомендуем распечатать эту информацию перед установкой FreeBSD. Вам может помочь использование таблицы вроде этой:

.Пример сведений об оборудовании
[cols="1,1,1,1", frame="none", options="header"]
|===
| Название устройства
| IRQ
| Порт ввода-вывода
| Примечания

|Первый жесткий диск
|нет
|нет
|40 GB, Seagate, первый IDE master

|CDROM
|нет
|нет
|Первый IDE slave

|Второй жесткий диск
|нет
|нет
|20 GB, IBM, второй IDE master

|Первый IDE контроллер
|14
|0x1f0
|

|Сетевая карта
|нет
|нет
|Intel(R) 10/100

|Модем
|нет
|нет
|3Com(R) 56K факс-модем, COM1

|...
|===

После сбора информации о компонентах компьютера, вы можете проверить их соответствие аппаратным требованиям устанавливаемого релиза FreeBSD.

=== Сделайте резервное копирование данных

Если компьютер, на который вы устанавливаете FreeBSD, содержит важные данные, убедитесь в наличии резервных копий и проверьте их сохранность перед установкой операционной системы. Во время установки FreeBSD запросит подтверждение перед тем, как записать данные на диск, но, если процесс запущен, изменения нельзя отменить.

[[install-where]]
=== Решите куда установить FreeBSD

Если вы хотите, чтобы FreeBSD использовала весь жесткий диск, не о чем беспокоиться - можете пропустить этот раздел.

Однако, если нужно совмещать FreeBSD с другими операционными системами, необходимо иметь представление как данные размещаются на диске и как это касается вас.

[[install-where-i386]]
==== Разделы диска для FreeBSD/i386

Диск ПК может быть поделен на отдельные части. Эти части называют _разделами_. Поскольку в FreeBSD также есть разделы, терминология становится запутанной, и поэтому эти части дисков называются дисковыми слайсами, или просто слайсами в FreeBSD. Например, утилита FreeBSD `fdisk`, имеющая дело с дисковыми разделами PC, обращается со слайсами а не с разделами. Первоначально PC поддерживал только четыре раздела на диск. Эти разделы называются _главными разделами_. Чтобы обойти это ограничение и дать возможность создавать более чем четыре раздела, был создан новый тип раздела, _расширенный раздел_. Диск может содержать только один расширенный раздел. Специальные разделы, называемые _логическими разделами_, могут быть созданы внутри расширенного раздела.

Каждый раздел имеет _ID раздела_ - номер, который используется для определения типа данных на разделе. FreeBSD использует ID раздела `165`.

Как правило, каждая операционная система, которую вы используете, определяет разделы своим способом. Например, MS-DOS(R) и ее потомки, такие как Windows(R), присваивают каждому главному и логическому разделу _букву диска_, начиная с [.filename]#C:#.

FreeBSD нужно устанавливать в главный раздел. FreeBSD может хранить все свои данные, включая создаваемые вами файлы, на этом одном разделе. Тем не менее, если дисков много, вы можете создать разделы FreeBSD на всех дисках или на некоторых из них. При установке FreeBSD должен быть доступен по крайней мере один раздел. Это может быть чистый, подготовленный для установки раздел, или раздел с данными, которые больше не нужны.

Если все разделы на диске уже используются, вы должны освободить один из них для FreeBSD, используя программы, поставляемые с имеющейся операционной системой (например, `fdisk` для MS-DOS(R) или Windows(R)).

Если есть резервный раздел, используйте его. Однако, возможно сначала придется ужать один или несколько существующих разделов.

FreeBSD для установки нужен диск не менее 100 MB. Однако, это _очень_минимальная установка, при которой не останется места для ваших личных файлов. Более реальный объем - 250 MB без графической оболочки, и более 350 MB с графической оболочкой. Если вы собираетесь устанавливать большое количество дополнительного ПО, понадобится еще больше дискового пространства.

Для изменения размера разделов и освобождения места под FreeBSD вы можете использовать программу GParted. GParted способна работать с разделами NTFS. Утилита GParted доступна на некоторых Live CD дистрибутивах Linux, например: http://www.sysresccd.org/[SystemRescueCD].

Пользователи неоднократно сталкивались с проблемами при изменении размеров разделов, содержащих Microsoft(R) Vista. Поэтому рекомендуется держать под рукой инсталляционный диск с Microsoft(R) Vista во время выполнения подобных операций. Как и при любых других задачах обслуживания жестких дисков, настоятельно рекомендуется заранее сделать резервные копии данных.

[WARNING]
====

Неправильное использование этих утилит может привести к уничтожению данных на диске. Удостоверьтесь в наличии свежих и исправных резервных копий данных перед их использованием.
====

.Использование существующего раздела без изменения
[example]
====
Представьте что в компьютере один 4 GB диск, на котором уже установлена Windows(R), и диск разбит на два логических диска [.filename]#C:# и [.filename]#D:#, каждый по 2 GB. 1 GB данных на [.filename]#C:#, и 0.5 GB данных на [.filename]#D:#.

Это означает, что диск состоит из двух разделов, по одному на каждую букву. Вы можете скопировать все данные с [.filename]#D:# на [.filename]#C:#, это освободит второй раздел для FreeBSD.
====

.Сжатие существующих разделов
[example]
====
Представьте, что в компьютере один 4 GB диск, на котором уже установлена Windows(R). При установке Windows(R) вы создали один большой раздел, получив при этом диск [.filename]#C:# размером 4 GB. Вы используете 1.5 GB, и хотите выделить 2 GB для FreeBSD.

Для установки FreeBSD нужно выбрать:

. Сделать резервную копию Windows(R), затем переустановить Windows(R), выделив 2 GB под ее раздел.
. Использовать для сжатия раздела Windows(R) одну из вышеописанных утилит.

====

=== Соберите информацию о конфигурации сети

Если вы хотите подключиться к сети в процессе установки FreeBSD (например, при установке с FTP или NFS сервера), нужно знать конфигурацию сети. Вам будет предложено ввести эту информацию, чтобы FreeBSD смогла подключиться к сети для продолжения установки.

==== Подключение к сети Ethernet, или через кабельный/DSL модем

Если вы подключаетесь к сети Ethernet, или соединение с интернет подключено к Ethernet через кабельный или DSL модем, понадобится следующая информация:

. IP адрес
. IP адрес шлюза по умолчанию
. Имя хоста
. IP адрес DNS сервера
. Маска подсети

Если у вас нет этой информации, спросите системного администратора или провайдера интернет. Они могут сказать, что данные присваиваются автоматически, с использованием _DHCP_. Если это так, запомните это.

==== Подсоединение с помощью модема

Если вы дозваниваетесь до провайдера с помощью обычного модема, вы все же сможете установить FreeBSD через интернет, но это займет очень много времени.

Вам нужно знать:

. Номер телефона провайдера
. COM порт, к которому подключен модем
. Имя пользователя и пароль учетной записи для доступа в интернет

=== Проверьте сведения об обнаруженных ошибках FreeBSD

Хотя проект FreeBSD борется за то, чтобы каждый релиз FreeBSD был настолько стабильным, насколько это возможно, ошибки порой вкрадываются в процесс разработки. В очень редких случаях эти ошибки влияют на процесс установки. Как только эти проблемы обнаруживаются и исправляются, они попадают в http://www.FreeBSD.org/ru/releases/{rel120-current}r/errata/[сообщения об ошибках FreeBSD], находящиеся на сайте FreeBSD. Вы можете проверить сообщения об ошибках перед установкой, чтобы убедиться, что не существует проблем, о которых стоит беспокоиться.

Информация о релизах, включая сообщения об ошибках каждого релиза, находится на странице link:https://www.FreeBSD.org/ru/releases/[информации о релизах] link:https://www.FreeBSD.org/ru/[сайта FreeBSD].

=== Получение установочных файлов FreeBSD

Программа установки FreeBSD может установить FreeBSD из файлов, расположенных в одном из следующих мест:

.Локальный диск
* CDROM или DVD
* USB-накопитель
* Раздел MS-DOS(R) на вашем компьютере
* Лента SCSI или QIC
* Гибкие диски

.Сеть
* FTP сервер (через файрволл или HTTP прокси, если потребуется)
* NFS сервер
* Соединение через параллельный или последовательный порт

Если вы купили FreeBSD на CD или DVD, у вас уже есть все, что нужно, переходите к следующему разделу (<<install-boot-media>>).

Если у вас нет установочных файлов FreeBSD, перейдите к <<install-diff-media>>, который описывает, как подготовиться к установке FreeBSD любым указанным выше способом. После прочтения этого раздела, вернитесь сюда и прочтите <<install-boot-media>>.

[[install-boot-media]]
=== Подготовка загрузочных дисков

Процесс установки FreeBSD начинается с загрузки в ваш компьютер программы установки FreeBSD - эта программа не запускается из других операционных систем. Компьютер обычно загружает операционную систему, установленную на жестком диске, но также может быть настроен на загрузку с привода CDROM или с USB-накопителя.

[TIP]
====

Если у вас есть FreeBSD на CDROM или DVD (купленный или записанный самостоятельно), и компьютер позволяет загрузку с CDROM или DVD (обычно этот пункт в BIOS называется "Boot Order" или что-то вроде), можете пропустить этот раздел. Образы FreeBSD CDROM и DVD являются загрузочными и могут быть использованы для установки FreeBSD без какой-либо специальной подготовки.
====

Для создания загрузочного USB-диска выполните следующие шаги:

[.procedure]
====
. Получение образов для USB-накопителя
+ 
Загрузочные образы для USB-накопителя для FreeBSD 8._X_-RELEASE и более ранних можно найти в каталоге [.filename]#ISO-IMAGES/# по адресу `ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/_arch_/ISO-IMAGES/_version_/FreeBSD-_version_-RELEASE-_arch_-memstick.img`. Замените _arch_ и _version_ именем архитектуры и номером версии операционной системы, которую вы планируете установить. Например, образы USB-накопителя для FreeBSD/i386 {rel112-current}-RELEASE находятся в link:ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/{rel112-current}/FreeBSD-{rel112-current}-RELEASE-i386-memstick.img[ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/ISO-IMAGES/{rel112-current}/FreeBSD-{rel112-current}-RELEASE-i386-memstick.img].
+
[TIP]
======

Для FreeBSD версий 9.0-RELEASE и более поздних путь каталогов отличается от приведенных выше. Детали загрузки образов и установки FreeBSD 9.0-RELEASE и более поздних описаны в crossref:bsdinstall[bsdinstall,Установка FreeBSD версий 9.X и более поздних].
======
+ 
Название файла образа заканчивается на [.filename]#.img#. Каталог [.filename]#ISO-IMAGES/# содержит набор образов, среди которых вам необходимо выбрать один. Выбор зависит от версии устанавливаемой FreeBSD и, в некоторых случаях, от архитектуры оборудования, на которое будет выполняться установка.
+
[IMPORTANT]
======
Перед продолжением сделайте _резервную копию_ данных, находящихся на вашем USB-накопителе, так как последующие действия _сотрут_ все старые данные.
======

. Запись файла-образа на USB-накопитель

[.procedure]
======
*Procedure: Использование FreeBSD для записи файла-образа*

[WARNING]
****

В данном примере подразумевается, что устройство [.filename]#/dev/da0# является нашим целевым устройством, на которое будет производиться запись образа. Будьте предельно внимательны, так как, указав неверное устройство, вы уничтожите существующие данные.
****
.. Запись файла-образа при помощи man:dd[1]
+ 
Файл [.filename]#.img#_не_ является обыкновенным файлом, копируемым на накопитель. Это образ содержимого диска. Это значит, что вы _не можете_ просто скопировать файлы с диска на диск. Вместо копирования вы должны использовать man:dd[1] для записи образа непосредственно на накопитель:
+
[source,bash,subs="attributes"]
....
# dd if=FreeBSD-{rel112-current}-RELEASE-i386-memstick.img of=/dev/da0 bs=64k
....
+ 
Если отображается ошибка `Operation not permitted`, убедитесь, что целевое устройство не используется и не примонтировано вручную или автоматически какой-либо полезной утилитой. Далее, повторите попытку еще раз.
======

[.procedure]
======
*Procedure: Использование Windows(R) для записи файла-образа*
[WARNING]
****

Удостоверьтесь в том, что вы используете соответствующую целевому устройству букву диска, иначе вы уничтожите существующие данные.
****
.. Получение приложения Image Writer for Windows
+ 
Приложение Image Writer for Windows является свободно распространяемым ПО, которым можно корректно записать файл-образ на USB-накопитель. Посетите страницу https://launchpad.net/win32-image-writer/[https://launchpad.net/win32-image-writer/], скачайте и распакуйте приложение.
.. Запись файла-образа при помощи приложения Image Writer
+ 
Для запуска приложения дважды щелкните мышей иконку Win32DiskImager. Убедитесь, что буква диска, отображаемая в выпадающем списке `Device` соответствует USB-накопителю. Щелкните мышей на иконку с изображением папки и выберите необходимый файл-образ. Для подтверждения выбора имени файла нажмите кнопку btn:[Save]. Убедитесь, что все введённые данные корректны, и что в других приложениях нет открытых папок или файлов, находящихся на целевом USB-накопителе. И в заключение, щелкните кнопку btn:[Write] для записи файла-образа на накопитель.
======
====

Для создания загрузочных дискет для установки FreeBSD/pc98 сделайте следующее:

[.procedure]
====

. Получение образов загрузочных дискет
+ 
Загрузочные дискеты FreeBSD/pc98 могут быть закачаны из каталога floppies по адресу `ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/pc98/_version_-RELEASE/floppies/`. Замените _version_ номером версии, которую вы хотите установить.
+ 
Расширение файла образа дискеты - [.filename]#.flp#. Каталог [.filename]#floppies/# содержит множество разных образов. Скачайте [.filename]#boot.flp#, а также несколько файлов согласно типу установки, таких как [.filename]#kern.small*# или [.filename]#kern*#.
+
[IMPORTANT]
======
FTP клиент должен использовать _бинарный режим_ для загрузки образов дискет. Некоторые Web-браузеры используют _текстовый_ (_ASCII_) режим, который точно не позволит загрузиться с этих дискет.
======
+
. Подготовка дискет
+ 
Необходимо подготовить по одной дискете на каждый загруженный образ. Эти дискеты должны быть без дефектов. Лучший способ проверить это - отформатировать дискеты самостоятельно. Не доверяйте заводскому форматированию дискет. Утилита форматирования в Windows(R) не сообщит о наличии плохих секторов, она просто пометит их как "плохие" и проигнорирует. Советуем использовать новые дискеты если вы выбрали этот способ установки.
+
[IMPORTANT]
======
Если при попытке установки FreeBSD программа установки рушится, зависает, или делает что-то не так, сразу проверьте дискеты. Запишите образы на новые дискеты и попытайтесь еще раз.
======
+
. Запись образов на дискеты
+ 
Файлы с расширением [.filename]#.flp# это _не_ обычные файлы, которые можно записать на дискету. Это образы всего содержимого дискеты. Это означает, что вы _не можете_ просто скопировать их с одной дискеты на другую. Вместо этого, нужно использовать специальные утилиты для записи образов на диск.
+ 
Если вы записываете дискеты на компьютере под MS-DOS(R) / Windows(R), используйте утилиту `fdimage`.
+ 
Если вы используете образы с CDROM, и буква вашего CDROM [.filename]#E:#, запустите ее так:
+
[source,bash]
....
E:\> tools\fdimage floppies\boot.flp A:
....
+ 
Повторите эту команду для каждого файла [.filename]#.flp#, вставляя новую дискету каждый раз, пометьте каждую дискету именем файла, который вы скопировали на него. Измените команду если потребуется, в зависимости от места, куда вы поместили файлы [.filename]#.flp#. Если у вас нет CDROM, `fdimage` может быть загружена из каталога link:ftp://ftp.FreeBSD.org/pub/FreeBSD/tools/[tools] FTP сервера FreeBSD.
+ 
Если вы записываете дискеты на UNIX(R) (например, на другой системе FreeBSD), используйте утилиту man:dd[1] для записи образов непосредственно на дискеты. Находясь в FreeBSD, запустите:
+
[source,bash]
....
# dd if=boot.flp of=/dev/fd0
....
+ 
Под FreeBSD, [.filename]#/dev/fd0# означает первый гибкий диск (диск [.filename]#A:#). [.filename]#/dev/fd1# будет диском [.filename]#B:#, и так далее. Другие UNIX(R) системы могут по-другому именовать устройства гибких дисков, вам возможно понадобится прочитать документацию по соответствующей системе.
====

Теперь вы готовы к установке FreeBSD.

[[install-start]]
== Начало установки

[IMPORTANT]
====
Как правило, программа установки не будет производить никаких изменений на дисках, пока не выдаст следующее сообщение:

[.programlisting]
....
Last Chance: Are you SURE you want continue the installation?

If you're running this on a disk with data you wish to save then WE
STRONGLY ENCOURAGE YOU TO MAKE PROPER BACKUPS before proceeding!

We can take no responsibility for lost disk contents!
....

Установка может быть прервана в любой момент до этого предупреждения без каких-либо изменений на жестком диске. Если вы считаете, что что-то настроили неправильно, можете просто выключить компьютер без риска что-либо повредить.
====

[[install-starting]]
=== Загрузка

[[install-starting-i386]]
==== Загрузка i386(TM)

[.procedure]
====

. Компьютер выключен.
. Включите компьютер. После включения он должен показать способ входа в меню установки BIOS, как правило это клавиши kbd:[F2], kbd:[F10], kbd:[Del], или kbd:[Alt+S]. Используете те клавиши, которые показаны на экране. В некоторых случаях компьютер может показывать картинку после запуска. Как правило, нажатие kbd:[Esc] уберет картинку и позволит вам увидеть необходимую информацию.
. Найдите установки системы, указывающие ей с какого устройства загружаться. Обычно они обозначаются как "Boot Order", и там как правило отображен список устройств, таких как `Floppy`, `CDROM`, `First Hard Disk`, и так далее.
+ 
Если вы загружаетесь с CDROM, убедитесь, что он выбран. Если вы загружаетесь с USB-носителя или с дискеты, убедитесь, что выбрано соответствующее устройство. Если вы не уверены, посмотрите руководство к компьютеру и/или к его материнской плате.
+ 
Сделайте изменения, затем сохраните их и выйдите. Компьютер должен перезагрузиться.
. Если вы подготовили "загрузочный" USB-носитель, как описано в <<install-boot-media>>, вставьте его в USB порт перед включением компьютера.
+ 
Если вы загружаетесь с CDROM, потребуется сначала включить компьютер и вставить компакт-диск, как только это станет возможно.
+
[NOTE]
======
Для FreeBSD/pc98 существуют образы загрузочных дискет, подготовка которых описана в <<install-boot-media>>. Первая дискета будет содержать [.filename]#boot.flp#. Для загрузки в программу установки вставьте эту дискету в дисковод.
======
+ 
Если компьютер запускается как обычно, и загружает существующую операционную систему, возможны следующие причины:

.. Диск был вставлен недостаточно рано в процессе загрузки. Оставьте его внутри и перегрузите компьютер.
.. Установки BIOS, измененные ранее, действуют неправильно. Надо изменять их, пока они не заработают.
.. BIOS вашего компьютера не поддерживает загрузку с выбранного типа носителя.

. FreeBSD начнет загрузку. Если загрузка происходит с CDROM, вы увидите что-то вроде этого (информация о версии удалена):
+
[source,bash]
....
Booting from CD-Rom...
645MB medium detected
CD Loader 1.2

Building the boot loader arguments
Looking up /BOOT/LOADER... Found
Relocating the loader and the BTX
Starting the BTX loader

BTX loader 1.00 BTX version is 1.02
Consoles: internal video/keyboard
BIOS CD is cd0
BIOS drive C: is disk0
BIOS drive D: is disk1
BIOS 636kB/261056kB available memory

FreeBSD/i386 bootstrap loader, Revision 1.1

Loading /boot/defaults/loader.conf
/boot/kernel/kernel text=0x64daa0 data=0xa4e80+0xa9e40 syms=[0x4+0x6cac0+0x4+0x88e9d]
\
....
+ 
Если происходит загрузка с дискеты, вы увидите что-то вроде этого (информация о версии удалена):
+
[source,bash]
....
Booting from Floppy...
Uncompressing ... done

BTX loader 1.00  BTX version is 1.01
Console: internal video/keyboard
BIOS drive A: is disk0
BIOS drive C: is disk1
BIOS 639kB/261120kB available memory

FreeBSD/i386 bootstrap loader, Revision 1.1

Loading /boot/defaults/loader.conf
/kernel text=0x277391 data=0x3268c+0x332a8 |

Insert disk labelled "Kernel floppy 1" and press any key...
....
+ 
Следуя инструкциям, уберите дискету с [.filename]#boot.flp#, вставьте дискету с [.filename]#kern1.flp# и нажмите kbd:[Enter]. Загрузитесь с первой дискеты; последовательно вставляйте остальные диски при появлении соответствующего приглашения.
. Идет ли загрузка с CDROM, или с USB-носителя, или с дискеты в процессе загрузки появится меню загрузчика FreeBSD:
+
[[boot-loader-menu]]
.FreeBSD Boot Loader Menu
image::boot-loader-menu.png[]
+ 
Подождите десять секунд или нажмите kbd:[Enter].
====

==== Загрузка sparc64

Большинство систем sparc64 настроены на автоматическую загрузку с жесткого диска. Для того, чтобы установить FreeBSD, вам потребуется выполнить загрузку по сети или с компакт-диска, что в свою очередь требует получения доступа к PROM (OpenFirmware).

Чтобы получить доступ к PROM, перезагрузите систему и дождитесь появления сообщений загрузчика. Последние зависят от модели оборудования, но, в общем, выглядят подобно следующим:

[source,bash]
....
Sun Blade 100 (UltraSPARC-IIe), Keyboard Present
Copyright 1998-2001 Sun Microsystems, Inc.  All rights reserved.
OpenBoot 4.2, 128 MB memory installed, Serial #51090132.
Ethernet address 0:3:ba:b:92:d4, Host ID: 830b92d4.
....

Если на данном этапе ваша система продолжает загружаться с диска, то для доступа к PROM вам потребуется нажать на клавиатуре сочетания клавиш kbd:[L1+A] или kbd:[Stop+A], или же - послать `BREAK` на последовательной консоли (например, набрав `~#` в man:tip[1] или man:cu[1]). Приглашение PROM выглядит подобно следующему:

[source,bash]
....
ok     <.>
ok {0} <.>
....

<.> Однопроцессорные системы выдают такое приглашение.
<.> Приглашение, используемое многопроцессорными системами: цифра обозначает номер активного процессора.

На этой стадии необходимо вставить CDROM в привод и набрать `boot cdrom` в приглашении PROM.

[[view-probe]]
=== Просмотр результатов тестирования устройств

Последние несколько сотен линий, отображенные на экране, сохраняются и могут быть просмотрены.

Для просмотра буфера нажмите kbd:[Scroll Lock]. Это включит прокрутку экрана. Вы можете использовать клавиши навигации или kbd:[PageUp] и kbd:[PageDown] для просмотра результатов. Нажмите kbd:[Scroll Lock] еще раз для отключения прокрутки.

Сделайте это сейчас для просмотра текста, ушедшего за экран, когда ядро закончило тестирование устройств. Вы увидите текст вроде <<install-dev-probe>>, хотя в деталях он будет отличаться в зависимости от устройств, имеющихся в вашем компьютере.

[[install-dev-probe]]
.Типичный вывод Device Probe
[source,bash]
....
avail memory = 253050880 (247120K bytes)
Preloaded elf kernel "kernel" at 0xc0817000.
Preloaded mfs_root "/mfsroot" at 0xc0817084.
md0: Preloaded image </mfsroot> 4423680 bytes at 0xc03ddcd4

md1: Malloc disk
Using $PIR table, 4 entries at 0xc00fde60
npx0: <math processor> on motherboard
npx0: INT 16 interface
pcib0: <Host to PCI bridge> on motherboard
pci0: <PCI bus> on pcib0
pcib1:<VIA 82C598MVP (Apollo MVP3) PCI-PCI (AGP) bridge> at device 1.0 on pci0
pci1: <PCI bus> on pcib1
pci1: <Matrox MGA G200 AGP graphics accelerator> at 0.0 irq 11
isab0: <VIA 82C586 PCI-ISA bridge> at device 7.0 on pci0
isa0: <iSA bus> on isab0
atapci0: <VIA 82C586 ATA33 controller> port 0xe000-0xe00f at device 7.1 on pci0
ata0: at 0x1f0 irq 14 on atapci0
ata1: at 0x170 irq 15 on atapci0
uhci0 <VIA 83C572 USB controller> port 0xe400-0xe41f irq 10 at device 7.2 on pci
0
usb0: <VIA 83572 USB controller> on uhci0
usb0: USB revision 1.0
uhub0: VIA UHCI root hub, class 9/0, rev 1.00/1.00, addr1
uhub0: 2 ports with 2 removable, self powered
pci0: <unknown card> (vendor=0x1106, dev=0x3040) at 7.3
dc0: <ADMtek AN985 10/100BaseTX> port 0xe800-0xe8ff mem 0xdb000000-0xeb0003ff ir
q 11 at device 8.0 on pci0
dc0: Ethernet address: 00:04:5a:74:6b:b5
miibus0: <MII bus> on dc0
ukphy0: <Generic IEEE 802.3u media interface> on miibus0
ukphy0: 10baseT, 10baseT-FDX, 100baseTX, 100baseTX-FDX, auto
ed0: <NE2000 PCI Ethernet (RealTek 8029)> port 0xec00-0xec1f irq 9 at device 10.
0 on pci0
ed0 address 52:54:05:de:73:1b, type NE2000 (16 bit)
isa0: too many dependant configs (8)
isa0: unexpected small tag 14
orm0: <Option ROM> at iomem 0xc0000-0xc7fff on isa0
fdc0: <NEC 72065B or clone> at port 0x3f0-0x3f5,0x3f7 irq 6 drq2 on isa0
fdc0: FIFO enabled, 8 bytes threshold
fd0: <1440-KB 3.5" drive> on fdc0 drive 0
atkbdc0: <Keyboard controller (i8042)> at port 0x60,0x64 on isa0
atkbd0: <AT Keyboard> flags 0x1 irq1 on atkbdc0
kbd0 at atkbd0
psm0: <PS/2 Mouse> irq 12 on atkbdc0
psm0: model Generic PS/@ mouse, device ID 0
vga0: <Generic ISA VGA> at port 0x3c0-0x3df iomem 0xa0000-0xbffff on isa0
sc0: <System console> at flags 0x100 on isa0
sc0: VGA <16 virtual consoles, flags=0x300>
sio0 at port 0x3f8-0x3ff irq 4 flags 0x10 on isa0
sio0: type 16550A
sio1 at port 0x2f8-0x2ff irq 3 on isa0
sio1: type 16550A
ppc0: <Parallel port> at port 0x378-0x37f irq 7 on isa0
pppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/15 bytes threshold
plip0: <PLIP network interface> on ppbus0
ad0: 8063MB <IBM-DHEA-38451> [16383/16/63] at ata0-master UDMA33
acd0: CD-RW <LITE-ON LTR-1210B> at ata1-slave PIO4
Mounting root from ufs:/dev/md0c
/stand/sysinstall running as init on vty0
....

Внимательно проверьте результаты тестирования устройств и убедитесь, что FreeBSD обнаружила все устройства, какие нужно. Если устройство не найдено, его не будет в списке. crossref:kernelconfig[kernelconfig,Собственное ядро] позволяет добавлять поддержку устройств, отсутствующих в ядре [.filename]#GENERIC#, например звуковых карт.

После проверки аппаратных устройств, появится <<config-country>>. Используйте клавиши навигации для выбора страны, региона или группы. Затем нажмите kbd:[Enter], произойдет выбор страны.

[[config-country]]
.Меню выбора страны
image::config-country.png[]

Если вы выбрали страну [.guimenuitem]#United States#, то будет использована стандартная американская раскладка клавиатуры, если же была выбрана другая страна, то отобразится следующее меню. Используя клавиши навигации, выберите необходимую раскладку и нажмите kbd:[Enter].

[[config-keymap]]
.Меню выбора раскладки клавиатуры
image::config-keymap.png[]

После меню выбора страны будет отображено главное меню sysinstall.

[[using-sysinstall]]
== Введение в Sysinstall

Утилита sysinstall это программа установки, предоставляемая проектом FreeBSD. Это консольное приложение, разделенное на несколько меню и экранов, которые вы можете использовать для настройки и управления процессом установки.

Меню sysinstall управляется клавишами навигации, kbd:[Enter], kbd:[Tab], пробелом, и другими. Подробное описание клавиш и их функций содержится в информации по использованию sysinstall.

Для просмотра этой информации убедитесь, что выбраны пункт [.guimenuitem]#Usage# и кнопка btn:[Select], как показано на <<sysinstall-main3>>, затем нажмите kbd:[Enter].

Будут показаны инструкции по использованию меню. После просмотра инструкций, нажмите kbd:[Enter] для возврата в главное меню.

[[sysinstall-main3]]
.Выбор Usage в главном меню Sysinstall
image::main1.png[]

[[select-doc]]
=== Выбор меню документации (Doc)

Из главного меню выберите клавишами навигации [.guimenuitem]#Doc# и нажмите kbd:[Enter].

[[main-doc]]
.Выбор меню документации
image::main-doc.png[]

Будет отображено меню документации.

[[docmenu1]]
.Меню документации Sysinstall
image::docmenu1.png[]

Рекомендуется прочитать предоставляемую документацию.

Для просмотра документа выберите его с помощью клавиш навигации и нажмите kbd:[Enter]. После прочтения документа нажмите kbd:[Enter] для возврата в меню документации.

Для возврата в главное меню выберите [.guimenuitem]#Exit# с помощью клавиш навигации и нажмите kbd:[Enter].

[[keymap]]
=== Выбор меню раскладки клавиатуры (Keymap)

Для изменения раскладки клавиатуры выберите из меню с помощью клавиш навигации [.guimenuitem]#Keymap# и нажмите kbd:[Enter]. Это потребуется только при использовании нестандартной или не-US клавиатуры.

[[sysinstall-keymap]]
.Выбор меню раскладки клавиатуры
image::main-keymap.png[]

Различные раскладки клавиатуры могут быть выбраны из меню с использованием клавиш навигации, затем следует нажать kbd:[Space]. Нажатие kbd:[Space] еще раз приведет к отмене выбора. Когда необходимые раскладки будут выбраны, перейдите на btn:[OK] с помощью клавиш навигации и нажмите kbd:[Enter].

На экран выведена только часть списка. Нажав kbd:[Tab], можно выбрать btn:[Cancel], вернуться к раскладке по умолчанию и перейти к главному меню.

[[sysinstall-keymap-menu]]
.Меню раскладки клавиатуры
image::keymap.png[]

[[viewsetoptions]]
=== Параметры установки (Options)

Выберите пункт [.guimenuitem]#Options# и нажмите kbd:[Enter].

[[sysinstall-options]]
.Выбор параметров установки
image::main-options.png[]

[[options]]
.Параметры Sysinstall
image::options.png[]

Параметры по умолчанию обычно устраивают большинство пользователей и не нуждаются в изменении. Имя релиза зависит от устанавливаемой версии.

Описание выбранного пункта будет появляться внизу экрана с синей подсветкой. Обратите внимание, что один из параметров - [.guimenuitem]#Use Defaults#, означает сброс всех параметров к значениям по умолчанию.

Нажатие kbd:[F1] отобразит справку по различным параметрам.

Нажатием kbd:[Q] можно перейти к главному меню.

[[start-install]]
=== Начало стандартной установки (Standard)

Пункт [.guimenuitem]#Standard# рекомендуется для новых пользователей UNIX(R) или FreeBSD. Используйте клавиши навигации для выбора пункта [.guimenuitem]#Standard#, а затем нажмите kbd:[Enter] для запуска установки.

[[sysinstall-standard]]
.Начало стандартной установки
image::main-std.png[]

[[install-steps]]
== Выделение дискового пространства

Ваша первая задача - выделить дисковое пространство под FreeBSD и разметить его, чтобы sysinstall могла его подготовить. Для этого вам нужно знать, как FreeBSD ищет информацию на диске.

[[install-drive-bios-numbering]]
=== Нумерация дисков в BIOS

Перед установкой и настройкой операционной системы необходимо знать, как FreeBSD трактует предоставляемую системой BIOS информацию о дисках и их именовении.

В PC, работающем под BIOS-зависимой операционной системой, такой как MS-DOS(R) или Microsoft(R) Windows(R), BIOS может отходить от обычного порядка нумерации дисков. Это позволяет пользователю загружаться не только с так называемого "primary master" диска. Это особенно удобно для тех пользователей, которые покупают второй идентичный первому жесткий диск и регулярно делают копии первого диска на второй. Затем, если первый диск выйдет из строя, будет заражен вирусом или поврежден из-за сбоя операционной системы, он может быть легко восстановлен путем логической перестановки дисков в BIOS. Это все равно что переключить кабели дисков, но без вскрытия корпуса.

Более дорогостоящие системы со SCSI контроллерами зачастую имеют расширения BIOS, позволяющие сходным путем менять порядок до семи SCSI дисков.

Пользователи, привыкшие пользоваться этими полезными функциями, могут быть удивлены, что во FreeBSD результаты не совпадают с ожидаемыми. FreeBSD не использует BIOS, и не знает о "логическом отображении дисков в BIOS". Это может привести к очень сложным ситуациям, особенно когда диски имеют одинаковую геометрию и содержат точную копию данных друг друга.

При использовании FreeBSD всегда восстанавливайте настройки BIOS к первоначальной нумерации перед установкой системы и оставляйте их в таком виде. Если вам понадобится переключить диски, сделайте это, но путем физического переконфигурирования, вскрыв корпус, переключив перемычки и кабели.

****
Билл разобрал старый Wintel компьютер, чтобы сделать еще один компьютер под FreeBSD для Фреда. Билл установил один SCSI диск как нулевое устройство SCSI и поставил на него FreeBSD.

Фред начал использовать систему, но через несколько дней обнаружил, что старый SCSI диск сообщает о множестве сбоев и сказал об этом Биллу.

Еще через несколько дней Билл решил, что настало время решить проблему, и достал такой же SCSI диск из "заначки" в кладовке. Первая проверка поверхности показала, что диск работает нормально; Билл установил этот диск как четвертое устройство SCSI и скопировал образ диска с нулевого устройства на четвертое. Теперь, когда новый диск был установлен и отлично работал, Билл решил что неплохо бы начать использовать его, и с помощью функции SCSI BIOS поменял порядок дисков, чтобы система могла грузиться с четвертого устройства SCSI. FreeBSD загрузилась и работала без проблем.

Фред поработал еще несколько дней, и скоро они с Биллом решили, что настало время для нового приключения - время обновить версию FreeBSD. Билл удалил нулевое устройство SCSI, потому что оно "подглючивало", и установил на его место такой же диск из "заначки". Затем Билл установил новую версию FreeBSD на новое нулевое устройство SCSI используя дискеты Фреда с интернет сервера FTP. Установка прошла отлично.

Фред использовал новую версию FreeBSD несколько дней и удостоверился, что она вполне подходит для работы в инженерном отделе. Настало время скопировать все архивы со старого диска. Фред смонтировал четвертое устройство SCSI (последнюю копию старой версии FreeBSD) и обнаружил, что ни одного из его драгоценных файлов на четвертом устройстве SCSI нет.

Куда делись данные?

Когда Билл сделал копию с нулевого устройства SCSI на четвертое устройство SCSI, оно стало "клоном". Когда Билл поменял настройки SCSI BIOS, чтобы загрузиться с четвертого устройства SCSI, он всего лишь обманул сам себя. FreeBSD все еще работала с нулевого устройства SCSI. Изменение этих настроек BIOS привело к загрузке части кода Boot и Loader с выбранного в BIOS диска, но после загрузки драйверов FreeBSD настройки BIOS были проигнорированы, и FreeBSD вернулась к нормальной нумерации. Как показано "на пальцах", система продолжила работать с нулевым устройством SCSI, и все данные Фреда остались там, а не на четвертом устройстве SCSI. То, что система грузилась с четвертого устройства SCSI, было всего лишь обманутыми ожиданиями.

Мы рады упомянуть, что данные не были уничтожены или повреждены при нашем исследовании этого феномена. Старое нулевое устройство SCSI было вытащено из груды железа, и все файлы Фреда вернулись к нему.

Хотя в этом рассказе были использованы SCSI диски, с IDE дисками все точно так же.
****

[[main-fdisk]]
=== Создание слайсов с использованием FDisk

[NOTE]
====
Внесенные вами изменения не будут записываться на диск сразу. Если вы думаете, что сделали ошибку, и хотите начать сначала, можете использовать меню для выхода из sysinstall и попробовать еще раз или нажатием kbd:[U] вызвать опцию [.guimenuitem]#Undo# (отмена). Если вы запутались и не можете выйти, просто выключите компьютер.
====

После начала стандартной установки в sysinstall будет показано это сообщение:

[source,bash]
....
                                 Message
 In the next menu, you will need to set up a DOS-style ("fdisk")
 partitioning scheme for your hard disk. If you simply wish to devote
 all disk space to FreeBSD (overwriting anything else that might be on
 the disk(s) selected) then use the (A)ll command to select the default
 partitioning scheme followed by a (Q)uit. If you wish to allocate only
 free space to FreeBSD, move to a partition marked "unused" and use the
 (C)reate command.
                                [  OK  ]

                      [ Press enter or space ]
....

Нажмите kbd:[Enter] как предлагается. Будет показан список всех жестких дисков, обнаруженных ядром во время тестирования устройств. <<sysinstall-fdisk-drive1>> показывает пример системы с двумя IDE дисками. Они были названы [.filename]#ad0# и [.filename]#ad2#.

[[sysinstall-fdisk-drive1]]
.Выберите диск для FDisk
image::fdisk-drive1.png[]

Вы можете быть удивлены, почему устройства [.filename]#ad1# здесь нет. Почему оно было пропущено?

Предположим, что у вас есть два жестких диска IDE, один master на первом контроллере IDE, а второй master на втором контроллере IDE. Если FreeBSD пронумерует их в том порядке, в котором нашла, [.filename]#ad0# и [.filename]#ad1#, все будет работать.

Но если вы добавите третий диск, как slave устройство на первый контроллер IDE, он станет [.filename]#ad1#, а предыдущий [.filename]#ad1# станет [.filename]#ad2#. Поскольку имена устройств (таких как [.filename]#ad1s1a#) используются для обращения к файловым системам, вы можете вдруг обнаружить, что некоторые из ваших файловых систем больше не отображаются правильно и вам потребуется изменить конфигурацию FreeBSD.

Для обхода этой проблемы, ядро может быть настроено так, чтобы именовать IDE диски на основе их местоположения, а не порядка, в котором они были найдены. С этой схемой master диск на втором контроллере IDE будет _всегда_ устройством [.filename]#ad2#, если даже нет устройств [.filename]#ad0# или [.filename]#ad1#.

Это конфигурация ядра FreeBSD по умолчанию, поэтому на экране показаны [.filename]#ad0# и [.filename]#ad2#. У компьютера, с которого был взят этот снимок экрана, есть по одному IDE диску на обеих master каналах IDE контроллеров и ни одного диска на каналах slave.

Вы должны выбрать диск, на который хотите установить FreeBSD, и нажать btn:[OK]. Запустившийся FDisk будет выглядеть примерно как <<sysinstall-fdisk1>>.

Экран FDisk разбит на три раздела.

Первый раздел, занимающая первые две линии экрана, показывает подробную информацию о выбранном в данный момент диске, включая его имя во FreeBSD, геометрию и общий размер диска.

Второй раздел показывает имеющиеся в данный момент на диске слайсы, где они начинаются и заканчиваются, их размер, имя, которое им дала FreeBSD, описание и подтип. На этом примере показаны два маленьких неиспользованных слайса, которые являются артефактами схемы разметки диска на PC. Также показан один большой FAT слайс, который почти всегда является диском [.filename]#C:# в MS-DOS(R) / Windows(R), и дополнительный слайс, который может содержать диски с другими буквами для MS-DOS(R) / Windows(R).

Третий раздел показывает команды, доступные в FDisk.

[[sysinstall-fdisk1]]
.Типичные разделы `fdisk` перед редактированием
image::fdisk-edit1.png[]

Ваши действия теперь будут зависеть от того, как вы хотите разбить диск на слайсы.

Если вы хотите использовать для FreeBSD весь диск (это приведет к удалению всех других данных на этом диске когда вы подтвердите sysinstall продолжение процесса установки), нажмите kbd:[A], что соответствует опции [.guimenuitem]#Использовать весь диск (Use Entire Disk)#. Существующие слайсы будут удалены, и заменены на небольшую область, помеченную как `неиспользуемая (unused)` (это опять же артефакт разметки диска ПК), и один большой слайс для FreeBSD. Когда вы сделаете это, нужно выбрать вновь созданный слайс FreeBSD используя клавиши навигации, а затем нажать kbd:[S], чтобы сделать слайс загрузочным. Экран будет похож на <<sysinstall-fdisk2>>. Обратите внимание, что `A` в колонке `Flags` означает, что слайс _активен_ и с него будет происходить загрузка.

Если вы будете удалять существующий слайс для освобождения места под FreeBSD, выберите слайс, используя клавиши навигации, и нажмите kbd:[D]. Затем можете нажать kbd:[C], и получить приглашение на ввод размера слайса, который вы хотите создать. Введите соответствующее значение и нажмите kbd:[Enter]. Значение по умолчанию в этом поле означает наибольший размер слайса, который может быть выбран; это может быть наибольший непрерывный блок неразмеченного пространства или размер всего жесткого диска.

Если вы уже освободили место для FreeBSD, то можете нажать kbd:[C] для создания нового слайса. Будет также предложено ввести размер слайса, который вы хотите создать.

[[sysinstall-fdisk2]]
.Разбиение в Fdisk с использованием всего диска
image::fdisk-edit2.png[]

Когда закончите, нажмите kbd:[Q]. Изменения будут сохранены в sysinstall, но еще не записаны на диск.

[[bootmgr]]
=== Установка менеджера загрузки (Boot Manager)

Теперь вам предлагается установить менеджер загрузки. Как правило, нужно выбрать установку менеджера загрузки если:

* У вас больше чем один диск и вы устанавливаете FreeBSD не на первый диск.
* Вы устанавливаете FreeBSD вместе с другой операционной на один и тот же диск, и хотите выбирать при загрузке FreeBSD или другую операционную систему.

Если FreeBSD единственная операционная система, установленная на этом компьютере, и находится на первом жестком диске, подойдет менеджер загрузки [.guimenuitem]#Standard#. Выберите [.guimenuitem]#None# если вы используете менеджер загрузки сторонних разработчиков, способный загрузить FreeBSD.

Сделайте выбор и нажмите kbd:[Enter].

[[sysinstall-bootmgr]]
.Меню менеджера загрузки Sysinstall
image::boot-mgr.png[]

Экран подсказки, вызываемый по нажатию kbd:[F1], описывает проблемы, которые могут быть встречены при попытке совместного использования диска операционными системами.

=== Создание слайсов на другом диске

Если дисков больше чем один, вернитесь к экрану выбора дисков (Select Drives) после выбора менеджера загрузки. Если вы собираетесь устанавливать FreeBSD более чем на один диск, можете выбрать другой диск и повторить процесс разбиения на слайсы с использованием FDisk.

[IMPORTANT]
====
Если вы устанавливаете FreeBSD не на первый жесткий диск, потребуется установить менеджер загрузки FreeBSD на оба диска.
====

[[sysinstall-fdisk-drive2]]
.Выход из выбора диска
image::fdisk-drive2.png[]

Клавиша kbd:[Tab] переключает между последним выбранным диском, btn:[OK], и btn:[Cancel].

Нажмите kbd:[Tab] один раз для выбора btn:[OK], затем нажмите kbd:[Enter] для продолжения установки.

[[bsdlabeleditor]]
=== Создание разделов с помощью Disklabel

Теперь вы должны создать несколько разделов внутри каждого только что созданного слайса. Запомните, что у каждого раздела есть буква с `a` до `h`, а разделы `b`, `c`, и `d` имеют соглашения, которых вы должны придерживаться.

Некоторые приложения могут выигрывать от определенных схем разделов, особенно если у вас разделы на более чем одном диске. Тем не менее, для вашей первой установки FreeBSD не нужно слишком углубляться в принципы разбиения диска. Более важно установить FreeBSD и начать ее использовать. Вы всегда можете переустановить FreeBSD для изменения схемы разделов, когда поближе познакомитесь с операционной системой.

Эта схема показывает четыре раздела - один для подкачки и три для файловых систем.

.Планирование разделов для первого диска
[cols="1,1,1,1", frame="none", options="header"]
|===
| Раздел
| Файловая система
| Размер
| Описание

|`a`
|[.filename]#/#
|1 GB
|Корневая файловая система. Любая другая файловая система будет смонтирована на эту. 1 GB это подходящий размер для этой файловой системы. Вы не будете хранить на ней слишком много данных, а обычная установка FreeBSD разместит здесь около 128 MB данных. Оставшееся пространство используется для временных файлов, а также оставляет возможность расширения для будущих версий FreeBSD, которым может понадобится больше места в [.filename]#/#.

|`b`
|N/A
|2-3 x RAM
|

Раздел подкачки находится на разделе `b`. Выбор правильного размера раздела подкачки это немного искусство. Хороший практический способ выбрать размер подкачки это установить его равным двум или трем размерам доступной физической памяти (RAM). Должно быть хотя бы 64 MB подкачки; если в компьютере меньше чем 32 MB памяти - установите размер подкачки равным 64 MB.

Если у вас больше одного диска, можно расположить подкачку на каждом диске. FreeBSD будет использовать каждый диск, что серьезно увеличит скорость подкачки. В этом случае, определите общий размер подкачки, который вам нужен (например, 128 MB), и поделите его на число имеющихся дисков (например, два) для определения размера разделов подкачки, которые нужно разместить на каждом вашем диске, в этом примере 64 MB на диск.

|`e`
|[.filename]#/var#
|512 MB
|Каталог [.filename]#/var# содержит файлы, которые постоянно меняются; логи и другие административные файлы. Многие из этих файлов интенсивно читаются и записываются в процессе ежедневной работы FreeBSD. Размещение их на отдельной файловой системе позволяет FreeBSD оптимизировать доступ к этим файлам без затрагивания других каталогов, не имеющих такой же модели доступа.

|`f`
|[.filename]#/usr#
|Остальная часть диска (по крайней мере - 8 GB)
|Все другие файлы как правило хранятся в каталоге [.filename]#/usr# и его подкаталогах.
|===

[WARNING]
====

Значения, приведённые выше, являются примерными и уместны к использованию лишь опытными пользователями. Остальным - рекомендуется применять опцию автоматического разбиения, называемую `Auto Defaults` в редакторе разделов FreeBSD.
====

Если вы устанавливаете FreeBSD более чем на один диск, вы должны также создать разделы в других слайсах, которые настроили. Простейший путь сделать это - создать два раздела на каждом диске, один для подкачки, а другой для файловой системы.

.Разметка разделов для остальных дисков
[cols="1,1,1,1", frame="none", options="header"]
|===
| Раздел
| Файловая система
| Размер
| Описание

|`b`
|N/A
|Смотрите описание
|Как уже обсуждалось, вы можете распространить подкачку на каждый диск. Даже если раздел `a` свободен, соглашение говорит о том, что подкачка находится на разделе `b`.

|`e`
|/disk_n_
|Остальная часть диска
|Остальная часть диска занята одним большим разделом. Он легко может быть помещен на раздел `a` вместо раздела `e`. Однако, соглашение говорит, что раздел `a` зарезервирован на слайсе для корневой ([.filename]#/#) файловой системы. вы можете не следовать этому соглашению, но программа sysinstall будет ему следовать, поэтому приняв его, вы сделаете установку несколько проще. Вы можете монтировать эти файловые системы к любой точке; в этом примере предлагается смонтировать их как каталоги [.filename]#/diskn#, где _n_ это номер, который уникален для каждого диска. Но вы можете использовать другую схему, если захотите.
|===

Теперь, выбрав разметку разделов, можете приступить к их созданию в sysinstall. Вы увидите это сообщение:

[source,bash]
....
                                 Message
 Now, you need to create BSD partitions inside of the fdisk
 partition(s) just created. If you have a reasonable amount of disk
 space (1 GB or more) and don't have any special requirements, simply
 use the (A)uto command to allocate space automatically. If you have
 more specific needs or just don't care for the layout chosen by
 (A)uto, press F1 for more information on manual layout.

                                [  OK  ]
                          [ Press enter or space ]
....

Нажмите kbd:[Enter] для запуска редактора разделов FreeBSD, называемого Disklabel.

<<sysinstall-label>> показывает экран только что запущенного Disklabel. Экран поделен на три раздела.

Первые несколько линий показывают имя диска, с которым вы сейчас работаете и слайс, содержащий раздел, который вы создаете (здесь Disklabel называет это `именем раздела (Partition name)` вместо имени слайса). Этот экран также показывает объем свободного пространства на слайсе, т.е. пространство, выделенное под слайс, но еще не отданное под раздел.

В центре экрана показаны уже созданные разделы, имена файловых систем, содержащихся в разделах, их размер и некоторые опции, применяемые при создания файловых систем.

Нижняя треть экрана показывает управляющие клавиши, работающие в Disklabel.

[[sysinstall-label]]
.Редактор Sysinstall Disklabel
image::disklabel-ed1.png[]

Disklabel может автоматически создать разделы и присвоить им размеры по умолчанию. Значения размеров по умолчанию вычисляются с помощью внутреннего алгоритма, исходя из емкости диска. Попробуйте это, нажав kbd:[A]. Вы увидите экран как на <<sysinstall-label2>>. В зависимости от размера диска, значения по умолчанию могут подходить или не подходить вам. Это не имеет значения, если вы не принимаете их.

[NOTE]
====
По умолчанию под каталог [.filename]#/tmp# выделяется собственный раздел вместо использования части раздела [.filename]#/#. Это помогает избежать заполнения раздела [.filename]#/# временными файлами.
====

[[sysinstall-label2]]
.Редактор Sysinstall Disklabel с установками по умолчанию
image::disklabel-auto.png[]

Если вы решили не использовать разделы по умолчанию и заменить их на свои, используйте клавиши навигации для выбора первого раздела, затем нажмите kbd:[D] для его удаления. Повторите это для удаления всех предложенных разделов.

Для создания первого раздела (`a`, монтируемого как [.filename]#/# - root), убедитесь, что выбран соответствующий слайс вверху экрана и нажмите kbd:[C]. Появится диалог, предлагающий выбрать размер нового раздела (как показано на <<sysinstall-label-add>>). Вы можете ввести количество блоков диска, или количество мегабайт с `M` после номера, или гигабайт с `G`, или цилиндров с `C`.

[[sysinstall-label-add]]
.Свободное место для корневого раздела
image::disklabel-root1.png[]

Размер по умолчанию задан для создания корневого раздела на весь слайс. Если вы используете размеры разделов, описанные ранее в примере, удалите это значение используя kbd:[Backspace], а затем введите `512M`, как показано на <<sysinstall-label-add2>>. Затем нажмите btn:[OK].

[[sysinstall-label-add2]]
.Редактирование размера корневого раздела
image::disklabel-root2.png[]

После указания размера раздела вам будет задан вопрос, должен ли этот раздел содержать файловую систему или раздел подкачки. Диалог показан на <<sysinstall-label-type>>. Первый раздел будет содержать файловую систему, поэтому проверьте, что выбрана [.guimenuitem]#FS# и нажмите kbd:[Enter].

[[sysinstall-label-type]]
.Выбор типа корневого раздела
image::disklabel-fs.png[]

Наконец, поскольку вы создаете файловую систему, нужно сказать Disklabel где файловая система будет смонтирована. Диалог показан на <<sysinstall-label-mount>>. Точка монтирования корневой файловой системы [.filename]#/#, поэтому введите `/`, и нажмите kbd:[Enter].

[[sysinstall-label-mount]]
.Выбор точки монтирования корневой файловой системы
image::disklabel-root3.png[]

На экране будет показан вновь созданный раздел. Вам нужно повторить эту процедуру для других разделов. При создании раздела подкачки вопроса про точку монтирования не будет, поскольку раздел подкачки никогда не монтируется. Когда будете создавать последний раздел, [.filename]#/usr#, можете оставить предложенный размер как есть, чтобы использовать весь остаток слайса.

Последний экран FreeBSD редактора DiskLabel будет похож на <<sysinstall-label4>>, хотя ваш выбор значений может быть другим. Нажмите kbd:[Q], чтобы выйти.

[[sysinstall-label4]]
.Редактор Sysinstall Disklabel
image::disklabel-ed2.png[]

[[install-choosing]]
== Выбор устанавливаемых компонентов

[[distset]]
=== Выбор дистрибутивного набора (Distribution Set)

Выбор дистрибутивного набора зависит в основном от направления будущего использования системы и от доступного дискового пространства. Предустановленные опции варьируются от наименьшей возможной конфигурации до полной установки. Для новичков в UNIX(R) и/или FreeBSD лучшим выбором будет одна из этих предустановленных опций. Настройка дистрибутивного набора как правило нужна более опытным пользователям.

Нажмите kbd:[F1] для получения информации о дистрибутивных наборах и их содержимом. После просмотра помощи нажмите kbd:[Enter] для возврата к меню выбора дистрибутивного набора.

Если желательно наличие графического интерфейса пользователя, то задачи настройки X сервера и выбора десктопа по умолчанию должны быть выполнены после установки FreeBSD. Более подробная информация по установке и настройке X сервера находится в crossref:x11[x11, X Window System].

Если планируется пересборка ядра, выберите опцию, включающую исходные тексты. Информация о том, зачем пересобирать ядро и как это сделать, находится на crossref:kernelconfig[kernelconfig, Настройка ядра FreeBSD].

Ясно, что наиболее универсальная система включает все. Если места на диске достаточно, выберите [.guimenuitem]#All#, как показано на <<distribution-set1>> и нажмите kbd:[Enter]. Если есть сомнения относительно того, хватит ли диска, используйте наиболее подходящую опцию. Не беспокойтесь о том, какой выбор будет наилучшим, другие части дистрибутива могут быть добавлены после установки.

[[distribution-set1]]
.Выбор дистрибутивных наборов
image::dist-set.png[]

[[portscol]]
=== Установка Коллекции Портов

После выбора подходящего дистрибутива можно будет выбрать установку Коллекции Портов FreeBSD. Коллекция Портов - лёгкий и удобный путь установки программ. Коллекция Портов не содержит исходных кодов программ. Это набор файлов, который автоматизирует загрузку, компилирование и установку пакетов программного обеспечения сторонних разработчиков. crossref:ports[ports, Установка приложений. порты и пакеты] показывает, как использовать Коллекцию Портов.

Программа установки не проверяет, есть ли достаточно места. Выберите эту опцию только в том случае, если его достаточно. В FreeBSD {rel120-current}, Коллекция Портов занимает около {ports-size}. В более современных релизах это значение всегда больше.

[source,bash]
....
                         User Confirmation Requested
 Would you like to install the FreeBSD ports collection?

 This will give you ready access to over 24,000 ported software packages,
 at a cost of around 500 MB of disk space when "clean" and possibly much
 more than that if a lot of the distribution tarballs are loaded
 (unless you have the extra CDs from a FreeBSD CD/DVD distribution
 available and can mount it on /cdrom, in which case this is far less
 of a problem).

 The ports collection is a very valuable resource and well worth having
 on your /usr partition, so it is advisable to say Yes to this option.

 For more information on the ports collection & the latest ports,
 visit:
     http://www.FreeBSD.org/ports

                              [ Yes ]     No
....

Выберите btn:[yes] для установки Коллекции Портов, или btn:[no], чтобы пропустить установку. Нажмите kbd:[Enter], чтобы продолжить. Меню выбора дистрибутивных наборов появится опять.

[[distribution-set2]]
.Подтверждение выбора дистрибутивного набора
image::dist-set2.png[]

Если вы согласны с выбранными опциями, переместитесь на [.guimenuitem]#Exit#, убедитесь, что выбран btn:[OK] и нажмите kbd:[Enter], чтобы продолжить.

[[install-media]]
== Выбор источника для установки

При установке с CDROM или DVD используйте клавиши навигации, для перехода к пункту [.guimenuitem]#Install from a FreeBSD CD/DVD#. Убедитесь, что выбран btn:[OK], и нажмите kbd:[Enter] для запуска установки.

При других методах установки выберите соответствующую опцию и следуйте инструкциям.

Нажмите kbd:[F1] для просмотра справки по источникам установки. Нажмите kbd:[Enter] для возврата к меню выбора источника установки.

[[choose-media]]
.Выбор источника установки
image::media.png[]

[NOTE]
.Режимы установки с FTP
====
Есть три режима установки через FTP, которые вы можете выбрать: активный FTP, пассивный FTP, или через HTTP прокси.

Активный FTP: [.guimenuitem]#Install from an FTP server#::
С этой опцией все закачки по FTP будут выполнены в "активном" режиме. Этот режим не позволяет работать через файрволл, но зачастую позволяет работать со старыми серверами FTP, не поддерживающими пассивный режим. Если соединение прерывается в пассивном режиме (по умолчанию), попробуйте активный!

Пассивный FTP: [.guimenuitem]#Install from an FTP server through a firewall#::
Эта опция говорит sysinstall использовать "пассивный" режим для работы с FTP. Он позволяет работать через файрволл, не разрешающий входящие соединения на случайных TCP портах.

FTP через HTTP прокси: [.guimenuitem]#Install from an FTP server through a http proxy#::
Эта опция говорит sysinstall использовать HTTP протокол (как Web-браузер) для работы с FTP через прокси. Прокси будет транслировать все запросы и посылать их на FTP сервер. Это позволяет проходить через файрволл, на котором FTP запрещен, но есть HTTP прокси. В этом случае потребуется указать прокси и FTP сервер.

Для работы с FTP через прокси, необходимо поместить имя сервера как часть имени пользователя после знака "@". Прокси сервер "обманет" настоящий сервер. Например, предположим что вы хотите провести установку с `ftp.FreeBSD.org`, используя FTP через прокси `foo.example.com`, прослушивающем порт 1234.

В этом случае, войдите в меню параметров, установите имя пользователя FTP `ftp@ftp.FreeBSD.org`, а вместо пароля введите свой адрес email. В качестве источника установки выберите FTP (или пассивный FTP, если прокси его поддерживает), и URL `ftp://foo.example.com:1234/pub/FreeBSD`.

Так как [.filename]#/pub/FreeBSD# с сервера `ftp.FreeBSD.org` идет через прокси `foo.example.com`, вы сможете провести установку с _этого_ компьютера (файлы будут загружены с `ftp.FreeBSD.org` как требуется для установки).
====

[[install-final-warning]]
== Подтверждение установки

Теперь можно начинать установку. Это последний шанс отменить установку, и таким образом избежать изменений на жестком диске.

[source,bash]
....
                       User Confirmation Requested
 Last Chance! Are you SURE you want to continue the installation?

 If you're running this on a disk with data you wish to save then WE
 STRONGLY ENCOURAGE YOU TO MAKE PROPER BACKUPS before proceeding!

 We can take no responsibility for lost disk contents!

                             [ Yes ]    No
....

Выберите btn:[yes] и нажмите kbd:[Enter], чтобы начать.

Время установки сильно зависит от выбранного дистрибутивного набора, источника установки и скорости компьютера. Появится несколько сообщений о статусе процесса установки.

Установка будет завершена, когда отобразится следующее сообщение:

[source,bash]
....
                               Message

Congratulations! You now have FreeBSD installed on your system.

We will now move on to the final configuration questions.
For any option you do not wish to configure, simply select No.

If you wish to re-enter this utility after the system is up, you may
do so by typing: /usr/sbin/sysinstall.

                                 [ OK ]

                      [  Press enter or space  ]
....

Нажмите kbd:[Enter] для начала послеустановочной настройки.

Выбор btn:[no] и нажатие kbd:[Enter] прервет процесс установки, изменения в систему внесены не будут. Появится следующее сообщение:

[source,bash]
....
                                Message
Installation complete with some errors.  You may wish to scroll
through the debugging messages on VTY1 with the scroll-lock feature.
You can also choose "No" at the next prompt and go back into the
installation menus to retry whichever operations have failed.

                                 [ OK ]
....

Это сообщение появилось, поскольку ничего не было установлено. Нажатие kbd:[Enter] вернет вас в главное меню установки, чтобы выйти из нее.

[[install-post]]
== После установки

После успешной установки необходимо настроить множество параметров. Некоторые параметры могут быть заданы из меню параметров после установки, перед загрузкой установленной FreeBSD, или после нее с использованием `sysinstall`, где надо выбрать пункт [.guimenuitem]#Configure#.

[[inst-network-dev]]
=== Настройка сетевых устройств (Network Device Configuration)

Если вы настраивали PPP для установки через FTP, этот экран не появится, и настройку можно будет произвести позже как описано выше.

Чтобы лучше узнать о локальных сетях и настройке FreeBSD в качестве шлюза/маршрутизатора, обратитесь к главе crossref:advanced-networking[advanced-networking,Сложные вопросы работы в сети].

[source,bash]
....
                     User Confirmation Requested
   Would you like to configure any Ethernet or PPP network devices?

                             [ Yes ]   No
....

Для настройки сетевого устройства выберите btn:[yes] и нажмите kbd:[Enter]. Или нажмите btn:[no], чтобы продолжить.

[[ed-config1]]
.Выбор Ethernet устройства
image::ed0-conf.png[]

Выберите интерфейс для настройки с помощью клавиш навигации и нажмите kbd:[Enter].

[source,bash]
....
                      User Confirmation Requested
       Do you want to try IPv6 configuration of the interface?

                              Yes   [ No ]
....

Для частной локальной сети обычный протокол интернет (IPv4) вполне достаточен, поэтому выбрана кнопка btn:[no] и нажат kbd:[Enter].

Если вы хотите подсоединиться к существующей сети IPv6 через сервер RA, выберите btn:[yes] и нажмите kbd:[Enter]. Поиск RA серверов займет несколько секунд.

[source,bash]
....
                             User Confirmation Requested
	Do you want to try DHCP configuration of the interface?

                              Yes   [ No ]
....

Если DHCP (Dynamic Host Configuration Protocol) не нужен, выберите btn:[no] с помощью клавиш навигации и нажмите kbd:[Enter].

Выбор btn:[yes] запустит dhclient, и, если все пройдет нормально, заполнит информацию о конфигурации сети автоматически. Обратитесь к crossref:network-servers[network-dhcp,Автоматическая настройка сети (DHCP)] за более подробными сведениями.

Следующий экран конфигурации сети показывает настройку устройства Ethernet системы, которая будет работать шлюзом для локальной сети.

[[ed-config2]]
.Настройка сети для _ed0_
image::ed0-conf2.png[]

Используйте kbd:[Tab] для выбора полей и заполнения их соответствующими данными:

Host::
Полное имя хоста, в этом примере `k6-2.example.com`.

Domain::
Имя домена, в котором находится ваш компьютер, в этом примере `example.com`.

IPv4 Gateway::
IP хоста, пересылающего пакеты наружу локальной сети. Вам потребуется заполнить его, если это компьютер, подключенный к сети. _Оставьте это поле пустым_, если компьютер является шлюзом в интернет для сети. Шлюз IPv4 известен также как шлюз по умолчанию или маршрут по умолчанию.

Name server::
IP адрес местного сервера DNS. В этой локальной сети нет DNS сервера, поэтому использован IP адрес DNS сервера провайдера (`208.163.10.2`).

IPv4 address::
IP адрес, использованный для этого интерфейса, `192.168.0.1`

Netmask::
Адрес блока, использованного для этой локальной сети, это `192.168.0.0` - `192.168.0.255`. с маской сети `255.255.255.0`.

Дополнительные параметры для ifconfig::
Любые специфичные для интерфейса опции к `ifconfig`, которые вы хотите добавить. В данном случае ничего.

Используйте kbd:[Tab] для выбора btn:[OK] после окончания настройки и нажмите kbd:[Enter].

[source,bash]
....
                      User Confirmation Requested
	Would you like to bring the ed0 interface up right now?

                             [ Yes ]   No
....

Выбор btn:[yes] и нажатие kbd:[Enter] введет компьютер в сеть. Тем не менее, компьютеру все еще требуется перезагрузка.

[[gateway]]
=== Настройка шлюза (Configure Gateway)

[source,bash]
....
                       User Confirmation Requested
       Do you want this machine to function as a network gateway?

                              [ Yes ]    No
....

Если компьютер будет шлюзом для локальной сети, пересылая пакеты между другими компьютерами, выберите btn:[yes] и нажмите kbd:[Enter]. Если это обычный компьютер, выберите btn:[no] и нажмите kbd:[Enter] для продолжения.

[[inetd-services]]
=== Настройка сервисов интернет (Configure Internet Services)

[source,bash]
....
                      User Confirmation Requested
Do you want to configure inetd and the network services that it provides?

                               Yes   [ No ]
....

Если выбрана btn:[no], различные сервисы, такие как telnetd не будут запущены. Это означает, что удаленные пользователи не смогут зайти по telnet на этот компьютер. Локальные пользователи все же смогут заходит на удаленные компьютеры по telnet.

Эти сервисы могут быть включены после установки путем редактирования [.filename]#/etc/inetd.conf# с помощью вашего любимого текстового редактора. Обращайтесь к crossref:network-servers[network-inetd-overview,Обзор] за более подробной информацией.

Выберите btn:[yes] если хотите настроить эти сервисы во время установки. Появится дополнительный запрос подтверждения:

[source,bash]
....
                      User Confirmation Requested
The Internet Super Server (inetd) allows a number of simple Internet
services to be enabled, including finger, ftp and telnetd.  Enabling
these services may increase risk of security problems by increasing
the exposure of your system.

With this in mind, do you wish to enable inetd?

                             [ Yes ]   No
....

Нажмите btn:[yes], чтобы продолжить.

[source,bash]
....
                      User Confirmation Requested
inetd(8) relies on its configuration file, /etc/inetd.conf, to determine
which of its Internet services will be available.  The default FreeBSD
inetd.conf(5) leaves all services disabled by default, so they must be
specifically enabled in the configuration file before they will
function, even once inetd(8) is enabled.  Note that services for
IPv6 must be separately enabled from IPv4 services.

Select [Yes] now to invoke an editor on /etc/inetd.conf, or [No] to
use the current settings.

                             [ Yes ]   No
....

Выбор btn:[yes] позволит добавить сервисы путем удаления `#` перед началом строки.

[[inetd-edit]]
.Редактирование [.filename]#inetd.conf#
image::edit-inetd-conf.png[]

После добавления нужных сервисов нажатие kbd:[Esc] отобразит меню, позволяющее выйти с сохранением изменений.

[[ssh-login]]
=== Настройка входа по SSH

[source,bash]
....
                      User Confirmation Requested
                  Would you like to enable SSH login?
                           Yes        [  No  ]
....

Выбор btn:[yes] активирует запуск man:sshd[8] - демона для приложения OpenSSH, что в свою очередь позволит создавать безопасные удалённые соединения c вашей машиной. За более детальной информацией о OpenSSH обратитесь к crossref:security[openssh,OpenSSH].

[[ftpanon]]
=== Анонимный (Anonymous) FTP

[source,bash]
....
                      User Confirmation Requested
 Do you want to have anonymous FTP access to this machine?

                              Yes    [ No ]
....

[[deny-anon]]
==== Запрещение анонимного FTP

Выбор кнопки по умолчанию btn:[no] и нажатие kbd:[Enter] все же позволит пользователям, имеющим учетные записи с паролями, использовать FTP для доступа к компьютеру.

[[ftpallow]]
==== Разрешение анонимного FTP

Кто угодно сможет получить доступ к компьютеру, если вы разрешите анонимные соединения FTP. Предварительно должны быть рассмотрены возможные проблемы с безопасностью. Более подробная информация о безопасности находится в crossref:security[security, Безопасность].

Чтобы разрешить анонимный FTP, выберите btn:[yes], используя клавиши навигации, и нажмите kbd:[Enter]. От вас потребуется дополнительное подтверждение:

[source,bash]
....
                       User Confirmation Requested
 Anonymous FTP permits un-authenticated users to connect to the system
 FTP server, if FTP service is enabled.  Anonymous users are
 restricted to a specific subset of the file system, and the default
 configuration provides a drop-box incoming directory to which uploads
 are permitted.  You must separately enable both inetd(8), and enable
 ftpd(8) in inetd.conf(5) for FTP services to be available.  If you
 did not do so earlier, you will have the opportunity to enable inetd(8)
 again later.

 If you want the server to be read-only you should leave the upload
 directory option empty and add the -r command-line option to ftpd(8)
 in inetd.conf(5)

 Do you wish to continue configuring anonymous FTP?

                          [ Yes ]         No
....

В этом сообщении сказано: если вы хотите разрешить анонимный FTP доступ, то вам также придется активировать (см. <<inetd-services>>) сам сервис FTP в [.filename]#/etc/inetd.conf#. Выберите btn:[yes], нажмите kbd:[Enter], далее отобразится следующий экран:

[[anon-ftp2]]
.Настройка по анонимного FTP по умолчанию
image::ftp-anon1.png[]

Используя kbd:[Tab] для выбора полей ввода, заполните соответствующую информацию:

UID::
Идентификатор, который вы намереваетесь присвоить анонимному пользователю FTP. Файлам, загруженным на FTP, будет присвоен этот идентификатор.

Group::
В эту группу будет входить анонимный пользователь FTP.

Comment::
Строка с описанием анонимного пользователя; она будет внесена в [.filename]#/etc/passwd#.

FTP Root Directory::
Часть иерархии файловой системы, в которой будут храниться файлы, доступные анонимному пользователю FTP.

Upload Subdirectory::
Подкаталог, доступный на запись анонимному пользователю FTP.

Корневой каталог FTP по умолчанию будет размещен в [.filename]#/var#. Если в нем предположительно не хватает места для для нужд FTP, можно использовать каталог [.filename]#/usr#, выбрав корневой каталог FTP (FTP root directory) [.filename]#/usr/ftp#.

Когда будут выбраны подходящие значения, нажмите kbd:[Enter], чтобы продолжить.

[source,bash]
....
                          User Confirmation Requested
         Create a welcome message file for anonymous FTP users?

                              [ Yes ]    No
....

Если вы выберете btn:[yes] и нажмете kbd:[Enter], запустится редактор, позволяющий отредактировать сообщение FTP.

[[anon-ftp4]]
.Редактирование FTP Welcome Message
image::ftp-anon2.png[]

Этот текстовый редактор называется `ee`. Используйте инструкции, чтобы изменить сообщение, или измените сообщение позже, используя выбранный вами редактор. Обратите внимание, что имя/расположение файла показаны внизу окна редактора.

Нажмите kbd:[Esc] и появится меню с пунктом по умолчанию [.guimenuitem]#a) leave editor# (выйти из редактора). Нажмите kbd:[Enter], чтобы выйти и продолжить. Нажмите kbd:[Enter] еще раз, чтобы сохранить изменения, если они были сделаны.

[[nfsconf]]
=== Настройка сетевой файловой системы (Configure Network File System)

Сетевая файловая система (Network File System, NFS) позволяет совместно использовать файлы в сети. Компьютер может быть настроен как сервер, клиент, или как то и другое. Обратитесь к crossref:network-servers[network-nfs,Network File System (NFS)] за более подробной информацией.

[[nsf-server-options]]
==== Сервер NFS (NFS Server)

[source,bash]
....
                       User Confirmation Requested
 Do you want to configure this machine as an NFS server?

                              Yes    [ No ]
....

Если вам не нужен NFS сервер, выберите btn:[no] и нажмите kbd:[Enter].

Если выбран пункт btn:[yes], появится сообщение, говорящее о том, что должен быть создан файл [.filename]#exports#.

[source,bash]
....
                               Message
Operating as an NFS server means that you must first configure an
/etc/exports file to indicate which hosts are allowed certain kinds of
access to your local filesystems.
Press [Enter] now to invoke an editor on /etc/exports
                               [ OK ]
....

Нажмите kbd:[Enter], чтобы продолжить. Запустится текстовый редактор, позволяющий создать и отредактировать файл [.filename]#exports#.

[[nfs-server-edit]]
.Редактирование [.filename]#exports#
image::nfs-server-edit.png[]

Используйте инструкции для добавления экспортируемых файловых систем сейчас, или позднее с помощью выбранного вами текстового редактора. Обратите внимание, что имя/расположение файла показаны внизу окна редактора.

Нажмите kbd:[Esc] и появится меню с пунктом по умолчанию [.guimenuitem]#a) leave editor#. Нажмите kbd:[Enter], чтобы выйти и продолжить.

[[nfs-client-options]]
==== Клиент NFS (NFS Client)

NFS клиент позволяет организовать доступ к серверам NFS.

[source,bash]
....
                       User Confirmation Requested
 Do you want to configure this machine as an NFS client?

                              Yes   [ No ]
....

С помощью клавиш навигации выберите btn:[yes] или btn:[no], как потребуется, и нажмите kbd:[Enter].

[[console]]
=== Настройки системной консоли (System Console Settings)

Есть несколько параметров для настройки системной консоли.

[source,bash]
....
                      User Confirmation Requested
       Would you like to customize your system console settings?

                              [ Yes ]  No
....

Для просмотра и настройки параметров выберите btn:[yes] и нажмите kbd:[Enter].

[[saver-options]]
.Параметры настройки системной консоли
image::console-saver1.png[]

Часто используемая опция это хранитель экрана (screen saver). Используйте клавиши навигации для выбора [.guimenuitem]#Saver# и нажмите kbd:[Enter].

[[saver-select]]
.Параметры хранителя экрана
image::console-saver2.png[]

Выберите подходящий хранитель экрана с помощью клавиш навигации и нажмите kbd:[Enter]. Опять появится меню настройки системной консоли.

Время по умолчанию 300 секунд. Для изменения временного интервала выберите [.guimenuitem]#Saver# еще раз. В меню настроек хранителя экрана выберите [.guimenuitem]#Timeout# с помощью клавиш навигации и нажмите kbd:[Enter]. Появится меню:

[[saver-timeout]]
.Временной интервал хранителя экрана
image::console-saver3.png[]

Значение может быть изменено, затем выберите btn:[OK] и нажмите kbd:[Enter] для возврата в меню настройки системной консоли.

[[saver-exit]]
.Выход из меню конфигурации консоли
image::console-saver4.png[]

Выбор [.guimenuitem]#Exit# и нажатие kbd:[Enter] вернет вас к послеустановочной настройке.

[[timezone]]
=== Установка часового пояса (Setting The Time Zone)

Установка часового пояса на компьютере позволит ему автоматически вносить поправки к местному времени и правильно выполнять другие, связанные с часовым поясом функции.

Пример приведен для компьютера, расположенного в восточном часовом поясе Соединенных Штатов. Ваш выбор будет зависеть от вашего географического положения.

[source,bash]
....
                      User Confirmation Requested
          Would you like to set this machine's time zone now?

                            [ Yes ]   No
....

Выберите btn:[yes] и нажмите kbd:[Enter] для установки часового пояса.

[source,bash]
....
                       User Confirmation Requested
 Is this machine's CMOS clock set to UTC? If it is set to local time
 or you don't know, please choose NO here!

                              Yes   [ No ]
....

Выберите btn:[yes] или btn:[no] в зависимости от настроек часов компьютера и нажмите kbd:[Enter].

[[set-timezone-region]]
.Выбор региона
image::timezone1.png[]

Соответствующий регион выбран с помощью клавиш навигации и нажат kbd:[Enter].

[[set-timezone-country]]
.Выбор страны
image::timezone2.png[]

Выберите соответствующую страну с помощью клавиш навигации и нажмите kbd:[Enter].

[[set-timezone-locality]]
.Выбор часового пояса
image::timezone3.png[]

Выбран соответствующий часовой пояс с помощью клавиш навигации и нажат kbd:[Enter].

[source,bash]
....
                            Confirmation
            Does the abbreviation 'EDT' look reasonable?

                            [ Yes ]   No
....

Правильно будет согласиться с назначением аббревиатуры временного пояса. Если она подходит, нажмите kbd:[Enter], чтобы продолжить послеустановочную настройку.

[[mouse]]
=== Настройка мыши (Mouse Settings)

Эти настройки позволят вырезать и вставлять текст в консоли и пользовательских программах с помощью трехкнопочной мыши. Если используется двухкнопочная мышь, обратитесь к странице справочника man:moused[8] после установки, чтобы узнать подробности об эмуляции трехкнопочной мыши. Этот пример приведен для настройки не-USB мыши (например мыши для порта PS/2 или COM):

[source,bash]
....
                      User Confirmation Requested
         Does this system have a PS/2, serial, or bus mouse?

                            [ Yes ]    No 
....

Выберите btn:[yes] для PS/2 мыши, последовательной мыши или мыши типа bus mouse. Выберите btn:[no] для USB мыши и нажмите kbd:[Enter].

[[mouse-protocol]]
.Выбор протокола мыши
image::mouse1.png[]

Используйте клавиши навигации для выбора [.guimenuitem]#Type# и нажмите kbd:[Enter].

[[set-mouse-protocol]]
.Установка протокола мыши
image::mouse2.png[]

В этом примере использована PS/2 мышь, поэтому подойдет протокол по умолчанию [.guimenuitem]#Auto#. Чтобы изменить протокол, используйте клавиши навигации для выбора другого пункта. Убедитесь, что выбран btn:[OK], и нажмите kbd:[Enter] для выхода из меню.

[[config-mouse-port]]
.Настройка порта мыши
image::mouse3.png[]

Используйте клавиши навигации для выбора [.guimenuitem]#Port# и нажмите kbd:[Enter].

[[set-mouse-port]]
.Установка порта мыши
image::mouse4.png[]

К этой системе подключена мышь PS/2, поэтому подходит значение по умолчанию [.guimenuitem]#PS/2#. Чтобы изменить порт, используйте клавиши навигации и нажмите kbd:[Enter].

[[test-daemon]]
.Запуск даемона мыши
image::mouse5.png[]

Наконец, используйте клавиши навигации для выбора [.guimenuitem]#Enable#, затем нажмите kbd:[Enter] для запуска и тестирования даемона мыши.

[[test-mouse-daemon]]
.Проверка даемона мыши
image::mouse6.png[]

Подвигайте курсор по экрану и убедитесь, что он движется правильно. Если это так, выберите btn:[yes] и нажмите kbd:[Enter]. Если нет, мышь не была правильно настроена - выберите btn:[no] и попробуйте использовать другие опции настройки.

Выберите [.guimenuitem]#Exit# с помощью клавиш навигации и нажмите kbd:[Enter] для возврата к послеустановочной настройке.

[[packages]]
=== Установка пакетов (Install Packages)

Пакеты - это прекомпилированные бинарные файлы и это удобный способ установки программ.

В качестве примера показана установка одного пакета. Если потребуется, можно установить дополнительные пакеты. После установки для добавления пакетов может быть использована команда `sysinstall`.

[source,bash]
....
                     User Confirmation Requested
 The FreeBSD package collection is a collection of hundreds of
 ready-to-run applications, from text editors to games to WEB servers
 and more. Would you like to browse the collection now?

                            [ Yes ]   No
....

Выбор [.guimenuitem]#[ Yes ]# и нажатие kbd:[Enter] приведет к появлению экрана выбора пакетов:

[[package-category]]
.Выбор категории пакетов
image::pkg-cat.png[]

Только пакеты с текущего носителя доступны для установки в любое время.

Все доступные пакеты будут показаны если выбрать категорию [.guimenuitem]#All#, можно также выбирать отдельные категории. Перейдите к выбранной категории с помощью клавиш навигации и нажмите kbd:[Enter].

Появится меню, содержащее доступные в данной категории пакеты.

[[package-select]]
.Выбор пакетов
image::pkg-sel.png[]

Выбрана оболочка bash. Выберите все необходимые пакеты, перемещаясь по меню и нажимая клавишу пробела на выбираемых пакетах. Краткое описание пакета будет появляться в нижней левой части экрана.

Нажатие kbd:[Tab] переключает между последним выбранным пакетом, btn:[OK], и btn:[Cancel].

После того, как будет закончена отметка пакетов для установки, нажмите kbd:[Tab] один раз для переключения на btn:[OK] и нажмите kbd:[Enter] для переключения на меню выбора пакетов.

Нажимая клавиши навигации влево или вправо, можно переключаться между btn:[OK] и btn:[Cancel]. Этот метод может быть применен также для выбора btn:[OK] и возврата к меню выбора пакетов нажатием kbd:[Enter].

[[package-install]]
.Установка пакетов
image::pkg-install.png[]

Используйте kbd:[Tab] и клавиши навигации для выбора btn:[Install] и нажмите kbd:[Enter]. вам потребуется подтвердить установку пакетов:

[[package-install-confirm]]
.Подтверждение установки пакетов
image::pkg-confirm.png[]

Выбор btn:[OK] и нажатие kbd:[Enter] запустит установку пакетов. Во время установки будут выдаваться сообщения. Обратите внимание на возможные сообщения об ошибках.

После установки пакетов настройка продолжится. Если вы не выбрали ни один из пакетов и хотите вернуться к завершению настройки, выберите btn:[Install] в любом случае.

[[addusers]]
=== Добавление пользователей/групп (Add Users/Groups)

В процессе установки нужно добавить хотя бы одного пользователя, чтобы использовать систему без входа под `root`. Корневой каталог обычно мал и запуск приложений под `root` быстро заполнит его. Ниже показано предупреждение:

[source,bash]
....
                     User Confirmation Requested
 Would you like to add any initial user accounts to the system? Adding
 at least one account for yourself at this stage is suggested since
 working as the "root" user is dangerous (it is easy to do things which
 adversely affect the entire system).

                            [ Yes ]   No
....

Выберите btn:[yes] и нажмите kbd:[Enter], чтобы продолжить добавление пользователя.

[[add-user2]]
.Выбор User (пользователь)
image::adduser1.png[]

Выберите [.guimenuitem]#User# с помощью клавиш навигации и нажмите kbd:[Enter].

[[add-user3]]
.Вод информации о пользователе
image::adduser2.png[]

При выборе полей с помощью kbd:[Tab] в нижней части экрана будет появляться описание, помогающее ввести необходимую информацию:

Логин (Login ID)::
Имя нового пользователя (обязательно).

UID::
Числовой ID (идентификатор) для этого пользователя (оставьте пустым для автоматического выбора).

Группа (Group)::
Имя группы этого пользователя (оставьте пустым для автоматического выбора).

Пароль (Password)::
Пароль этого пользователя (заполняйте это поле с осторожностью!).

Полное имя::
Полное имя пользователя (комментарий).

Член групп (Member groups)::
Группы, к которым принадлежит пользователь (т.е. имеет права доступа).

Домашний каталог (Home directory)::
Домашний каталог пользователя (оставьте пустым для выбора по умолчанию).

Оболочка (Login shell)::
Оболочка пользователя, запускаемая при входе в систему (оставьте пустым для оболочки по умолчанию, например [.filename]#/bin/sh#).

Оболочка была изменена с [.filename]#/bin/sh# на [.filename]#/usr/local/bin/bash# для использования bash, которая была перед этим установлена из пакета. Не пытайтесь использовать несуществующую оболочку, вы не сможете войти в систему. Наиболее часто используемая в мире BSD оболочка это C shell, которую можно обозначить как [.filename]#/bin/tcsh#.

Пользователь был добавлен в группу `wheel`, чтобы иметь возможность стать суперпользователем с привилегиями `root`.

Когда все будет введено, нажмите btn:[OK] и меню управления пользователями и группами (User and Group Management) появится снова:

[[add-user4]]
.Выход из меню управления пользователями и группами
image::adduser3.png[]

Сейчас также можно добавить группы, если известно, для чего они потребуются. Иначе в это меню можно войти, запустив `sysinstall` после окончания установки.

После завершения добавления пользователей, выберите [.guimenuitem]#Exit# с помощью клавиш навигации и нажмите kbd:[Enter] для продолжения установки.

[[rootpass]]
=== Установка пароля `root`

[source,bash]
....
                        Message
 Now you must set the system manager's password.
 This is the password you'll use to log in as "root".

                         [ OK ]

               [ Press enter or space ]
....

Нажмите kbd:[Enter] для установки пароля `root`.

Необходимо два раза правильно ввести пароль. Излишне упоминать, что должна быть возможность восстановления пароля, если вы его забудете. Обратите внимание, что ни набираемый пароль, ни звездочки на экран не выдаются.

[source,bash]
....
New password:
Retype new password :
....

Установка продолжится после успешного ввода пароля.

[[exit-inst]]
=== Выход из установки (Exiting Install)

Если нужно настроить <<network-services,дополнительные сетевые устройства>>, или произвести другие настройки, вы можете сделать это сейчас или после установки с помощью `sysinstall`.

[source,bash]
....
                     User Confirmation Requested
 Visit the general configuration menu for a chance to set any last
 options?

                              Yes   [ No ]
....

Выберите btn:[no] с помощью клавиш навигации и нажмите kbd:[Enter] для возврата к главному меню установки.

[[final-main]]
.Выход из установки
image::mainexit.png[]

Выберите btn:[X Exit Install] с помощью клавиш навигации и нажмите kbd:[Enter]. Будет задан вопрос о подтверждении выхода из установки:

[source,bash]
....
                     User Confirmation Requested
 Are you sure you wish to exit? The system will reboot.

                            [ Yes ]   No
....

Выберите btn:[yes]. Если вы загружались с привода CDROM, следующее сообщение напомнит вам о необходимости извлечь диск:

[source,bash]
....
                    Message
 Be sure to remove the media from the drive.

                    [ OK ]
           [ Press enter or space ]
....

CDROM заблокирован, пока компьютер не начнет перегружаться. CDROM будет разблокирован и диск нужно будет извлечь из привода (быстро). Выберите btn:[OK].

Система начнет перезагрузку, смотрите за сообщениями об ошибках, которые могут появиться. За подробностями по процессу загрузки обратитесь к <<freebsdboot>>.

[[network-services]]
=== Настройка дополнительных сетевых сервисов

Настройка сетевых сервисов может быть пугающей задачей для новых пользователей, если у них нет опыта в этой области. Работа в сети, включая интернет, критична для многих современных операционных систем, включая FreeBSD; очень важно иметь некоторые знания о дополнительных сетевых возможностях FreeBSD. Настраивая их во время установки, пользователь получает некоторую информацию о различных доступных сервисах.

Сетевые сервисы - это программы, принимающие данные из любой точки сети. Чтобы убедиться, что эти программы не делают ничего "вредного", требуется особое внимание. К сожалению, программисты не совершенны и время от времени допускают ошибки в сетевых сервисах; эти ошибки позволяют атакующим взломать их и использовать в собственных целях. Важно, чтобы вы включали сетевые сервисы только в том случае, если знаете, какие сервисы нужны. В случае сомнений лучше не включать сервис, пока он не понадобится. Вы всегда можете включить его позже, запустив sysinstall еще раз, или используя возможности, предоставляемые файлом [.filename]#/etc/rc.conf#.

Выбор опции menu:Networking[] отобразит меню, похожее на это:

[[network-configuration]]
.Верхняя часть меню настройки сети (Network Configuration)
image::net-config-menu1.png[]

Первая опция, [.guimenuitem]#Interfaces# (интерфейсы), была ранее описана в <<inst-network-dev>>, эту опцию можно проигнорировать.

Выбор опции [.guimenuitem]#AMD# добавит поддержку BSD утилиты автоматического монтирования. Она обычно используется вместе с протоколом NFS (смотрите ниже) для автоматического монтирования удаленных файловых систем. Здесь не требуется специальной конфигурации.

Следующая линия это опция флаги [.guimenuitem]#AMD# (flags). Когда эта опция выбрана, появится меню для ввода специфичных флагов AMD. Меню уже содержит набор различных опций:

[source,bash]
....
-a /.amd_mnt -l syslog /host /etc/amd.map /net /etc/amd.map
....

Опция `-a` указывает месторасположение монтирования систем по умолчанию, в этом примере [.filename]#/.amd_mnt#. Опция `-l` указывает [.filename]#log# файл по умолчанию; тем не менее, если для ведения логов используется `syslogd`, все логи отправляются даемону системных логов. Каталог [.filename]#/host# используется для монтирования экспортированных файловых систем с удаленного хоста, а [.filename]#/net# для монтирования экспортированных файловых систем с IP адреса. Файл [.filename]#/etc/amd.map# определяет опции по умолчанию для монтируемых AMD каталогов.

Опция [.guimenuitem]#Anon FTP# позволяет получить анонимный доступ к FTP. Выберите ее, чтобы сделать этот компьютер анонимным FTP сервером. Помните о риске безопасности, создаваемом этой опцией. Будет отображено еще одно меню для разъяснения риска безопасности и для более тонкой настройки.

Опция [.guimenuitem]#Gateway# сделает компьютер шлюзом, как было объяснено ранее. Этот пункт может быть использован для отмены опции [.guimenuitem]#Gateway#, если она была ошибочно установлена в процессе установки.

Опцию [.guimenuitem]#Inetd# можно использовать для настройки или полного отключения даемона man:inetd[8], как было описано выше.

Опция [.guimenuitem]#Mail# используется для настройки системного MTA по умолчанию (Mail Transfer Agent, агент передачи почты). Выбор этой опции приведет к появлению следующего меню:

[[mta-selection]]
.Выбор MTA по умолчанию
image::mta-main.png[]

Здесь предоставляется выбор MTA для установки по умолчанию. MTA это почтовый сервер, доставляющий почту пользователям системы или интернет.

Выбор [.guimenuitem]#Sendmail# приведет к установке популярного сервера sendmail, MTA по умолчанию для FreeBSD. Опция [.guimenuitem]#Sendmail local# настроит sendmail в качестве MTA по умолчанию, но отключит возможность получения входящей почты из интернет. Другие MTA, представленные здесь, [.guimenuitem]#Postfix# и [.guimenuitem]#Exim#, действуют подобно [.guimenuitem]#Sendmail#. Оба они доставляют почту; тем не менее, некоторые пользователи предпочитают эти альтернативы sendmail.

После выбора MTA или пропуска этого пункта появится меню настройки сети со следующей опцией, клиент [.guimenuitem]#NFS#.

Клиент [.guimenuitem]#NFS# позволяет настроить систему для соединения с сервером через NFS. Сервер NFS дает другим машинам доступ к файловой системе через протокол NFS. Если это отдельно стоящий компьютер, опцию можно не выбирать. NFS может потребовать дополнительной настройки позже; обращайтесь к crossref:network-servers[network-nfs,Network File System (NFS)] за более подробной информацией о настройке сервера и клиента.

Ниже находится опция [.guimenuitem]#NFS# сервер, позволяющая вам настроить систему для работы в качестве NFS сервера. Она добавляет требуемую информацию для запуска процедуры вызова удаленных сервисов RPC (remote procedure call services). RPC используется для организации соединения между хостами и программами.

Следующая строка это [.guimenuitem]#Ntpdate#, которая отвечает за синхронизацию времени. Когда эта опция выбрана, появится приблизительно такое меню:

[[Ntpdate-config]]
.Настройка Ntpdate
image::ntp-config.png[]

Выберите из этого меню ближайший к вашему местонахождению сервер. Выбор ближайшего сервера сделает синхронизацию времени более точной, поскольку у более дальнего сервера может быть более длинная задержка соединения.

Следующая опция это выбор PCNFSD. Эта опция устанавливает пакет package:net/pcnfsd[] из Коллекции Портов. Это полезная утилита, предоставляющая сервисы авторизации NFS для систем, в которых собственная отсутствует, таких как Microsoft MS-DOS(R).

Теперь вы можете прокрутить меню немного вниз, чтобы увидеть другие опции:

[[Network-configuration-cont]]
.Нижняя часть меню настройки сети
image::net-config-menu2.png[]

Утилиты man:rpcbind[8], man:rpc.statd[8] и man:rpc.lockd[8] для удаленного вызова процедур (Remote Procedure Calls, RPC). Утилита `rpcbind` управляет соединением между NFS серверами и клиентами, она требуется серверу NFS для корректной работы. Даемон rpc.statd взаимодействует с даемонами rpc.statd на других хостах для обеспечения мониторинга статуса. Полученный статус обычно хранится в файле [.filename]#/var/db/statd.status#. Последняя опция это [.guimenuitem]#rpc.lockd#, которая, будучи выбранной, предоставляет сервисы блокировки файлов. Она обычно используется с rpc.statd для отслеживания хостов, запрашивающих блокировки и частоты этих запросов. Хотя две последние опции прекрасно подходят для отладки, они не требуются серверам и клиентам NFS для корректной работы.

Ниже в списке опций находится [.guimenuitem]#Routed#, даемон маршрутизации. Утилита man:routed[8] управляет сетевыми таблицами маршрутизации, обнаруживает широковещательные маршрутизаторы, и предоставляет копию таблиц маршрутизации любому физически подключенному к сети хосту по запросу. Это обычно используется компьютерами, являющимися шлюзом для локальной сети. Когда эта опция выбрана, появится меню выбора местоположения утилиты по умолчанию. Значение по умолчанию уже выбрано, чтобы подтвердить его нажмите kbd:[Enter]. Появится следующее меню, запрашивающее флаги для routed. По умолчанию это флаг `-q`, он должен уже быть на экране.

На следующей линии находится опция [.guimenuitem]#Rwhod#, выбор которой приведет к запуску даемона man:rwhod[8] при старте системы. Утилита `rwhod` периодически рассылает широковещательные системные сообщения по сети или собирает их в режиме "потребителя". Дополнительную информацию можно найти на страницах справочника man:ruptime[1] и man:rwho[1].

Следующая перед последней опцией в списке это даемон man:sshd[8]. Это сервер безопасной оболочки (secure shell) из OpenSSH и он настоятельно рекомендуется для использования вместо стандартных серверов telnet и FTP. Сервер sshd используется для создания безопасных соединений от одного хоста к другому с использованием шифрования.

И наконец, опция [.guimenuitem]#TCP# Extensions. Она включает расширения TCP, определенные в RFC 1323 и RFC 1644. Хотя для многих хостов они могут повысить скорость соединения, с другими соединение может быть оборвано. Для серверов эти расширения не рекомендуются, но клиентским компьютерам могут дать некоторые преимущества.

Теперь, после настройки сетевых сервисов, вы можете прокрутить меню к верхнему пункту, [.guimenuitem]#X Exit#, и перейти к следующему шагу, или же просто покинуть sysinstall, дважды нажав [.guimenuitem]#X Exit#, а после - btn:[X Exit Install].

[[freebsdboot]]
=== Загрузочный процесс FreeBSD (FreeBSD Bootup)

[[freebsdboot-i386]]
==== Загрузка FreeBSD/i386

Если все пройдет нормально, вы увидите прокручивающиеся за экран сообщения, затем приглашение ко входу в систему. Вы может просмотреть сообщения, нажав kbd:[Scroll-Lock] и используя kbd:[PgUp] и kbd:[PgDn]. Нажатие kbd:[Scroll-Lock] еще раз вернет вас к приглашению.

Все сообщение может не отобразиться (ограничение буфера), но может быть просмотрено путем ввода команды `dmesg` в командной строке.

Войдите, используя имя пользователя/пароль, добавленные во время установки (`rpratt` в этом примере). Избегайте входа под `root`, если это не требуется.

Типичные сообщения при загрузке (информация о версии удалена):

[source,bash]
....
Copyright (c) 1992-2002 The FreeBSD Project.
Copyright (c) 1979, 1980, 1983, 1986, 1988, 1989, 1991, 1992, 1993, 1994
	The Regents of the University of California. All rights reserved.

Timecounter "i8254"  frequency 1193182 Hz
CPU: AMD-K6(tm) 3D processor (300.68-MHz 586-class CPU)
  Origin = "AuthenticAMD"  Id = 0x580  Stepping = 0
  Features=0x8001bf<FPU,VME,DE,PSE,TSC,MSR,MCE,CX8,MMX>
  AMD Features=0x80000800<SYSCALL,3DNow!>
real memory  = 268435456 (262144K bytes)
config> di sn0
config> di lnc0
config> di le0
config> di ie0
config> di fe0
config> di cs0
config> di bt0
config> di aic0
config> di aha0
config> di adv0
config> q
avail memory = 256311296 (250304K bytes)
Preloaded elf kernel "kernel" at 0xc0491000.
Preloaded userconfig_script "/boot/kernel.conf" at 0xc049109c.
md0: Malloc disk
Using $PIR table, 4 entries at 0xc00fde60
npx0: <math processor> on motherboard
npx0: INT 16 interface
pcib0: <Host to PCI bridge> on motherboard
pci0: <PCI bus> on pcib0
pcib1: <VIA 82C598MVP (Apollo MVP3) PCI-PCI (AGP) bridge> at device 1.0 on pci0
pci1: <PCI bus> on pcib1
pci1: <Matrox MGA G200 AGP graphics accelerator> at 0.0 irq 11
isab0: <VIA 82C586 PCI-ISA bridge> at device 7.0 on pci0
isa0: <ISA bus> on isab0
atapci0: <VIA 82C586 ATA33 controller> port 0xe000-0xe00f at device 7.1 on pci0
ata0: at 0x1f0 irq 14 on atapci0
ata1: at 0x170 irq 15 on atapci0
uhci0: <VIA 83C572 USB controller> port 0xe400-0xe41f irq 10 at device 7.2 on pci0
usb0: <VIA 83C572 USB controller> on uhci0
usb0: USB revision 1.0
uhub0: VIA UHCI root hub, class 9/0, rev 1.00/1.00, addr 1
uhub0: 2 ports with 2 removable, self powered
chip1: <VIA 82C586B ACPI interface> at device 7.3 on pci0
ed0: <NE2000 PCI Ethernet (RealTek 8029)> port 0xe800-0xe81f irq 9 at
device 10.0 on pci0
ed0: address 52:54:05:de:73:1b, type NE2000 (16 bit)
isa0: too many dependant configs (8)
isa0: unexpected small tag 14
fdc0: <NEC 72065B or clone> at port 0x3f0-0x3f5,0x3f7 irq 6 drq 2 on isa0
fdc0: FIFO enabled, 8 bytes threshold
fd0: <1440-KB 3.5" drive> on fdc0 drive 0
atkbdc0: <keyboard controller (i8042)> at port 0x60-0x64 on isa0
atkbd0: <AT Keyboard> flags 0x1 irq 1 on atkbdc0
kbd0 at atkbd0
psm0: <PS/2 Mouse> irq 12 on atkbdc0
psm0: model Generic PS/2 mouse, device ID 0
vga0: <Generic ISA VGA> at port 0x3c0-0x3df iomem 0xa0000-0xbffff on isa0
sc0: <System console> at flags 0x1 on isa0
sc0: VGA <16 virtual consoles, flags=0x300>
sio0 at port 0x3f8-0x3ff irq 4 flags 0x10 on isa0
sio0: type 16550A
sio1 at port 0x2f8-0x2ff irq 3 on isa0
sio1: type 16550A
ppc0: <Parallel port> at port 0x378-0x37f irq 7 on isa0
ppc0: SMC-like chipset (ECP/EPP/PS2/NIBBLE) in COMPATIBLE mode
ppc0: FIFO with 16/16/15 bytes threshold
ppbus0: IEEE1284 device found /NIBBLE
Probing for PnP devices on ppbus0:
plip0: <PLIP network interface> on ppbus0
lpt0: <Printer> on ppbus0
lpt0: Interrupt-driven port
ppi0: <Parallel I/O> on ppbus0
ad0: 8063MB <IBM-DHEA-38451> [16383/16/63] at ata0-master using UDMA33
ad2: 8063MB <IBM-DHEA-38451> [16383/16/63] at ata1-master using UDMA33
acd0: CDROM <DELTA OTC-H101/ST3 F/W by OIPD> at ata0-slave using PIO4
Mounting root from ufs:/dev/ad0s1a
swapon: adding /dev/ad0s1b as swap device
Automatic boot in progress...
/dev/ad0s1a: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1a: clean, 48752 free (552 frags, 6025 blocks, 0.9% fragmentation)
/dev/ad0s1f: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1f: clean, 128997 free (21 frags, 16122 blocks, 0.0% fragmentation)
/dev/ad0s1g: FILESYSTEM CLEAN; SKIPPING CHECKS
/dev/ad0s1g: clean, 3036299 free (43175 frags, 374073 blocks, 1.3% fragmentation)
/dev/ad0s1e: filesystem CLEAN; SKIPPING CHECKS
/dev/ad0s1e: clean, 128193 free (17 frags, 16022 blocks, 0.0% fragmentation)
Doing initial network setup: hostname.
ed0: flags=8843<UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST> mtu 1500
	inet 192.168.0.1 netmask 0xffffff00 broadcast 192.168.0.255
	inet6 fe80::5054::5ff::fede:731b%ed0 prefixlen 64 tentative scopeid 0x1
	ether 52:54:05:de:73:1b
lo0: flags=8049<UP,LOOPBACK,RUNNING,MULTICAST> mtu 16384
	inet6 fe80::1%lo0 prefixlen 64 scopeid 0x8
	inet6 ::1 prefixlen 128
	inet 127.0.0.1 netmask 0xff000000
Additional routing options: IP gateway=YES TCP keepalive=YES
routing daemons:.
additional daemons: syslogd.
Doing additional network setup:.
Starting final network daemons: creating ssh RSA host key
Generating public/private rsa1 key pair.
Your identification has been saved in /etc/ssh/ssh_host_key.
Your public key has been saved in /etc/ssh/ssh_host_key.pub.
The key fingerprint is:
cd:76:89:16:69:0e:d0:6e:f8:66:d0:07:26:3c:7e:2d root@k6-2.example.com
 creating ssh DSA host key
Generating public/private dsa key pair.
Your identification has been saved in /etc/ssh/ssh_host_dsa_key.
Your public key has been saved in /etc/ssh/ssh_host_dsa_key.pub.
The key fingerprint is:
f9:a1:a9:47:c4:ad:f9:8d:52:b8:b8:ff:8c:ad:2d:e6 root@k6-2.example.com.
setting ELF ldconfig path: /usr/lib /usr/lib/compat /usr/X11R6/lib
/usr/local/lib
a.out ldconfig path: /usr/lib/aout /usr/lib/compat/aout /usr/X11R6/lib/aout
starting standard daemons: inetd cron sshd usbd sendmail.
Initial rc.i386 initialization:.
rc.i386 configuring syscons: blank_time screensaver moused.
Additional ABI support: linux.
Local package initialization:.
Additional TCP options:.

FreeBSD/i386 (k6-2.example.com) (ttyv0)

login: rpratt
Password:
....

Генерирование ключей RSA и DSA может занять некоторое время на медленных компьютерах. Это может случиться только при первой загрузке свежеустановленной системы. Последующие загрузки будут быстрее.

Если X сервер был настроен и был выбран десктоп по умолчанию, он может быть запущен из командной строки командой `startx`.

[[shutdown]]
=== Завершение работы FreeBSD (FreeBSD Shutdown)

Важно правильно завершать работу операционной системы. Нельзя просто выключать питание. Сначала нужно стать суперпользователем, введя в командной строке `su` и пароль `root`. Это сработает только если пользователь является членом группы `wheel`. Или зайдите под `root` и используйте команду `shutdown -h now`.

[source,bash]
....
The operating system has halted.
Please press any key to reboot.
....

Можно безопасно выключать питание после того, как будет выполнена команда shutdown и появится сообщение "Please press any key to reboot". Если вместо выключения питания будет нажата любая клавиша, система перезагрузится.

Вы также можете использовать комбинацию клавиш kbd:[Ctrl+Alt+Del] для перезагрузки системы, хотя это не рекомендуется в обычной ситуации.

[[install-trouble]]
== Решение проблем

Следующий раздел описывает основные проблемы при установке, о которых обычно сообщают пользователи. Здесь также несколько вопросов и ответов от тех, кто хочет настроить двойную загрузку FreeBSD и MS-DOS(R) или Windows(R).

=== Что делать, если что-то идет не так

По причине различных ограничений архитектуры PC, невозможно протестировать устройства достоверно на 100%, тем не менее, есть несколько вещей, которые вы можете сделать, если тестирование завершится неудачно.

Сверьтесь с http://www.FreeBSD.org/releases/[Информацией об оборудовании] для вашей версии FreeBSD, чтобы убедиться, что ваше оборудование поддерживается.

Если оборудование поддерживается, но все же происходят зависания или вы встретились с другими проблемами, потребуется собрать crossref:kernelconfig[kernelconfig,собственное ядро]. Это позволит вам добавить поддержку аппаратных устройств, отсутствующих в ядре [.filename]#GENERIC#. Ядро на загрузочном диске настроено в предположении, что у большинства аппаратных устройств IRQ, адреса ввода-вывода и каналы DMA установлены производителем к значениям по умолчанию. Если оборудование было перенастроено, вам скорее всего потребуется отредактировать конфигурацию ядра и перекомпилировать его, чтобы сообщить FreeBSD, где что искать.

Возможно также, что тестирование устройства, которого нет, приведет позже к ошибке тестирования существующего устройства. В этом случае тестирование конфликтующего драйвера (драйверов) должно быть запрещено.

[NOTE]
====
Некоторые проблемы установки можно обойти или уменьшить, обновив встроенное программное обеспечение различных компонент оборудования, особенно материнской платы. Встроенное программное обеспечение также называют BIOS и у большинства производителей компьютеров или материнских плат есть Web-сайты, где можно найти обновления и информацию об обновлениях.

Большинство производителей настоятельно советуют не обновлять BIOS пока не возникнет серьезной необходимости, например появление критически важных обновлений. Процесс обновления _может_ пойти неверно, что приведет к неустранимому повреждению микросхемы BIOS.
====

=== Использование файловых систем MS-DOS(R) и Windows(R)

В настоящее время, FreeBSD не поддерживает файловые системы, сжатые с помощью программы Double Space(TM). Поэтому файловая система должна быть разжата, чтобы FreeBSD смогла получить доступ к данным. Это может быть сделано с помощью приложения Compression Agent, находящегося в меню [.guimenuitem]#Пуск#> [.guimenuitem]#Программы# > [.guimenuitem]#Системные#.

FreeBSD поддерживает файловые системы MS-DOS(R) (иногда называемые файловыми системами FAT). Команда man:mount_msdosfs[8] включает такие файловые системы в существующую иерархию, тем самым обеспечивая доступ к их содержимому. Как правило, утилита man:mount_msdosfs[8] непосредственно не вызывается; вместо этого она выполняется системой при наличии соответствующей записи в [.filename]#/etc/fstab# или же вызывается утилитой man:mount[8], запущенной с соответствующими параметрами.

Ниже приведен пример записи в [.filename]#/etc/fstab# для файловой системы MS-DOS(R):

[.programlisting]
....
/dev/ad0sN  /dos  msdosfs rw  0  0
....

[NOTE]
====
Каталог [.filename]#/dos# должен быть создан заранее. Формат файла [.filename]#/etc/fstab# подробно описан в man:fstab[5].
====

Также приведем пример монтирования файловой системы MS-DOS(R) посредством man:mount[8]:

[source,bash]
....
# mount -t msdosfs /dev/ad0s1 /mnt
....

В этом примере файловая система MS-DOS(R) расположена на первом разделе первого жесткого диска. Ваша конфигурация может быть другой, проверьте вывод команд `dmesg` и `mount`. Они должны предоставить достаточно информации для определения названий разделов.

[NOTE]
====
Способ нумерации дисковых слайсов (то есть, "разделов" в терминах MS-DOS(R)) может отличаться от способа, принятого в других операционных системах. В частности, расширенным разделам MS-DOS(R) присваиваются номера, следующие за первичными разделами MS-DOS(R). Утилита man:fdisk[8] поможет определить, какие слайсы принадлежат FreeBSD, а какие - другим операционным системам.
====

Разделы NTFS также можно смонтировать похожим способом, используя команду man:mount_ntfs[8].

=== Решение проблем: вопросы и ответы

==== Моя система зависает на этапе определения оборудования во время загрузки, или система ведет себя странно во время установки, или же не определяется привод гибкого диска.

На архитектурах i386, amd64 и ia64 при конфигурировании оборудования, обнаруженного во время загрузки, FreeBSD повсеместно использует систему ACPI. К сожалению, до сих пор находятся неполадки как в драйвере ACPI, так и в материнских платах, так и в их BIOS. Использование ACPI можно отключить установив переменную `hint.acpi.0.disabled` на третьем этапе загрузки:

[source,bash]
....
 set hint.acpi.0.disabled="1"
....

Эта настройка сбрасывается каждый раз при перезагрузке системы, поэтому необходимо добавить строку `hint.acpi.0.disabled="1"` в файл [.filename]#/boot/loader.conf#. Информация о загрузчике приведена в crossref:boot[boot-synopsis,Описание].

==== Выполняется первая загрузка после установки FreeBSD, ядро загружается и определяет аппаратное обеспечение, но загрузка останавливается с сообщением типа:

Это древняя проблема, проявляющаяся в случаях, когда загрузочный диск не является первым диском в системе. BIOS использует свою схему нумерации дисков по сравнению с FreeBSD, и сложно правильно решить, как соответствуют эти нумерации.

В случае, если загрузочный диск не является первым диском в системе, то FreeBSD потребуется некоторая помощь. Есть два возможных случая, и в обоих вам придется сообщить FreeBSD где находится корневая файловая система. Это делается указанием вручную следующих данных: номера диска (согласно нумерации BIOS), типа диска и номера диска (согласно определениям FreeBSD).

Первый случай: у вас имеется два IDE диска, каждый из них сконфигурирован как мастер на соответствующей шине IDE, и вы намереваетесь загрузить FreeBSD с второго диска. BIOS определяет эти диски как `disk 0` и `disk 1`, в то время как FreeBSD определяет их как [.filename]#ad0# и [.filename]#ad2#.

FreeBSD находится на `disk 1` (BIOS-нумерация), его тип - `ad` и номер - 2 (по данным FreeBSD), следовательно, необходимо указать:

[source,bash]
....
 1:ad(2,a)kernel
....

Заметьте, если второй диск настроен как подчиненный (slave) на первой шине IDE, то указание вышеприведённого необязательно (а по существу, еще и неверно).

Второй случай подразумевает загрузку с диска SCSI при существующих в системе дисках IDE. В этом случае, согласно определениям FreeBSD номер диска меньше, чем номер по представлениям BIOS. Если у вас есть два диска IDE и диск SCSI, то, согласно BIOS, номер SCSI диска - 2, а согласно FreeBSD, тип - `da` и номер - 0, следовательно, вам необходимо указать следующее:

[source,bash]
....
 2:da(0,a)kernel
....

чтобы сообщить FreeBSD, что вы намереваетесь загрузить систему с диска 2 по нумерации BIOS, который является первым диском в системе. Если бы у вас был один диск IDE, вам бы пришлось использовать `1:` (по нумерации BIOS).

Определив верные параметры, внесите их в том виде, как вы их набирали, в файл [.filename]#/boot.config#. Если не указывается иначе, то FreeBSD будет использовать содержимое этого файла как значение по умолчанию в приглашении `boot:`.

==== Я перехожу к загрузке с жесткого диска впервые после установки FreeBSD, но приглашение Boot Manager всякий раз выводит только F? в меню загрузчика, и на этом загрузка прерывается.

При установке FreeBSD в редакторе разделов была указана неверная геометрия жесткого диска. Вернитесь в редактор разделов и укажите действительную геометрию вашего жесткого диска. Вам придется переустановить заново FreeBSD.

Если вы затрудняетесь определить верную геометрию для вашей машины, то сделайте следующее: установите небольшой раздел MS-DOS(R) вначале диска, а FreeBSD разместите после него. Установочная программа обнаружит раздел MS-DOS(R) и попробует определить значение геометрии по этому разделу, что, как правило, завершается успехом.

Следующий способ не рекомендуется, он оставлен здесь для справки:

[.blockquote]
Если вы устанавливаете выделенный сервер FreeBSD или рабочую станцию, в которых вопросы совместного существования MS-DOS(R), Linux или иной операционной системы в будущем не возникнут, то у вас есть возможность использовать весь диск (опция [.guimenuitem]#A# в редакторе разделов), после выбора которой FreeBSD займет весь диск от самого первого до самого последнего сектора. При этом, все вопросы геометрии диска станут неактуальными.

==== Система определяет мою сетевую карту man:ed[4], но я постоянно получаю сообщения device timeout.

Возможно ваша сетевая карта находится не на том IRQ, которое указано в файле [.filename]#/boot/device.hints#. Драйвер man:ed[4] по умолчанию не использует "программную" конфигурацию (значения, вводимые утилитой EZSETUP в MS-DOS(R)), но ситуация изменится, если вы укажете `-1` в значении хинт-переменной для этого интерфейса.

Либо осуществите ручное конфигурирование устройства переключением джамперов на карте (также может потребоваться изменение конфигурации ядра), либо же смените значение IRQ на `-1`, установив переменную `hint.ed.0.irq="-1"`. Это укажет ядру использовать программное конфигурирование.

Также вероятно, что ваша карта находится на IRQ номер 9, которое используется совместно с IRQ номер 2, и которое часто является причиной проблем (особенно, если ваш VGA адаптер занимает IRQ номер 2!). Постарайтесь избежать использования IRQ номер 2 или 9 вообще.

==== Когда sysinstall запущен в терминале X11, то желтый шрифт на светло сером фоне практически не различим. Есть ли способ обеспечить лучший контраст colorcontrast для этого приложения?

Если вы уже установили X11, а цвета, выбираемые по умолчанию утилитой sysinstall, делают текст неразборчивым в man:xterm[1] или man:rxvt[1], то добавьте следующую строку `XTerm*color7: #c0c0c0` в ваш [.filename]##~/.Xdefaults## и вы получите более тёмный фоновый серый цвет.

[[install-advanced]]
== Расширенное руководство по установке

Этот раздел описывает особые случаи установки FreeBSD.

[[headless-install]]
=== Установка FreeBSD на систему без монитора или клавиатуры

Этот тип установки называется "установка без монитора", потому что на компьютере, на который вы пробуете установить FreeBSD или не подсоединен монитор, или даже нет VGA выхода. Вы спросите, как это возможно? Используя последовательную консоль. Последовательная консоль в своей основе имеет другой компьютер, который служит дисплеем и клавиатурой для системы. Чтобы сделать это, создайте инсталляционный USB-накопитель, как описано в <<install-boot-media>>, или скачайте надлежащий установочный образ ISO (описано в <<install-cdrom>>).

Чтобы модифицировать настройки источника установки для загрузки с последовательной консоли, следуйте этой инструкции:

[.procedure]
====
. Загрузка с USB-накопителя с выводом на последовательную консоль
+ 
Если вы произведете загрузку с только что созданного USB-накопителя, FreeBSD загрузится в нормальный режим установки. Мы хотим, чтобы FreeBSD загрузилась на последовательную консоль для нашей установки. Чтобы сделать это, смонтируйте USB-накопитель на вашу систему FreeBSD используя команду man:mount[8].
+
[source,bash]
....
# mount /dev/da0a /mnt
....
+
[NOTE]
======
Измените названия файла устройства и точки монтирования в соответствии со значениями для вашей конфигурации.
======
+ 
Теперь необходимо настроить USB-накопитель для загрузки на последовательную консоль. В файл [.filename]#loader.conf#, находящийся на файловой системе USB-накопителя, добавьте запись, устанавливающую в качестве системной консоли последовательную консоль.
+
[source,bash]
....
# echo 'console="comconsole"' >> /mnt/boot/loader.conf
....
+ 
Далее, когда ваш USB-накопитель правильно настроен, размонтируйте его с помощью команды man:umount[8]:
+
[source,bash]
....
# umount /mnt
....
+ 
Теперь извлеките USB-накопитель и перейдите к третьему пункту этой инструкции.
. Загрузка с CD с выводом на последовательную консоль
+ 
Если вы произведете загрузку с только что записанного установочного CD диска (подробности создания которого описаны в <<install-cdrom>>), FreeBSD загрузится в нормальный режим установки. Однако, вам необходимо, чтобы FreeBSD загрузилась на последовательную консоль. Для этого придется исправить ISO образ заранее, до его записи на диск CD-R.
+ 
В приведённом далее примере подразумевается, что подготовку образа вы выполняете на вашем втором компьютере, работающем под управлением FreeBSD. Также подразумевается, что на нём есть файл загрузочного ISO образа, например [.filename]#FreeBSD-{rel120-current}-RELEASE-i386-disc1.iso#. Извлеките из образа все файлы утилитой man:tar[1]:
+
[source,bash,subs="attributes"]
....
# mkdir /path/to/headless-iso
# tar -C /path/to/headless-iso -pxvf FreeBSD-{rel120-current}-RELEASE-i386-disc1.iso
....
+ 
Теперь необходимо внести некоторые изменения в набор файлов и каталогов, полученных из образа. Добавьте в файл [.filename]#loader.conf# запись, устанавливающую в качестве системной консоли последовательную консоль.
+
[source,bash]
....
# echo 'console="comconsole"' >> /path/to/headless-iso/boot/loader.conf
....
+ 
Далее необходимо создать новый образ ISO из извлеченного и исправленного старого образа. Для этого воспользуйтесь утилитой man:mkisofs[8] (порт package:sysutils/cdrtools[]):
+
[source,bash,subs="attributes"]
....
# mkisofs -v -b boot/cdboot -no-emul-boot -r -J -V "Headless_install" \
        -o Headless-FreeBSD-{rel120-current}-RELEASE-i386-disc1.iso /path/to/headless-iso
....
+ 
А теперь, имея в распоряжении модифицированный новый образ ISO, самое время записать его на диск CD-R при помощи вашей любимой программы для записи дисков.
. Подсоединение нуль-модемного кабеля
+ 
Теперь нужно соединить два компьютера crossref:serialcomms[term-cables-null,нуль-модемным кабелем]. Просто подсоедините этот кабель к последовательным портам двух компьютеров. _Обычный последовательный кабель не будет работать_, вам потребуется нуль-модемный кабель, поскольку в нем некоторые линии соединены накрест.
. Загрузка для установки
+ 
Настало время начать установку. Вставьте USB-накопитель в компьютер, на который вы будете производить установку без монитора и включите его. Если же вы используете загрузочный CD диск, вставьте его в привод после того, как включите машину.
. Подключение к компьютеру без монитора
+ 
Теперь вы можете подключиться к этому компьютеру с помощью man:cu[1]:
+
[source,bash]
....
# cu -l /dev/cuau0
....
====

Это все! Теперь вы можете управлять компьютером без монитора через сессию `cu`. Машина загрузит ядро, а затем появится выбор типа терминала. Выберите цветную консоль FreeBSD и проводите установку!

[[install-diff-media]]
== Подготовка собственного источника установки

[NOTE]
====
Чтобы не повторяться, "диск FreeBSD" в данном случае означает FreeBSD CDROM или DVD, который вы купили или подготовили самостоятельно.
====

Может быть несколько ситуаций, в которых вам потребуется подготовить собственный диск и/или источник для установки FreeBSD. Это может быть физический носитель, такой как лента, или источник, с которого sysinstall сможет взять файлы, такой как локальный сервер FTP, или раздел MS-DOS(R).

Например:

* У вас есть много компьютеров, подсоединенных к локальной сети, и один диск с FreeBSD. Вы хотите создать локальный сервер FTP, используя содержимое диска FreeBSD, а затем использовать с ваших компьютеров этот локальный сервер FTP вместо подсоединения к интернет.
* У вас есть диск с FreeBSD, и FreeBSD не распознает ваш CD/DVD привод, а MS-DOS(R) / Windows(R) распознает. Вы хотите скопировать файлы установки FreeBSD на раздел MS-DOS(R) этого же компьютера и установить FreeBSD, используя эти файлы.
* На компьютере, на который вы хотите провести установку, нет ни привода CD/DVD, ни сетевой карты, но вы можете подсоединиться в "Laplink-стиле" последовательным или параллельным кабелем к другому компьютеру, на котором они есть.
* Вы хотите создать ленту, которую можно использовать для установки FreeBSD.

[[install-cdrom]]
=== Создание установочного CDROM

В составе каждого релиза проект FreeBSD предоставляет доступ как минимум к двум образам CDROM ("ISO images") для каждой поддерживаемой архитектуры. Эти образы могут быть записаны ("прожжены") на CD если у вас есть CD-рекордер, а затем использованы для установки FreeBSD. Если у вас есть CD-рекордер и дешевый канал интернет, это простейший путь установить FreeBSD.

[.procedure]
====

. Скачайте соответствующие ISO образы
+ 
ISO образы для каждого релиза могут быть загружены с [.filename]#ftp://ftp.FreeBSD.org/pub/FreeBSD/ISO-IMAGES-архитектура/версия# или с ближайшего зеркала. Замените _архитектура_ и _версия_ в соответствии архитектурой и номером релиза соответственно.
+ 
Этот каталог обычно содержит следующие образы:
+
.Названия ISO-образов дисков FreeBSD и их значения
[cols="1,1", frame="none", options="header"]
|===
| Имя файла
| Содержимое

|[.filename]#FreeBSD-version-RELEASE-arch-bootonly.iso#
|Этот образ CD предоставляет возможность начать процесс установки, загрузившись с диска в приводе CD-ROM. Однако, в нём отсутствуют архивы, необходимые для установки FreeBSD с этого же диска. Подразумевается, что необходимые файлы будут скачаны из доступных в сети источников (например, c сервера FTP).

|[.filename]#FreeBSD-version-RELEASE-arch-dvd1.iso.gz#
|Этот образ DVD содержит всё необходимое для установки базовой системы FreeBSD, а также - документацию и набор прекомпилированных пакетов. Также образ поддерживает возможность загрузки в режим "livefs".

|[.filename]#FreeBSD-version-RELEASE-arch-memstick.img#
|Этот образ предназначен для создания загрузочных USB-накопителей. Такой накопитель может использоваться для установки операционной системы на машины, поддерживающие загрузку с USB дисков. USB-накопитель также может использоваться для аварийного восстановления системы (содержит "livefs"). В образе также имеются пакеты с документацией.

|[.filename]#FreeBSD-version-RELEASE-arch-disc1.iso#
|Этот образ CD содержит базовую систему FreeBSD и набор пакетов с документацией.

|[.filename]#FreeBSD-version-RELEASE-arch-disc2.iso#
|Этот образ CD содержит пакеты сторонних разработчиков, которые смогли поместиться на диск. Для FreeBSD 9._X_ подобные образы не создавались.

|[.filename]#FreeBSD-version-RELEASE-arch-disc3.iso#
|Еще один образ CD, заполненный пакетами сторонних разработчиков. Этот образ не создавался для FreeBSD 9._X_.

|[.filename]#FreeBSD-version-RELEASE-arch-livefs.iso#
|Данный образ CD поддерживает загрузку в режим аварийного восстановления системы (содержит "livefs") и не предназначен для выполнения установки операционной системы с самого диска.
|===
+ 
Вы _должны_ загрузить либо ISO-образ `bootonly`, либо образ `disc1`. Не загружайте их оба, так как образ `disc1` содержит всё, что есть на ISO-образе bootonly.
+ 
Используйте ISO-образ `bootonly`, если доступ в Internet для вас обходится недорого. Он позволит вам установить FreeBSD, и вы сможете установить впоследствии программы сторонних производителей используя систему портов/пакетов (смотрите crossref:ports[ports, Установка приложений. порты и пакеты]) если необходимо.
+ 
Используйте образ `dvd1`, если вы хотите установить релиз FreeBSD и получить достаточный набор программ сторонних производителей, расположенных на этом диске.
+ 
Дополнительные образы дисков полезны, но не необходимы, особенно если у вас есть высокоскоростной доступ к интернет.
. Запись CD
+ 
Затем вам нужно записать образы CD на диски. Если вы делаете это из другой системы FreeBSD, обратитесь к crossref:disks[creating-cds,Запись и использование оптических носителей (CD)] за более подробной информацией (в частности, crossref:disks[burncd,burncd] и crossref:disks[cdrecord,cdrecord]).
+ 
Если вы делаете это в другой системе, потребуется использовать те утилиты для управления CD-рекордером, которые есть в этой системе. Образы дисков предоставляются в стандартном формате ISO, который поддерживается многими программами.
====

[NOTE]
====
Если вы интересуетесь созданием собственных вариантов релизов FreeBSD, пожалуйста, прочтите статью о link:{releng}[Процессе подготовки релизов].
====

[[install-ftp]]
=== Создание локального сервера FTP с FreeBSD

Диск FreeBSD сформирован так же, как и сервер FTP. Это сильно упрощает создание локального сервера FTP, который может быть использован другими компьютерами вашей сети для установки FreeBSD.

[.procedure]
====

. Убедитесь, что на компьютере FreeBSD, на котором будет установлен сервер FTP, CDROM находится в приводе и смонтируйте [.filename]#/cdrom#.
+
[source,bash]
....
# mount /cdrom
....
+
. Создайте учетную запись для anonymous FTP в [.filename]#/etc/passwd#. Сделайте это, отредактировав [.filename]#/etc/passwd# с помощью man:vipw[8] и добавив эту строку:
+
[.programlisting]
....
ftp:*:99:99::0:0:FTP:/cdrom:/nonexistent
....
+
. Убедитесь что сервис FTP включен в [.filename]#/etc/inetd.conf#.
====

Всякий, кто может подсоединиться по сети к вашему компьютеру, может выбрать тип носителя FTP и набрать `ftp://_ваш компьютер_` после выбора "Other" в меню серверов FTP во время установки.

[NOTE]
====
Если загрузочный носитель (обычно это дискеты) для ваших FTP-клиентов в точности не соответствует версии, находящейся на локальном сервере FTP, то sysinstall не позволит вам завершить установку. Если версии похожи и вы хотите это явно указать, то перейдите в меню Options и замените название дистрибутива на [.guimenuitem]#any#.
====

[WARNING]
====

Этот подход хорош для компьютера в вашей локальной сети, защищенного с помощью файрволла. Предоставление сервиса FTP другим компьютерам через интернет (а не через локальную сеть) привлекает к вашему компьютеру внимание кракеров и других лиц, чье внимание нежелательно. Мы настоятельно рекомендуем придерживаться правильной политики безопасности, если вы делаете это.
====

=== Создание дискет для установки

Если вам требуется выполнить установку с дискет (чего мы _не_ рекомендуем делать) или по причине не поддерживаемого оборудования, или просто потому, что вы не любите простых путей, потребуется сначала подготовить несколько дискет для установки.

Как минимум, вам потребуется столько 1.44 MB дискет, сколько нужно, чтобы вместить все файлы из каталога [.filename]#base# (base distribution). Если вы подготавливаете эти дискеты из MS-DOS(R), они _должны_ быть отформатированы с помощью команды MS-DOS(R) `FORMAT`. Если вы используете Windows(R), используйте Explorer для форматирования дисков (кликните правой кнопкой мыши на диске [.filename]#A:# и выберите "Format").

_Не_ доверяйте заводскому форматированию дискет. Отформатируйте их еще раз самостоятельно, просто для уверенности. Множество проблем, о которых сообщали наши пользователи, были результатом использования неправильно отформатированных дисков, поэтому мы сейчас обращаем на это внимание.

Если вы создаете образы на другом компьютере FreeBSD, форматирование все еще не лишне, хотя вам не потребуется создавать файловую систему MS-DOS(R) на каждой дискете. Вы можете использовать `bsdlabel` и `newfs` для создания на них файловых систем UFS, в следующей последовательности (для 3.5" 1.44 MB дискет):

[source,bash]
....
# fdformat -f 1440 fd0.1440
# bsdlabel -w fd0.1440 floppy3
# newfs -t 2 -u 18 -l 1 -i 65536 /dev/fd0
....

Затем вы можете смонтировать их и писать на них как на любую другую файловую систему.

После форматирования дискет вам потребуется скопировать на них файлы. Файлы дистрибутива разделены на части, размер которых позволяет легко разместить пять частей на обычной 1.44 MB дискете. Заполните все дискеты файлами, помещая столько файлов на одну дискету, сколько уместится, пока у вас не будет всех необходимых компонент дистрибутива. Каждый компонент должен располагаться в подкаталоге на дискете, например [.filename]#a:\base\base.aa#, [.filename]#a:\base\base.ab#, и так далее.

[IMPORTANT]
====
Файл [.filename]#base.inf# также необходимо поместить на первую дискету набора [.filename]#base#. Прочитав этот файл, установочная программа определяет, сколько частей необходимо скопировать и соединить для сборки дистрибутива.
====

Как только в процессе установки появится экран Media, выберите [.guimenuitem]#Floppy# и установка продолжится.

[[install-msdos]]
=== Установка с раздела MS-DOS(R)

Чтобы подготовиться к установке с раздела MS-DOS(R), скопируйте файлы с дистрибутива в каталог [.filename]#freebsd# корневого каталога раздела. Например, [.filename]#c:\freebsd#. Структура каталога CDROM или сервера FTP должна быть в точности воспроизведена в этом каталоге, мы предлагаем использовать команду MS-DOS(R) `xcopy` если вы копируете дистрибутив с CD. Например, чтобы подготовить минимальную установку FreeBSD:

[source,bash]
....
C:\> md c:\freebsd
C:\> xcopy e:\bin c:\freebsd\bin\ /s
C:\> xcopy e:\manpages c:\freebsd\manpages\ /s
....

Предполагается, что на [.filename]#C:# есть свободное место, а на [.filename]#E:# смонтирован CDROM.

Если у вас нет CDROM, можно загрузить дистрибутив с link:ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/{rel120-current}-RELEASE/[ftp.FreeBSD.org]. Каждый компонент находится в своем собственном каталоге, например компонент _base_ можно найти в каталоге link:ftp://ftp.FreeBSD.org/pub/FreeBSD/releases/i386/{rel120-current}-RELEASE/base/[{rel120-current}/base/].

Все компоненты, которые вы будете устанавливать с раздела MS-DOS(R) (и для которых у вас есть место), нужно расположить в [.filename]#c:\freebsd# - для минимальной установки нужна только компонента `BIN`.

=== Создание ленты для установки

Установка с ленты это возможно самый простой метод, уступающий только установке с FTP или CDROM. Программа установки может найти на ленте файлы, которые записаны на нее с помощью tar. После получения всех файлов дистрибутива, которые вам нужны, запишите их на ленту с помощью tar:

[source,bash]
....
# cd /freebsd/distdir
# tar cvf /dev/rwt0 dist1 ... dist2
....

Когда вы приступите к установке, нужно убедиться в наличии достаточного места во временном каталоге (который будет предложено выбрать), чтобы поместилось _все_ содержимое записанной ленты. Поскольку лента - устройство не-произвольного доступа, этот метод установки требует некоторого места во временном хранилище.

[NOTE]
====
При начале установки лента должна быть в приводе _до_ загрузки с дискеты. В ином случае она может быть не найдена при тестировании устройств.
====

=== Перед установкой по сети

Есть три возможных типа установки по сети. Ethernet (стандартный Ethernet контроллер), последовательный порт (PPP), или параллельный порт (PLIP (laplink кабель)).

Для самой быстрой установки по сети хорошим выбором будет Ethernet адаптер! FreeBSD поддерживает большинство PC Ethernet карт; список поддерживаемых карт (и требуемых для них установок) предоставляется в информации об оборудовании для каждого релиза FreeBSD. Если вы используете одну из поддерживаемых PCMCIA Ethernet карт, убедитесь также, что она подключена _перед_ тем, как ноутбук будет включен! К сожалению, FreeBSD в настоящее время не поддерживает горячее подключение PCMCIA карт во время установки.

Вам также потребуется знать IP адрес в сети, сетевую маску для класса подсети, и имя компьютера. Если вы делаете установку через соединение PPP и у вас нет статического IP, не бойтесь, IP адрес будет динамически выделен вам провайдером. Системный администратор может подсказать вам, какие значения использовать для данной установки по сети. Если вы будете обращаться к другим хостам по имени, а не по IP адресу, понадобится также сервер DNS и, возможно, адрес шлюза (если вы используете PPP, это IP адрес вашего провайдера), чтобы связаться с ним. Если вы хотите производить установку с FTP через HTTP прокси, потребуется также адрес прокси. Если вы не знаете ответов на все или большинство этих вопросов, свяжитесь с системным администратором или ISP _перед_ тем, как начать этот тип установки.

Если вы используете модем, PPP это конечно почти единственный выбор. Убедитесь что у вас есть информация о провайдере, так как она понадобится на довольно ранней стадии процесса установки.

Если вы используете PAP или CHAP для соединения с провайдером (другими словами, вы можете соединяться с провайдером из Windows(R) без использования скрипта), все что вам понадобится это ввести `dial` в приглашении ppp. Иначе вам нужно знать, как дозвониться до провайдера с помощью "AT команд", специфичных для вашего модема, так как программа дозвона PPP предоставляет только очень простой эмулятор терминала. Обратитесь к crossref:ppp-and-slip[userppp,руководству] user-ppp и link:{faq}#ppp/[FAQ] для получения более подробных сведений. Если у вас проблемы, логи могут быть выведены на экран с помощью команды `set log local ...`.

Если доступно постоянное соединение с другой машиной FreeBSD, вы можете также подумать об установке через параллельный порт "laplink" кабелем. Скорость соединения через параллельный порт значительно выше, чем обычно возможно через последовательную линию (до 50 кбайт/с), это приведет к ускорению установки.

==== Перед установкой через NFS

Установка через NFS очень проста. Просто скопируйте компоненты FreeBSD, которые вам нужны, на NFS сервер, а затем укажите на него при выборе источника установки NFS.

Если этот сервер поддерживает только "привилегированные порты" (это как правило так для рабочих станций Sun), потребуется установить параметр `NFS Secure` в меню menu:Options[] перед тем, как начать установку.

Если у вас Ethernet карта плохого качества с низкой скоростью передачи данных, вы возможно захотите переключить флаг `NFS Slow` в Options.

Чтобы установка по NFS работала, сервер должен поддерживать монтирование подкаталогов, например, если установочный каталог дистрибутива FreeBSD {rel120-current} находится на: [.filename]#ziggy:/usr/archive/stuff/FreeBSD#, `ziggy` должен позволять непосредственное монтирование [.filename]#/usr/archive/stuff/FreeBSD#, а не только [.filename]#/usr# или [.filename]#/usr/archive/stuff#.

В файле FreeBSD [.filename]#/etc/exports# это управляется параметром `-alldirs`. Другие NFS серверы могут иметь другие соглашения. Если вы получаете сообщения сервера `permission denied`, это может означать, что соответствующая опция не включена.
