.\"	$OpenBSD: ssh-keygen.1,v 1.40 2001/04/23 21:57:07 markus Exp $
.\"
.\"  -*- nroff -*-
.\"
.\" Author: Tatu Ylonen <ylo@cs.hut.fi>
.\" Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland
.\"                    All rights reserved
.\"
.\" As far as I am concerned, the code I have written for this software
.\" can be used freely for any purpose.  Any derived versions of this
.\" software must be clearly marked as such, and if the derived work is
.\" incompatible with the protocol description in the RFC file, it must be
.\" called by a name other than "ssh" or "Secure Shell".
.\"
.\"
.\" Copyright (c) 1999,2000 Markus Friedl.  All rights reserved.
.\" Copyright (c) 1999 Aaron Campbell.  All rights reserved.
.\" Copyright (c) 1999 Theo de Raadt.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.\" %FreeBSD%
.\" $FreeBSD$
.\"
.Dd September 25, 1999
.Dt SSH-KEYGEN 1
.Os
.Sh 名称
.Nm ssh-keygen
.Nd 認証用の鍵を生成、管理、および変換する
.Sh 書式
.Nm ssh-keygen
.Op Fl q
.Op Fl b Ar ビット数
.Op Fl t Ar 鍵の種類
.Op Fl N Ar 新しいパスフレーズ
.Op Fl C Ar コメント (訳注: SSH1 のみ)
.Op Fl f Ar 出力先 identity ファイル
.Nm ssh-keygen
.Fl p
.Op Fl P Ar 古いパスフレーズ
.Op Fl N Ar 新しいパスフレーズ
.Op Fl f Ar パスフレーズを変更する identity ファイル
.Nm ssh-keygen
.Fl i
.Op Fl f Ar 変換する identity ファイル
.Nm ssh-keygen
.Fl e
.Op Fl f Ar 変換する identity ファイル
.Nm ssh-keygen
.Fl y
.Op Fl f Ar identity ファイル
.Nm ssh-keygen
.Fl c
.Op Fl P Ar パスフレーズ
.Op Fl C Ar コメント
.Op Fl f Ar コメントを変更する identity ファイル
.Nm ssh-keygen
.Fl l
.Op Fl f Ar 指紋を表示する identity ファイル
.Nm ssh-keygen
.Fl B
.Op Fl f Ar ダイジェストを表示する identity ファイル
.Sh 解説
.Nm
は
.Xr ssh 1
で認証に使う鍵を生成、管理および変換します。デフォルトでは
.Nm
は SSH プロトコル バージョン 1 で使われる RSA1 鍵を生成するように
なっていますが、
.Fl t
オプションを指定すれば SSH プロトコル バージョン 2 で使われる
鍵を生成することができます。
.Pp
ふつう、RSA認証 または DSA認証で SSH を使いたいユーザは、
一度このプログラムを実行すれば
.Pa $HOME/.ssh/identity
、
.Pa $HOME/.ssh/id_dsa
または
.Pa $HOME/.ssh/id_rsa
に鍵 (identity ファイル) を作ることができます。また
.Pa /etc/rc
などで見れらるように、
システム管理者がホスト鍵を生成するためにこのプログラムを
使うこともできます。
.Pp
通常、このプログラムは鍵を生成したあと、その鍵 (identity) をどのファイルに
格納すればよいのか尋ねます。公開鍵は、秘密鍵を含む identity 
ファイルの名前に
.Dq .pub
をつけた名前のファイルとして格納されます。またこのプログラムは
パスフレーズも尋ねてきます。
任意の長さの文字列をパスフレーズとして使用することができます。
パスフレーズをつけないときには、これは空でもかまいません
(ホスト鍵のパスフレーズは必ず空でなければいけません)。
よいパスフレーズとは、 10〜30文字程度の長さで、簡単な文章や容易に
推測できるものではないことです (英語の散文は単語ごとのエントロピーが
わずか 1〜2 ビットしかなく、パスフレーズとしては非常によくない例です)。
パスフレーズは
.Fl p
オプションによって、後から変更することもできます。
.Pp
失われてしまったパスフレーズをもとに戻すことはできません。もし
パスフレーズを忘れてしまったり、なくしてしまったときには、
新しい鍵を生成してその公開鍵を別のマシンにコピーしなくてはならないでしょう。
.Pp
RSA1 鍵 (訳注: SSH1 で使う鍵) の場合、
鍵のファイルにはコメントフィールドがあります。これはユーザが
鍵を区別するためだけに便宜的に用意されているものです
(訳注: SSH2 の鍵にはコメントはありません)。コメントには
鍵の用途やその他有用な情報を書いておくことができます。
最初に鍵が作られるとき、コメントは
.Dq user@host
の形に初期化されますが、
.Fl c
オプションを使えば変更することができます。
.Pp
鍵を生成したあと、それを使用可能にするために
どこに置けばよいかは後で説明しています。
.Pp
オプションには次のようなものがあります:
.Bl -tag -width Ds
.It Fl b Ar ビット数
生成する鍵のビット数を指定します。最小値は 512 ビットです。
ふつうは 1024 ビットの鍵で充分だと考えられており、これ以上鍵を
長くしてもセキュリティの向上には役に立たず、遅くなるだけです。
デフォルトは 1024 ビットになっています。
.It Fl c
秘密鍵ファイルおよび公開鍵ファイルのコメントを変更します。
まず秘密鍵の入っているファイル名を訊かれ、
パスフレーズがあればそれを入力したあとに新しいコメントを入力します。
.It Fl e
このオプションは OpenSSH 形式の秘密鍵あるいは公開鍵ファイルを
読み、
.Sq SECSH Public Key File Format (SECSH 公開鍵ファイル形式)
の鍵を標準出力に表示します。
このオプションを使うと、OpenSSH の鍵を
いくつかの商用 SSH 実装で使われている形式の鍵に変換できます。
.It Fl f
鍵を入れるファイルのファイル名を指定します。
.It Fl i
このオプションは SSH2-互換の形式である、暗号化されていない
秘密鍵 (あるいは公開鍵) ファイルを読み、それを 
OpenSSH 互換の秘密鍵 (あるいは公開鍵) に変換して
標準出力に表示します。
.Nm
は
.Sq SECSH Public Key File Format (SECSH 公開鍵ファイル形式)
の鍵も読みこめます。
このオプションを使うと、いくつかの商用 SSH 実装で使われている
鍵を OpenSSH で使用できます。
.It Fl l
指定された秘密鍵ファイルあるいは公開鍵ファイルの
指紋 (fingerprint) を表示します。
.It Fl p
新しく秘密鍵をつくるのではなく、すでにある秘密鍵ファイルのパス
フレーズを変更します。まず秘密鍵の入っているファイルを訊かれ、
古いパスフレーズを入力したあと、新しいパスワードを 2回入力します。
.It Fl q
静かな
.Nm ssh-keygen 
。
.Pa /etc/rc
で新しい鍵をつくるときに使われます。
.It Fl y
このオプションは OpenSSH 形式の秘密鍵ファイルを読み、
OpenSSH 形式の公開鍵を標準出力に表示します。
.It Fl t Ar 鍵の種類
生成する鍵の種類を指定します。
とりうる値として、プロトコル バージョン 1 で使う
.Dq rsa1
、およびプロトコル バージョン 2 で使う
.Dq rsa
または
.Dq dsa
があります。デフォルトは 
.Dq rsa1
です。
.It Fl B
指定された秘密鍵あるいは公開鍵の bubblebabble ダイジェストを
表示します。
.It Fl C Ar コメント
新しいコメントを指定します。
.It Fl N Ar 新しいパスフレーズ
新しいパスフレーズを指定します。
.It Fl P Ar パスフレーズ
(古い) パスフレーズを指定します。
.El
.Sh 関連ファイル
.Bl -tag -width Ds
.It Pa $HOME/.ssh/identity
そのユーザの、プロトコル バージョン 1 における
RSA 認証用 秘密鍵を格納します。このファイルはその
ユーザ以外の誰にも見せてはいけません。この鍵を生成するときに
パスフレーズを指定するこもできます。パスフレーズは、3DES を使って
ファイル中の秘密鍵の部分を暗号化するのに用いられます。このファイルは
.Nm
によって自動的にアクセスされるわけではありませんが、
秘密鍵ファイルのデフォルトの名前としてこれが提案されます。
.Xr sshd 8
はログイン要求があった際にこのファイルを読み込みます。
.It Pa $HOME/.ssh/identity.pub
プロトコル バージョン 1 における RSA 認証用の公開鍵を格納します。
RSA 認証でログインしたいすべてのマシンの
.Pa $HOME/.ssh/authorized_keys
にこのファイルの内容を追加しておいてください。
このファイルの内容を秘密にしておく必要はありません。
.It Pa $HOME/.ssh/id_dsa
そのユーザの、プロトコル バージョン 2 における
DSA 認証用 秘密鍵を格納します。このファイルはその
ユーザ以外の誰にも見せてはいけません。この鍵を生成するときに
パスフレーズを指定するこもできます。パスフレーズは、3DES を使って
ファイル中の秘密鍵の部分を暗号化するのに用いられます。このファイルは
.Nm
によって自動的にアクセスされるわけではありませんが、
秘密鍵ファイルのデフォルトの名前としてこれが提案されます。
.Xr sshd 8
はログイン要求があった際にこのファイルを読み込みます。
.It Pa $HOME/.ssh/id_dsa.pub
プロトコル バージョン 2 における DSA 認証用の公開鍵を格納します。
RSA 認証でログインしたいすべてのマシンの
.Pa $HOME/.ssh/authorized_keys2
にこのファイルの内容を追加しておいてください。
このファイルの内容を秘密にしておく必要はありません。
.It Pa $HOME/.ssh/id_rsa
そのユーザの、プロトコル バージョン 2 における
RSA 認証用 秘密鍵を格納します。このファイルはその
ユーザ以外の誰にも見せてはいけません。この鍵を生成するときに
パスフレーズを指定するこもできます。パスフレーズは、3DES を使って
ファイル中の秘密鍵の部分を暗号化するのに用いられます。このファイルは
.Nm
によって自動的にアクセスされるわけではありませんが、
秘密鍵ファイルのデフォルトの名前としてこれが提案されます。
.It Pa $HOME/.ssh/id_rsa.pub
プロトコル バージョン 2 における RSA 認証用の公開鍵を格納します。
RSA 認証でログインしたいすべてのマシンの
.Pa $HOME/.ssh/authorized_keys2
にこのファイルの内容を追加しておいてください。
このファイルの内容を秘密にしておく必要はありません。
.El
.Sh 作者
OpenSSH は Tatu Ylonen による、フリーな
オリジナル版 ssh 1.2.12 リリースから派生したものです。
Aaron Campbell、 Bob Beck、 Markus Friedl、 Niels Provos、
Theo de Raadt および Dug Song が多くのバグをとり除き、
新しい機能をふたたび追加して OpenSSH をつくりました。
SSH プロトコル バージョン 1.5 および 2.0 のサポートは
Markus Friedl の貢献によるものです。
.Sh 日本語訳
新山 祐介 (euske@cl.cs.titech.ac.jp) 2001/8/6
.Pp
当マニュアルページは氏のご好意により
.Fx
日本語マニュアルに収録させていただいています。
翻訳についてのご意見、ご指摘がありましたら新山氏
<euske@cl.cs.titech.ac.jp>、および
.Fx
jpman プロジェクト <man-jp@jp.FreeBSD.org> までお送りください。
.Sh 関連項目
.Xr ssh 1 ,
.Xr ssh-add 1 ,
.Xr ssh-agent 1 ,
.Xr sshd 8
.Rs
.%A J. Galbraith
.%A R. Thayer
.%T "SECSH Public Key File Format"
.%N draft-ietf-secsh-publickeyfile-01.txt
.%D March 2001
.%O work in progress material
.Re
