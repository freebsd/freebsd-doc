.\" $FreeBSD$
.de Id
.ds Rv \\$3
.ds Dt \\$4
..
.Id %FreeBSD: src/gnu/usr.bin/rcs/ci/ci.1,v 1.6 1999/08/27 23:36:38 peter Exp %
.ds i \&\s-1ISO\s0
.ds r \&\s-1RCS\s0
.ds u \&\s-1UTC\s0
.if n .ds - \%--
.if t .ds - \(em
.TH CI 1 \*(Dt GNU
.SH 名称
ci \- RCS ファイルにリビジョンをチェックインする
.SH 書式
.B ci
.RI [ options ] " file " .\|.\|.
.SH 解説
.B ci
は \*r ファイルに新たなリビジョンを格納します。
引数のうち、\*r ファイルの拡張子形式に一致する
ファイル名を \*r ファイルとみなします。
それ以外のファイル名は、新たなリビジョンを含んだワークファイルとみなします。
.B ci
はワークファイルの内容を対応した \*r ファイルに格納します。
もしワークファイルのみが指定されたなら、
.B ci
はサブディレクトリ \*r、次にワークファイルがあるディレクトリの順に
対応する \*r ファイルを検索します。
詳細は後述の
.SM "ファイル名規則"
の項を参照してください。
.PP
.B ci
が動作するには、
.B ci
を起動したユーザが
\*r ファイルのアクセスリスト
に登録されているか、アクセスリストが空であるか、
ユーザが \*r ファイルの持ち主であるか、
あるいはスーパユーザである必要があります。
すでに存在する枝 (branch) に新しいリビジョンを追加するには、
枝の先端 (tip) リビジョンが、
追加しようとするユーザによってロックされていなければなりません。
ロックされていない場合、新たな枝のみ作成可能です。
非厳格モード (
.BR rcs (1)
参照) の場合、
ファイルの所有者に対してはこの制限はありません。
他人が行っているロックは、
.B rcs
コマンドによって解除できます。
.PP
.B \-f
オプションが指定されていなければ、
.B ci
は追加しようとするリビジョンと直前のリビジョンとの比較を行います。
違いがなかった場合、新たなリビジョンを作成するかわりに、
ワークファイルを元のリビジョンのものに復元します。
復元するときには、ci はいったんワークファイルを削除し、
ロックを解除します。
.B "ci\ \-l"
はロックし、
.B "ci\ \-u"
はロックを解除します。
これらのオプションが指定されていれば、あたかも直前のリビジョンに対して
.B "co\ \-l"
または
.B "co\ \-u"
を実行したかのようにして直前のリビジョンの内容を取り出します。
復元が行われる場合、
.B \-n
と
.B \-s
オプションは復元されるリビジョンに対して作用します。
.PP
リビジョンを格納するときに、
.B ci
はログメッセージの入力を促すプロンプトを表示します。
ログメッセージは、そのリビジョンの変更点の要約です。
ファイル終端 (EOF) あるいは、
ピリオド
.B \&.
のみからなる行によって入力を完了させます。
複数のファイルが登録される場合、
.B ci
は前に入力したログメッセージを
再利用するかどうかを聞いてきます。
もし標準入力が端末でなければ、
.B ci
は確認を行わず、
登録されるすべてのファイルに対して同じログメッセージを使用します。
.B \-m
オプションの項も参照してください。
.PP
もし \*r ファイルが存在しなければ、
.B ci
は新規に \*r ファイルを作成し、
ワークファイルの内容を初期リビジョン (デフォルトでは
.BR 1.1 )
として格納します。
その場合、アクセスリストは空に初期化されます。
初期リビジョンを格納するときは、
ログメッセージのかわりに
ファイルの内容を記述したテキストを入力します (後述の
.B \-t
オプションの項を参照してください)。
.PP
登録するリビジョン番号 (
.I rev )
は、
.BR \-f ,
.BR \-i ,
.BR \-I ,
.BR \-j ,
.BR \-k ,
.BR \-l ,
.BR \-M ,
.BR \-q ,
.BR \-r ,
.B \-u
のオプションのうちのいずれかで指定することができます。
.I rev
はシンボル、数値、あるいは両者の組み合わせたものです。
.I rev
で使用するシンボル名は定義済みでなければなりません;
チェックイン時にシンボル名を割り当てる方法については
.B \-n
および
.B \-N
を参照して下さい。
もし
.I rev
が
.B $
ならば、
.B ci
はワークファイル中のキーワードからリビジョン番号を決定します。
.PP
もし
.I rev
がピリオドから始まる場合、デフォルトの枝 (通常は幹 (trunk)) に格納されます。
もし
.I rev
が枝番号に続いてピリオドである場合、当該枝の最新のリビジョンが使用されます。
.PP
.I rev
がリビジョン番号の場合、
それは登録する枝のなかで最も大きな値である必要があります。
さもなければ、新しい枝を作成する必要があります。
.PP
.I rev
がリビジョン番号ではなく枝番号の場合、
その枝に対する新しいリビジョンが作成されます。
新しいリビジョン番号は、その枝の先端リビジョン番号に 1 を加えたものとなります。
もし
.I rev
が存在しない枝番号ならば、新たな枝が作成され、初期リビジョンとして
.IB rev .1
が作成されます。
.br
.ne 8
.PP
.I rev
が省略された場合、
.B ci
はユーザが行った最後のロックからリビジョン番号を決定します。
ユーザがある枝の先端リビジョンをロックしている場合は、
新たなリビジョンがその枝に追加されます。
新しいリビジョン番号は
先端リビジョン番号に 1 を加えたものになります。
ユーザが先端ではないリビジョンをロックしている場合は、
新たな枝が作成されます。
新たな枝番号は、ロック対象のリビジョンの
最も大きな枝番号に 1 を加えたものになります。
デフォルトでは、新たな枝やリビジョンの番号は
.B 1
となります。
.PP
.I rev
が省略され、ユーザがロックを行わず、そのファイルの所有者であり、
かつロックが
.I 非厳格モード
であるなら、
デフォルトの枝 (通常は幹 (trunk);
.BR rcs (1)
の
.B \-b
オプションの項を参照) に新たなリビジョンが作成されます。
.PP
例外: 幹 (trunk) においてリビジョンを追加することはできますが、
途中に挿入することはできません。
.SH オプション
.TP
.BI \-r rev
リビジョン
.I rev
をチェックインします。
.TP
.B \-r
.B \-r
オプションをリビジョン抜きで使用した場合、
.B ci
にとって特別な意味が有ります。他の \*r コマンドでは
.B \-r
オプションを単体で使用するとデフォルト枝の最新のリビジョンを指定します。
しかし、
.B ci
ではロック解除、ワークファイル削除を行い、
シェルのエイリアスやスクリプトによりデフォルトとされてしまった
.B \-l
や
.B \-u
オプションの効果を打ち消します。
.TP
.BR \-l [\f2rev\fP]
.B \-r
と同様の動作を行ったあと、
.B "co\ \-l"
と同様の動作も行います。
すなわち、登録されたリビジョンは即座にロックされ、チェックアウトされます。
これは、リビジョンをチェックインしてさらに編集を続けたい場合に便利です。
.TP
.BR \-u [\f2rev\fP]
.B \-l
とほぼ同様の動作をしますが、登録されたリビジョンはロックされません。
これは、チェックインしたリビジョンの内容をすぐに参照したい場合に便利です。
.RS
.PP
.BR \-l
、リビジョン無し
.BR \-r ,
.B \-u
オプションは、最後に指定したもののみが効力を持ちます。
たとえば、
.B "ci\ \-u\ \-r"
は
.B "ci\ \-r"
と等価です。
リビジョン無し
.B \-r
が
.B \-u
に優先するからです。
.RE
.TP
.BR \-f [\f2rev\fP]
強制的に登録します。
直前のリビジョンとの違いがない場合にも、
新しいリビジョンとして登録します。
.TP
.BR \-k [\f2rev\fP]
リビジョン番号などをローカルに算出せずに、
ワークファイルからキーワードを探し、
リビジョン番号、作成日時、状態、作者 (
.BR co (1)
を参照) を検索し、登録されるリビジョンに割り当てます。
さらに、
.B ci
を起動したユーザ名と実際にチェックインされた日付を含む
デフォルトのログメッセージを作成します。
本オプションは、配布されたソフトウェアを登録するのに便利です。
複数のサイトに配布されたリビジョンは、
元のリビジョン番号、作成日付、状態、作者を保存するために、
.B \-k
オプションを使って登録するべきです。
ワークファイルのキーワードから取り出した値とログメッセージは、
.BR \-d ,
.BR \-m ,
.BR \-s ,
.B \-w
や、他のリビジョン番号を生成するようなオプションにより
変更することができます。
.TP
.BR \-q [\f2rev\fP]
沈黙モードです。
診断メッセージを表示しません。
直前のリビジョンから変更がない場合、
.B \-f
オプションを指定していなければ、登録を行いません。
.TP
.BR \-i [\f2rev\fP]
最初のチェックイン; \*r ファイルが既に有る時にはエラー報告します。
特定のアプリケーションのレース状態を避けます。
.TP
.BR \-j [\f2rev\fP]
初期化を行わず、チェックインします;
\*r ファイルが無いとエラー報告します。
.TP
.BR \-I [\f2rev\fP]
対話モードで動作します。
たとえ標準入力が端末でなくても、ユーザに対して問い合わせを行います。
.TP
.BR \-d "[\f2date\fP]"
チェックイン日付として指定された
.I date
を用います。
.I date
は
.BR co (1)
で記述された自由形式で指定することができます。
これは、チェックイン日時をごまかしたい場合や、
日付キーワードがワークファイルにないにもかかわらず
.B \-k
オプションを使いたい場合に便利です。
.I date
が指定されなかった場合、ワークファイルの最終更新日付が用いられます。
.TP
.BR \-M [\f2rev\fP]
作成されるワークファイルの最終更新日付を、
取り出されたリビジョンの日付にします。
たとえば、
.BI "ci\ \-d\ \-M\ \-u" "\ f"
は、
.I f
の内容がキーワード置換により変更された場合も最終更新日時を変更しません。
本オプションを指定すると
.BR make (1)
に影響を与えるので、注意して使用する必要があります。
.TP
.BI \-m "msg"
チェックインするすべてのリビジョンのログメッセージとして
.I msg
を用います。
慣習的に
.B #
で始まるログメッセージはコメントであり、GNU Emacs の
.B vc
パッケージのようなプログラムはこれを無視します。
また、
.BI { clumpname }
(の後に空白が続く) ログメッセージは可能であればまとめられることを意味します。
それはたとえ別々のファイルに関連づけられていてもです;
.BI { clumpname }
ラベルは、まとめる目的でのみ使用されます。
それ自身はログメッセージであるとは見なされません。
.TP
.BI \-n "name"
チェックインしたリビジョンにシンボリック名
.I name
をつけます。
もし同じシンボリック名が別のリビジョンに割り当てられていた場合、
.B ci
はエラーメッセージを出力します。
.TP
.BI \-N "name"
.B -n
と同様の動作を行います。
ただし、同じシンボリック名が他のリビジョンに割り当てられていた場合は、
再割り当てを行います (こちらを優先します)。
.TP
.BI \-s "state"
チェックインされるリビジョンの状態を
.I state
とします。デフォルトは
.B Exp
(Experimental: 実験的) です。
.TP
.BI \-t file
\*r ファイル中の内容記述テキストをファイル
.I file
の内容で置き換えます。
すでに内容記述テキストがある場合はこれを削除します。ファイル名
.I file
は
.B \-
で始まってはいけません。
.TP
.BI \-t\- string
\*r ファイル中の内容記述テキストを文字列
.I string
で置き換えます。
すでに内容記述テキストがある場合は削除されます。
.RS
.PP
.B \-t
オプションは、どちらの形式で使う場合も、
最初のチェックイン時にしか意味を持ちません。
それ以外の場合は単に無視されます。
.PP
最初のチェックイン時に
.B \-t
オプションが指定されなかった場合、
.B ci
は標準
入力から内容記述テキストを読み込みます。
テキストは、ファイル終端 (EOF) あるいはピリオド (
.BR \&.
) のみの行で終了します。
ユーザへの問い合わせが可能な場合には、
テキストの入力を促すプロンプトが表示されます (
.B \-I
オプション参照)。
.PP
旧バージョンとの互換性のため、引数のない
.B \-t
オプションは無視されます。
.RE
.TP
.B \-T
新しいリビジョンが存在し、
\*r ファイルの修正時刻が新しいリビジョンの時刻よりも古ければ、
\*r ファイルの修正時刻に対して新しいリビジョンの時刻を代入します;
そうでない場合は \*r ファイルの修正時刻は保たれます。
リビジョンをロックした場合は、
.B ci
は通常 \*r ファイルの修正時刻を現在の時刻に設定します。
なぜならロックが \*r ファイルに格納され、
ロックの削除は \*r ファイルの変更を要するからです。
\*r ファイルがワークファイルよりも新しくなる方法として 2 通り有ります:
まず、
.B "ci\ \-M"
は現在時刻以前の日付でワークファイルを作成します;
2 番目に、直前のバージョンを回復する時、
ワークファイルを変更しない場合にも \*r ファイルは変更され得ます。
\*r ファイルのワークファイルにおける
.BR make (1)
依存により、上記 2 ケースは過剰の再コンパイルという結果になり得ます。
.B \-T
オプションを使用することで、\*r ファイルの日付をごまかし、
再コンパイルを禁止します。
このオプションは注意して使って下さい;
あるワークファイルのチェックインが、
同じ \*r ファイルに関連づけられている別のワークファイルに影響を及ぼすべき
時でも、再コンパイルを抑制し得ます。
例えば、\*r ファイルの時刻を 01:00、
(変更された) ワークファイルの時刻を 02:00、
別のワークファイルのコピーの時刻を 03:00、
現在の時刻を 04:00 とします。
ここで、
.B "ci\ \-d\ \-T"
とすると、\*r ファイルの時刻は通常の 04:00 ではなく 02:00 になります;
この結果、
.BR make (1)
は別のコピーが \*r ファイルよりも新しいと (誤って) 認識します。
.TP
.BI \-w "login"
指定された
.I login
をリビジョンの作者として登録します。
作者名をごまかしたい場合や、
作者キーワードがワークファイルにないにもかかわらず
.B -k
オプションを使いたい場合に便利です。
.TP
.BI \-V
\*r のリビジョン番号を表示します。
.TP
.BI \-V n
\*r システムのバージョン
.I n
のエミュレーションを行います。詳細は
.BR co (1)
を参照してください。
.TP
.BI \-x "suffixes"
\*r ファイルの拡張子を指定します。
拡張子が空ではない場合、
拡張子まで含めたすべてのパス名を \*r ファイル名であるとみなします。
拡張子が空の場合は、
.BI RCS/ path
または
.IB path1 /RCS/ path2
形式のものを \*r ファイル名であるとみなします。
本オプションの場合、
.B /
で区切ることにより、複数の拡張子を指定できます。たとえば、
.B \-x,v/
は、
.B ,v
と空の拡張子の 2 つの拡張子を持つ \*r ファイルを指定します。
複数の拡張子が指定された場合、指定された順に \*r ファイルを検索します。
最初に見つかったサフィックスが \*r ファイルに対して用いられます。
\*r ファイルを生成できるが、 \*r ファイルが見つからないときは、
これらのサフィックスを新しいファイル名に対して用います。
デフォルトの拡張子は、インストールされる環境により異なります。
UNIX のようなコンマをファイル名中に含めることの出来る計算機では、通常
.B \-x,v/
が、それ以外の計算機では空の拡張子が用いられます。
.TP
.BI \-z zone
キーワード置換での日付の出力書式の指定を行い、また、
.BI \-d date
オプションでの
.I date
のデフォルトのタイムゾーンの指定を行います。
.I zone
は、省略する事も、UTC からの数値差で指定する事も、特別な文字列
.B LT
を使ってローカル時間で指定する事もできます。
デフォルトでは
.I zone
は空であり、
この場合は伝統的な \*r フォーマット、
すなわちタイムゾーン無しの \*u であり日付をスラッシュで区切ります;
そうでない場合は時刻はタイムゾーン付の \*i 8601 フォーマットです。
例えば、ローカルタイムが 1990 年 1 月 11 日 太平洋標準時間
(\*u の 8 時間西) 午後 8 時の場合、時間の出力は次のようになります:
.RS
.LP
.RS
.nf
.ta \w'\f3\-z+05:30\fP  'u +\w'\f31990-01-11 09:30:00+05:30\fP  'u
.ne 4
\f2オプション\fP\f2時刻の出力\fP
\f3\-z\fP	\f31990/01/12 04:00:00\fP	\f2(デフォルト)\fP
\f3\-zLT\fP	\f31990-01-11 20:00:00\-08\fP
\f3\-z+05:30\fP	\f31990-01-12 09:30:00+05:30\fP
.ta 4n +4n +4n +4n
.fi
.RE
.LP
.B \-z
オプションは \*r ファイルに格納されている日付 (常に \*u です)
には影響しません。
.SH "ファイル名規則"
\*r ファイルとワークファイルの組み合わせは 3 通りの方法で指定することができます
(使用例の項目も参照してください)。
.PP
1) \*r ファイルとワークファイルの両方を指定する。
\*r ファイルのパス名は
.IB path1 / workfileX
形式、ワークファイルのパス名は
.IB path2 / workfile
形式をとります。この場合の
.IB path1 /
と
.IB path2 /
はパス (異なるパスや、空でも可) を示し、
.I workfile
はファイル名、
.I X
は \*r ファイルの拡張子です。もし
.I X
が空なら、
.IB path1 /
は
.B RCS/
で始まるか、
.B /RCS/
を含まねばなりません。
.PP
2) \*r ファイルのみを指定する。
ワークファイルがカレントディレクトリに作成され、\*r ファイル名から
.IB path1 /
と拡張子
.I X
を取り除いたファイル名になります。
.PP
3) ワークファイルのみを指定する。
.B ci
はまず、各 \*r 拡張子
.I X
に対して、
.IB path2 /RCS/ workfileX
形式の名前で検索を行います。
さらに、(もしこれが見つからず、
.I X
が空でなければ、)
.IB path2 / workfileX
を検索します。
.PP
1) または 2) の方法で \*r ファイルが指定されていない場合、
.I ci
はまずディレクトリ
.B ./RCS
を検索し、次にカレントディレクトリを検索します。
.PP
異常により \*r ファイルのオープンに失敗すると、
.I ci
はエラー報告します。
他に \*r ファイルのパス名の候補があってもです。
たとえばディレクトリ
.I d
で \*r コマンドを利用できないようにするには、
.IB d /RCS
なる名前の通常ファイルを作成しておきます。
すると、\*r コマンドは
.IB d /RCS
をディレクトリとしてオープンしようとしますが、
ディレクトリではないのでオープンすることができず失敗します。
.SH 使用例
\*r 拡張子が
.B ,v
、カレントディレクトリには \*r ファイルを含む
.B RCS
というサブディレクトリがあり、
.B io.c,v
があると仮定します。
ここで、以下に示したコマンドを実行すると、
どれもカレントディレクトリにある
.B io.c
を
.B RCS/io.c,v
にチェックインし、
.B io.c
を削除します。
.LP
.RS
.nf
.ft 3
ci  io.c;    ci  RCS/io.c,v;   ci  io.c,v;
ci  io.c  RCS/io.c,v;    ci  io.c  io.c,v;
ci  RCS/io.c,v  io.c;    ci  io.c,v  io.c;
.ft
.fi
.RE
.PP
\*r 拡張子が空、カレントディレクトリには \*r ファイルを含む
.B RCS
というサブディレクトリがあり、
.B io.c
があると仮定します。ここで以下に示すコマンドは、どれも新しい
リビジョンのチェックインを行います。
.LP
.RS
.nf
.ft 3
ci  io.c;    ci  RCS/io.c;
ci  io.c  RCS/io.c;
ci  RCS/io.c  io.c;
.ft
.fi
.RE
.SH "ファイルモード"
.B ci
が作成した \*r ファイルは、
ワークファイルの読み込みと実行の許可属性を受け継ぎます。
すでに \*r ファイルが存在すれば、
.B ci
はその読み込みと実行の許可属性を保持します。
.B ci
は、つねに \*r ファイルの書き込み許可属性を不許可にします。
.SH 関連ファイル
いくつかの一時ファイルが、ワークファイルの存在するディレクトリまたは
一時ディレクトリ (環境変数の項の
.B \s-1TMPDIR\s0
参照) に作成されます。
セマフォファイル等のファイルが
\*r ファイルが存在するディレクトリに作成されます。
空ではない拡張子を用いている場合、
セマフォファイル名の先頭文字には、
拡張子の先頭文字と同じ文字が用いられます;
よって、拡張子として、ワークファイルの拡張子の先頭文字と同じ文字を
指定しないように注意してください。
空の拡張子を指定している場合、
セマフォファイル名の最後の文字がアンダスコア (
.B _
) となります。
.PP
.B ci
は、 \*r ファイルやワークファイルを変更しません。通常
.B ci
はそれらのファイルをアンリンクし、新しいファイルを作成します;
ただし、\*r ファイルへのシンボリックリンクの鎖を壊す代わりに、
目的のファイルをアンリンクします。
よって、
.B ci
は変更されるワークファイルへの
ハードリンク、シンボリックリンクを全て壊します;
さらに、\*r ファイルへのハードリンクは無効となり、
シンボリックリンクは保存されます。
.PP
実効ユーザは、\*r ファイルを含むディレクトリの
検索および書き込み権を持っていなければなりません。
通常実ユーザは、 \*r ファイルとワークファイルの読み込み許可と、
それらを含むディレクトリの検索および書き込み権を持っていなければなりません。
しかし、古い計算機のなかには実ユーザと実効ユーザの間を
容易に行き来することができないものもあります。
これらの計算機では、実効ユーザのみが利用されます。
.B ci
や
.B co
のコピーに setuid が設定されていなければ、
実ユーザと実効ユーザは同一です。
次節で説明するように、
もし実効ユーザが全 \*r ファイルとそれを含むディレクトリを所有し、
実効ユーザのみが \*r ディレクトリに書き込めるように設定できるなら、
\*r ファイルのセキュリティを強化することが可能です。
.PP
ユーザは \*r ファイルを含むディレクトリの許可属性を変更することで、
\*r ファイルに対するアクセスを制限できます;
そのディレクトリに書き込み権のあるユーザだけが、
\*r ファイルを変更する \*r コマンドを使用することができます。
たとえば、ユーザが複数のグループに属することが出来る計算機では、
\*r ディレクトリをあるグループのみが書き込み権を持つように設定します。
これは、略式のプロジェクトでは十分ですが、
グループに所属するユーザが自由に \*r ファイルを変更することができ、
\*r ファイルすべてを削除することもできます。
そのため、正式なプロジェクトでは、
\*r ファイルを自由に操作きる \*r 管理者と、
新たなリビジョンをチェックインすること以外の操作はできない他のユーザとを、
区別することがあります。
.SH SETUID の使用
\*r 管理者以外のユーザがリビジョンを削除できないようにするには、
以下のように setuid 特権を使用することができます。
.nr n \w'\(bu'+2n-1/1n
.ds n \nn
.if \n(.g .if r an-tag-sep .ds n \w'\(bu'u+\n[an-tag-sep]u
.IP \(bu \*n
その計算機で \*r にて setuid が使用できるか確認します。
疑問があるときは、信頼できる専門家に意見を聞いてください。
最も良いのは、
.B seteuid()
システムコールが Posix 1003.1a Draft 5 に
記述されているように動作することです。
なぜなら、実ユーザが
.BR root
であっても、\*r	は実ユーザと実効ユーザを簡単に切り替えることができるからです。
その次に良いのは、
.B setuid()
システムコールが saved setuid
(Posix 1003.1-1990の {\s-1_POSIX_SAVED_IDS\s0} の動作) を
サポートしている場合です;
この場合、実ユーザもしくは実効ユーザが
.BR root
である時のみ失敗します。
\*r は setuid に失敗すると、ただちに終了します。
.IP \(bu \nn
ユーザグループの \*r 管理者として、ユーザ
.I A
を選びます。
.I A
だけが、\*r ファイルに対して
.B rcs
コマンドを実行することができます。
.I A
は
.B root
や、特権を持ったユーザであってはいけません。
相互に異なるユーザグループには、異なる管理者を使用するべきです。
.IP \(bu \nn
ユーザが実行するファイルのディレクトリに、パス名
.I B
を選びます。
.IP \(bu \nn
以下のように、通常のインストールディレクトリ
.I D
から、
.B ci
と
.B co
を
.I B
にコピーし、
.I A
へ setuid します:
.LP
.RS
.nf
.ne 3
\f3mkdir\fP  \f2B\fP
\f3cp\fP  \f2D\fP\^\f3/c[io]\fP  \f2B\fP
\f3chmod  go\-w,u+s\fP  \f2B\fP\f3/c[io]\fP
.fi
.RE
.IP \(bu \nn
以下のように、各ユーザのパスに
.I B
を加えます:
.LP
.RS
.nf
.ne 2
\f3PATH=\fP\f2B\fP\f3:$PATH;  export  PATH\fP  # ordinary shell
\f3set  path=(\fP\f2B\fP  \f3$path)\fP  # C shell
.fi
.RE
.IP \(bu \nn
以下のように、
.I A
だけが書き込み許可を持つ \*r ディレクトリ
.I R
を作成します:
.LP
.RS
.nf
.ne 2
\f3mkdir\fP  \f2R\fP
\f3chmod  go\-w\fP  \f2R\fP
.fi
.RE
.IP \(bu \nn
特定のユーザだけに \*r ファイルの読み込みを許可したい場合、
そのユーザをユーザグループ
.IR G
に入れて、さらに
.I A
が以下のように、\*r ディレクトリを保護します:
.LP
.RS
.nf
.ne 2
\f3chgrp\fP  \f2G  R\fP
\f3chmod  g\-w,o\-rwx\fP  \f2R\fP
.fi
.RE
.IP \(bu \nn
(存在すれば) 古い \*r ファイルを
.IR R
にコピーし、
.I A
が所有であることを保証します。
.IP \(bu \nn
\*r ファイルのアクセスリストは、
リビジョンをチェックインおよびロックできるユーザを制限します。
デフォルトのアクセスリストは空で、
\*r ファイルを読むことのできる全てのユーザに、登録の権限を与えます。
チェックインを制限したい場合は、
.I A
がそのファイルに対して
.B "rcs\ \-a"
を実行します;
.BR rcs (1)
を参照してください。
特に
.BI "rcs\ \-e\ \-a" A
は、
.IR A
だけにアクセスを制限します。
.IP \(bu \nn
初めてチェックインを行う前に、
.I A
は
.B "rcs\ \-i"
によって新しい \*r ファイルを初期化します。
チェックインを制限したい場合、
.B \-a
オプションを付け加えます。
.IP \(bu \nn
setuid 特権は、
.BR ci ,
.BR co ,
.BR rcsclean
のみに与えます;
.B rcs
や他のコマンドに、setuid 特権を与えてはなりません。
.IP \(bu \nn
\*r コマンドに対して、他の setuid コマンドを実行しないでください。
setuid はあなたが考えるより扱いにくいものです。
.SH 環境変数
.TP
.B \s-1RCSINIT\s0
本変数に空白で区切ったオプションを設定することで、
コマンドライン引数に先立って処理されます。
空白はバックスラッシュによってエスケープすることができます。
.B \s-1RCSINIT\s0
はほとんどの \*r コマンドで参照されます。特に
.BR \-q ,
.BR \-V ,
.BR \-x ,
.B \-z
オプションを指定しておくと便利です。
.TP
.B \s-1TMPDIR\s0
一時ディレクトリ名を指定します。
設定されていない場合は、環境変数
.B \s-1TMP\s0
と
.B \s-1TEMP\s0
とを調べ、始めに見つかった値を用います;
どれも設定されていない場合は、
計算機依存のデフォルトのディレクトリ (たいていは
.B /tmp
) を使用します。
.SH 診断
各リビジョンに対して、
.I ci
は \*r ファイル名、ワークファイル名、追加するリビジョン番号、直前の
リビジョン番号を表示します。全ての処理が成功した場合のみ、
終了ステータスが 0 になります。
.SH 作者
Author: Walter F. Tichy.
.br
Manual Page Revision: \*(Rv; Release Date: \*(Dt.
.br
Copyright \(co 1982, 1988, 1989 Walter F. Tichy.
.br
Copyright \(co 1990, 1991, 1992, 1993, 1994, 1995 Paul Eggert.
.SH 関連項目
co(1),
ident(1), make(1), rcs(1), rcsclean(1), rcsdiff(1),
rcsintro(1), rcsmerge(1), rlog(1), setuid(2), rcsfile(5)
.br
Walter F. Tichy,
\*r\*-A System for Version Control,
.I "Software\*-Practice & Experience"
.BR 15 ,
7 (July 1985), 637-654.
.br
