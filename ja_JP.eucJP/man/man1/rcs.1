.\" $FreeBSD$
.de Id
.ds Rv \\$3
.ds Dt \\$4
..
.Id %FreeBSD: src/gnu/usr.bin/rcs/rcs/rcs.1,v 1.5 1999/08/27 23:36:52 peter Exp %
.ds r \&\s-1RCS\s0
.if n .ds - \%--
.if t .ds - \(em
.if !\n(.g \{\
.       if !\w|\*(lq| \{\
.               ds lq ``
.               if \w'\(lq' .ds lq "\(lq
.       \}
.       if !\w|\*(rq| \{\
.               ds rq ''
.               if \w'\(rq' .ds rq "\(rq
.       \}
.\}
.TH RCS 1 \*(Dt GNU
.SH 名称
rcs \- RCS ファイルの属性を変更する
.SH 書式
.B rcs
.IR "options file " .\|.\|.
.SH 解説
.B rcs
は、\*r ファイルの新規作成および \*r ファイルの属性変更を行います。
\*r ファイルは、複数のリビジョン、アクセスリスト、変更履歴、
内容記述、制御属性からなります。
.B rcs
コマンドが実行できるのは、
実行したユーザが \*r ファイルのアクセスリストに登録されているか、
アクセスリストが空であるか、ユーザが \*r ファイルの所有者であるか、
スーパユーザであるか、あるいは
.B \-i
オプションが指定されている場合に限られます。
.PP
\*r 拡張子にマッチするファイル名は \*r ファイルであるとみなし、その他
のファイル名はワークファイルであるとみなします。詳しくは、
.BR ci (1)
を参照してください。リビジョン番号は
.BR ci (1)
に記述されている形式を用います。
.SH オプション
.TP
.B \-i
新たな \*r ファイルを作成し、初期化します。ただし、リビジョンは作成しません。
指定されたファイル名にディレクトリ名が含まれていない場合、
.B rcs
はまずカレントディレクトリにある
.BR ./RCS
ディレクトリにファイルを作成しよう
と試みます。これに失敗したら、カレントディレクトリに作成しようと試みます。
もしすでに \*r
ファイルが存在した場合はエラーとなります。
.TP
.BI \-a "logins"
\*r ファイルのアクセスリストに
.I logins
で指定したユーザ名を追加します。
.I logins
は、コンマで区切ったユーザ名のリストです。
.TP
.BI \-A "oldfile"
.I oldfile
で指定した \*r ファイルのアクセスリストに登録されているユーザ名を、
対象の \*r ファイルのアクセスリストに追加します。
.TP
.BR \-e [\f2logins\fP]
.I logins
で指定したユーザ名を、\*r ファイルのアクセスリストから消去します。
.I logins
が省略された場合は、アクセスリスト全体を消去します。
.TP
.BR \-b [\f2rev\fP]
.I rev
をデフォルトの枝とします。
.I rev
が省略された場合、デフォルト枝は
幹上で最も大きな番号を持つ枝になります。
.TP
.BI \-c string
コメント開始文字列を
.IR string
に設定します。
最初に
.BR ci
を起動した時、あるいは
.B "rcs\ \-i"
に
.BR \-c
オプションを指定しなかった時は、コメント開始文字列は
ワークファイルの拡張子から自動的に推測されます。
.RS
.PP
通常、\*r はチェックアウト (
.BR co (1)
参照) 時の記録行を挿入する際に、
.B $\&Log$
行の行頭部を使用するので、このオプションは現在廃止の方向にあります。
しかしながら、\*r の古いバージョンでは、
.B $\&Log$
行の行頭部ではなくコメント開始文字列を使用しているので、
\*r の新旧両方のバージョンのファイルを使用する場合は、
そのコメント開始文字列が
.B $\&Log$
行の行頭部と一致するようにしなければなりません。
.RE
.TP
.BI \-k subst
デフォルトのキーワード展開方式を
.IR subst
に設定します。キーワード展開の効果については
.BR co (1)
に記述してあります。
.BR co ,
.BR rcsdiff ,
.B rcsmerge
に
.B \-k
オプションを指定することで、デフォルトの展開方式を無効にすることができます。
.B "rcs\ \-kv"
を用いるときは注意してください。なぜなら、
.B \-kv
をデフォルトにすると
.B "co\ \-l"
とあいいれなくなるからです。
.B "rcs\ \-kkv"
によって、通常のデフォルト値に戻すことができます。
.TP
.BR \-l [\f2rev\fP]
リビジョン
.I rev
をロックします。
.I rev
が枝を示す場合、枝上の最新のリビジョンがロックされます。
.I rev
が省略された場合、デフォルト枝上の最新のリビジョンがロックされます。
ロックすることにより、そのリビジョンのファイルに対して複数の人が
変更することを防止できます。別の人が既にロックしている場合、
.B "rcs\ \-u"
により、ロックを解除することができます(下記参照)。
.TP
.BR \-u [\f2rev\fP]
リビジョン
.I rev
をロック解除します。
.I rev
が枝を示す場合、枝上の最新のリビジョンがロック解除されます。
.I rev
が省略された場合、コマンドを実行したユーザがロックした
最新のリビジョンがロック解除されます。
通常、ロックしたユーザのみがロックを解除することができます。
他のユーザがロックを解除しようとすると、
ロックしたユーザへメールが送信されます。
メールにはロックを解除する理由等を書いた
コメントを付加します。コメントはロックを解除しようとしたユーザが入力し、
ファイル終端あるいは
.B \&.
のみを含む行を入力することで終了します。
.TP
.B \-L
ロックを厳格に行なうモード (以下、厳格モード) に設定します。
厳格ロックを指定すると、\*r ファイルの
所有者であっても、ロックしているファイルをチェックインすることが
できなくなります。
複数のユーザで共有するようなファイルは本モードで利用すべきです。
.TP
.B \-U
ロックを厳格には行なわないモード (以下、非厳格モード) に設定します。
非厳格ロックを指定すると、\*r ファイルの所有者はロックすることなく、
新しいリビジョンをチェックインすることができます。複数の
ユーザで共有するファイルは本モードで使用すべきではありません。
デフォルトのロックモードを厳格にするか非厳格にするかは、\*r システムを
インストールしたシステム管理者が決めますが、通常は厳格モードです。
.TP
\f3\-m\fP\f2rev\fP\f3:\fP\f2msg\fP
リビジョン
.I rev
のログメッセージを
.I msg
に置換します。
.TP
.B \-M
ロックしたユーザ以外のユーザがロックを解除した際に、メールを送りません。
これは使用を簡便にする目的のオプションではありません。他の方法により
ユーザに警告を行うようなプログラムを使用し、
.B "rcs\ \-u"
を単に低いレベルのロック解除の目的で使用するような場合のために
用意されています。
.TP
\f3\-n\fP\f2name\fP[\f3:\fP[\f2rev\fP]]
枝またはリビジョン
.I rev
にシンボリック名
.I name
を関連付けます。
.B :
も
.I rev
も省略した場合、シンボリック名
.I name
は削除されます。
.I name
がすでに別の
リビジョンに関連付けられていた場合はエラーとなります。
.I rev
がシンボリック名の場合も
.I name
との関連付けは番号によって行われます。枝番号に
.I \&.
を付加したものは、その枝での最新のリビジョンを示します。
.B :
だけで
.I rev
を省略した場合、デフォルト枝(通常は幹)の最新のリビジョンが関連付けられます。
たとえば、
.BI "rcs\ \-n" name ":\ RCS/*"
はすべての \*r ファイルの最新のリビジョンに対してシンボリック名
.I name
を関連付けます。一方、
.BI "rcs\ \-n" name ":$\ RCS/*"
は各 \*r ファイルに対応したワークファイル中のキーワードに含まれる
リビジョン番号と
.I name
を関連付けます。
.TP
\f3\-N\fP\f2name\fP[\f3:\fP[\f2rev\fP]]
.B -n
と同様に動作します。ただし、同じ
.I name
が別のリビジョンに関連付けられていてもエラーとはせず、
関連付けをしなおします。
.TP
.BI \-o range
.I range
で指定したリビジョンを削除します。
.I range
がただ 1 つのリビジョン番号ならば、そのリビジョンを削除します。
.I range
に枝番号が含まれれば、その枝の最新のリビジョンを削除します。
.IB rev1 : rev2
形式の範囲指定では、同じ枝上の
.I rev1
から
.I rev2
までのすべてのリビジョンが削除されます。
.BI : rev
は枝の開始から
.I rev
までのリビジョンを、
.IB rev :
は同じ枝上の
.I rev
以降のリビジョンのすべてを削除します。
削除されるリビジョンにロックや枝があってはいけません。
.TP
.B \-q
診断メッセージは表示されません。
.TP
.B \-I
対話モードで動作します。たとえ標準入力が端末でなくても、ユーザに対して
問い合わせを行います。
.TP
.B \-s\f2state\fP\f1[\fP:\f2rev\fP\f1]\fP
リビジョン
.I rev
の状態を
.I state
にします。
.I rev
が枝番号なら、その枝の最新のリビジョンの状態を変更します。
.I rev
が省略されたなら、デフォルト枝の最新リビジョンを変更します。
.I state
としては自由な識別子を指定できます。一般に用いられる識別子としては、
.B Exp
(experimental: 実験的)、
.B Stab
(stable: 安定した)、
.B Rel
(released: リリースした)があります。デフォルトでは、
.BR ci (1)
は状態を
.B Exp
にします。
.TP
.BR \-t [\f2file\fP]
\*r ファイルの内容記述テキストをファイル
.I file
の内容で置換します。すでに存在していた内容記述は削除されます。ファイル名は
.B \-
で始まってはいけません。
.I file
が省略された場合、
テキストは標準入力から読み込まれ、ファイル終端または
.B \&.
のみを含む行で終了します。可能ならば、テキストの入力を
促すプロンプトが表示されます(
.B \-I
オプションの項を参照)。
.B \-i
オプションを指定すると、
.B \-t
オプションが指定されていなくても内容記述テキストの入力を求めます。
.TP
.BI \-t\- string
\*r ファイルの内容記述テキストを文字列
.I string
で置換します。すでに存在していた内容記述は削除されます。
.TP
.B \-T
リビジョンが削除されない限り、\*r ファイルの変更時刻を保存します。
このオプションを使うことにより、\*r ファイルの中のワークファイルの
コピーによって生ずる
.BR make (1)
の依存関係に伴う必要以上の再コンパイルを防ぐことができます。
このオプションを使用する際には注意が必要です。本当に再コンパイルが必要な
場合にも再コンパイルされない場合が生じます。つまり、\*r ファイルへの変更が
ワークファイル中のキーワードの変更を意味する場合があるからです。
.TP
.BI \-V
\*r システムのバージョン番号を表示します。
.TP
.BI \-V n
\*r システムのバージョン
.I n
のエミュレーションを行います。詳細は
.BR co (1)
を参照してください。
.TP
.BI \-x "suffixes"
\*r ファイル拡張子を
.I suffixes
に指定します。詳しくは
.BR ci (1)
を参照してください。
.TP
.BI \-z zone
デフォルトのタイムゾーンとして
.I zone
を使用します。
このオプションは何の効果もありません。他の \*r コマンドとの互換性を保つ
ために存在します。
.PP
.B rcs
コマンドの将来予定されている拡張との互換性を維持するには、
少なくともひとつのオプションを明示的に指定する必要があります。
.SH 互換性
.BI \-b rev
オプションを指定すると、 \*r バージョン 3 以前では処理できない \*r
ファイルが生成されます。
.PP
.BI \-k subst
オプション(
.B \-kkv
を除く)を指定すると、 \*r バージョン 4 以前では
処理できない \*r ファイルが生成されます。
.PP
バージョン
.I n
の \*r で処理できる \*r ファイルを生成するために
.BI "rcs \-V" n
を利用することができます。これにより、バージョン
.I n
で処理できない情報を削除することができます。
.PP
バージョン 5.5 以前の \*r は
.B \-x
オプションをサポートしません。\*r ファイルの拡張子としては
.B ,v
が用いられます。
.SH 関連ファイル
.B rcs
は
.BR ci (1)
とほぼ同様のファイル群にアクセスします。ただし、アクセスは
すべて実効ユーザ ID によって行われます。
また、ワークファイルやそのディレクトリには書き込みを
行いません。リビジョン番号として
.B $
を指定した場合を除き、ワークファイルを読むこともありません。
.SH 環境変数
.TP
.B \s-1RCSINIT\s0
コマンドライン引数に先立って与えられるオプションを指定します。
各オプションは空白で区切って指定します。詳しくは
.BR ci (1)
を参照してください。
.SH 診断
\*r ファイル名およびひとつ古い(outdated)リビジョン番号が診断出力として
表示されます。
すべての処理が成功した場合に限り終了ステータス 0 を返します。
.SH 作者
Author: Walter F. Tichy.
.br
Manual Page Revision: \*(Rv; Release Date: \*(Dt.
.br
Copyright \(co 1982, 1988, 1989 by Walter F. Tichy.
.br
Copyright \(co 1990, 1991, 1992, 1993, 1994, 1995 Paul Eggert.
.SH 関連項目
rcsintro(1), co(1), ci(1), ident(1), rcsclean(1), rcsdiff(1),
rcsmerge(1), rlog(1), rcsfile(5)
.br
Walter F. Tichy,
\*r\*-A System for Version Control,
.I "Software\*-Practice & Experience"
.BR 15 ,
7 (July 1985), 637-654.
.SH バグ
システムクラッシュ等の大惨事があると、\*r はセマフォファイルを
残してしまうため、後に \*r を実行しようとすると、\*r ファイルが使用中であると
警告します。
これを直すにはセマフォファイルを消去する必要があります。
通常、セマフォファイル名前は
.B ,
で始まるか、
.B _
で終了します。
.PP
以前の版の
.B rcs
では
.B -o
オプションにおけるリビジョンの区切りは
.BR :
ではなく
.B \-
でした。
しかし、これはシンボリック名が
.B \-
を含んでいるときに混乱を生じます。
従来の版との互換性のため
.B "rcs \-o"
は
.B \-
を用いた記法もサポートしますが、
この記法を用いた場合は警告メッセージを表示します。
.PP
シンボリック名が指しているリビジョンが存在するとは限りません。例えば、
.B \-o
オプションによってリビジョンが削除されてもそれを指すシンボリック名は削
除されずに残っています。シンボリック名を削除するには
.B \-n
オプションを用いる必要があります。
.br
