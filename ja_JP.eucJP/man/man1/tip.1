.\" Copyright (c) 1980, 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@(#)tip.1	8.4 (Berkeley) 4/18/94
.\" %FreeBSD: src/usr.bin/tip/tip/tip.1,v 1.7.2.1 2000/04/23 16:52:35 bsd Exp %
.\" jpman %Id: tip.1,v 1.3 1997/07/26 21:48:01 horikawa Stab %
.\"
.Dd April 18, 1994
.Dt TIP 1
.Os BSD 4
.Sh 名称
.Nm tip
.Nd リモートシステムとの接続を行なう
.Sh 書式
.Nm tip
.Op Fl v
.Fl Ns Ns Ar speed 
.Ar system\-name
.Nm tip
.Op Fl v
.Fl Ns Ns Ar speed 
.Ar phone\-number
.Sh 解説
.Nm tip
は、他のマシンとの間に全二重のコネクションを確立し、
リモートマシンへ直接ログインしてみせます。
言うまでもないことですが、コネクションを張りたいマシンに対しては、
ログインアカウント (かそれに相当するもの) がなければなりません。
.Pp
以下のオプションが使用可能です:
.Bl -tag -width indent
.It Fl v
冗長モードを設定します。
.El
.Pp
入力された文字は通常は直接リモートマシンに転送されます
(それは同様にエコーされます)。
行頭にチルダ文字 (`~') が入力された場合には、これはエスケープ文字として
働きます; 以下の組み合わせが認識されます:
.Bl -tag -width flag
.It Ic \&~^D No または Ic \&~ .
コネクションを切断し、プログラムを終了します
(リモートマシンにはログインしたままでいることもできます)。
.It Ic \&~c Op Ar name 
ローカルのカレントディレクトリを
.Ar name
で指定したものに変更します
(引数が指定されない場合には、ホームディレクトリに移動します)。
.It Ic \&~!
シェルを起動します (シェルを終了すると、tip に戻ります)。
.It Ic \&~>
ローカルマシンのファイルをリモートマシンにコピーします。
.Nm tip
は、ローカルファイル名の入力プロンプトを出します。
.It Ic \&~<
リモートシステムのファイルをローカルマシンに転送します。
.Nm tip
は、まず転送されるファイル名の入力プロンプトを出し、
それからリモートマシンで実行するコマンドのプロンプトを出します。
.It Ic \&~p Ar from Op Ar to 
リモートの
.Ux
ホストにファイルを送ります。put コマンドは
.Nm tip
が ``from'' ファイルを送っている間、リモートの
.Ux
システム上で ``cat > 'to''' コマンドを実行します。
``to'' ファイル名が指定されない場合には、
このファイル名には ``from'' ファイル名を使用します。
このコマンドは、実際には
``~>''コマンドを
.Ux
システムに特定して実装したバージョンです。
.It Ic \&~t Ar from Op Ar to 
リモートの
.Ux
ホストからファイルを受信します。put コマンドと同じく、``to'' ファイル名
が指定されない場合には、このファイル名は ``from'' ファイル名と同じになります。
リモートホストでは
.Nm tip
にファイル転送を行なうために ``cat 'from';echo ^A'' を実行します。
.It Ic \&~|
リモートコマンドからの出力を、ローカル
.Ux
プロセスへパイプを用いてリダイレクトします。
ローカル
.Ux
システムに送られるコマンド文字列は、シェルで処理されます。
.It Ic \&~$
ローカル
.Ux
プロセスからパイプを介してリモートホストへ出力します。
ローカル
.Ux
システムに送られるコマンド文字列は、シェルで処理されます。
.It Ic \&~C
ローカルシステム上で \s-1XMODEM\s+1 などの特別なプロトコルを扱うための
子プロセスを起動します。この子プロセスは特別に用意された、次のような
ファイルディスクリプタを用いて動作します。
.nf
.in +1i
0 <-> 自側 tty 入力
1 <-> 自側 tty 出力
2 <-> 自側 tty 出力
3 <-> 相手側 tty 入力
4 <-> 相手側 tty 出力
.in -1i
.fi
.It Ic \&~#
.Dv BREAK
信号をリモートホストに送信します。
必要な
.Ar ioctl
システムコールをサポートしていないシステムの場合には、回線速度の
変更と
.Dv DEL
文字の組み合わせでブレイクをシミュレートします。
.It Ic \&~s
変数をセットします (以下の記述を参照してください)。
.It Ic \&~^Z
.Nm tip
を停止します
(システムがジョブコントロールをサポートしている場合にのみ使用可能です)。
.It Ic \&~^Y
ローカル側の
.Nm tip
のみ停止します
(システムがジョブコントロールをサポートしている場合にのみ使用可能です);
.Nm tip  
の ``リモート側'' すなわちリモートホストの表示出力については引続き走行します。
.It Ic \&~?
チルダエスケープで使用できるコマンド一覧を表示します。
.El
.Pp
.Nm tip
は、
.Pa /etc/remote
ファイルを用いて特定システムへの接続方法を検索し、他システムと
接続する際のパラメータを特定します;
.Pa /etc/remote
ファイルの完全な記述は
.Xr remote  5
を参照してください。
各システムは、コネクションを確立する際にデフォルトの通信速度が決められて
います。この通信速度が適当でない場合には、コマンドラインにて通信速度を
指定することができます。例えば
.Ql "tip -300 mds"
です。
.Pp
.Nm tip
がコネクションを確立すると、リモートホストにコネクションメッセージを
送信します; デフォルトのメッセージが存在するならば
.Pa /etc/remote
に定義されています (
.Xr remote 5 
を参照してください)。
.Pp
.Nm tip
に引数の入力を促されている場合 (例えば、ファイル転送の設定の間)
には、入力された行は標準の erase や kill 文字で編集することが許されています。
入力を促されている時に空行を入力したり操作を中断
した場合には、入力を促す画面から抜け出し、リモートマシンとの対話に戻ります。
.Pp
.Nm tip
は、モデムや回線の排他制御や
.Xr uucico 8 
で採用されているロックプロトコルを用いることで、複数のユーザが
リモートシステムへ接続することを制限しています。
.Pp
ファイル転送時には
.Nm tip
は転送した行数を表示します。
~> や ~< コマンドを使用した場合には、``eofread'' 変数や ``eofwrite''
変数は、ファイル読み込時の end-of-file 文字の認識や、ファイル書き込み時
の end-of-file 文字の指定に用いられます (後述)。ファイル転送時のフロー制御は、
通常は tandem モードで行なわれます。リモートシステムが tandem
モードをサポートしない場合には、``echocheck'' が設定され、
.Nm tip
が相手に転送した文字のエコーを用いてリモートシステムと同期します。
.Pp
.Nm tip
が他システムとの接続のために電話をかける場合には、
動作を示すさまざまな表示を行ないます。
.Nm tip
は AT コマンドセットを使用するモデムをサポートします。
.Nm tip
は特定のモデムを制御する方法を
.Pa /etc/modems
ファイルから見つけ出します;
完全な記述は
.Xr modems  5
を参照してください。
.Ss 変数
.Nm tip
は、自己を制御するために、
.Ar 変数
を取り扱います。
いくつかの変数は、一般ユーザの権限では参照のみで変更することはできません
(スーパユーザのみ、これらの変数の変更が許可されています)。変数は、
``s'' エスケープにて、参照および変更が可能です。変数設定の書式は、
.Xr vi  1
や
.Xr Mail  1  
での変数設定の書式と同様です。コマンドの引数に ``all'' を指定することで、
ユーザが読み出し可能なすべての変数を表示することができます。また、ユーザは
特定の変数について、変数名の最後に `?' を付加することにより、
その値を表示することができます。
例えば ``escape?'' とすることで、現在のエスケープ文字を表示します。
.Pp
変数値として採用されるものは、数値、文字列、文字、もしくは論理値です。
論理変数の設定については、単に変数名を設定するだけで設定されます;
これらは、変数名の前に `!' 文字をつけることにより偽に設定
されます。他の変数型については、変数と値の間を `=' でつなぐことで設定
できます。すべての設定について、その指定中に空白を入れてはいけません。
単独の set コマンドは、変数の値を設定するだけでなく、変数の値を知るため
にも用いられます。
変数は実行時に set コマンドを実行することで初期化されます (
ホームディレクトリの
.Pa .tiprc
ファイル中で、``~s'' プレフィックスがない場合です)。
.Fl v
オプションを指定することで、
.Nm tip
が初期化時に行なった設定を表示します。
確実に共通変数と思われるものについては、略号表記されます。
以下に共通変数およびその略号と、デフォルトの値の一覧を示します。
.Bl -tag -width Ar
.It Ar beautify
(論理値) セッション確立時に受けとった表示不可の文字については無視します;
.Ar be
と略号表記されます。
.It Ar baudrate
(数値) コネクション確立時の通信速度を指定します;
.Ar ba
と略号表記されます。
.It Ar chardelay
(数値) 各文字の送信後に待つミリ秒数を指定します;
.Ar cdelay
と略号表記されます。
.It Ar dialtimeout
(数値) 相手先に電話をかける際に、コネクション確立までの待ち時間 (秒単位) を
指定します;
.Ar dial
と略号表記されます。
.It Ar echocheck
(論理値) ファイル転送時のリモートホストとの同期を、
送信された最後の文字のエコーを待つことで取ります;
本変数のデフォルト値は
.Ar off
です。
.It Ar eofread
(文字列) ~< コマンドを用いてファイル転送した場合に、
転送終了を示す文字群です;
.Ar eofr
と略号表記されます。
.It Ar eofwrite
(文字列) ~> コマンドを用いてファイル転送した場合に、
転送終了を示すために送る文字列です;
.Ar eofw
と略号表記されます。
.It Ar eol
(文字列) 行末を示す文字群です。
.Nm tip
は行末文字の直後に現れたエスケープ文字のみ、エスケープ文字として認識します。
.It Ar escape
(文字) コマンドプレフィックス (エスケープ) 文字です;
.Ar es
と略号表記されます;
本変数のデフォルト値は `~' です。
.It Ar exceptions
(文字列) beautification の指定で無視されない文字群を指定します;
.Ar ex
と略号表記されます;
本変数のデフォルト値は ``\et\en\ef\eb'' です。
.It Ar force
(文字) リテラルデータ送信を強制する文字です;
.Ar fo
と略号表記されます;
本変数のデフォルト値は`^P'です。
.It Ar framesize
(数値) ファイルを受信した場合に、ファイルシステムとの間にあるバッファに
バッファリングするデータ量 (バイト単位) です;
.Ar fr
と略号表記されます。
.It Ar host
(文字列) 接続しているホスト名です;
.Ar ho
と略号表記されます。
.It Ar linedelay
(数値) 各行の送信後に待つミリ秒数を指定します;
.Ar ldelay
と略号表記されます。
.It Ar login
(文字列) 接続直後に実行されるログインシェルスクリプトのパス名です;
標準入出力はリモートホストへリダイレクトされます。
パス名の先頭のチルダ文字は展開されます;
.Ar li
と略号表記されます。
.It Ar logout
(文字列) 切断直前に実行されるシェルスクリプトのパス名です;
標準入出力はリモートホストへリダイレクトされます。
パス名の先頭のチルダ文字は展開されます;
.Ar lo
と略号表記されます。
.It Ar prompt
(文字) リモートホストの行末文字です;
.Ar pr
と略号表記されます;
本変数のデフォルト値は `\en' です。本変数は、データ転送時の同期を取るのに
用いられます。ファイル転送時に行なう転送行のカウントは、この文字を
いくつ受けとったかということに基づきます。
.It Ar raise
(論理値) 大文字に変換するモードです;
.Ar ra
と略号表記されます;
本変数のデフォルト値は
.Ar off
です。
本モードが有効になると、すべての小文字の文字列は、リモートホストへの転送時に
.Nm tip
によって大文字に変更されます。
.It Ar raisechar
(文字) 大文字へ変換するモードの切替を行なう入力文字です;
.Ar rc
と略号表記されます;
本変数のデフォルト値は `^A' です。
.It Ar record
(文字列) セッションの記録を取るファイル名です;
.Ar rec
と略号表記されます;
本変数のデフォルト値は ``tip.record'' です。
.It Ar script
(論理値) セッションの記録を取るモードです;
.Ar sc
と略号表記されます;
本変数のデフォルト値は
.Ar off
です。
.Ar script
が
.Li true
の場合には、
.Nm tip
はリモートホストから転送されたすべてのデータを
.Ar record
に指定されたファイルに記録します。
.Ar beautify
スイッチが有効になっている場合には、表示可能な
.Tn ASCII
文字 (文字コードに換算して 040 から 0177 までの間) についてのみ記録されます。
beautification 規則の例外を指定する
.Ar exceptions
変数による設定も有効となります。
.It Ar tabexpand
(論理値) ファイル転送時にタブ文字を空白文字に展開するモードです;
.Ar tab
と略号表記されます。
本変数のデフォルト値は
.Ar false
です。
本モードが有効になっている場合には、タブ文字は空白文字 8 つに展開されます。
.It Ar verbose
(論理値) 冗長モードです;
.Ar verb
と略号表記されます;
本変数のデフォルト値は
.Ar true
です。
冗長モードが有効になっている場合には、
.Nm tip
はダイヤル時にメッセージを出力したり、ファイル転送を行なっている際の
現在の転送行数を指定したりします。
.El
.Sh 環境変数
.Nm tip
は、以下の環境変数を参照します:
.Bl -tag -width Fl
.It Ev SHELL
(文字列) ~! コマンド実行時に使用するシェルの名前です; デフォルト値は
``/bin/sh'' であり、環境変数に別の値が設定されている場合には、そちらの
値を参照します。
.It Ev HOME
(文字列) ~c コマンド実行時に用いるホームディレクトリです; デフォルト値は、
実行時の環境によります。
.It Ev HOST
指定がない場合のデフォルトの接続先を指定します。
.El
.Pp
変数
.Ev ${REMOTE}
と
.Ev ${PHONES}
も、エクスポートされます。
.Sh 関連ファイル
.Bl -tag -width /var/spool/lock/LCK..* -compact
.It Pa /etc/modems
システムごとのモデム設定データベース。
.It Pa /etc/remote
システムごとのリモートシステム記述ファイル。
.It Pa /etc/phones
システムごとの電話番号データベース。
.It ${REMOTE}
ユーザごとに持てるリモートシステム記述ファイル。
.It ${PHONES}
ユーザごとに持てる電話番号データベース。
.It ~/.tiprc
初期化ファイル。
.It Pa tip.record
記録ファイル。
.It /var/log/aculog
回線アクセス記録。
.It Pa /var/spool/lock/LCK..*
.Xr uucp
との回線競合を避けるための回線排他制御ファイル。
.El
.Sh 診断
診断メッセージは、そのまま読んで解釈可能です。
.Sh 関連項目
.Xr cu 1 ,
.Xr remote 5 ,
.Xr phones 5
.Sh 歴史
.Nm tip
は
.Bx 4.2
から登場しました。
.Sh バグ
すべての変数が文書化されているわけではありません。文書化されていないものは
おそらく削除されるでしょう。
