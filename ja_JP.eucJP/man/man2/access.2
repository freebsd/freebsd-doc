.\" Copyright (c) 1980, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @(#)access.2	8.2 (Berkeley) 4/1/94
.\" %FreeBSD: src/lib/libc/sys/access.2,v 1.7.2.1 2000/04/22 17:06:48 phantom Exp %
.\"
.\" $FreeBSD$
.Dd April 1, 1994
.Dt ACCESS 2
.Os BSD 4
.Sh 名称
.Nm access
.Nd ファイルまたはパス名のアクセス許可をチェックする
.Sh ライブラリ
.Lb libc
.Sh 書式
.Fd #include <unistd.h>
.Ft int
.Fn access "const char *path" "int mode"
.Sh 解説
.Fn access
関数は、
.Fa mode
によって示されたアクセス許可について
.Fa path
で指定されるファイルのアクセス可能性をチェックします。
.Fa mode
の値は、チェックされるアクセス許可 (読取り許可については
.Dv R_OK
、書込み許可については
.Dv W_OK
、実行 / 検索許可については
.Dv X_OK )
のビット単位の OR、または存在試験
.Dv F_OK
です。
パス名
.Fa path
のすべての構成要素がアクセス許可についてチェックされます
.Pf ( Dv F_OK
も含まれます)。
.Pp
実ユーザ ID は実効ユーザ ID の代わりに使用され、
実グループアクセスリスト (実グループ ID を含む)
がパーミッションを検証するために実効 ID の代わりに使用されます。
.Pp
プロセスに適切な特権があり、
.Dv X_OK
について成功を示していても、実際にはファイルの実行許可ビットが
設定されていないことがあります。同じことが、
.Dv R_OK
および
.Dv W_OK
にも該当します。
.Sh 戻り値
.Fa path
が見つからない場合、または希望のアクセスモードが認められない場合、
値 -1 が返されます。そうでない場合は、値 0 が返されます。
.Sh エラー
ファイルへのアクセスは次の場合に拒絶されます。
.Bl -tag -width Er
.It Bq Er ENOTDIR
パスの構成要素中にディレクトリ以外のものが含まれています。
.It Bq Er ENAMETOOLONG
パス名の構成要素が 255 文字を越えているか、
またはパス名全体が 1023 文字を越えています。
.It Bq Er ENOENT
指定されたファイルが存在しません。
.It Bq Er ELOOP
パス名を変換するときに検出されたシンボリックリンクが多すぎます。
.It Bq Er EROFS
読取り専用ファイルシステム上のファイルについて書込みアクセスが
要求されました。
.It Bq Er ETXTBSY
現時点で実行中の純粋な手続き (共有テキスト)
ファイルについて書込みアクセスが要求されています。
.It Bq Er EACCES
ファイルモードの許可ビットが要求されたアクセスを許容しないか、
またはパスの構成要素について検索許可が拒絶されています。
ファイルの所有者は ``所有者 (owner)'' の読取り、書込み、
および実行のモードビットに従ってチェックされた許可を持ちます。
所有者以外のファイルのグループのメンバは ``グループ (group)'' モードビットに
従ってチェックされた許可を持ち、
他のすべてのものは ``その他 (other)'' モードビットに
従ってチェックされた許可を持ちます。
.It Bq Er EFAULT
.Fa path
は、プロセスに割り当てられたアドレス空間の範囲外を指しています。
.It Bq Er EIO
ファイルシステムに読み書きしている間に入出力エラーが発生しました。
.El
.Sh 関連項目
.Xr chmod 2 ,
.Xr stat 2
.Sh 規格
.Fn access
関数は
.St -p1003.1-90
に準拠しています。
.Sh 警告
.Fn access
は、セキュリティホールになる可能性があり、決して使用しないようにしてください。
.Sh 歴史
.Fn access
関数は
.At v7
で登場しました。
