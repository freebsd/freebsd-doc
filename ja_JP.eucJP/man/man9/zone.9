.\"-
.\" Copyright (c) 2001 Dag-Erling Co骾an Sm鷨grav
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\" %FreeBSD: src/share/man/man9/zone.9,v 1.9.2.4 2002/05/02 20:01:29 asmodai Exp %
.\"
.\" $FreeBSD$
.Dd January 27, 2001
.Dt ZONE 9
.Os
.Sh 抩憊
.Nm zbootinit ,
.Nm zinitna ,
.Nm zinit ,
.Nm zalloc ,
.Nm zfree ,
.Nm zalloci ,
.Nm zfreei ,
.Nd 札□件失伕弗□正
.Sh 踏摯
.In sys/param.h
.In sys/queue.h
.In vm/vm_zone.h
.Ft void
.Fn zbootinit "vm_zone_t z" "char *name" "int size" "void *item" "int nitems"
.Ft int
.Fn zinitna "vm_zone_t z" "struct vm_object *obj" "char *name" "int size" "int nentries" "int flags" "int zalloc"
.Ft vm_zone_t
.Fn zinit "char *name" "int size" "int nentries" "int flags" "int zalloc"
.Ft void *
.Fn zalloc "vm_zone_t z"
.Ft void
.Fn zfree "vm_zone_t z" "void *item"
.Ft void *
.Fn zalloci "vm_zone_t z"
.Ft void
.Fn zfreei "vm_zone_t z" "void *item"
.Sh 荸濩
札□件失伕弗□正反が讀卞釐五今互瑁戶日木月挀僻仄凶釐五今及嫩杴及螂寧毛
棟咥允月凶戶及躲峔讀卅奶件正白尼□旦毛羼間仄引允﹝
札□件失伕弗□正反撢墊凜卞喃曰癲化日木凶札□件反手切欠氏﹜
芺戶喃曰癲化日木化中月札□件卞覆仄化手銀迕允月仇午互請侳﹜引凶公及凶戶﹜
職及丟乒伉棟咥伙□民件方曰手皮□玄皿伕本旦及方曰鍍中蟾閉匹厙迕第Х匹允﹝
.Pp
札□件反翮艦嶺及丐月き域及釐五今及嫩杴及螂寧匹允﹝
札□件失伕弗□正反升及嫩杴互銀迕醱井公丹匹卅中及井毛葦撩歹卅中方丹卞仄﹜
札□件井日
嫩杴毛喃曰癲化月凶戶及楮醒云方太荸旵仄化枑允 (詨匹及銀迕及凶戶卞嫩杴毛
厙迕第Х卞允月) 凶戶及楮醒毛羼間仄引允﹝
.Pp
厭瞻蟲毛札□件失伕弗□正匹棟咥仄﹜
喃曰癲化及棉卞呥戶慇心碧心及白奴□伙玉毛酸允仇午卞方曰
滇互裔爛午卅月札□件及た嶺毛銀迕仄凶中樺寧﹜
札□件失伕弗□正互ま朿匹銀迕允月燮え 2 勾及禾奶件正毛
仇及厭瞻蟲互芺沶仄化云仁优邰互丐曰引允﹝
.Bd -literal
struct my_item {
        struct my_item  *z_rsvd1;
        struct my_item  *z_rsvd2;
        /* 厭瞻蟲及酸曰及朿坌 */
};
.Ed
.Pp
公丹仄卅中樺寧﹜備★及喃癲化及詨匹仇木日及巨件玄伉互莽木凶午心卅允屯五匹允﹝
嫩杴及瘉賡及喃癲化及詨匹反﹜0 卞弁伉失今木化中引允﹝
仄井仄公木卞糧仁喃癲化匹反﹜
瘉嗤荸旵今木凶手及互ま芢午仄化酸勻化中月匹仄斤丹互﹜
蟆課及白奴□伙玉反拺陸匹允﹝
.Pp
札□件反皮□玄皿伕本旦互升木分仃褡躅仄化中月井卞匙繡仄化﹜
2 勾及峸絲及丹切及域杅匹綜嶽今木引允﹝
.Pp
VM 扑旦氾丞互敦蟈卞賡渝祭今木化中月樺寧卞反﹜
.Fn zinit
毛銀迕仄化が讀卞喃癲化日木凶札□件互綜嶽匹五引允﹝
.Fa name
婁醒反札□件及凶戶及羶中筏課讀卅抩蟆尺及禾奶件正匹丐月屯五匹允﹝
仇木反讓煌午犯田永幼件弘杴讀及凶戶卞銀迕今木引允﹝
.Fa size
云方太
.Fa nentries
反公木冗木﹜札□件卞方勻化忡儅今木月嫩杴及釐五今云方太公及札□件及
賡渝及釐五今 (嫩杴醒匹) 匹允﹝
喃曰慇心戊件氾平旦玄及醱匹札□件井日嫩杴互喃癲化日木月窗莘互丐月
樺寧卞反﹜
.Fa flags
婁醒反
.Dv ZONE_INTERRUPT
卞澀爛今木月屯五匹允﹝
仇及樺寧﹜札□件反瑁仄化
.Fa nentries
嫩杴方曰手釐五仁卅日卅中仇午卞鏜啦仄化仁分今中﹝
職及蟈化及樺寧卞反
.Fa flags
反 0 卞澀爛今木月屯五匹允﹝
瘉詨及婁醒
.Fa zalloc
反札□件互域м卞卅月蘸卞公及札□件互釐五仁卅月屯五 VM 矢□斥及醒毛憎仄引允﹝
.Pp
VM 扑旦氾丞互怳分敦蟈卞賡渝祭今木化中卅中樺寧卞反﹜
札□件失伕弗□正反嫩杴卞坌仃芨尹月凶戶及 VM 矢□斥毛
が讀卞喃癲化月仇午互匹五引六氏﹝公及凶戶﹜裟太請仄礎互斃讀卅嫩杴及皿□伙毛
間蛟允月优邰互丐曰引允﹝
仇及樺寧﹜2 勾及蟾閉匹賡渝祭互敦弇仄引允﹝瘉賡卞﹜札□件及瘉賡及銀迕及蟆卞
.Fn zbootinit
互裟太請今木﹜詨匹 VM 扑旦氾丞互粟が仄凶午五卞﹜
.Fn zinitna
及裟太請仄卞方勻化公及札□件及賡渝祭互敦弇今木引允﹝
.Pp
.Fn zbootinit
尺及瘉賡及婁醒反賡渝祭今木月屯五斃讀卅
.Vt "struct vm_zone"
尺及禾奶件正匹允﹝
2 筇雂 3 筇雂洏鴃憧韝恟墾陘忡儅今木月嫩杴及釐五今匹允﹝
4 筇雂帡醒反札□件互敦蟈卞賡渝祭今木月引匹及棉卞札□件失伕弗□正互
公仇井日婁五請允匹丐欠丹斃讀卅嫩杴及т昫尺及禾奶件正匹允﹝
.Fa nitems
婁醒反т昫醱及嫩杴醒匹允﹝
.Pp
.Fa zinitna
尺及婁醒反
.Fa zinit
尺及手及午き元匹允互﹜賡渝祭今木月屯五札□件尺及禾奶件正﹜云方太
.Dv ZONE_INTERRUPT
及樺寧卞公仇井日矢□斥毛喃癲化月凶戶及
.Vt "struct vm_object"
尺及禾奶件正互笛歹勻化中引允﹝
.Pp
札□件井日嫩杴毛喃癲化月凶戶卞反﹜簽賬卞公及札□件及禾奶件正毛慾吨瓣
.Fn zalloc
毛裟太請仄引允﹝仇木反嫩杴尺及禾奶件正毛﹜引凶反﹜札□件及醱及蟈化及
嫩杴互銀迕醱匹啾勾失伕弗□正互札□件毛釐五仁匹五卅中引木卅樺寧卞反﹜
.Dv NULL
毛﹜忒仄引允﹝
.Fn zalloc
反喃曰慇心本□白匹反卅中仇午卞鏜啦仄化仁分今中﹝
喃曰慇心本□白卅喃癲化及凶戶卞反
.Fn zalloc
午き元本穴件氾奴弁旦毛儅勾
.Fn zalloci
毛銀迕仄引允﹝
.Pp
嫩杴反公及札□件尺及禾奶件正云方太公及嫩杴尺及禾奶件正毛慾吨瓣
.Fn zfree
毛裟太請仄卞方勻化﹜喃癲化日木化中凶札□件卞荸旵仄枑今木引允﹝
.Fn zalloci
互銀迕今木化墊卅歹木凶喃癲化及樺寧卞反覆殺允月
.Fn zfreei
楮醒毛銀迕仄引允﹝
.Sh 枑曰襖
.Fn zinitna
楮醒反嶽跦凜卞反 1 毛公仄化撩л凜卞反 0 毛忒仄引允﹝
礿域及撩л及樺寧反喃曰慇心本□白卅札□件及凶戶及失玉伊旦塢棉毛
蟆手勻化喃癲化日木卅中仇午匹允﹝
.Pp
.Fn zinit
楮醒反敦蟈卞賡渝祭今木凶
.Vt "struct vm_zone"
尺及禾奶件正毛﹜引凶反
.Vt "struct vm_zone"
毛
.Fn malloc
匹五卅井勻凶樺寧井
.Dv ZONE_INTERRUPT
白仿弘互澀爛今木化中化
.Fn zinitna
互失玉伊旦塢棉及蟆喃癲化卞撩л仄凶樺寧卞
.Dv NULL
毛﹜忒仄引允﹝
.Pp
.Fn zalloc
楮醒反嫩杴尺及禾奶件正毛﹜引凶反札□件及怳銀迕嫩杴互尕簫仄化失伕弗□正互
札□件毛傀艦匹五卅中樺寧卞
.Dv NULL
毛﹜忒仄引允﹝
.Sh 楮洘嫩杴
.Xr malloc 9
.Sh 昳銖
札□件失伕弗□正反
.Fx 3.0
匹反元戶化瓚樺仄引仄凶﹝
.Sh 綜樊
.An -nosplit
札□件失伕弗□正反
.An John S. Dyson
互踏五引仄凶﹝
.Pp
仇及穴瓦亙失伙矢□斥反
.An Dag-Erling Co\(:idan Sm\(/orgrav Aq des@FreeBSD.org
互踏五引仄凶﹝
