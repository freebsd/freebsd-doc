.\"-
.\" Copyright (c) 2001 Dag-Erling Co骾an Sm鷨grav
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\" %FreeBSD: src/share/man/man9/zone.9,v 1.26 2004/01/25 11:39:41 des Exp %
.\"
.\" $FreeBSD$
.Dd July 21, 2003
.Dt ZONE 9
.Os
.Sh 抩憊
.Nm uma_zcreate ,
.Nm uma_zalloc ,
.Nm uma_zfree ,
.Nm uma_zdestroy ,
.Nm uma_zone_set_max
.Nd 札□件失伕弗□正
.Sh 踏摯
.In sys/param.h
.In sys/queue.h
.In vm/uma.h
.Ft uma_zone_t
.Fo uma_zcreate
.Fa "char *name" "int size"
.Fa "uma_ctor ctor" "uma_dtor dtor" "uma_init uminit" "uma_fini fini"
.Fa "int align" "u_int16_t flags"
.Fc
.Ft "void *"
.Fn uma_zalloc "uma_zone_t zone" "int flags"
.Ft void
.Fn uma_zfree "uma_zone_t zone" "void *item"
.Ft void
.Fn uma_zdestroy "uma_zone_t zone"
.Ft void
.Fn uma_zone_set_max "uma_zone_t zone" "int nitems"
.Sh 荸濩
札□件失伕弗□正反が讀卞釐五今互瑁戶日木月挀僻仄凶釐五今及嫩杴及螂寧毛
棟咥允月凶戶及躲峔讀卅奶件正白尼□旦毛羼間仄引允﹝
札□件失伕弗□正反撢墊凜卞喃曰癲化日木凶札□件反手切欠氏﹜
芺戶喃曰癲化日木化中月札□件卞覆仄化手銀迕允月仇午互請侳﹜引凶公及凶戶﹜
職及丟乒伉棟咥伙□民件方曰手皮□玄皿伕本旦及方曰鍍中蟾閉匹厙迕第Х匹允﹝
.Pp
札□件反翮艦嶺及丐月き域及釐五今及嫩杴及螂寧匹允﹝
札□件失伕弗□正反升及嫩杴互銀迕醱井公丹匹卅中及井毛葦撩歹卅中方丹卞仄﹜
札□件井日
嫩杴毛喃曰癲化月凶戶及楮醒云方太荸旵仄化枑允 (詨匹及銀迕及凶戶卞嫩杴毛
厙迕第Х卞允月) 凶戶及楮醒毛羼間仄引允﹝
.Pp
厭瞻蟲毛札□件失伕弗□正匹棟咥仄﹜
喃曰癲化及棉卞呥戶慇心碧心及白奴□伙玉毛酸允仇午卞方曰
滇互裔爛午卅月札□件及た嶺毛銀迕仄凶中樺寧﹜
札□件失伕弗□正互ま朿匹銀迕允月燮え 2 勾及禾奶件正毛
仇及厭瞻蟲互芺沶仄化云仁优邰互丐曰引允﹝
.Bd -literal -offset indent
struct my_item {
        struct my_item  *z_rsvd1;
        struct my_item  *z_rsvd2;
        /* 厭瞻蟲及酸曰及朿坌 */
};
.Ed
.Pp
公丹仄卅中樺寧﹜備★及喃癲化及詨匹仇木日及巨件玄伉互莽木凶午心卅允屯五匹允﹝
嫩杴及瘉賡及喃癲化及詨匹反﹜0 卞弁伉失今木化中引允﹝
仄井仄公木卞糧仁喃癲化匹反﹜
瘉嗤荸旵今木凶手及互ま芢午仄化酸勻化中月匹仄斤丹互﹜
蟆課及白奴□伙玉反拺陸匹允﹝
.Pp
.Fn uma_zcreate
楮醒反﹜仇木井日嫩杴互喃癲化日木月仇午互第Х卅蕙仄中札□件毛綜嶽仄引允﹝
.Fa name
婁醒反犯田永弘云方太旦氾□正旦及凶戶及氾平旦玄及札□件抩匹允﹝
仇及丟乒伉反﹜札□件及喃癲化互荸旵今木月引匹反﹜荸旵今木月屯五匹反丐曰引六氏﹝
.Pp
婁醒
.Fa ctor
午
.Fa dtor
反﹜公木冗木
.Fn uma_zalloc
午
.Fn uma_zfree
及裟太請仄凜卞 uma 扔皮扑旦氾丞井日裟壬木月﹜戊□伙田永弁楮醒匹允﹝
仇木日及杴讀反﹜鳳蜓及喃曰癲化凜午荸旵凜卞优邰午卅月﹜
賡渝祭云方太г莽及凶戶及白永弁毛羼間允月仇午匹允﹝
.Fa ctor
云方太
.Fa dtor
及戊□伙田永弁及恌中銀中杅午仄化反﹜
喃曰癲化日木凶左皮斥尼弁玄及弘伕□田伙市它件玄及譬幫互丐月匹仄斤丹﹝
.Pp
婁醒
.Fa uminit
午
.Fa fini
反﹜札□件井日及左皮斥尼弁玄喃曰癲化及瘉贗祭卞銀迕今木引允﹝
仇木日反﹜邰菲撢蜇引凶反丟乒伉做⑸及咥苀卞方曰﹜
uma 扔皮扑旦氾丞互呁醒及嫩杴毛喃曰癲化引凶反荸旵允月优邰互丐月午五卞﹜
裟太請今木引允﹝
.Fa uminit
云方太
.Fa fini
及戊□伙田永弁及恌中銀中杅午仄化反﹜
左皮斥尼弁玄卞殖引木月立亙□氾永弁旦及賡渝祭午г莽互丐月匹仄斤丹﹝
仇木卞方曰﹜左皮斥尼弁玄互 uma 扔皮扑旦氾丞及左皮斥尼弁玄井日忒今木凶午五卞﹜
湃卞賡渝祭碧心及立亙□氾永弁旦毛瘋銀迕第Х午卅曰引允﹝
仇木日反﹜備
.Fn uma_zalloc
支
.Fn uma_zfree
及裟太請仄凜卞反裟太請今木內﹜
呁醒及左皮斥尼弁玄卞覆仄化田永民讀卞裟太請今木引允﹝
.Pp
嫩杴反公及札□件尺及禾奶件正毛慾吨
.Fn uma_zalloc
及裟請仄卞方勻化喃癲化日木﹜
.Fa flags
婁醒卞
.Xr malloc 9
午仄化妐踏祭今木凶薊鎗今木凶白仿弘毛澀爛今木引允﹝
公及嫩杴反公及札□件卞荸旵仄枑今木引允﹝
嶽跦及樺寧卞反嫩杴尺及禾奶件正毛忒仄引允﹝
札□件醱及蟈嫩杴互銀迕醱匹啾勾失伕弗□正互札□件毛傀艦匹五卅中筒卅樺寧井﹜
.Dv M_NOWAIT
互抸憎今木化中月樺寧﹜
.Dv NULL
毛忒仄引允﹝
.Pp
嫩杴反公及札□件尺及禾奶件正云方太公及嫩杴尺及禾奶件正毛慾吨瓣
.Fn uma_zfree
及裟太請仄卞方勻化﹜喃癲化日木化中凶札□件卞荸旵仄枑今木引允﹝
.Pp
塢匹丐月綜嶽今木凶札□件反﹜
.Fn uma_zdestroy
毛銀迕仄化﹜公及札□件及凶戶卞喃癲化日木凶蟈化及丟乒伉毛荸旵仄化﹜
г莽今木月仇午互第Х匹允﹝
公及札□件井日
.Fn uma_zalloc
卞方勻化喃癲化日木凶嫩杴反﹜公及蟆卞
.Fn uma_zfree
卞方勻化荸旵今木卅仃木壬卅曰引六氏﹝
.Pp
.Fn uma_zone_set_max
及杴讀反﹜
.Fa zone
婁醒卞方勻化隙爛今木凶札□件卞覆仄化燬迕卞匹五月丟乒伉及瘉釐恟毛
孺蜃允月仇午匹允﹝
.Fa nitems
婁醒卞反公及札□件ま及嫩杴及曉蜃毛芨尹引允﹝
仇及孺蜃反﹜喃曰癲化日木凶嫩杴﹜釩旵今木凶嫩杴﹜云方太 CPU 咍及
平乓永扑亙ま卞丐月釩旵今木凶嫩杴毛殖戈﹜公及札□件及醱及嫩杴及玄□正伙醒匹允﹝
呁醒及 CPU 毛儅勾扑旦氾丞曉匹反﹜丟乒伉及尕簫互卅中凜卞匹今尹﹜
隙爛今木凶醒及嫩杴毛喃曰癲化月仇午互尕第Х匹丐月仇午互丐曰引允﹝
卅兮卅日壬﹜孺蜃卞婁勻井井月凜鰾匹﹜酸曰及蟈化及釩旵今木化中月嫩杴互﹜
職及 CPU 及平乓永扑亙及醱卞丐月井手仄木卅中井日匹允﹝
.Sh 枑曰襖
.Fn uma_zalloc
楮醒反嫩杴尺及禾奶件正毛﹜引凶反札□件及怳銀迕嫩杴互尕簫仄化失伕弗□正互
札□件毛傀艦匹五卅中樺寧卞
.Dv NULL
毛﹜忒仄引允﹝
.Sh 楮洘嫩杴
.Xr malloc 9
.Sh 昳銖
札□件失伕弗□正反
.Fx 3.0
匹反元戶化瓚樺仄引仄凶﹝
旦仿皮失伕弗□正午仄化及窗Х及凶戶﹜
.Fx 5.0
匹漪呿讀卞庍凳今木引仄凶﹝
.Sh 綜樊
.An -nosplit
札□件失伕弗□正反
.An John S. Dyson
互踏五引仄凶﹝
札□件失伕弗□正反﹜旦仿皮失伕弗□正午仄化及窗Х及凶戶﹜
.An Jeff Roberson Aq jeff@FreeBSD.org
互釐朿坌毛踏五躂仄引仄凶﹝
.Pp
仇及穴瓦亙失伙矢□斥反
.An Dag-Erling Sm\(/orgrav Aq des@FreeBSD.org
互踏五引仄凶﹝
UMA 及凶戶卞
.An Jeroen Ruigrok van der Werven Aq asmodai@FreeBSD.org
互庍凳仄引仄凶﹝
