<!--
     The FreeBSD Documentation Project
     The FreeBSD Japanese Documentation Project

     Original revision: 1.6
     $FreeBSD$
-->

<chapter id="disks">
  <title>ディスク</title>

  <para><emphasis>原作 &a.obrien; 26 April 1998</emphasis></para>
  <para><emphasis>訳: &a.jp.yoshiaki;. 19 July 1998.</emphasis></para>

  <para>1台だけディスクのあるマシンに新しい SCSI ディスクを追加する
    場合について述べましょう. まず, コンピュータの電源を切り,
    コンピュータにコントローラとドライブを接続します. これには
    様々な手順がありえるため詳細についてはこのドキュメントの範囲外
    です.</para>

  <para><username>root</username>ユーザとして login します.
    ドライブを接続した
    あとで <filename>/var/run/dmesg.boot</filename> を調べて,
    新しいドライブが
    認識されたことを確認します. 以下の例では, あたらしく加える
    ドライブは <filename>da1</filename> で
    <filename>/1</filename> へマウントしたいとします.
    (IDE ドライブを加える場合は<filename>da</filename> の代りに
    <filename>wd</filename>を使います)</para>

  <para>FreeBSD は IBM-PC 互換コンピュータで動作しますので,
    (訳注: 通常の場合では)
    ディスクは PC BIOS パーティションに属しなければなりません.
    これは伝統的な BSD パーティションとは異なります. PC のディスク
    は最大4までのエントリを持ちます. もしディスク全体を FreeBSD に
    わりあてるのであれば,
    <emphasis>ディスク全体を使用</emphasis>を選ぶことが
    できます. そうでないなら PC BIOS パーティションの一つに
    FreeBSD を入れることになります. FreeBSD では PC BIOS
    パーティションのことを <emphasis>slices</emphasis> と呼びます.
    伝統的な
    BSD パーティションと混同するのを防ぐためです. FreeBSD のために
    つくったスライスをつかうこともできますし, ほかの OS を
    インストールしてあるスライスをつかうこともできます.
    これは他のオペレーティングシステムの <command>fdisk</command>
    ユーティリティの混乱を引き起こしません.</para>

  <para>スライスをつかう場合, ドライブは
    <filename>/dev/da1s1e</filename> のよう
    な形で加えられます. これは, SCSI ディスクの, ユニット番号1
    (2台目の SCSI ディスク), スライス1 (PC BIOS パーティション1),
    <filename>e</filename> BSD パーティションという意味です.
    全体を割り当てる場合は, ドライブは  <filename>/dev/da1e</filename>
    という単純な形になります.</para>

  <sect1>
    <title>sysinstall を利用する</title>
    <!-- kuriyama - Should use command tag? -->

    <para><command>/stand/sysinstall</command>を利用すると,
      新しいディスクの
      パーティションやディスクラベルの設定をメニューから簡単に
      行うことができます.
      <username>root</username>ユーザで login するか
      <command>su</command> コマンドを使います.
      <command>/stand/sysinstall</command> を動かし,
      <literal>カスタム</literal> メニューに入ります.
      <literal>カスタムメニュー</literal> で
      <literal>パーティション</literal>
      を選びます. そうするとシステムに接続されているハードディスクの
      リストがあらわれるでしょう. <literal>da1</literal>
      がリストに無い場合は接続と
      <filename>/var/run/dmesg.boot</filename> にある
      <command>dmesg</command> の出力を
      チェックする必要があります.</para>
    <!-- kuriyama - カスタム is "Configure"? -->

    <para><literal>da1</literal>を選び, <literal>FDISK
	パーティションエディタ</literal> に入ります. ディスク全体を
      FreeBSD でつかうのであれば <literal>A</literal> を選びます.
      <quote>正しいパーティションエントリを保持して, このドライブには
	将来的に他のオペレーティングシステムを
	同居させる余地を残しますか?</quote> と聞かれますので,
      そうしたい場合は<literal>YES</literal> を選んでください.
      変更をディスクに書き込むには<command>W</command>
      コマンドを使います. FDISK
      エディタを終了するには<command>q</command>コマンドを使います.
      FDISK エディタを終了すると Master Boot Record
      について質問されます.
      すでに動いているシステムにディスクを追加するのですから
      <literal>None</literal> を選びます.</para>

    <para>次に <literal>ディスクラベルエディタ</literal>に入ります.
      ここで BSD の伝統的パーティションをつくります.
      ディスクには <literal>a</literal> から <literal>h</literal>
      までのラベルがついた
      8区画のパーティションをつくることができます.
      一部のパーティションのラベルについては特別に扱われます.
      <literal>a</literal> パーティションは root パーティション
      (<filename>/</filename>) に
      使われます. したがって, システムディスク(すなわち ブートを行う
      ディスク)に 1つだけ<literal>a</literal>
      パーティションをつくるべきです.
      <literal>b</literal>
      パーティションは swap パーティションとして使われ
      ます. swap パーティションは複数のディスク上につくっても
      かまいません. <literal>c</literal>
      パーティションは「ディスク全体を使用」
      としている場合はディスク全体をさします. スライスを利用している
      場合は FreeBSD のスライス全体をさします. そのほかの
      パーティションは一般的な目的に利用します.</para>

    <para>sysinstall のラベルエディタは root や swap 以外の
      パーティションでは <literal>e</literal>
      をつかうように勧めます.
      ラベルエディタでは単一のファイルシステムを作成するには
      <command>C</command> コマンドをつかいます.
      FS (ファイルシステム) か swap かを聞いてきますので
      <literal>FS</literal> を
      選びマウントポイントを入力(<filename>/mnt</filename>
      のように)します.
      インストール後の設定のモードではディスクの追加をするときに,
      sysinstall は <filename>/etc/fstab</filename>
      にエントリを作成しません.
      したがってここでのマウントポイントの入力は
      重要ではありません.</para>

    <para>これでディスクへのディスクラベルの書き込みと
      ファイルシステムの作成の準備ができました.
      <command>W</command> を
      押してください. sysinstall が新しいパーティションがマウント
      できないことについてエラーを出しますが無視してください.
      ラベルエディタから抜けて sysinstall を終了してください.</para>

    <para>最後のステップは <filename>/etc/fstab</filename>
      の編集で, 新しいディスクのエントリを追加します.</para>
  </sect1>

  <sect1>
    <title>コマンドラインユーティリティの利用</title>

    <sect2>
      <title>* スライスを利用する</title>

      <para></para>
    </sect2>

    <sect2>
      <title>ディスク全体を利用する</title>

      <para>新しいドライブを別のオペレーティングシステムで共有しない
	場合, ディスク全体を利用 (<literal>dedicated</literal> mode)
	することも
	できます. このモードではダメージが与えられるということは
	ありませんが Microsoft のオペレーティングシステムが混乱する
	ということを覚えておいてください.
	IBM の OS/2 では認識できない場合, すべて占有されていると
	解釈します.</para>

      <screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/rda1 bs=1k count=1</userinput>
&prompt.root; <userinput>disklabel -Brw da1 auto</userinput>
&prompt.root; <userinput>disklabel -e da1</userinput>				# `e' パーティションの作成
&prompt.root; <userinput>newfs -d0 /dev/rda1e</userinput>
&prompt.root; <userinput>mkdir -p /1</userinput>
+&prompt.root; <userinput>vi /etc/fstab</userinput>				# /dev/da1e のエントリ
&prompt.root; <userinput>mount /1</userinput></screen>

      <para>別の方法は:</para>

      <screen>&prompt.root; <userinput>dd if=/dev/zero of=/dev/rda1 count=2</userinput>
&prompt.root; <userinput>disklabel /dev/rda1 | disklabel -BrR da1 /dev/stdin</userinput>
&prompt.root; <userinput>newfs /dev/rda1e</userinput>
&prompt.root; <userinput>mkdir -p /1</userinput>
&prompt.root; <userinput>vi /etc/fstab</userinput>					# /dev/da1e のエントリ
&prompt.root; <userinput>mount /1</userinput></screen>
    </sect2>
  </sect1>

  <sect1>
    <title>* 伝統的なものとは異なるドライブ</title>

    <sect2>
      <title>* Zip ドライブ</title>

      <para></para>
    </sect2>

    <sect2>
      <title>* Jaz ドライブ</title>

      <para></para>
    </sect2>

    <sect2>
      <title>* Sequest ドライブ</title>

      <para></para>
    </sect2>
  </sect1>
</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../handbook.sgml" "part" "chapter")
     End:
-->
