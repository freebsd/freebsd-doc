<!DOCTYPE HTML PUBLIC "-//FreeBSD//DTD HTML 4.01 Transitional-Based Extension//EN" [
<!ENTITY base CDATA "../..">
<!ENTITY date "$FreeBSD$">
<!ENTITY title "Projet &java; pour FreeBSD : &jdk; 1.3">
<!ENTITY % navinclude.developers "INCLUDE">
]>

<!--
  The FreeBSD French Documentation Project
  Original revision: 1.15

  Version francaise : Stephane Legrand <stephane@freebsd-fr.org>
  Version francaise (mise a jour) : Stephane Legrand <stephane@freebsd-fr.org>
  Version francaise (mise a jour) : Vincent Tougait <viny@scientiae.net>
  Version francaise (mise a jour) : Antoine Brodin <antoine.brodin@laposte.net>
-->

<html>
&header;

<table border="0">
      <tr>
	<td>

<p>
<b>19 D&eacute;cembre 2003 :</b> <a href="mailto:glewis@FreeBSD.org">Greg
Lewis</a> a sorti un nouveau jeu de patches (version 9) pour le JDK 1.3.1
et a &eacute;galement mis &agrave; jour le port ports/java/jdk13. Ces nouveaux
patches sont, comme d'habitude, disponibles sur <a href=
"http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
<br>Cette nouvelle version contient de nombreuses corrections et am&eacute;liorations, il est donc recommand&eacute; de faire une mise &agrave jour
avant de signaler tout probl&egrave;me.
</p>

<p>
<b>12 F&eacute;vrier 2003 :</b> <a href="mailto:glewis@FreeBSD.org">Greg
Lewis</a> a sorti un nouveau jeu de patches (version 8) pour le &jdk; 1.3.1
et a &eacute;galement mis &agrave; jour le port ports/java/jdk13. Ces nouveaux
patches sont, comme d'habitude, disponibles sur <a href=
"http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
<br>Cette nouvelle version est la premi&egrave;re du JDK 1.3.1 &agrave; passer
les tests de compatibilit&eacute;s de Sun. Elle contient de nombreuses corrections et am&eacute;liorations, il est
donc recommand&eacute; de faire cette mise &agrave; jour avant de signaler tout probl&egrave;me.
</p>

<p>
<b>26 Juillet 2002 :</b> <a href="mailto:glewis@FreeBSD.org">Greg
Lewis</a> a sorti un nouveau jeu de patches (version 7) pour le JDK 1.3.1
et a &eacute;galement mis &agrave; jour le port ports/java/jdk13. Ces nouveaux
patches sont, comme d'habitude, disponibles sur <a href=
"http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
<br>Cette nouvelle version contient de nombreuses corrections et am&eacute;liorations, il est
donc recommand&eacute; de faire cette mise &agrave; jour avant de signaler tout probl&egrave;me.
</p>

<p>
<b>13 F&eacute;vrier 2002 :</b> <a href="mailto:glewis@FreeBSD.org">Greg
Lewis</a> a sorti un nouveau jeu de patches (version 6) pour le JDK 1.3.1
et a &eacute;galement mis &agrave; jour le port ports/java/jdk13. Ces nouveaux
patches sont, comme d'habitude, disponibles sur <a href=
"http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
<br>Cette nouvelle version contient de nombreuses corrections et am&eacute;liorations, il est
donc recommand&eacute; de faire cette mise &agrave; jour avant de signaler tout probl&egrave;me.
</p>

<p>
<b>16 Octobre 2001 :</b> <a href="mailto:glewis@FreeBSD.org">Greg
Lewis</a> a sorti un nouveau jeu de patches (version 5) pour le JDK 1.3.1
et a &eacute;galement mis &agrave; jour le port ports/java/jdk13. Ces nouveaux
patches sont, comme d'habitude, disponibles sur <a href=
"http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
<br>Cette nouvelle version contient de nombreuses corrections et am&eacute;liorations, il est
donc recommand&eacute; de faire cette mise &agrave; jour avant de signaler tout probl&egrave;me.
</p>

<p>
<b>10 Septembre 2001 :</b> <a href="mailto:glewis@FreeBSD.org">Greg
Lewis</a> a sorti un nouveau jeu de patches (version 4) pour le JDK 1.3.1
et a &eacute;galement mis &agrave; jour le port ports/java/jdk13. Ces nouveaux
patches sont, comme d'habitude, disponibles sur <a href=
"http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
<br>Cette nouvelle version contient de nombreuses corrections et am&eacute;liorations, il est
donc recommand&eacute; de faire cette mise &agrave; jour avant de signaler tout probl&egrave;me.
</p>

<p>
<b>27 Ao&ucirc;t 2001 :</b> <a href="mailto:glewis@FreeBSD.org">Greg Lewis</a>
a sorti le tant attendu port du JDK 1.3.1. Il peut maintenant &ecirc;tre compil&eacute;
&agrave; partir du r&eacute;pertoire ports/java/jdk13. Il faut not&eacute; que toutes les
remarques d&eacute;crites ci-dessous s'appliquent et qu'il s'agit toujours d'une version
<strong>uniquement &agrave; destination des d&eacute;veloppeurs</strong>. Il n'est pas
recommand&eacute; de l'utiliser en production.
</p>

<p>
<b>16 Juillet 2001 :</b> <a href="mailto:glewis@FreeBSD.org">Greg Lewis</a>
a sorti plusieurs patches pour les d&eacute;veloppeurs int&eacute;ress&eacute;s par la compilation d'une
version native du JDK&nbsp;1.3.1 pour FreeBSD. Il est &agrave; noter qu'il s'agit d'une
version <strong>uniquement &agrave; destination des d&eacute;veloppeurs</strong> et que cela ne
compilera pas une version fonctionnelle du JDK.
Ces patches sont rendus disponibles principalement afin que les personnes int&eacute;ress&eacute;es
puissent participer &agrave; ce projet de port en ayant une base pour commencer.
Ces patches ainsi qu'un r&eacute;sum&eacute; de la proc&eacute;dure de compilation sont disponibles sur
<A HREF="http://www.eyesbeyond.com/freebsddom/java/jdk13.html">http://www.eyesbeyond.com/freebsddom/java/jdk13.html</a>
</p>

<P><B>15 Septembre 2000 :</B> <a href="mailto:gallatin@cs.duke.edu">Andrew
 Gallatin</a> et <a href="mailto:sean@stat.Duke.EDU">Sean O'Connell</a>
travaillent actuellement &agrave; faire fonctionner le JDK 1.3 de IBM. Afin de le faire
fonctionner sur votre syst&egrave;me, vous devrez appliquer plusieurs patches au code source de FreeBSD.
Les patches sont disponibles sur :
<br>
<a href="http://www.cs.duke.edu/~gallatin/linux_sa_siginfo/4.0-release.diff">
4.0-RELEASE</a>
<br><a href="http://people.FreeBSD.org/~patrick/ibmjdk/linux.patch2">
4.0-STABLE</a>
<br><a href="http://www.cs.duke.edu/~gallatin/linux_sa_siginfo/diff">
-CURRENT</a> (pre-SMPng)

<P>Pour citer le message de Drew :
<br><pre>
Je suis finalement parvenu &agrave; faire fonctionner le jdk 1.3 de IBM. Je ne l'ai pas test&eacute;
de mani&egrave;re approfondie mais la partie AWT semble cependant enfin fonctionner.

Voici un nouveau jeu de patches &agrave; appliquer sur -current pre-SMPng. Les patches
concernent :

- changement de la valeur de MINSIGSTKSZ de 8192 &agrave; 2048
- impl&eacute;mentation de linux_rt_sendsig() & linux_rt_sigreturn()
- impl&eacute;mentation du code sigtramp c&ocirc;t&eacute; utilisateur pour linux_rt_sigreturn()
- impl&eacute;mentation de linux_to_bsd_sigaltstack & bsd_to_linux_sigaltstack() afin
        corriger un bug dans linux_sigaltstack & afin d'&eacute;viter des copies de code
        dans linux_rt_sigreturn(). Cela corrige &eacute;galement le "Java HotSpot(TM)
        Client VM warning: cannot uninstall alt signal stack" qui appara&icirc;t avec
        le JDK 1.3 de Sun.
- changement du drapeau MAP_STACK &agrave; MAP_ANON pour les mmaps de
        LINUX_MAP_GROWSDOWN. Cela a &eacute;t&eacute; l'&eacute;tape finale pour que les choses fonctionnent.
        Y-a-t'il des gourous de la VM pour en discuter ? Il y a apparemment
        un probl&egrave;me avec les piles &agrave; taille dynamique sur les threads linux [*]

Patches disponibles sur : http://www.cs.duke.edu/~gallatin/linux_sa_siginfo/diff

[*]Le "probl&egrave;me" est l'heuristique utilis&eacute; par vm_map_growstack() afin de
d&eacute;terminer la part de la pile dans le processus principale. Nous
utilisons actuellement :

        is_procstack = addr >= (vm_offset_t)vm->vm_maxsaddr;

o&ugrave; vm->vm_maxsaddr provient de exec_new_vmspace():
        vmspace->vm_maxsaddr = (char *)USRSTACK - MAXSSIZ;

Le thread principal du JDK de IBM r&eacute;duit sa taille de pile &agrave; rlim_cur=2040*1024.
Il cr&eacute;&eacute; alors des piles pour ses threads &agrave; des adresses sup&eacute;rieures
&agrave; vm_maxsaddr mais inf&eacute;rieures &agrave; la limite basse courante de la pile du processus
principal d&eacute;fini par p->p_rlimit[RLIMIT_STACK].rlim_cur. La premi&egrave;re fois
qu'un thread acc&egrave;de &agrave; quelque chose qui recquiert une extension de cette r&eacute;gion, il part
en vrilles.
</pre>

<P>Et le courrier &eacute;lectronique de Sean :
<pre>
J'ai tr&egrave;s rapidement port&eacute; sur -stable le travail de Andrew Gallatin pour faire
fonctionner le SDK Java de IBM. J'ai pu utilis&eacute; le lanceur d'applet sur une
des d&eacute;mos et cela a fonctionn&eacute;. Je ne peux pas vraiment en dire plus.

Les patches sont tous relatifs au r&eacute;pertoire /usr/src (ou / puisqu'ils sont
tous dans sys)

La majorit&eacute; des patches concernent les fichiers du r&eacute;pertoire /sys/i386/linux.
Vous devez appliquer les patches; faire un cd sur /sys/modules/linux;
taper make; kldunload linux; taper make install; et kldload linux

Il y a une modification suppl&eacute;mentaire qui met MINSIGSTKSZ &agrave; 2048
dans sys/sys/signal.h .. cela n&eacute;cessite une recompilation du noyau afin
que cette modification soit prise en compte.
</pre>

<P><B>18 Juillet 2000 :</B> <a href="ernst@jollem.com">Ernst de Haan</a>
travaillent actuellement &agrave; faire fonctionner la version Linux du JDK 1.3.0b9 de Sun
sur 4.0-STABLE. Le fichier .java_wrapper est disponible
<a href="http://people.FreeBSD.org/~patrick/sunjdk/java_wrapper">
ici</a>. (N'oubliez pas de le renommer en .java_wrapper)

<P>Le courrier &eacute;lectronique de Ernst :
<pre>
Juste une derni&egrave;re astuce : modifiez le fichier jre/lib/jvm.cfg et placez la derni&egrave;re
ligne en premier. Vous aurez donc :

   -classic
   -hotspot
   -server

J'obtiens un warning, par ailleurs, avec l'application Swing :

   Warning: Cannot convert string "MetaCtrl&lt;Key&gt;Insert" to type VirtualBinding

Ernst


Ernst de Haan a &eacute;crit :
> Bonjour &agrave; tous,
>
> Je parviens &agrave; faire fonctionner la version Linux du JDK 1.3.0 beta 9 de Sun
> sur mon syst&egrave;me FreeBSD 4.0-STABLE. Il fonctionne par ailleurs plut&ocirc;t bien.
>
> java -version indique :
>
>    bash-2.04$ java -version
>    expr: syntax error
>    java version "1.3.0beta_refresh"
>    Java(TM) 2 Runtime Environment, Standard Edition (build 1.3.0beta_refresh-b09)
>    Classic VM (build 1.3.0beta_refresh-b09, green threads, nojit)
>
> La premi&egrave;re ligne avec l'erreur de syntaxe est un petit probl&egrave;me li&eacute; au fichier
> .java_wrapper mais il est &agrave; priori inoffensif. J'ai du faire quelques modifications
> au script .java_wrapper afin de le faire fonctionner sur mon syst&egrave;me. J'ai mis en attachement
> la version que j'utilise.
>
> Je n'ai pas encore r&eacute;alis&eacute; beaucoup de tests mais j'ai essay&eacute; une application
> Swing. J'ai constat&eacute; quelques diff&eacute;rences au niveau des fontes sinon tout semble
> fonctionner plut&ocirc;t bien et rapidement :)
>
> Wow, bient&ocirc;t FreeBSD sera la plate-forme avec le plus grand nombre de
> JDKs, une fois que nous aurons un WINE fonctionnel ce qui nous permettra d'utiliser
> &eacute;galement les JDKs Windows, et que nous aurons &eacute;crit un &eacute;mulateur
> AS/400, et... et... ;-)
>
> Ernst
>
> P.S.  Merci &agrave; Victor Salaman qui m'a orient&eacute; vers la bonne direction.
>       Il fait fonctionner la version Linux du JDK 1.3 de Sun depuis quelque temps d&eacute;j&agrave;.
</pre>

<P><B>29 Janvier 2000 :</B> Le port du JDK 1.3 n'a pas commenc&eacute;.
Il ne d&eacute;butera pas avant que celui du JDK 1.2 ne soit achev&eacute;.

</td>
</tr>
</TABLE>
&footer;
</BODY>
</HTML>
