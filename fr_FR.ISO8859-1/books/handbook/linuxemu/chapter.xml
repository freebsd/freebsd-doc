<?xml version="1.0" encoding="iso-8859-1"?>
<!--
     The FreeBSD Documentation Project
     The FreeBSD French Documentation Project

     $FreeBSD$
     Original revision: 1.136
-->

<chapter id="linuxemu">
  <chapterinfo>
    <authorgroup>
      <author>
	<firstname>Jim</firstname>
	<surname>Mock</surname>
	<contrib>Restructuré et en partie mis &agrave; jour
	  par </contrib>
      </author>
      <!-- 22 Mar 2000 -->
    </authorgroup>
    <authorgroup>
      <author>
	<firstname>Brian N.</firstname>
	<surname>Handy</surname>
	<contrib>Contribution originelle de </contrib>
      </author>
      <author>
	<firstname>Rich</firstname>
	<surname>Murphey</surname>
      </author>
    </authorgroup>
  </chapterinfo>

  <title>Compatibilité binaire avec Linux</title>
  &trans.a.fonvieille;

  <sect1 id="linuxemu-synopsis">
    <title>Synopsis</title>
    <indexterm><primary>compatibilité binaire avec Linux</primary></indexterm>
    <indexterm>
      <primary>compatibilité binaire</primary>
      <secondary>Linux</secondary>
    </indexterm>

    <para>&os; fournit une compatibilité binaire avec plusieurs autres
      systèmes d'exploitation du type &unix;, y compris Linux.
      A ce point, vous devez vous demander pourquoi exactement
      &os; a besoin d'être capable d'exécuter des binaires Linux?
      La réponse &agrave; cette question est très simple.  De
      nombreuses entreprises et de nombreux développeurs ne
      développent que pour Linux, puisque que c'est la dernière
      chose &ldquo;&agrave; la mode&rdquo; dans le monde de l'informatique.
      Cela ne laisse aux utilisateurs de &os; que la possibilité
      de réclamer auprès des ces mêmes entreprises
      et développeurs des versions native pour &os; de leurs
      applications.  Le problème est, que la plupart de ces
      entreprises ne réalisent pas vraiment combien de personnes
      utiliseraient leur produit si il y aurait une version pour &os;
      également, et la plupart continuent de développer uniquement
      pour Linux.  Donc que doit faire un utilisateur de &os;?
      C'est l&agrave; que la compatibilité binaire avec Linux entre en
      scène.</para>

    <para>En bref, la compatibilité permet aux utilisateurs de
      &os; d'exécuter environ 90% des applications Linux
      sans aucune modification.  Cela inclus des applications
      comme <application>&staroffice;</application>,
      la version Linux de <application>&netscape;</application>,
      <application>&adobe;&nbsp;&acrobat;</application>,
      <application>&realplayer;</application>,
      <application><trademark>VMware</trademark></application>,
      <application>&oracle;</application>,
      <application>&wordperfect;</application>, <application>Doom</application>,
      <application>Quake</application>, et plus.  On rapporte
      également que dans certaines situations, les binaires Linux
      sont plus performants sous &os; que sous Linux.</para>

    <para>Il existe cependant certaines caractéristiques
      spécifiques &agrave; Linux qui ne sont pas
      supportées sous &os;.  Les binaires Linux ne
      fonctionneront pas sous &os; s'ils utilisent massivement
      des appels
      &i386; spécifiques, comme activation du mode virtuel
      8086.</para>

    <para>Après la lecture de ce chapitre, vous connaîtrez:</para>
    <itemizedlist>
      <listitem>
	<para>Comment activer la compatibilité binaire avec
	  Linux sur votre système.</para>
      </listitem>

      <listitem>
	<para>Comment installer des bibliothèques partagées Linux
	  supplémentaires.</para>
	</listitem>

      <listitem>
	<para>Comment installer des application Linux sur votre
	  système &os;.</para>
      </listitem>

      <listitem>
	<para>Les détails de l'implémentation de la
	  compatibilité Linux sous &os;.</para>
      </listitem>
    </itemizedlist>

    <para>Avant de lire ce chapitre, vous devrez:</para>

    <itemizedlist>
      <listitem>
	<para>Savoir comment installer des logiciels tiers
	  (<xref linkend="ports"/>).</para>
      </listitem>
    </itemizedlist>

  </sect1>

  <sect1 id="linuxemu-lbc-install">
    <title>Installation</title>

    <indexterm><primary>KLD (kernel loadable object)</primary></indexterm>

    <para>La compatibilité binaire avec Linux n'est pas
      activée par défaut.  La manière la plus simple
      pour activer cette fonctionnalité est de charger le KLD
      <literal>linux</literal> (<quote>Kernel LoaDable
      object</quote>&mdash;objet chargeable par le noyau, ce que l'on
      nomme couramment un module).  Vous pouvez charger ce module
      en tapant ce qui suit sous l'utilisateur
      <username>root</username>:</para>

    <screen>&prompt.root; <userinput>kldload linux</userinput></screen>

    <para>Si vous désirez que la compatibilité Linux soit
      toujours activée, alors vous devrez ajouter la ligne
      suivante au fichier <filename>/etc/rc.conf</filename>:</para>

    <programlisting>linux_enable="YES"</programlisting>

    <para>La commande &man.kldstat.8; peut être utilisée
      pour vérifier que le KLD est chargé:</para>

    <screen>&prompt.user; <userinput>kldstat</userinput>
Id Refs Address    Size     Name
 1    2 0xc0100000 16bdb8   kernel
 7    1 0xc24db000 d000     linux.ko</screen>

    <indexterm>
      <primary>options du noyau</primary>
      <secondary>LINUX</secondary>
    </indexterm>

    <para>Si pour quelques raisons vous ne voulez ou pouvez charger le
      KLD, alors vous pouvez lier statiquement la compatibilité
      binaire Linux dans votre noyau en ajoutant <literal>options
      COMPAT_LINUX</literal> &agrave; votre fichier de configuration du noyau.
      Puis installez votre noyau comme décrit dans la
      <xref linkend="kernelconfig"/>.</para>

    <sect2>
      <title>Installer les bibliothèques Linux</title>
      <indexterm>
	<primary>Linux</primary>
	<secondary>installer les bibliothèques Linux</secondary>
      </indexterm>

      <para>Cela peut être fait de deux manières, soit
	en utilisant le logiciel porté
	<link linkend="linuxemu-libs-port">linux_base</link>, soit
	en les installant <link
	linkend="linuxemu-libs-manually">&agrave; la main</link>.</para>

      <sect3 id="linuxemu-libs-port">
	<title>Installation &agrave; l'aide du logiciel porté
	  linux_base</title>
	<indexterm><primary>catalogue des logiciels
	  portés</primary></indexterm>

	<para>C'est de loin la méthode la plus simple pour
	  installer les bibliothèques.  La procédure est
	  juste identique &agrave; l'installation d'un autre logiciel
	  porté &agrave; partir du
	  <ulink type="html" url="file://localhost/usr/ports/">catalogue
	  des logiciels portés</ulink>.
	  Faites ce qui suit:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/emulators/linux_base-fc4</userinput>
&prompt.root; <userinput>make install distclean</userinput></screen>

	<para>La compatibilité binaire Linux devrait maintenant
	  fonctionner.  Certains programmes pourront se plaindre de
	  versions mineures incorrectes de certaines bibliothèques
	  systèmes.  Cela semble, en général, ne pas
	  vraiment être un problème.</para>

	<note><para>Il peut y avoir de multiples versions disponibles
	  du logiciel porté <filename
	  role="package">emulators/linux_base</filename>, correspondant
	  &agrave; différentes distributions et versions de Linux.
	  Vous devez installez la version la plus proche de ce que
	  nécessite les applications Linux que vous désirez
	  installer.</para></note>
      </sect3>

      <sect3 id="linuxemu-libs-manually">
	<title>Installer les bibliothèques &agrave; la main</title>

	<para>Si vous n'avez pas le catalogue des logiciels
	  portés installé, vous pouvez &agrave; la
	  place installer les bibliothèques &agrave; la main.
	  Il vous faudra les bibliothèques partagées
	  Linux dont &agrave; besoin le programme et l'éditeur
	  de lien dynamiques.  Vous devrez également
	  créer un répertoire racine
	  &ldquo;masquant&rdquo; (&ldquo;shadow root&rdquo;),
	  <filename>/compat/linux</filename>, pour les
	  bibliothèques Linux sur votre système &os;.
	  Toute bibliothèque partagée ouverte par les
	  programmes Linux exécutés sous &os; iront d'abord voir
	  dans cette arborescence.  Ainsi, si un programme Linux
	  charge, par exemple, <filename>/lib/libc.so</filename>,
	  &os; essayera d'abord d'ouvrir
	  <filename>/compat/linux/lib/libc.so</filename>, puis si
	  cette bibliothèque n'existe pas,
	  <filename>/lib/libc.so</filename>.  Les bibliothèques
	  partagées doivent donc être installées
	  sous l'arborescence <filename>/compat/linux/lib</filename>
	  plutôt que sous les chemins d'accès
	  mentionnés par la commande Linux
	  <command>ld.so</command>.</para>

	<para>Généralement, vous ne devrez cherchez &agrave;
	  savoir de quelles bibliothèques partagées
	  dépendent les binaires Linux que les premières
	  fois que vous installerez des programmes Linux sur votre
	  système &os;.  Au bout d'un moment, vous disposerez
	  d'un jeu suffisant de bibliothèques partagées
	  Linux sur votre système pour être en mesure
	  d'exécuter les binaires Linux nouvellement
	  importés sans effort supplémentaire.</para>
      </sect3>

      <sect3>
	<title>Comment installer des bibliothèques
	  partagées supplémentaires</title>
	<indexterm><primary>bibliothèques
	  partagées</primary></indexterm>

	<para>Que faire si vous avez installé le logiciel
	  porté <filename>linux_base</filename> et que votre
	  application se plaint toujours qu'il lui manque des
	  bibliothèques partagées?
	  Comment savoir quelles bibliothèques partagées
	  ont besoin les binaires Linux, et où se les
	  procurer?  Il a habituellement deux possibilités
	  (pour suivre les instructions ci-dessous, vous devrez
	  être en session sous le compte super-utilisateur
	  <username>root</username>).</para>

	<para>Si vous avez accès &agrave; un système
	  Linux, déterminez de quelles bibliothèques
	  partagées l'application a besoin, et copiez-les sur
	  votre système &os;.  Soit l'exemple suivant:</para>

	<informalexample>
	  <para>Supposons que vous veniez de télécharger
	    le binaire Linux de <application>Doom</application>,
	    et que vous l'avez installé sur un système
	    Linux.  Vous pouvez alors vérifier de quelles
	    bibliothèques partagées il a besoin pour
	    fonctionner avec la commande
	    <command>ldd linuxdoom</command>:</para>

	  <screen>&prompt.user; <userinput>ldd linuxdoom</userinput>
libXt.so.3 (DLL Jump 3.1) =&gt; /usr/X11/lib/libXt.so.3.1.0
libX11.so.3 (DLL Jump 3.1) =&gt; /usr/X11/lib/libX11.so.3.1.0
libc.so.4 (DLL Jump 4.5pl26) =&gt; /lib/libc.so.4.6.29</screen>

	  <indexterm><primary>liens symboliques</primary></indexterm>
	  <para>Vous devrez récupérer tous les
	    fichiers mentionnés dans la dernière colonne,
	    et les installer sous <filename>/compat/linux</filename>,
	    en utilisant les noms de la première colonne comme
	    liens symboliques qui pointent dessus.  Cela signifie
	    que vous aurez éventuellement les fichiers suivants
	    sur votre système &os;:</para>

	  <screen>/compat/linux/usr/X11/lib/libXt.so.3.1.0
/compat/linux/usr/X11/lib/libXt.so.3 -&gt; libXt.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3.1.0
/compat/linux/usr/X11/lib/libX11.so.3 -&gt; libX11.so.3.1.0
/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</screen>

	  <blockquote>
	    <note>
	      <para>Remarquez que si vous avez déj&agrave;
		une bibliothèque partagée de même
		numéro de version majeure que celle indiquée
		par la première colonne du résultat
		de la commande <command>ldd</command>, il est inutile
		de copier le fichier donné par la dernière
		colonne sur votre système, celui que vous
		avez déj&agrave; devrait suffire.
		Il est cependant recommandé de recopier
		malgré tout la bibliothèque partagée
		si c'est une version récente.
		Vous pouvez supprimer l'ancienne version, du moment
		que le lien symbolique pointe sur la nouvelle.  Par
		exemple, si vous avez les bibliothèques suivantes
		sur votre système:</para>

	      <screen>/compat/linux/lib/libc.so.4.6.27
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.27</screen>

	      <para>et que vous avez un nouveau binaire qui
		d'après le résultat de la commande
		<command>ldd</command> semble avoir besoin d'une
		version plus récente:</para>

	      <screen>libc.so.4 (DLL Jump 4.5pl26) -&gt; libc.so.4.6.29</screen>
	      <para>Si vous n'avez qu'une ou deux versions de retard
		sur le dernier indice, alors ne vous souciez pas
		d'installer la version
		<filename>/lib/libc.so.4.6.29</filename> plus
		récente, parce que le programme devrait fonctionner
		sans problème avec une version
		légèrement antérieure.
		Vous pouvez néanmoins décider de remplacer
		<filename>libc.so</filename>, ce qui devrait vous
		donner quelque chose comme:</para>

	      <screen>/compat/linux/lib/libc.so.4.6.29
/compat/linux/lib/libc.so.4 -&gt; libc.so.4.6.29</screen>
	    </note>
	  </blockquote>

	  <blockquote>
	    <note>
	      <para>Le mécanisme de lien symbolique n'est
		nécessaire que pour les binaires Linux.
		L'éditeur de liens dynamiques de &os;
		se charge lui-même de trouver les numéros
		de versions majeures adéquats et vous
		n'avez pas &agrave; vous en préoccuper.</para>
	    </note>
	  </blockquote>
	</informalexample>
      </sect3>
    </sect2>

    <sect2>
      <title>Installer des binaires Linux ELF</title>
      <indexterm>
	<primary>Linux</primary>
	<secondary>binaires ELF</secondary>
      </indexterm>

      <para>Une étape supplémentaire est parfois
	nécessaire pour les binaires ELF: le
	&ldquo;marquage&rdquo;.  Si vous tentez d'exécuter un
	binaire ELF non marqué, vous obtiendrez un message
	d'erreur ressemblant &agrave; ce qui suit:</para>

      <screen>&prompt.user; <userinput>./mon-binaire-elf-linux</userinput>
ELF binary type not known
Abort</screen>

      <para>Pour que le noyau &os; puisse distinguer un binaire ELF
	&os; d'un binaire Linux, vous devez employer l'utilitaire
	&man.brandelf.1;:</para>

      <screen>&prompt.user; <userinput>brandelf -t Linux mon-binaire-elf-linux</userinput></screen>

      <indexterm><primary>outils GNU</primary></indexterm>
      <para>Les outils GNU incorporent désormais automatiquement
	les marques nécessaires dans les binaires ELF, vous
	aurez donc de moins en moins besoin de passer par cette
	étape &agrave; l'avenir.</para>
    </sect2>

    <sect2>
      <title>Configurer le résolveur de noms de domaines</title>

      <para>Si le DNS ne fonctionne pas, ou si vous avez les
	messages:</para>

      <screen>resolv+: "bind" is an invalid keyword resolv+:
"hosts" is an invalid keyword</screen>

      <para>Vous devrez configurer un fichier
	<filename>/compat/linux/etc/host.conf</filename>
	contenant:</para>

      <programlisting>order hosts, bind
multi on</programlisting>

      <para>Où l'ordre ci-dessus spécifie qu'il faut tout
	d'abord regarder dans le fichier <filename>/etc/hosts</filename>
	puis interroger le DNS.  Quand le fichier
	<filename>/compat/linux/etc/host.conf</filename> n'existe pas,
	les applications Linux trouvent le fichier
	<filename>/etc/host.conf</filename> de &os; et se plaignent de
	sa syntaxe &os; incompatible.  Supprimez
	<literal>bind</literal> si vous n'avez pas configuré de
	serveur de noms avec le fichier
	<filename>/etc/resolv.conf</filename>.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-mathematica">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Boris</firstname>
	  <surname>Hollas</surname>
	  <contrib>Mis &agrave; jour pour &mathematica; 5.X par </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Installer &mathematica;</title>

    <indexterm>
      <primary>applications</primary>
      <secondary><application>Mathematica</application></secondary>
    </indexterm>

    <para>Ce document décrit l'installation de la version Linux
      de <application>&mathematica; 5.X</application> sur un
      système &os;.</para>

    <para>La version Linux de <application>&mathematica;</application>
      ou la version <application>&mathematica; for Students</application>
      peut être commandée directement auprès de
      Wolfram &agrave; l'adresse
      <ulink url="http://www.wolfram.com/"></ulink>.</para>

    <sect2>
      <title>Utiliser l'installeur &mathematica;</title>

      <para>En premier lieu vous devez indiquer &agrave; &os;
	que les binaires Linux de
	<application>&mathematica;</application> utilisent l'ABI
	Linux.  La méthode la plus simple pour y parvenir est
	le marquage par défaut des binaires ELF non marqués
	comme étant des binaires Linux, ce marquage se faisant
	avec la commande:</para>

      <screen>&prompt.root; <userinput>sysctl kern.fallback_elf_brand=3</userinput></screen>

      <para>Avec cela &os; supposera que les binaires ELF non
	marqués sont des binaires Linux, et donc vous devriez
	être en mesure d'exécuter le programme d'installation
	directement depuis le CDROM.</para>

      <para>Copiez ensuite sur votre disque dur le fichier
	<filename>MathInstaller</filename>:</para>

      <screen>&prompt.root; <userinput>mount /cdrom</userinput>
&prompt.root; <userinput>cp /cdrom/Unix/Installers/Linux/MathInstaller /localdir/</userinput></screen>

      <para>et dans ce fichier, remplacez <literal>/bin/sh</literal>
	sur la première ligne par
	<literal>/compat/linux/bin/sh</literal>.  Cela permet de
	garantir que l'installeur est exécuté par la
	version Linux de &man.sh.1;.  Ensuite, remplacez toutes les
	occurrences de <literal>Linux)</literal> par
	<literal>FreeBSD)</literal> &agrave; l'aide d'un
	éditeur de texte ou la procédure proposée
	dans la section suivante.  Cela indique &agrave; l'installeur
	<application>&mathematica;</application>, qui fait appel
	&agrave; la commande <command>uname -s</command> pour
	déterminer le système d'exploitation, de traiter
	&os; comme un système d'exploitation de type Linux.
	Lancer maintenant la commande <command>MathInstaller</command>
	procédera &agrave; l'installation de
	<application>&mathematica;</application>.</para>
    </sect2>

    <sect2>
      <title>Modifier les exécutables &mathematica;</title>

      <para>Les procédures que
	<application>&mathematica;</application> a créé
	lors de l'installation doivent être modifiées
	avant que vous ne puissiez les utiliser.  Si vous avez choisi
	<filename class="directory">/usr/local/bin</filename> comme
	répertoires pour les exécutables
	<application>&mathematica;</application>, vous trouverez alors
	dans ce répertoire des liens symboliques vers les
	fichiers nommés <filename>math</filename>,
	<filename>mathematica</filename>,
	<filename>Mathematica</filename>, et
	<filename>MathKernel</filename>.  Dans chacun d'entre eux,
	remplacez <literal>Linux)</literal> par
	<literal>FreeBSD)</literal> avec un éditeur de texte ou
	la procédure suivante:</para>

      <programlisting>#!/bin/sh
cd /usr/local/bin
for i in math mathematica Mathematica MathKernel
  do sed 's/Linux)/FreeBSD)/g' $i &gt; $i.tmp
  sed 's/\/bin\/sh/\/compat\/linux\/bin\/sh/g' $i.tmp &gt; $i
  rm $i.tmp
  chmod a+x $i
done</programlisting>
    </sect2>

    <sect2>
      <title>Obtenir votre mot de passe pour &mathematica;</title>

      <indexterm>
	<primary>Ethernet</primary>
	<secondary>adresse MAC</secondary>
      </indexterm>

      <para>Quand vous lancez <application>&mathematica;</application>
	pour la première fois, un mot de passe vous sera
	demandé.  Si vous n'avez pas encore
	récupéré votre mot de passe auprès
	de Wolfram, lancez le programme <command>mathinfo</command>
	présent dans le répertoire d'installation afin
	d'obtenir l'<quote>identifiant</quote> de votre machine.  Cet
	identifiant de machine est basé uniquement sur
	l'adresse MAC de votre première carte Ethernet, vous ne
	pouvez donc pas utiliser votre copie de
	<application>&mathematica;</application> sur une machine
	différente.</para>

      <para>Quand vous vous enregistrez auprès de Wolfram,
	par courrier électronique, téléphone, ou
	fax, vous leur communiquerez l'&ldquo;identifiant&rdquo; de la
	machine et ils vous donneront en réponse le mot
	de passe correspondant qui a la forme de plusieurs groupes
	de nombres.</para>
    </sect2>

    <sect2>
      <title>Exécuter l'interface de &mathematica; via le
	réseau</title>

      <para><application>&mathematica;</application> utilise des polices
	de caractères spécifiques pour afficher des
	caractères qui ne sont pas présents dans
	l'ensemble standard de polices (caractère
	intégrale, somme, lettres grecques, etc.).
	Le protocole X a besoin que ces polices
	de caractères soient installées
	<emphasis>localement</emphasis>.  Cela signifie que vous devrez
	copier sur votre machine locale ces polices &agrave; partir du
	CDROM ou d'une machine avec
	<application>&mathematica;</application> installé.  Ces
	polices sont normalement stockées dans
	<filename>/cdrom/Unix/Files/SystemFiles/Fonts</filename> sur
	le CDROM, ou dans
	<filename>/usr/local/mathematica/SystemFiles/Fonts</filename>
	sur votre disque dur.  En fait les polices sont dans les
	sous-répertoires <filename>Type1</filename> et
	<filename>X</filename>.  Il existe différentes manières
	de les utiliser, comme décrit ci-dessous.</para>

      <para>La première manière est de les copier dans
	un des répertoires de polices de caractères existant
	dans <filename>/usr/X11R6/lib/X11/fonts</filename>.
	Il faudra alors éditer le fichier
	<filename>fonts.dir</filename>, y ajouter les noms des
	polices, et changer le nombre de polices sur la première
	ligne.  Alternativement, vous devriez pouvoir juste
	exécuter &man.mkfontdir.1; dans le répertoire
	dans lequel vous avez copié les polices de
	caractères.</para>

      <para>La deuxième manière est de copier les
	répertoires dans
	<filename>/usr/X11R6/lib/X11/fonts</filename>:</para>

      <screen>&prompt.root; <userinput>cd /usr/X11R6/lib/X11/fonts</userinput>
&prompt.root; <userinput>mkdir X</userinput>
&prompt.root; <userinput>mkdir MathType1</userinput>
&prompt.root; <userinput>cd /cdrom/Unix/Files/SystemFiles/Fonts</userinput>
&prompt.root; <userinput>cp X/* /usr/X11R6/lib/X11/fonts/X</userinput>
&prompt.root; <userinput>cp Type1/* /usr/X11R6/lib/X11/fonts/MathType1</userinput>
&prompt.root; <userinput>cd /usr/X11R6/lib/X11/fonts/X</userinput>
&prompt.root; <userinput>mkfontdir</userinput>
&prompt.root; <userinput>cd ../MathType1</userinput>
&prompt.root; <userinput>mkfontdir</userinput></screen>

      <para>Maintenant ajoutez les nouveaux répertoires de
	polices &agrave; votre chemin de recherche des polices
	de caractères:</para>

      <screen>&prompt.root; <userinput>xset fp+ /usr/X11R6/lib/X11/fonts/X</userinput>
&prompt.root; <userinput>xset fp+ /usr/X11R6/lib/X11/fonts/MathType1</userinput>
&prompt.root; <userinput>xset fp rehash</userinput></screen>

      <para>Si vous utilisez le serveur
	<application>&xorg;</application>, vous pouvez charger
	ces répertoires de polices automatiquement en les
	ajoutant &agrave; votre fichier
	<filename>xorg.conf</filename>.</para>

      <note>
	<para>Sous les serveurs <application>&xfree86;</application>,
	  le fichier de configuration se nomme
	  <filename>XF86Config</filename>.</para>
      </note>

      <indexterm><primary>polices de caractères</primary></indexterm>

      <para>Si vous <emphasis>n'avez pas</emphasis> déj&agrave;
	de répertoire appelé
	<filename>/usr/X11R6/lib/X11/fonts/Type1</filename>, vous
	pouvez modifier le nom du répertoire
	<filename>MathType1</filename> dans l'exemple ci-dessus par
	<filename>Type1</filename>.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-maple">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Aaron</firstname>
	  <surname>Kaplan</surname>
<!--	  <address><email>aaron@lo-res.org</email></address>-->
	  <contrib>Contribution de </contrib>
	</author>
      </authorgroup>
      <authorgroup>
	<author>
	  <firstname>Robert</firstname>
	  <surname>Getschmann</surname>
<!--	  <address><email>rob@getschmann.org</email></address>-->
	  <contrib>Remerciements &agrave; </contrib>
	</author>
      </authorgroup>
    </sect1info>
    <title>Installer &maple;</title>

    <indexterm>
      <primary>applications</primary>
      <secondary><application>Maple</application></secondary>
    </indexterm>

    <para><application>&maple;</application> est un programme
      mathématique commercial similaire &agrave;
      <application>&mathematica;</application>.  Vous devez
      acquérir ce logiciel auprès de
      <ulink url="http://www.maplesoft.com/"></ulink> et vous
      enregistrer pour obtenir un fichier de licence.  Pour installer
      ce logiciel sous &os;, veuillez suivre les étapes
      suivantes:</para>

      <procedure>
	<step>
	  <para>Exécutez la procédure
	    <filename>INSTALL</filename> fournie avec le logiciel.
	    Choisissez l'option &ldquo;RedHat&rdquo; quand le
	    programme vous le demandera.  Un répertoire
	    d'installation typique devrait être:
	    <filename
	    class="directory">/usr/local/maple</filename>.</para></step>

        <step>
	  <para>Si vous ne l'avez pas déj&agrave; fait,
	    demandez une licence pour
	    <application>&maple;</application> auprès de
	    Maple Waterloo Software (<ulink
	    url="http://register.maplesoft.com/"></ulink>) et
	    copiez-la sous
	    <filename>/usr/local/maple/license/license.dat</filename>.</para></step>

        <step>
	  <para>Installez le gestionnaire de licence
	    <application>FLEXlm</application> en exécutant la
	    procédure d'installation
	    <filename>INSTALL_LIC</filename> fournie avec
	    <application>&maple;</application>.  Précisez
	    le nom de la machine au serveur de licence.</para></step>

        <step>
	  <para>Modifiez le fichier
	    <filename>/usr/local/maple/bin/maple.system.type</filename>
	    avec le correctif suivant:</para>

<programlisting>   ----- snip ------------------
*** maple.system.type.orig      Sun Jul  8 16:35:33 2001
--- maple.system.type   Sun Jul  8 16:35:51 2001
***************
*** 72,77 ****
--- 72,78 ----
          # the IBM RS/6000 AIX case
          MAPLE_BIN="bin.IBM_RISC_UNIX"
          ;;
+     "FreeBSD"|\
      "Linux")
          # the Linux/x86 case
        # We have two Linux implementations, one for Red Hat and
   ----- snip end of patch -----</programlisting>

	<para>Remarquez qu'après
	  <literal>"FreeBSD"|\</literal> aucun espace ne doit
	  être ajouté.</para>

	<para>Ce correctif demande &agrave;
	  <application>&maple;</application> de reconnaître
	  &ldquo;FreeBSD&rdquo; comme étant un type de
	  système Linux.  La procédure
	  <filename>bin/maple</filename> fait appel &agrave; la
	  procédure
	  <filename>bin/maple.system.type</filename> qui &agrave; son
	  tour appelle <command>uname -a</command> pour déterminer
	  le nom du système d'exploitation.  En fonction de ce
	  nom, la procédure déterminera quels binaires
	  utiliser.</para></step>

      <step>
	<para>Lancez le serveur de licence.</para>

	<para>La procédure suivante, installée sous le
	  nom <filename>/usr/local/etc/rc.d/lmgrd.sh</filename>
	  est une façon pratique de lancer
	  <command>lmgrd</command>:</para>

	<programlisting>   ----- snip ------------

#! /bin/sh
PATH=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/usr/X11R6/bin
PATH=${PATH}:/usr/local/maple/bin:/usr/local/maple/FLEXlm/UNIX/LINUX
export PATH

LICENSE_FILE=/usr/local/maple/license/license.dat
LOG=/var/log/lmgrd.log

case "$1" in
start)
	lmgrd -c ${LICENSE_FILE} 2&gt;&gt; ${LOG} 1&gt;&amp;2
	echo -n " lmgrd"
	;;
stop)
	lmgrd -c ${LICENSE_FILE} -x lmdown 2&gt;&gt; ${LOG} 1&gt;&amp;2
	;;
*)
	echo "Usage: `basename $0` {start|stop}" 1&gt;&amp;2
	exit 64
	;;
esac

exit 0
   ----- snip ------------</programlisting></step>


      <step>
	<para>Testez <application>&maple;</application>:</para>

	<screen>&prompt.user; <userinput>cd /usr/local/maple/bin</userinput>
&prompt.user; <userinput>./xmaple</userinput></screen>

	<para>Cela devrait fonctionner.  Assurez-vous d'écrire
	  &agrave; Maplesoft pour leur indiquer que vous désirez
	  une version native pour &os;!</para>
      </step>
    </procedure>

    <sect2>
      <title>Pièges courants</title>

      <itemizedlist>
	<listitem>
	  <para>Le gestionnaire de licence
	    <application>FLEXlm</application> peut être
	    difficile &agrave; utiliser.  De la documentation
	    supplémentaire &agrave; ce sujet est disponible
	    &agrave; l'adresse <ulink
	    url="http://www.globetrotter.com/"></ulink>.</para>
	</listitem>

	<listitem>
	  <para><command>lmgrd</command> est connu pour
	    être très capricieux au sujet
	    du fichier de licence et de planter si il y a un
	    quelconque problème.  Un fichier de licence correct
	    devrait ressembler &agrave; ceci:</para>

<programlisting># =======================================================
# License File for UNIX Installations ("Pointer File")
# =======================================================
SERVER chillig ANY
#USE_SERVER
VENDOR maplelmg

FEATURE Maple maplelmg 2000.0831 permanent 1 XXXXXXXXXXXX \
         PLATFORMS=i86_r ISSUER="Waterloo Maple Inc." \
         ISSUED=11-may-2000 NOTICE=" Technische Universitat Wien" \
         SN=XXXXXXXXX</programlisting>

	  <note>
	    <para>Le numéro de série et la clé ont
	      été ici remplacés par des <literal>X</literal>.
	      <hostid>chillig</hostid> est le nom de la
	      machine.</para>
	  </note>

	  <para>L'édition du fichier de licence est
	    possible tant que vous ne touchez pas &agrave; la ligne
	    &ldquo;FEATURE&rdquo; (qui est protégée
	    par la clé de la licence).</para>
	</listitem>
      </itemizedlist>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-matlab">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Dan</firstname>
	  <surname>Pelleg</surname>
	  <contrib>Contribution de </contrib>
	</author>
	<!-- daniel+handbook@pelleg.org -->
      </authorgroup>
    </sect1info>
    <title>Installer &matlab;</title>

    <indexterm>
      <primary>applications</primary>
      <secondary><application>MATLAB</application></secondary>
    </indexterm>

    <para>Ce document décrit l'installation de la version
      Linux de <application>&matlab; version 6.5</application> sur un
      système &os;.  Le logiciel fonctionne plutôt
      bien, &agrave; l'exception de la <application>&jvm;</application>,
      machine virtuelle <application>&java;</application> (voir la
      <xref linkend="matlab-jre"/>).</para>

    <para>La version Linux de <application>&matlab;</application> peut
      être commandée directement auprès de
      The MathWorks &agrave; l'adresse <ulink
      url="http://www.mathworks.com"></ulink>.  Assurez-vous d'avoir
      le fichier de licence ou les instructions pour le
      créer.  Pendant que vous y êtes, faites-leur savoir
      que vous désireriez une version &os; native de leur
      logiciel.</para>

    <sect2>
      <title>Installer &matlab;</title>

      <para>Pour installer <application>&matlab;</application>, faites
	ce qui suit:</para>

      <procedure>
	<step>
	  <para>Insérez le CD d'installation et montez-le.
	    Ouvrez une session super-utilisateur
	    (<username>root</username>), comme recommandé par
	    la procédure d'installation.  Pour lancer la
	    procédure d'installation tapez:</para>

	  <screen>&prompt.root; <userinput>/compat/linux/bin/sh /cdrom/install</userinput></screen>

	  <tip>
	    <para>Le programme d'installation est graphique.
	      Si vous obtenez une erreur disant que le programme
	      est incapable d'ouvrir une instance d'affichage, tapez
	      <command>setenv HOME ~<replaceable>utilisateur</replaceable></command>,
	      où <replaceable>utilisateur</replaceable> est
	      l'utilisateur &agrave; partir duquel vous avez fait un
	      &man.su.1;.</para>
	  </tip>
	</step>

	<step>
	  <para>Quand on vous demande le répertoire racine
	    pour <application>&matlab;</application>, tapez:
	    <userinput>/compat/linux/usr/local/matlab</userinput>.</para>

	  <tip>
	    <para>Pour faciliter la suite de l'installation et
	      réduire les frappes inutiles, tapez &agrave; l'invite
	      de l'interpréteur de commandes ceci:
	      <command>set MATLAB=/compat/linux/usr/local/matlab</command></para>
	  </tip>
	</step>

	<step>
	  <para>Editez le fichier de licence comme précisé
	    lors de l'obtention de la licence
	    <application>&matlab;</application>.</para>

	  <tip>
	    <para>Vous pouvez préparer d'avance ce fichier
	      en utilisant votre éditeur favori, et en le copiant
	      sous le nom <filename>$MATLAB/license.dat</filename>
	      avant que le programme d'installation ne vous demande de
	      l'éditer.</para>
	  </tip>
	</step>

	<step>
	  <para>Terminez le processus d'installation.</para>
	</step>
      </procedure>

      <para>A ce point, votre installation de
	<application>&matlab;</application> est terminée.  Les
	étapes suivantes rajoutent le nécessaire
	pour l'intégrer &agrave; votre système
	&os;.</para>
    </sect2>

    <sect2>
      <title>Démarrage du gestionnaire de licence</title>
      <procedure>
	<step>
	  <para>Créez des liens symboliques pour les
	    procédures du gestionnaire de licence:</para>

	  <screen>&prompt.root; <userinput>ln -s $MATLAB/etc/lmboot /usr/local/etc/lmboot_TMW</userinput>
&prompt.root; <userinput>ln -s $MATLAB/etc/lmdown /usr/local/etc/lmdown_TMW</userinput></screen>
	</step>

	<step>
	  <para>Créez un fichier de démarrage nommé
	    <filename>/usr/local/etc/rc.d/flexlm.sh</filename>.
	    L'exemple ci-dessous est une version modifiée
	    du fichier <filename>$MATLAB/etc/rc.lm.glnx86</filename>
	    fourni.  Les modifications concernent l'emplacement des
	    fichiers, et le lancement du gestionnaire de licence
	    sous l'émulation Linux.</para>

	  <programlisting>#!/bin/sh
case "$1" in
  start)
        if [ -f /usr/local/etc/lmboot_TMW ]; then
              /compat/linux/bin/sh /usr/local/etc/lmboot_TMW -u <replaceable>utilisateur</replaceable> &amp;&amp; echo 'MATLAB_lmgrd'
        fi
        ;;
  stop)
	if [ -f /usr/local/etc/lmdown_TMW ]; then
            /compat/linux/bin/sh /usr/local/etc/lmdown_TMW  &gt; /dev/null 2&gt;&amp;1
	fi
        ;;
  *)
	echo "Usage: $0 {start|stop}"
	exit 1
	;;
esac

exit 0</programlisting>

	  <important>
	    <para>Le fichier doit être rendu
	      exécutable:</para>

	    <screen>&prompt.root; <userinput>chmod +x /usr/local/etc/rc.d/flexlm.sh</userinput></screen>

	    <para>Vous devez remplacer
	      <replaceable>utilisateur</replaceable> dans la
	      procédure par un nom d'utilisateur valide sur
	      votre système (et non pas
	      <username>root</username>).</para>
	  </important>
	</step>

	<step>
	  <para>Lancez le gestionnaire de licence avec la
	    commande:</para>

	  <screen>&prompt.root; <userinput>/usr/local/etc/rc.d/flexlm.sh start</userinput></screen>
	</step>
      </procedure>
    </sect2>

    <sect2 id="matlab-jre">
      <title>Lier l'environnement d'exécution &java;
	(&ldquo;&java; Runtime Environment&rdquo;)</title>

      <para>Modifiez le lien vers le
	&ldquo;<application>&java;</application> Runtime
	Environment&rdquo; (JRE) pour un lien fonctionnant
	correctement sous &os;:</para>

      <screen>&prompt.root; <userinput>cd $MATLAB/sys/java/jre/glnx86/</userinput>
&prompt.root; <userinput>unlink jre; ln -s ./jre1.1.8 ./jre</userinput></screen>
    </sect2>

    <sect2>
      <title>Création d'une procédure de lancement
	pour &matlab;</title>

      <procedure>
	<step>
	  <para>Placez la procédure de démarrage suivante
	    dans le répertoire
	    <filename>/usr/local/bin/matlab</filename>:
	  </para>

	  <programlisting>#!/bin/sh
/compat/linux/bin/sh /compat/linux/usr/local/matlab/bin/matlab "$@"</programlisting>
	</step>

	<step>
	  <para>Puis tapez la commande
	    <command>chmod +x /usr/local/bin/matlab</command>.</para>
	</step>
      </procedure>

      <tip>
	<para>En fonction de la version
	  <filename role="package">emulators/linux_base</filename>
	  utilisée, vous pouvez rencontrer des problèmes
	  lors de l'utilisation de cette procédure.  Pour
	  éviter cela, éditez le fichier
	  <filename>/compat/linux/usr/local/matlab/bin/matlab</filename>,
	  et modifiez la ligne qui dit:</para>

	<programlisting>if [ `expr "$lscmd" : '.*-&gt;.*'` -ne 0 ]; then</programlisting>

	<para>(dans la version 13.0.1, c'est la ligne 410) en:</para>

	<programlisting>if test -L $newbase; then</programlisting>
      </tip>
    </sect2>

    <sect2>
      <title>Créer une procédure d'arrêt pour
	&matlab;</title>

      <para>Ce qui suit est nécessaire pour corriger le fait
	que &matlab; ne peut être quitter correctement.</para>

      <procedure>
	<step>
	  <para>Créez un fichier
	    <filename>$MATLAB/toolbox/local/finish.m</filename>, et y
	    mettre la ligne suivante:</para>

	  <programlisting>! $MATLAB/bin/finish.sh</programlisting>

	  <note><para><literal>$MATLAB</literal> doit être
	    écrit tel quel.</para></note>

	  <tip>
	    <para>Dans le même répertoire, vous
	      trouverez les fichiers
	      <filename>finishsav.m</filename> et
	      <filename>finishdlg.m</filename>, qui vous permettront
	      de sauvegarder l'environnement avant de quitter.
	      Si vous utilisez l'un d'eux, insérez la ligne
	      ci-dessus après la commande
	      <literal>save</literal>.</para></tip>
	</step>

	<step>
	  <para>Créez un fichier
	    <filename>$MATLAB/bin/finish.sh</filename>, qui contiendra
	    ce qui suit:</para>

	  <programlisting>#!/usr/compat/linux/bin/sh
(sleep 5; killall -1 matlab_helper) &amp;
exit 0</programlisting>
	</step>

	<step>
	  <para>Rendez le fichier exécutable:</para>

	  <screen>&prompt.root; <userinput>chmod +x $MATLAB/bin/finish.sh</userinput></screen>
	</step>
      </procedure>
    </sect2>

    <sect2 id="matlab-using">
      <title>Utilisation de &matlab;</title>

      <para>A ce point, vous êtes prêt &agrave;
	taper la commande <command>matlab</command> et &agrave; commencer
	&agrave; l'utiliser.</para>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-oracle">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Marcel</firstname>
	  <surname>Moolenaar</surname>
	  <contrib>Contribution de </contrib>
	</author>
	<!-- marcel@cup.hp.com -->
      </authorgroup>
    </sect1info>
    <title>Installer &oracle;</title>

    <indexterm>
      <primary>applications</primary>
      <secondary><application>Oracle</application></secondary>
    </indexterm>

    <sect2>
      <title>Préface</title>
      <para>Ce document décrit le processus d'installation
	d'<application>&oracle; 8.0.5</application> et
	d'<application>&oracle; 8.0.5.1 Enterprise Edition</application>
	pour Linux sur une machine &os;.</para>
    </sect2>

    <sect2>
      <title>Installer l'environnement Linux</title>

      <para>Assurez-vous d'avoir installé les deux logiciels
	<filename role='package'>emulators/linux_base</filename> et
	<filename role='package'>devel/linux_devtools</filename> du
	catalogue des logiciels portés.  Si vous rencontrez
	des problèmes avec ces logiciels portés,
	il se peut que vous ayez &agrave; utiliser les versions
	pré-compilées ou des versions plus
	anciennes disponibles dans le catalogue des logiciels
	portés.</para>

      <para>Si vous désirez installer l'agent intelligent,
	vous devrez également installer le
	&ldquo;package&rdquo; Red Hat Tcl:
	<filename>tcl-8.0.3-20.i386.rpm</filename>.  La commande
	générale pour installer des RPMs avec le logiciel
	<application>RPM</application> (<filename
	role='package'>archivers/rpm</filename>) est:</para>

      <screen>&prompt.root; <userinput>rpm -i --ignoreos --root /compat/linux --dbpath /var/lib/rpm <replaceable>package</replaceable></userinput></screen>

      <para>L'installation du <replaceable>package</replaceable> ne
	devrait pas générer d'erreur.</para>
    </sect2>

    <sect2>
      <title>Créer l'environnent &oracle;</title>

      <para>Avant de pouvoir installer
	<application>&oracle;</application>, vous devez configurer un
	environnement propre.  Ce document ne décrit
	que ce qu'il y a faire <emphasis>spécifiquement</emphasis>
	pour utiliser <application>&oracle;</application> pour Linux
	sous &os;, et non pas ce qui a été décrit
	dans le guide d'installation
	d'<application>&oracle;</application>.</para>

      <sect3 id="linuxemu-kernel-tuning">
        <title>Optimisation du noyau</title>
	<indexterm><primary>optimisation du noyau</primary></indexterm>

	<para>Comme décrit dans le guide d'installation
	  d'<application>&oracle;</application>, vous devez
	  configurer une taille maximale pour la mémoire
	  partagée.  Sous &os; n'utilisez pas l'option
	  <literal>SHMMAX</literal>.  <literal>SHMMAX</literal> est
	  simplement calculée &agrave; partir de
	  <literal>SHMMAXPGS</literal> et <literal>PGSIZE</literal>.
	  Définissez donc l'option <literal>SHMMAXPGS</literal>.
	  Toutes les autres options peuvent être
	  configurées comme décrit dans le guide.
	  Par exemple:</para>

	<programlisting>options SHMMAXPGS=10000
options SHMMNI=100
options SHMSEG=10
options SEMMNS=200
options SEMMNI=70
options SEMMSL=61</programlisting>

	<para>Configurez ces options en fonction de l'utilisation
	  prévue d'<application>&oracle;</application>.</para>

	<para>Assurez-vous également de la présence des
	  options suivantes dans votre fichier de configuration du
	  noyau:</para>

<programlisting>options SYSVSHM #SysV shared memory
options SYSVSEM #SysV semaphores
options SYSVMSG #SysV interprocess communication</programlisting>
      </sect3>

      <sect3 id="linuxemu-oracle-account">

        <title>Compte &oracle;</title>

	<para>Créez un compte <username>oracle</username>
	  de la même manière que vous créerez
	  un autre compte utilisateur.  Le compte
	  <username>oracle</username> n'a de spécial que
	  le fait que vous devez lui donner un interpréteur de
	  commandes Linux.  Ajoutez
	  <literal>/compat/linux/bin/bash</literal> au fichier
	  <filename>/etc/shells</filename> et fixez l'interpréteur
	  de commande du compte <username>oracle</username> &agrave;
	  <filename>/compat/linux/bin/bash</filename>.</para>
      </sect3>

      <sect3 id="linuxemu-environment">
        <title>Environnement</title>

	<para>En plus des variables d'environnement normales
	  d'<application>&oracle;</application> comme
	  <envar>ORACLE_HOME</envar> et <envar>ORACLE_SID</envar>
	  vous devez fixer les variables d'environnement
	  suivantes:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
          <colspec colwidth="1*"/>
          <colspec colwidth="2*"/>
	    <thead>
	      <row>
		<entry>Variable</entry>

		<entry>Valeur</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry><envar>LD_LIBRARY_PATH</envar></entry>

		<entry><literal>$ORACLE_HOME/lib</literal></entry>
	      </row>

	      <row>
		<entry><envar>CLASSPATH</envar></entry>

		<entry><literal>$ORACLE_HOME/jdbc/lib/classes111.zip</literal></entry>
	      </row>

	      <row>
		<entry><envar>PATH</envar></entry>

		<entry><literal>/compat/linux/bin
/compat/linux/sbin
/compat/linux/usr/bin
/compat/linux/usr/sbin
/bin
/sbin
/usr/bin
/usr/sbin
/usr/local/bin
$ORACLE_HOME/bin</literal></entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

        <para>Il est conseillé de définir toutes les
	  variables d'environnement dans le fichier
	  <filename>.profile</filename>.  Un exemple complet est:</para>

<programlisting>ORACLE_BASE=/oracle; export ORACLE_BASE
ORACLE_HOME=/oracle; export ORACLE_HOME
LD_LIBRARY_PATH=$ORACLE_HOME/lib
export LD_LIBRARY_PATH
ORACLE_SID=ORCL; export ORACLE_SID
ORACLE_TERM=386x; export ORACLE_TERM
CLASSPATH=$ORACLE_HOME/jdbc/lib/classes111.zip
export CLASSPATH
PATH=/compat/linux/bin:/compat/linux/sbin:/compat/linux/usr/bin
PATH=$PATH:/compat/linux/usr/sbin:/bin:/sbin:/usr/bin:/usr/sbin
PATH=$PATH:/usr/local/bin:$ORACLE_HOME/bin
export PATH</programlisting>
      </sect3>
    </sect2>

    <sect2>
      <title>Installer &oracle;</title>

      <para>En raison d'une particularité de l'émulateur
	Linux, vous devez créer un répertoire appelé
	<filename>.oracle</filename> dans <filename>/var/tmp</filename>
	avant de lancer le programme d'installation.
	Faites en sorte
	que l'utilisateur <username>oracle</username> en soit le
	propriétaire.  Vous devriez être en mesure
	d'installer <application>&oracle;</application> sans problème.
	Si vous rencontrez cependant des problèmes,
	contrôlez tout d'abord votre distribution
	d'<application>&oracle;</application> et/ou configuration!
	Après avoir installé <application>&oracle;</application>,
	appliquez les correctifs décrits dans les deux
	sous-sections suivantes.</para>

      <para>Un problème fréquent est que l'interface au
	protocole TCP n'est pas correctement installée.
	Avec comme conséquence l'impossibilité d'écouter
	le trafic TCP.  Les opérations suivantes aident
	&agrave; résoudre ce problème:</para>

      <screen>&prompt.root; <userinput>cd $ORACLE_HOME/network/lib</userinput>
&prompt.root; <userinput>make -f ins_network.mk ntcontab.o</userinput>
&prompt.root; <userinput>cd $ORACLE_HOME/lib</userinput>
&prompt.root; <userinput>ar r libnetwork.a ntcontab.o</userinput>
&prompt.root; <userinput>cd $ORACLE_HOME/network/lib</userinput>
&prompt.root; <userinput>make -f ins_network.mk install</userinput></screen>

      <para>N'oubliez pas de lancer &agrave; nouveau
	<filename>root.sh</filename>!</para>

    <sect3 id="linuxemu-patch-root">
      <title>Appliquer un correctif au fichier root.sh</title>

	<para>Quand on installe <application>&oracle;</application>,
	  certaines opérations, qui doivent être
	  effectuées en tant que <username>root</username>,
	  sont enregistrées dans une procédure
	  d'interpréteur de commandes appelée
	  <filename>root.sh</filename>.  Cette procédure se
	  trouve dans le répertoire <filename>orainst</filename>.
	  Appliquez le correctif suivant au fichier
	  <filename>root.sh</filename>, pour faire en sorte qu'il
	  utilise le chemin correct pour <command>chown</command>, ou
	  exécute une procédure sous un interpréteur
	  de commandes Linux natif.</para>

	<programlisting>*** orainst/root.sh.orig Tue Oct 6 21:57:33 1998
--- orainst/root.sh Mon Dec 28 15:58:53 1998
***************
*** 31,37 ****
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/bin/chown
#
# Define variables to be used in this script
--- 31,37 ----
# This is the default value for CHOWN
# It will redefined later in this script for those ports
# which have it conditionally defined in ss_install.h
! CHOWN=/usr/sbin/chown
#
# Define variables to be used in this script</programlisting>

	<para>Quand vous n'installez pas
	  <application>&oracle;</application> &agrave; partir d'un CD,
	  vous pouvez modifier les sources de
	  <filename>root.sh</filename>.  La procédure se nomme
	  <filename>rthd.sh</filename> et se trouve dans le
	  répertoire <filename>orainst</filename> dans l'arborescence
	  des sources.</para>
      </sect3>

      <sect3 id="linuxemu-patch-tcl">
	<title>Patching genclntsh</title>

	<para>La procédure <command>genclntsh</command>
	  est utilisée pour créer une simple bibliothèque
	  partagée cliente.  Elle est utilisée lors de la
	  construction des démos.  Appliquez le correctif
	  suivant pour commenter la définition de la variable
	  d'environnement <envar>PATH</envar>:</para>

	<programlisting>*** bin/genclntsh.orig Wed Sep 30 07:37:19 1998
--- bin/genclntsh Tue Dec 22 15:36:49 1998
***************
*** 32,38 ****
#
# Explicit path to ensure that we're using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst
--- 32,38 ----
#
# Explicit path to ensure that we're using the correct commands
#PATH=/usr/bin:/usr/ccs/bin export PATH
! #PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin export PATH
#
# each product MUST provide a $PRODUCT/admin/shrept.lst</programlisting>
      </sect3>
    </sect2>

    <sect2>
      <title>Exécuter &oracle;</title>

      <para>Après avoir suivi les instructions
	précédentes, vous devriez être en mesure
	d'exécuter <application>&oracle;</application> comme si
	le programme tournait sous Linux.</para>
    </sect2>
  </sect1>

  <sect1 id="sapr3">
    <sect1info>
      <authorgroup>
	<author>
	  <firstname>Holger</firstname>
	  <surname>Kipp</surname>
	  <contrib>Contribution de </contrib>
	</author>
      </authorgroup>
      <!-- holger.kipp@alogis.com -->
      <authorgroup>
	<author>
	  <firstname>Valentino</firstname>
	  <surname>Vaschetto</surname>
	  <contrib>Conversion en SGML par </contrib>
	</author>
      </authorgroup>
    </sect1info>

    <title>Installer &sap.r3;</title>

    <indexterm>
      <primary>applications</primary>
      <secondary><application>&sap.r3;</application></secondary>
    </indexterm>

    <para>Les installations de systèmes
      <application>&sap;</application> sous &os; ne
      seront pas supportées par l'équipe de support de SAP
      &mdash; ils n'assurent que le support pour des plateformes
      ceritifiées.</para>

    <sect2 id="preface">
      <title>Préface</title>

      <para>Ce document décrit une façon d'installer un
	système <application>&sap.r3;</application>
	avec la base de données <application>&oracle;</application>
	pour Linux sur une machine &os;, comprenant l'installation
	de &os; et d'<application>&oracle;</application>.  Deux
	configurations différentes seront décrites:</para>

      <itemizedlist>
	<listitem>
	  <para><application>&sap.r3; 4.6B (IDES)</application> avec
	  <application>&oracle; 8.0.5</application> sous
	  &os;&nbsp;4.3-STABLE</para>
	</listitem>

	<listitem>
	  <para><application>&sap.r3; 4.6C</application> avec
	  <application>&oracle; 8.1.7</application> sous
	  &os;&nbsp;4.5-STABLE</para>
	</listitem>
      </itemizedlist>

      <para>Même si ce document tente de décrire toutes les
	étapes importantes de façon détaillée,
	il n'est pas destiné &agrave; remplacer les guides
	d'installation d'<application>&oracle;</application> et
	<application>&sap.r3;</application>.</para>

      <para>Veuillez consulter la documentation fournie avec
	la version Linux de <application>&sap.r3;</application>
	et les questions spécifiques &agrave;
	<application>&oracle;</application>, ainsi que les
	ressources d'<application>&oracle;</application> et de
	<application>&sap; OSS</application>.</para>
    </sect2>

    <sect2 id="software">
      <title>Logiciels</title>

      <para>Les CD-ROMs suivants ont été utilisés pour
	les installations de <application>&sap;</application>:</para>

      <sect3 id="software-46b">
	<title>&sap.r3; 4.6B, &oracle; 8.0.5</title>

      <informaltable frame="none" pgwide="1">
	<tgroup cols="3">
	  <thead>
	    <row>
	      <entry>Nom</entry> <entry>Numéro</entry> <entry>Description</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row>
	      <entry>KERNEL</entry> <entry>51009113</entry> <entry>Noyau SAP Oracle /
		Installation / AIX, Linux, Solaris</entry>
	    </row>

	    <row>
	      <entry>RDBMS</entry> <entry>51007558</entry> <entry>Oracle / RDBMS 8.0.5.X /
		Linux</entry>
	    </row>

	    <row>
	      <entry>EXPORT1</entry> <entry>51010208</entry> <entry>IDES / DB-Export /
	Disque 1 sur 6</entry>
	    </row>

	    <row>
	      <entry>EXPORT2</entry> <entry>51010209</entry> <entry>IDES / DB-Export /
		Disque 2 sur 6</entry>
	    </row>

	    <row>
	      <entry>EXPORT3</entry> <entry>51010210</entry> <entry>IDES / DB-Export /
		Disque 3 sur 6</entry>
	    </row>

	    <row>
	      <entry>EXPORT4</entry> <entry>51010211</entry> <entry>IDES / DB-Export /
		Disque 4 sur 6</entry>
	    </row>

	    <row>
	      <entry>EXPORT5</entry> <entry>51010212</entry> <entry>IDES / DB-Export /
		Disque 5 sur 6</entry>
	    </row>

	    <row>
	      <entry>EXPORT6</entry> <entry>51010213</entry> <entry>IDES / DB-Export /
		Disque 6 sur 6</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

      <para>De plus, nous avons utilisé le CD d'<application>&oracle; 8
	Serveur</application> (version 8.0.5 de
	pré-production pour Linux, noyau 2.0.33) qui n'est pas
	vraiment nécessaire, et &os;&nbsp;4.3-STABLE (une version
	plus vieille de quelques jours que la 4.3-RELEASE).</para>

      </sect3>
      <sect3 id="software-46c">
	<title>&sap.r3; 4.6C SR2, &oracle; 8.1.7</title>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="3">
	    <thead>
	      <row>
		<entry>Nom</entry> <entry>Numéro</entry> <entry>Description</entry>
	      </row>
	    </thead>

	    <tbody>
	      <row>
		<entry>KERNEL</entry> <entry>51014004</entry> <entry>Noyau SAP Oracle /
		  Noyau SAP Version 4.6D / DEC, Linux</entry>
	      </row>

	      <row>
		<entry>RDBMS</entry> <entry>51012930</entry> <entry>Oracle 8.1.7/ RDBMS /
		  Linux</entry>
	      </row>

	      <row>
		<entry>EXPORT1</entry> <entry>51013953</entry> <entry>Version 4.6C SR2 / Export
		  / Disque 1 sur 4</entry>
	      </row>

	      <row>
		<entry>EXPORT1</entry> <entry>51013953</entry> <entry>Version 4.6C SR2 / Export
		  / Disque 2 sur 4</entry>
	      </row>

	      <row>
		<entry>EXPORT1</entry> <entry>51013953</entry> <entry>Version 4.6C SR2 / Export
		  / Disque 3 sur 4</entry>
	      </row>

	      <row>
		<entry>EXPORT1</entry> <entry>51013953</entry> <entry>Version 4.6C SR2 / Export
		  / Disque 4 sur 4</entry>
	      </row>

	      <row>
		<entry>LANG1</entry> <entry>51013954</entry> <entry>Version 4.6C SR2 /
		  Langue / DE, EN, FR / Disque 1 sur 3</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

        <para>En fonction des langues que vous désirez
	  installer, des CDs propres &agrave; ces langues pourront être
	  nécessaires.  Ici nous utilisons juste l'allemand (DE) et
	  l'anglais (EN), donc seul le premier CD propre aux langues
	  sera nécessaire.  Notez que le numéro des quatre
	  CDs EXPORT est identique (c'est différent du
	  numérotage des CDs 4.6B IDES).  Au moment
	  de l'écriture de ces lignes, cette installation utilise
	  &os;&nbsp;4.5-STABLE (du 20 mars 2002).</para>
      </sect3>
    </sect2>

    <sect2 id="sap-notes">
      <title>Notes concernant &sap;</title>

      <para>Les notes suivantes devraient être lues
	avant d'installer <application>&sap.r3;</application>
	et ont prouvé leur utilité durant
	l'installation:</para>

      <sect3 id="sap-notes-46b">
	<title>&sap.r3; 4.6B, &oracle; 8.0.5</title>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	    <thead>
	      <row>
		<entry>Numéro</entry>
		<entry>Titre</entry>
	      </row>
	    </thead>
	    <tbody>

	      <row>
		<entry>0171356</entry> <entry>SAP sous Linux:
		  Remarques importantes</entry>
	      </row>

	      <row>
		<entry>0201147</entry> <entry>INST: 4.6C R/3 Inst. sur
		  UNIX - Oracle</entry>
	      </row>

	      <row>
		<entry>0373203</entry> <entry>Mise &agrave; jour / Migration
		  Oracle 8.0.5 --&gt;
		  8.0.6/8.1.6 LINUX</entry>
	      </row>

	      <row>
		<entry>0072984</entry> <entry>Digital UNIX 4.0B pour
		  Oracle</entry>
	      </row>

	      <row>
		<entry>0130581</entry> <entry>Fin de l'étape
		  DIPGNTAB de R3SETUP</entry>
	      </row>

	      <row>
		<entry>0144978</entry> <entry>Votre système n'a pas
		  été installé correctement</entry>
	      </row>

	      <row>
		<entry>0162266</entry> <entry>Questions et conseils pour
		  R3SETUP sous Windows NT / W2K</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>
      </sect3>

      <sect3 id="sap-notes-46c">
	<title>&sap.r3; 4.6C, &oracle; 8.1.7</title>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	    <thead>
	      <row>
		<entry>Numéro</entry>
		<entry>Titre</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry>0015023</entry> <entry>Initialisation de la
		  table TCPDB (RSXP0004) (EBCDIC)</entry>
	      </row>

	      <row>
		<entry>0045619</entry> <entry>R/3 avec plusieurs langues
		  ou
		  languages or
		  typefaces</entry>
	      </row>

	      <row>
		<entry>0171356</entry> <entry>SAP sous Linux: Remarques
		  importantes</entry>
	      </row>

	      <row>
		<entry>0195603</entry> <entry>RedHat 6.1 version
		  entreprise: problèmes connus</entry>
	      </row>

	      <row>
		<entry>0212876</entry> <entry>Le nouvel outil d'archivage
		  SAPCAR</entry>
	      </row>

	      <row>
		<entry>0300900</entry> <entry>Linux: matériel DELL</entry>
	      </row>

	      <row>
		<entry>0377187</entry> <entry>RedHat 6.2: remarques
		  importantes</entry>
	      </row>

	      <row>
		<entry>0387074</entry> <entry>INST: R/3 4.6C SR2
		  Installation sous UNIX</entry>
	      </row>

	      <row>
		<entry>0387077</entry> <entry>INST: R/3 4.6C SR2 Inst. sous
		  UNIX - Oracle</entry>
	      </row>

	      <row>
		<entry>0387078</entry> <entry>SAP sous UNIX: Dépendances
		  4.6C SR2</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>
      </sect3>
    </sect2>

    <sect2 id="hardware-requirements">
      <title>Matériel nécessaire</title>

      <para>L'équipement suivant est suffisant
	pour l'installation d'un système
	<application>&sap.r3;</application>.  Bien sûr
	pour une utilisation en production, un choix
	plus pointu du matériel est nécessaire:</para>

      <informaltable frame="none" pgwide="1">
	<tgroup cols="3">
	  <thead>
	    <row>
	      <entry>Composant</entry>
	      <entry>4.6B</entry>
	      <entry>4.6C</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row>
	      <entry>Processeur</entry>
	      <entry>2 x 800MHz &pentium; III</entry>
	      <entry>2 x 800MHz &pentium; III</entry>
	    </row>

	    <row>
	      <entry>Mémoire</entry>
	      <entry>1Go ECC</entry>
	      <entry>2Go ECC</entry>
	    </row>

	    <row>
	      <entry>Espace disque</entry>
	      <entry>50-60Go (IDES)</entry>
	      <entry>50-60Go (IDES)</entry>
	    </row>
	  </tbody>
	</tgroup>
      </informaltable>

      <para>Pour une utilisation en production, des processeurs &xeon;
	avec un cache important, un accès disque rapide (SCSI,
	contrôleur RAID matériel) et de la mémoire
	ECC.  L'espace disque nécessaire est important en
	raison du système IDES pré-configuré, qui
	créé une base de données de 27&nbsp;Go
	durant l'installation.  Cet espace est également
	suffisant pour démarrer des systèmes
	destinés &agrave; la production.</para>

      <sect3 id="hardware-46b">
	<title>&sap.r3; 4.6B, &oracle; 8.0.5</title>

      <para>Le matériel suivant fut utilisé: une carte
	mère bi-processeurs avec 2 processeurs &pentium;&nbsp;III
	800&nbsp;MHz, une carte SCSI &adaptec; 29160 Ultra160
	(pour utiliser un lecteur de bande 40/80&nbsp;Go DLT et un
	lecteur de CDROM), une carte &mylex; &acceleraid; (2 canaux,
	firmware 6.00-1-00 avec 32&nbsp;Mo de RAM).  Au contrôleur
	RAID &mylex; sont reliés deux disques durs de 17&nbsp;Go
	(miroirs) et quatre disques de 36&nbsp;Go (RAID niveau
	5).</para>
      </sect3>

      <sect3 id="hardware-46c">
	<title>&sap.r3; 4.6C, &oracle; 8.1.7</title>

      <para>Pour cette installation un &dell; &poweredge; 2500 a
	été utilisé: une carte mère
	bi-processeurs avec deux processeurs &pentium;&nbsp;III
	1000&nbsp;MHz (256&nbsp;Ko de cache), 2&nbsp;Go PC133 ECC
	SDRAM, un contrôleur PERC/3 DC PCI RAID avec
	128&nbsp;Mo, et un lecteur DVD-ROM EIDE.  Au contrôleur
	RAID sont reliés deux disques durs 18&nbsp;Go (miroirs)
	et quatre disques de 36&nbsp;Go (RAID niveau 5).</para>
      </sect3>
    </sect2>

    <sect2 id="installation">
      <title>Installation de &os;</title>

      <para>Tout d'abord vous devez installer &os;.  Il existe de
	nombreuses manière d'installer &os;, pour plus d'informations
	consultez la <xref linkend="install-diff-media"/>.</para>

      <sect3 id="disk-layout">
	<title>Organisation des disques</title>

	<para>Pour rester simple, la même organisation des
	  disques a été utilisée pour les
	  installations de <application>&sap.r3; 46B</application> et
	  <application>&sap.r3; 46C SR2</application>.  Seuls les noms
	  de périphériques ont changé, comme les
	  installations ont été effectuées sur du
	  matériel différent
	  (<filename>/dev/da</filename> et
	  <filename>/dev/amr</filename> respectivement, aussi si
	  l'on utilise un contrôleur AMI MegaRAID, on verra
	  <filename>/dev/amr0s1a</filename> &agrave; la place de
	  <filename>/dev/da0s1a</filename>):</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="4">
	    <thead>
	      <row>
		<entry>Système de fichiers</entry>
		<entry>Taille (blocs de 1k)</entry>
		<entry>Taille (Go)</entry>
		<entry>Monté sous</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry><filename>/dev/da0s1a</filename></entry>
		<entry>1.016.303</entry>
		<entry>1</entry>
		<entry><filename class='directory'>/</filename></entry>
	      </row>

	      <row>
		<entry><filename>/dev/da0s1b</filename></entry>
		<entry> </entry>
		<entry>6</entry>
		<entry>swap</entry>
	      </row>

	      <row>
		<entry><filename>/dev/da0s1e</filename></entry>
		<entry>2.032.623</entry>
		<entry>2</entry>
		<entry><filename class='directory'>/var</filename></entry>
	      </row>

	      <row>
		<entry><filename>/dev/da0s1f</filename></entry>
		<entry>8.205.339</entry>
		<entry>8</entry>
		<entry><filename class='directory'>/usr</filename></entry>
	      </row>

	      <row>
		<entry><filename>/dev/da1s1e</filename></entry>
		<entry>45.734.361</entry>
		<entry>45</entry>
		<entry><filename class='directory'>/compat/linux/oracle</filename></entry>
	      </row>

	      <row>
		<entry><filename>/dev/da1s1f</filename></entry>
		<entry>2.032.623</entry>
		<entry>2</entry>
		<entry><filename class='directory'>/compat/linux/sapmnt</filename></entry>
	      </row>

	      <row>
		<entry><filename>/dev/da1s1g</filename></entry>
		<entry>2.032.623</entry>
		<entry>2</entry>
		<entry><filename class='directory'>/compat/linux/usr/sap</filename></entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

	<para>Configurez et initialisez les deux disques logiques
	  &agrave; l'avance avec les logiciels &mylex; ou PERC/3 RAID.
	  Ces logiciels peuvent être lancés lors
	  de la phase de démarrage du
	  <acronym>BIOS</acronym>.</para>

	<para>Notez que l'organisation du disque diffère
	  légèrement des recommandations de SAP, comme
	  SAP suggère de monter séparément
	  les sous-répertoires d'<application>&oracle;</application>
	  (et d'autres) &mdash; nous avons décidé de
	  simplement créer de véritables sous-répertoires
	  directement.</para>
      </sect3>

      <sect3 id="makeworldandnewkernel">
	<title>Utiliser <command>make world</command> et compiler
	  un nouveau noyau</title>

	<para>Téléchargez les sources -STABLE les plus
	  récentes.  Recompilez l'intégralité du
	  système et votre noyau personnalisé
	  après avoir configuré votre fichier de
	  configuration du noyau.  L&agrave;, vous devriez
	  également ajouter les <link
	  linkend="kerneltuning">paramètres du noyau</link>
	  requis par <application>&sap.r3;</application> et
	  <application>&oracle;</application>.</para>
      </sect3>
    </sect2>

    <sect2 id="installingthelinuxenviornment">
      <title>Installer l'environnement Linux</title>

      <sect3 id="installinglinuxbase-system">
	<title>Installer le système de base Linux</title>

	<para>Tout d'abord le logiciel porté
	  <link linkend="linuxemu-libs-port">linux_base</link> doit
	  être installé (en tant que super-utilisateur):</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/emulators/linux_base</userinput>
&prompt.root; <userinput>make install distclean</userinput></screen>
      </sect3>

      <sect3 id="installinglinuxdevelopment">
	<title>Installer l'environnement de développement
	  Linux</title>

	<para>L'environnement de développement Linux est
	  nécessaire, si vous désirez installer
	  <application>&oracle;</application> sous &os; comme cela est
	  décrit dans la <xref
	  linkend="linuxemu-oracle"/>:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/devel/linux_devtools</userinput>
&prompt.root; <userinput>make install distclean</userinput></screen>

	<para>L'environnement de développement Linux a
	  été installé en vue de l'installation
	  de <application>&sap.r3; 46B IDES</application>.  Ce n'est
	  pas nécessaire si <application>&oracle;
	  DB</application> n'est pas liée sur un système
	  &os;.  C'est le cas si vous utilisez l'archive
	  <application>tar</application>
	  <application>&oracle;</application> en provenance d'un
	  système Linux.</para>
      </sect3>


      <sect3 id="installingnecessaryrpms">
	<title>Installer les RPMs nécessaires</title>
	<indexterm><primary>RPMs</primary></indexterm>

	<para>Pour lancer le programme
	  <command>R3SETUP</command>, le support PAM est
	  nécessaire.  Lors de la première installation de
	  <application>&sap;</application> sous &os;&nbsp;4.3-STABLE,
	  nous avons tenté d'installer PAM avec tous les
	  &ldquo;packages&rdquo; nécessaires, et nous avons
	  finalement forcé l'installation du &ldquo;package&rdquo;
	  PAM, ce qui a fonctionné.  Pour
	  <application>&sap.r3; 4.6C SR2</application>, nous avons
	  directement forcé l'installation du
	  RPM PAM, ce qui fonctionne également, il semble donc
	  que les RPMs de dépendance ne sont pas
	  nécessaires:</para>

<screen>&prompt.root; <userinput>rpm -i --ignoreos --nodeps --root /compat/linux --dbpath /var/lib/rpm \
pam-0.68-7.i386.rpm</userinput></screen>

	<para>Pour utiliser l'agent intelligent
	  d'<application>&oracle; 8.0.5</application>, nous devons
	  également installer la version RedHat de Tcl
	  <filename>tcl-8.0.5-30.i386.rpm</filename> (sinon l'édition
	  de liens durant l'installation
	  d'<application>&oracle;</application> ne fonctionnera pas).
	  Il existe d'autres problèmes &agrave; ce niveau, mais ils
	  concernent directement la version Linux
	  d'<application>&oracle;</application>, et ne sont donc pas
	  spécifiquent &agrave; &os;.</para>
      </sect3>

      <sect3 id="linuxprocandfallbackelfbrand">
	<title>Quelques conseils supplémentaires</title>

	<para>Cela peut être une bonne idée d'ajouter
	  <literal>linprocfs</literal> au fichier
	  <filename>/etc/fstab</filename>, pour plus d'informations
	  consultez la page de manuel &man.linprocfs.5;.  Un autre
	  paramètre &agrave; positionner est
	  <literal>kern.fallback_elf_brand=3</literal>, ce qui
	  doit être fait dans le fichier
	  <filename>/etc/sysctl.conf</filename>.</para>
      </sect3>
    </sect2>

    <sect2 id="creatingsapr3env">
      <title>Créer l'environnement SAP/R3</title>

      <sect3 id="filesystemsandmountpoints">
	<title>Créer les systèmes de fichiers et points de
	  montage nécessaires</title>

	<para>Pour une simple installation, il est suffisant de
	  créer les systèmes de fichiers suivants:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	    <thead>
	      <row>
		<entry>point de montage</entry>
		<entry>taille en Go</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry><filename class='directory'>/compat/linux/oracle</filename></entry>
		<entry>45 Go</entry>
	      </row>

	      <row>
		<entry><filename class='directory'>/compat/linux/sapmnt</filename></entry>
		<entry>2 Go</entry>
	      </row>

	      <row>
		<entry><filename class='directory'>/compat/linux/usr/sap</filename></entry>
		<entry>2 Go</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

	<para>Il est également nécessaire de créer
	  certains liens.  Sinon l'intalleur
	  <application>&sap;</application> se plaindra, lors du
	  contrôle des liens créés:</para>

	<screen>&prompt.root; <userinput>ln -s /compat/linux/oracle /oracle</userinput>
&prompt.root; <userinput>ln -s /compat/linux/sapmnt /sapmnt</userinput>
&prompt.root; <userinput>ln -s /compat/linux/usr/sap /usr/sap</userinput></screen>

	<para>Un message d'erreur possible durant l'installation
	  (ici avec un système <emphasis>PRD</emphasis>
	  l'installation de
	  <application>&sap.r3; 4.6C SR2</application>):</para>

	<screen>INFO 2002-03-19 16:45:36 R3LINKS_IND_IND SyLinkCreate:200
    Checking existence of symbolic link /usr/sap/PRD/SYS/exe/dbg to
    /sapmnt/PRD/exe. Creating if it does not exist...

WARNING 2002-03-19 16:45:36 R3LINKS_IND_IND SyLinkCreate:400
    Link /usr/sap/PRD/SYS/exe/dbg exists but it points to file
    /compat/linux/sapmnt/PRD/exe instead of /sapmnt/PRD/exe. The
    program cannot go on as long as this link exists at this
    location. Move the link to another location.

ERROR 2002-03-19 16:45:36 R3LINKS_IND_IND Ins_SetupLinks:0
    can not setup link '/usr/sap/PRD/SYS/exe/dbg' with content
    '/sapmnt/PRD/exe'</screen>
      </sect3>

      <sect3 id="creatingusersanddirectories">
	<title>Création des utilisateurs et des
	  répertoires</title>

	<para><application>&sap.r3;</application> a besoin de deux
	  utilisateurs et de trois groupes.  Les noms d'utilisateurs
	  dépendent du système d'ID de
	  <application>&sap;</application> (SID) qui est composé
	  de trois lettres.  Certains de ces SIDs sont
	  réservés par <application>&sap;</application>
	  (par exemple <literal>SAP</literal> et
	  <literal>NIX</literal>.  Pour une liste complète
	  consultez la documentation de
	  <application>&sap;</application>).  Pour l'installation IDES,
	  nous avons utilisé <literal>IDS</literal>, pour
	  l'installation 4.6C SR2 <literal>PRD</literal>, comme ce
	  système était destiné &agrave; la
	  production.  Nous avons cependant les groupes suivants (les
	  identifiants de groupe peuvent être différents,
	  ce sont seulement les valeurs que nous avons utilisés
	  dans notre installation):</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="3">
	  <thead>
	  <row>
	    <entry>groupe ID</entry>
	    <entry>nom du groupe</entry>
	    <entry>description</entry>
	  </row>
	  </thead>
	  <tbody>
	  <row>
	    <entry>100</entry>
	    <entry>dba</entry>
	    <entry>Administrateur de la base de données</entry>
	  </row>
	  <row>
	    <entry>101</entry>
	    <entry>sapsys</entry>
	    <entry>Système &sap;</entry>
	  </row>
	  <row>
	    <entry>102</entry>
	    <entry>oper</entry>
	    <entry>Opérateur de la base de données</entry>
	  </row>
	  </tbody>
	  </tgroup>
	</informaltable>

	<para>Pour une installation
	  d'<application>&oracle;</application> par défaut, seul le
	  groupe <groupname>dba</groupname> est utilisé.
	  Tout comme le groupe <groupname>oper</groupname>, certains
	  utilisent également le groupe <groupname>dba</groupname>
	  (Voir les documentations d'<application>&oracle;</application>
	  et de <application>&sap;</application> pour plus
	  d'information).</para>

	<para>Nous avons également besoin des utilisateurs
	  suivants:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="6">
	  <thead>
	  <row>
	    <entry>ID utilisateur</entry>
	    <entry>nom d'utilisateur</entry>
	    <entry>nom générique</entry>
	    <entry>groupe</entry>
	    <entry>groupes supplémentaires</entry>
	    <entry>description</entry>
	  </row>
	  </thead>
	  <tbody>
	  <row>
	    <entry>1000</entry>
	    <entry>idsadm/prdadm</entry>
	    <entry><replaceable>sid</replaceable>adm</entry>
	    <entry>sapsys</entry>
	    <entry>oper</entry>
	    <entry>Administrateur &sap;</entry>
	  </row>
	  <row>
	    <entry>1002</entry>
	    <entry>oraids/oraprd</entry>
	    <entry>ora<replaceable>sid</replaceable></entry>
	    <entry>dba</entry>
	    <entry>oper</entry>
	    <entry>Administrateur de la base de données &oracle;</entry>
	  </row>
	  </tbody>
	  </tgroup>
	</informaltable>

	<para>L'ajout des utilisateurs avec la commande
	  &man.adduser.8; nécessite les entrées
	  suivantes (notez l'interpréteur de commandes et le
	  répertoire utilisateur) pour l'&ldquo;Administrateur
	  &sap;&rdquo;:</para>

	<programlisting>Name: <replaceable>sid</replaceable>adm
Password: ******
Fullname: SAP Administrator <replaceable>SID</replaceable>
Uid: 1000
Gid: 101 (sapsys)
Class:
Groups: sapsys dba
HOME: /home/<replaceable>sid</replaceable>adm
Shell: bash  (/compat/linux/bin/bash)</programlisting>

	<para>et pour l'&ldquo;Administrateur de la base de
	  données &oracle;&rdquo;:</para>

	<programlisting>Name: ora<replaceable>sid</replaceable>
Password: ******
Fullname: Oracle Administrator <replaceable>SID</replaceable>
Uid: 1002
Gid: 100 (dba)
Class:
Groups: dba
HOME: /oracle/<replaceable>sid</replaceable>
Shell: bash  (/compat/linux/bin/bash)</programlisting>

	<para>Ceci devrait également inclure le groupe
	  <groupname>oper</groupname> au cas où vous utiliseriez
	  les deux groupes <groupname>dba</groupname> et
	  <groupname>oper</groupname>.</para>
      </sect3>

      <sect3 id="creatingdirectories">
	<title>Création des répertoires</title>

	<para>Ces répertoires sont généralement
	  créés sous forme de systèmes de
	  fichiers séparés.  Cela dépend
	  entièrement de vous besoins.  Nous avons choisi de
	  créer de simple répertoires, comme ils sont
	  placés sur le même système RAID
	  5:</para>

	<para>Nous positionnerons tout d'abord les propriétaires
	  et les droits de certains répertoires (en tant que
	  <username>root</username>):</para>

	<screen>&prompt.root; <userinput>chmod 775 /oracle</userinput>
&prompt.root; <userinput>chmod 777 /sapmnt</userinput>
&prompt.root; <userinput>chown root:dba /oracle</userinput>
&prompt.root; <userinput>chown <replaceable>sid</replaceable>adm:sapsys /compat/linux/usr/sap</userinput>
&prompt.root; <userinput>chmod 775 /compat/linux/usr/sap</userinput></screen>

	<para>Ensuite nous crérons les répertoires en tant
	  qu'utilisateur
	  <username>ora<replaceable>sid</replaceable></username>.  Ce
	  seront tous les répertoires du type
	  <filename class='directory'>/oracle/<replaceable>SID</replaceable></filename>:</para>

	<screen>&prompt.root; <userinput>su - ora<replaceable>sid</replaceable></userinput>
&prompt.root; <userinput>cd /oracle/<replaceable>SID</replaceable></userinput>
&prompt.root; <userinput>mkdir mirrlogA mirrlogB origlogA origlogB</userinput>
&prompt.root; <userinput>mkdir sapdata1 sapdata2 sapdata3 sapdata4 sapdata5 sapdata6</userinput>
&prompt.root; <userinput>mkdir saparch sapreorg</userinput>
&prompt.root; <userinput>exit</userinput></screen>

	<para>Pour l'installation d'<application>&oracle; 8.1.7</application>
	  des répertoires supplémentaires sont
	  nécessaires:</para>

	<screen>&prompt.root; <userinput>su - ora<replaceable>sid</replaceable></userinput>
&prompt.root; <userinput>cd /oracle</userinput>
&prompt.root; <userinput>mkdir 805_32</userinput>
&prompt.root; <userinput>mkdir client stage</userinput>
&prompt.root; <userinput>mkdir client/80x_32</userinput>
&prompt.root; <userinput>mkdir stage/817_32</userinput>
&prompt.root; <userinput>cd /oracle/<replaceable>SID</replaceable></userinput>
&prompt.root; <userinput>mkdir 817_32</userinput></screen>

	<note><para>Le répertoire <filename
	  class='directory'>client/80x_32</filename> est
	  créé tel quel.  Ne remplacez pas le
	  <emphasis>x</emphasis> par quelque chose
	  d'autre.</para></note>

	<para>La dernière étape consiste &agrave;
	  créer les répertoires en tant qu'utilisateur
	  <username><replaceable>sid</replaceable>adm</username>:</para>

	<screen>&prompt.root; <userinput>su - <replaceable>sid</replaceable>adm</userinput>
&prompt.root; <userinput>cd /usr/sap</userinput>
&prompt.root; <userinput>mkdir <replaceable>SID</replaceable></userinput>
&prompt.root; <userinput>mkdir trans</userinput>
&prompt.root; <userinput>exit</userinput></screen>
      </sect3>

      <sect3 id="entriesinslashetcslashservices">
	<title>Entrées dans <filename>/etc/services</filename></title>

	<para><application>&sap.r3;</application> a besoin de certaines
	  entrées dans le fichier
	  <filename>/etc/services</filename>, qui ne seront pas
	  créées durant son installation sous &os;.
	  Veuillez ajouter les entrées suivantes (vous avez
	  besoin au moins des entrées correspondant au
	  numéro d'instance &mdash; dans notre cas,
	  <literal>00</literal>.  Cela ne posera pas de
	  problème d'ajouter toutes les entrées de
	  <literal>00</literal> &agrave; <literal>99</literal> pour
	  <literal>dp</literal>, <literal>gw</literal>,
	  <literal>sp</literal> et <literal>ms</literal>).  Si vous
	  allez utiliser <application>SAProuter</application> ou vous
	  devez accéder au <application>&sap;</application> OSS,
	  vous avez également besoin de l'entrée
	  <literal>99</literal>, comme le port 3299 est
	  généralement utilisé par le processus
	  <application>SAProuter</application> sur le système
	  cible:</para>

	<programlisting>
sapdp00    3200/tcp # SAP Dispatcher.      3200 + Instance-Number
sapgw00  3300/tcp # SAP Gateway.         3300 + Instance-Number
sapsp00  3400/tcp #                      3400 + Instance-Number
sapms00  3500/tcp #                      3500 + Instance-Number
sapms<replaceable>SID</replaceable> 3600/tcp # SAP Message Server.  3600 + Instance-Number
sapgw00s   4800/tcp # SAP Secure Gateway   4800 + Instance-Number</programlisting>
      </sect3>

      <sect3 id="necessarylocales">
	<title>&ldquo;Locales&rdquo; nécessaires</title>
	<indexterm><primary>locale</primary></indexterm>

	<para><application>&sap;</application> nécessite au moins
	  deux &ldquo;locales&rdquo; qui ne font pas partie de
	  l'installation RedHat par défaut.  SAP propose les
	  RPMs nécessaires en téléchargement
	  &agrave; partir de leur serveur FTP (qui est uniquement
	  accessible si vous êtes un client avec un accès
	  OSS).  Consultez la note 0171356 pour la liste des RPMs dont
	  vous avez besoin.</para>

	<para>Il est également possible de créer just
	  les appropriés (par exemple &agrave; partir de
	  <emphasis>de_DE</emphasis> et <emphasis>en_US</emphasis>),
	  mais nous ne recommandons pas cela pour un système
	  destiné &agrave; la production (bien que cela a
	  fonctionné sans problème avec le
	  système IDES).  Les &ldquo;locales&rdquo; suivantes
	  sont nécessaires:</para>

	<programlisting>de_DE.ISO-8859-1
en_US.ISO-8859-1</programlisting>

	<para>Créez les liens comme suit:</para>

	<screen>&prompt.root; <userinput>cd /compat/linux/usr/share/locale</userinput>
&prompt.root; <userinput>ln -s de_DE de_DE.ISO-8859-1</userinput>
&prompt.root; <userinput>ln -s en_US en_US.ISO-8859-1</userinput></screen>

	<para>S'ils n'existent pas, des problèmes apparaîtrons
	  lors de l'installation.  Si ces problèmes sont
	  intentionnellement ignorés (en fixant la valeur
	  de la variable <literal>STATUS</literal>
	  des étapes pour lesquelles les problèmes sont
	  apparus &agrave; la valeur <literal>OK</literal> dans le
	  fichier <filename>CENTRDB.R3S</filename>), il sera
	  impossible d'ouvrir une session sur le système
	  <application>&sap;</application> sans effort
	  supplémentaire.</para>
      </sect3>

      <sect3 id="kerneltuning">
	<title>Optimisation du noyau</title>
	<indexterm><primary>optimisation du noyau</primary></indexterm>

	<para>Les systèmes <application>&sap.r3;</application>
	demandent beaucoup de ressources.  Nous avons donc
	ajouté les paramètres suivants au fichier de
	configuration du noyau:</para>

	<programlisting># Set these for memory pigs (SAP and Oracle):
options MAXDSIZ="(1024*1024*1024)"
options DFLDSIZ="(1024*1024*1024)"
# System V options needed.
options SYSVSHM #SYSV-style shared memory
options SHMMAXPGS=262144 #max amount of shared mem. pages
#options SHMMAXPGS=393216 #use this for the 46C inst.parameters
options SHMMNI=256 #max number of shared memory ident if.
options SHMSEG=100 #max shared mem.segs per process
options SYSVMSG #SYSV-style message queues
options MSGSEG=32767 #max num. of mes.segments in system
options MSGSSZ=32 #size of msg-seg. MUST be power of 2
options MSGMNB=65535 #max char. per message queue
options MSGTQL=2046 #max amount of msgs in system
options SYSVSEM #SYSV-style semaphores
options SEMMNU=256 #number of semaphore UNDO structures
options SEMMNS=1024 #number of semaphores in system
options SEMMNI=520 #number of semaphore identifiers
options SEMUME=100       #number of UNDO keys</programlisting>

	<para>Les valeurs minimales sont précisées dans
	  la documentation en provenance de SAP.  Comme il n'y a pas
	  d'éléments concernant Linux, consultez la section
	  sur HP-UX (32bits) pour plus d'information.  Comme le
	  système utilisé pour l'installation de la
	  version 4.6C SR2 dispose de plus de mémoire principale,
	  les segments de mémoire partagée (&ldquo;shared
	  segments&rdquo;) peuvent être plus larges pour
	  <application>&sap;</application> et
	  <application>&oracle;</application>, cependant choisissez un
	  nombre plus important de page de mémoire
	  partagée.</para>

	<note><para>Avec l'installation par défaut de &os;
	  sur l'architecture &i386;, laissez <literal>MAXDSIZ</literal>
	  et <literal>DFLDSIZ</literal> &agrave; une valeur de
	  1&nbsp;Go maximum.  Sinon, des erreurs étranges comme
	  <errorname>ORA-27102: out of memory</errorname> et
	  <errorname>Linux Error: 12: Cannot allocate memory</errorname>
	  risquent d'apparaître.</para></note>
      </sect3>
    </sect2>

    <sect2 id="installingsapr3">
      <title>Installer &sap.r3;</title>

      <sect3 id="preparingsapcdroms">
	<title>Préparer les CDROMs &sap;</title>

	<para>Il y a de nombreux CDROMs &agrave; monter et
	  démonter lors de l'installation.  Si vous disposez de
	  suffisamment de lecteurs de CDROMs, vous pouvez tout
	  simplement les monter tous.  Nous avons décidé
	  de copier le contenu des CDROMs dans les répertoires
	  correspondant:</para>

	<programlisting>/oracle/<replaceable>SID</replaceable>/sapreorg/<replaceable>nom-du-cd</replaceable></programlisting>

	<para>où <replaceable>nom-du-cd</replaceable> est un nom
	  parmi <filename>KERNEL</filename>,
	  <filename>RDBMS</filename>, <filename>EXPORT1</filename>,
	  <filename>EXPORT2</filename>, <filename>EXPORT3</filename>,
	  <filename>EXPORT4</filename>, <filename>EXPORT5</filename> et
	  <filename>EXPORT6</filename> pour l'installation de la version
	  4.6B/IDES, et <filename>KERNEL</filename>,
	  <filename>RDBMS</filename>, <filename>DISK1</filename>,
	  <filename>DISK2</filename>, <filename>DISK3</filename>,
	  <filename>DISK4</filename> et <filename>LANG</filename> pour
	  l'installation de la version 4.6C SR2.  Tous les noms
	  de fichiers sur les CDs montés devraient être en
	  majuscules, sinon utilisez l'option <option>-g</option>
	  pour le montage.  Utilisez donc les commandes
	  suivantes:</para>

	<screen>&prompt.root; <userinput>mount_cd9660 -g /dev/cd0a /mnt</userinput>
&prompt.root; <userinput>cp -R /mnt/* /oracle/<replaceable>SID</replaceable>/sapreorg/<replaceable>nom-du-cd</replaceable></userinput>
&prompt.root; <userinput>umount /mnt</userinput></screen>
      </sect3>

      <sect3 id="runningtheinstall-script">
	<title>Exécuter la procédure d'installation</title>

	<para>Tout d'abord, vous devez préparer un répertoire
	  <filename class='directory'>install</filename>:</para>

	<screen>&prompt.root; <userinput>cd /oracle/<replaceable>SID</replaceable>/sapreorg</userinput>
&prompt.root; <userinput>mkdir install</userinput>
&prompt.root; <userinput>cd install</userinput></screen>

	<para>Ensuite la procédure d'installation est
	  lancée, qui copiera tous fichiers correspondant dans
	  le répertoire <filename
	  class='directory'>install</filename>:</para>

	<screen>&prompt.root; <userinput>/oracle/<replaceable>SID</replaceable>/sapreorg/KERNEL/UNIX/INSTTOOL.SH</userinput></screen>

	<para>L'installation IDES (4.6B) est fournie avec un
	  système <application>&sap.r3;</application> de
	  démonstration complètement configuré,
	  il y a donc six CDs EXPORT au lieu de juste trois CDs
	  EXPORT.  A ce point la configuration par défaut
	  d'installation <filename>CENTRDB.R3S</filename> est
	  destiné &agrave; l'installation d'une instance
	  centrale standard (<application>&r3;</application> et base de
	  données), et non pas l'instance centrale standard
	  IDES, on doit donc copier le fichier
	  <filename>CENTRDB.R3S</filename> correspondant du
	  répertoire <filename
	  class='directory'>EXPORT1</filename>, sinon
	  <command>R3SETUP</command> ne demandera que trois CDs
	  EXPORT.</para>

	<para>La nouvelle version <application>&sap; 4.6C
	  SR2</application> est fournie avec quatre CDs EXPORT.  Le
	  fichier de paramètres qui contrôle les
	  étapes de l'installation est le fichier
	  <filename>CENTRAL.R3S</filename>.  Contrairement aux
	  versions précédentes, il n'y a pas de
	  modèle de configuration d'installation
	  séparé pour une instance centrale avec ou sans
	  base de données.  <application>&sap;</application>
	  utilise un modèle de configuration
	  séparé pour l'installation de base de
	  données.  Pour relancer l'installation
	  postérieurement, il suffit de la relancer avec le
	  fichier d'origine.</para>

	<para>Pendant et après l'installation,
	  <application>&sap;</application> a besoin que la commande
	  <command>hostname</command> renvoie uniquement le nom de la
	  machine et non pas le nom complet de la machine.  Fixez donc
	  le nom de la machine en fonction, ou créez un alias
	  avec <command>alias hostname='hostname -s'</command> pour
	  les utilisateurs
	  <username>ora<replaceable>sid</replaceable></username> et
	  <username><replaceable>sid</replaceable>adm</username> (et
	  pour le super-utilisateur <username>root</username> au moins
	  durant les étapes de l'installation effectuées
	  en tant que <username>root</username>).  Il est
	  également possible d'ajuster les fichiers
	  <filename>.profile</filename> et <filename>.login</filename>
	  des deux utilisateurs qui sont installés lors de
	  l'installation de <application>&sap;</application>.</para>
      </sect3>

      <sect3 id="startr3setup-46B">
	<title>Exécuter <command>R3SETUP</command> 4.6B</title>

	<para>Assurez-vous que la variable <envar>LD_LIBRARY_PATH</envar>
	  est correctement positionnée:</para>

	<screen>&prompt.root; <userinput>export LD_LIBRARY_PATH=/oracle/IDS/lib:/sapmnt/IDS/exe:/oracle/805_32/lib</userinput></screen>

	<para>Lancez <command>R3SETUP</command> en tant que
	  <username>root</username> &agrave; partir du répertoire
	  d'installation:</para>

	<screen>&prompt.root; <userinput>cd /oracle/IDS/sapreorg/install</userinput>
&prompt.root; <userinput>./R3SETUP -f CENTRDB.R3S</userinput></screen>

	<para>La procédure pose ensuite un certain nombre de
	  questions (les valeurs par défaut sont entre crochets,
	  suivies par les entrées clavier):</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="3">
	  <thead>
	  <row>
	    <entry>Question</entry>
	    <entry>Défaut</entry>
	    <entry>Entrée(s) clavier</entry>
	  </row>
	  </thead>
	  <tbody>
	  <row>
	    <entry>Enter SAP System ID</entry>
	    <entry>[C11]</entry>
	    <entry>IDS<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter SAP Instance Number</entry>
	    <entry>[00]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter SAPMOUNT Directory</entry>
	    <entry>[/sapmnt]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter name of SAP central host</entry>
	    <entry>[troubadix.domain.de]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter name of SAP db host</entry>
	    <entry>[troubadix]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Select character set</entry>
	    <entry>[1] (WE8DEC)</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Oracle server version (1) Oracle 8.0.5, (2) Oracle 8.0.6, (3) Oracle 8.1.5, (4) Oracle 8.1.6</entry>
	    <entry> </entry>
	    <entry>1<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Extract Oracle Client archive</entry>
	    <entry>[1] (Yes, extract)</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to KERNEL CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/KERNEL</entry>
	  </row>
	  <row>
	    <entry>Enter path to RDBMS CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/RDBMS</entry>
	  </row>
	  <row>
	    <entry>Enter path to EXPORT1 CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/EXPORT1</entry>
	  </row>
	  <row>
	    <entry>Directory to copy EXPORT1 CD</entry>
	    <entry>[/oracle/IDS/sapreorg/CD4_DIR]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to EXPORT2 CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/EXPORT2</entry>
	  </row>
	  <row>
	    <entry>Directory to copy EXPORT2 CD</entry>
	    <entry>[/oracle/IDS/sapreorg/CD5_DIR]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to EXPORT3 CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/EXPORT3</entry>
	  </row>
	  <row>
	    <entry>Directory to copy EXPORT3 CD</entry>
	    <entry>[/oracle/IDS/sapreorg/CD6_DIR]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to EXPORT4 CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/EXPORT4</entry>
	  </row>
	  <row>
	    <entry>Directory to copy EXPORT4 CD</entry>
	    <entry>[/oracle/IDS/sapreorg/CD7_DIR]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to EXPORT5 CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/EXPORT5</entry>
	  </row>
	  <row>
	    <entry>Directory to copy EXPORT5 CD</entry>
	    <entry>[/oracle/IDS/sapreorg/CD8_DIR]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to EXPORT6 CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/IDS/sapreorg/EXPORT6</entry>
	  </row>
	  <row>
	    <entry>Directory to copy EXPORT6 CD</entry>
	    <entry>[/oracle/IDS/sapreorg/CD9_DIR]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter amount of RAM for SAP + DB</entry>
	    <entry> </entry>
	    <entry>850<keycap>Entrée</keycap> (en mégaoctets)</entry>
	  </row>
	  <row>
	    <entry>Service Entry Message Server</entry>
	    <entry>[3600]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Group-ID of sapsys</entry>
	    <entry>[101]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Group-ID of oper</entry>
	    <entry>[102]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Group-ID of dba</entry>
	    <entry>[100]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter User-ID of <replaceable>sid</replaceable>adm</entry>
	    <entry>[1000]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter User-ID of ora<replaceable>sid</replaceable></entry>
	    <entry>[1002]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Number of parallel procs</entry>
	    <entry>[2]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  </tbody>
	  </tgroup>
	</informaltable>

	<para>Si vous n'avez pas copié les CDs en différent
	  endroits, alors l'installeur <application>&sap;</application>
	  ne peut trouver le CD nécessaire (identifié par le
	  fichier <filename>LABEL.ASC</filename> sur le CD) et vous
	  demandera alors d'insérer, de monter le CD et de
	  confirmer ou d'entrer le chemin du point de montage.</para>

	<para>Le fichier <filename>CENTRDB.R3S</filename> peut ne pas
	  être exempt de problème.  Dans notre cas, il demanda
	  &agrave; nouveau le CD EXPORT4 mais indiqua la clé
	  correcte (6_LOCATION, puis 7_LOCATION, etc.), on peut donc
	  juste continuer &agrave; saisir les bonnes valeurs.</para>

	<para>En dehors des problèmes mentionnés plus
	  bas, tout devrait être assez direct jusqu'au moment
	  où la base de données
	  <application>&oracle;</application> doit être
	  installée.</para>
      </sect3>

      <sect3 id="startr3setup-46C">
	<title>Exécuter <command>R3SETUP</command> 4.6C SR2</title>

	<para>Assurez-vous que la variable <envar>LD_LIBRARY_PATH</envar>
	  est correctement positionnée.  La valeur est
	  différente de l'installation 4.6B avec
	  <application>&oracle; 8.0.5</application>:</para>

	<screen>&prompt.root; <userinput>export LD_LIBRARY_PATH=/sapmnt/PRD/exe:/oracle/PRD/817_32/lib</userinput></screen>

	<para>Lancez <command>R3SETUP</command> en tant que
	  <username>root</username> &agrave; partir du répertoire
	  d'installation:</para>

	<screen>&prompt.root; <userinput>cd /oracle/PRD/sapreorg/install</userinput>
&prompt.root; <userinput>./R3SETUP -f CENTRAL.R3S</userinput></screen>

	<para>La procédure pose ensuite un certain nombre de
	  questions (les valeurs par défaut sont entre crochets,
	  suivies par les entrées clavier):</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="3">
	  <thead>
	  <row>
	    <entry>Question</entry>
	    <entry>Défaut</entry>
	    <entry>Entrée(s) clavier</entry>
	  </row>
	  </thead>
	  <tbody>
	  <row>
	    <entry>Enter SAP System ID</entry>
	    <entry>[C11]</entry>
	    <entry>PRD<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter SAP Instance Number</entry>
	    <entry>[00]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter SAPMOUNT Directory</entry>
	    <entry>[/sapmnt]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter name of SAP central host</entry>
	    <entry>[majestix]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Database System ID</entry>
	    <entry>[PRD]</entry>
	    <entry>PRD<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter name of SAP db host</entry>
	    <entry>[majestix]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Select character set</entry>
	    <entry>[1] (WE8DEC)</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Oracle server version (2) Oracle 8.1.7</entry>
	    <entry> </entry>
	    <entry>2<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Extract Oracle Client archive</entry>
	    <entry>[1] (Yes, extract)</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter path to KERNEL CD</entry>
	    <entry>[/sapcd]</entry>
	    <entry>/oracle/PRD/sapreorg/KERNEL</entry>
	  </row>
	  <row>
	    <entry>Enter amount of RAM for SAP + DB</entry>
	    <entry>2044</entry>
	    <entry>1800<keycap>Entrée</keycap> (en mégaoctets)</entry>
	  </row>
	  <row>
	    <entry>Service Entry Message Server</entry>
	    <entry>[3600]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Group-ID of sapsys</entry>
	    <entry>[100]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Group-ID of oper</entry>
	    <entry>[101]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Group-ID of dba</entry>
	    <entry>[102]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter User-ID of <username>oraprd</username></entry>
	    <entry>[1002]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter User-ID of <username>prdadm</username></entry>
	    <entry>[1000]</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>LDAP support</entry>
	    <entry> </entry>
	    <entry>3<keycap>Entrée</keycap> (pas de support)</entry>
	  </row>
	  <row>
	    <entry>Installation step completed</entry>
	    <entry>[1] (continue)</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Choose installation service</entry>
	    <entry>[1] (DB inst,file)</entry>
	    <entry><keycap>Entrée</keycap></entry>
	  </row>
	  </tbody>
	  </tgroup>
	</informaltable>

	<para>Jusqu'ici, la création d'utilisateurs donne une
	  erreur durant l'installation lors des phases
	  OSUSERDBSID_IND_ORA (pour la création de
	  l'utilisateur
	  <username>ora<replaceable>sid</replaceable></username>) et
	  OSUSERSIDADM_IND_ORA (création de l'utilisateur
	  <username><replaceable>sid</replaceable>adm</username>).</para>

	<para>En dehors des problèmes mentionnés plus
	  bas, tout devrait être assez direct jusqu'au moment
	  où la base de données
	  <application>&oracle;</application> doit être
	  installée.</para>
      </sect3>
    </sect2>

    <sect2 id="installingoracle805">
      <title>Installer &oracle; 8.0.5</title>

      <para>Consultez les notes &sap; et les
	<filename>Readme</filename>s d'&oracle; concernant Linux et la
	base de données <application>&oracle;</application> pour
	de possibles problèmes.  La plupart, si ce n'est pas
	tous, de ces problèmes proviennent de
	bibliothèques incompatibles.</para>

      <para>Pour plus d'informations au sujet de l'installation
	d'<application>&oracle;</application>,
	référez-vous au chapitre sur l'<link
	linkend="linuxemu-oracle">installation d'&oracle;.</link></para>

      <sect3 id="installingtheoracle805withorainst">
	<title>Installer &oracle; 8.0.5 avec <command>orainst</command></title>

	<para>Si <application>&oracle; 8.0.5</application> doit
	  être utilisée, des bibliothèques
	  supplémentaires sont nécessaires pour une
	  édition de liens couronnée de succès,
	  comme <application>&oracle; 8.0.5</application> est
	  liée avec une ancienne bibliothèque glibc
	  (RedHat 6.0), cependant RedHat 6.1 utilise
	  déj&agrave; une nouvelle version de la
	  bibliothèque glibc.  Vous devez donc installer les
	  &ldquo;packages&rdquo; suivants pour s'assurer que
	  l'édition de liens fonctionnera:</para>

      <itemizedlist>
	<listitem>
	<para><filename>compat-libs-5.2-2.i386.rpm</filename></para>
	</listitem>
	<listitem>
	<para><filename>compat-glibc-5.2-2.0.7.2.i386.rpm</filename></para>
	</listitem>
	<listitem>
	<para><filename>compat-egcs-5.2-1.0.3a.1.i386.rpm</filename></para>
	</listitem>
	<listitem>
	<para><filename>compat-egcs-c++-5.2-1.0.3a.1.i386.rpm</filename></para>
	</listitem>
	<listitem>
	<para><filename>compat-binutils-5.2-2.9.1.0.23.1.i386.rpm</filename></para>
	</listitem>
      </itemizedlist>

	<para>Consultez les notes &sap; et les
	  <filename>Readme</filename>s d'&oracle; pour plus
	  d'informations.  On pourra utiliser les binaires d'origine
	  (au moment de l'installation, nous n'avons pas eu le temps
	  de contrôler cela), ou utiliser directement les binaires
	  fraichement liés d'un système RedHat.</para>

	<para>Pour la compilation de l'agent intelligent, la
	  version RedHat de Tcl doit être installée.
	  Si vous ne pouvez vous procurer
	  <filename>tcl-8.0.3-20.i386.rpm</filename>, un fichier plus
	  récent comme <filename>tcl-8.0.5-30.i386.rpm</filename> pour
	  RedHat 6.1 fera l'affaire.</para>

	<para>En dehors de ce problème de liens, l'installation est
	  relativement directe:</para>

	<screen>&prompt.root; <userinput>su - oraids</userinput>
&prompt.root; <userinput>export TERM=xterm</userinput>
&prompt.root; <userinput>export ORACLE_TERM=xterm</userinput>
&prompt.root; <userinput>export ORACLE_HOME=/oracle/IDS</userinput>
&prompt.root; <userinput>cd $ORACLE_HOME/orainst_sap</userinput>
&prompt.root; <userinput>./orainst</userinput></screen>

	<para>Confirmez tous les écrans en appuyant sur
	  <keycap>Entrée</keycap> jusqu'&agrave; l'installation
	  complète du logiciel, &agrave; l'exception de celui
	  qui permet de déselectionner la &ldquo;visionneuse de
	  texte &oracle;&rdquo; (<emphasis>&oracle; On-Line Text
	  Viewer</emphasis>), comme cette dernière n'est pas
	  disponible pour Linux.  Ensuite
	  <application>&oracle;</application> veut faire
	  l'édition de liens avec
	  <command>i386-glibc20-linux-gcc</command> &agrave; la place
	  des <command>gcc</command>, <command>egcs</command> ou
	  <command>i386-redhat-linux-gcc</command> disponibles.</para>

	<para>En raison d'un manque de temps, nous avons
	  décidé d'utiliser les binaires d'une version
	  <application>&oracle; 8.0.5 PreProduction</application>,
	  après que la première tentative d'obtenir
	  &agrave; partir du CD RDBMS une version fonctionnant eut
	  échoué, et que nous avons trouvé
	  qu'accéder aux bons RPMs était alors un
	  véritable cauchemar.</para>
      </sect3>

      <sect3 id="installingtheoracle805preproduction">
	<title>Installer la version &oracle; 8.0.5 Pre-production pour
	  Linux (noyau 2.0.33)</title>

	<para>Cette installation est simple.  Montez le CD, lancez
	  l'installeur.  Il vous demandera l'emplacement du
	  répertoire utilisateur
	  <application>&oracle;</application>, et y copiera tous les
	  binaires.  Nous n'avions, cependant, pas effacé les
	  restes de nos précédentes tentatives
	  d'installation RDBMS.</para>

	<para>Après cela, la base de données
	  <application>&oracle;</application> put être
	  installée sans encombres.</para>
      </sect3>
    </sect2>

    <sect2 id="installingoracle817">
      <title>Installer l'archive tar d'&oracle; 8.1.7 pour Linux</title>

      <para>Prennez l'archive <application>tar</application> que vous
	avez produite &agrave; partir du répertoire
	d'installation sur un système Linux, et
	désarchivez-la dans le répertoire <filename
	class='directory'>/oracle/<replaceable>SID</replaceable>/817_32/</filename>.</para>
    </sect2>

    <sect2 id="continuewithsapr4installation">
      <title>Poursuivre l'installation de &sap.r3;</title>

      <para>Tout d'abord vérifiez le paramétrage des
	environnements des utilisateurs <username>idsamd</username>
	(<replaceable>sid</replaceable>adm) et
	<username>oraids</username>
	(ora<replaceable>sid</replaceable>).  Ils devraient avoir,
	tous les deux, des fichiers <filename>.profile</filename>,
	<filename>.login</filename> et <filename>.cshrc</filename> qui
	utilisent la directement la commande
	<command>hostname</command>.  Si le nom de machine du
	système est un nom complet d'hôte, vous devez
	modifier <command>hostname</command> pour <command>hostname
	-s</command> dans ces trois fichiers.</para>

      <sect3 id="databaseload">
	<title>Chargement de la base de données</title>

	<para>Ensuite, <command>R3SETUP</command> peut être soit
	  relancé ou poursuivi (tout dépend si le
	  programme a été quitté ou non).
	  <command>R3SETUP</command> créé ensuite les
	  tables pour les données et charge ces données
	  (pour 46B IDES, &agrave; partir des disques EXPORT1 &agrave;
	  EXPORT6, pour 46C &agrave; partir des disques DISK1 &agrave;
	  DISK4) avec <command>R3load</command> dans la base de
	  données.</para>

	<para>Quand le chargement de la base de données
	  est achevé (cela peut prendre plusieurs heures), des
	  mots de passe sont demandés.  Pour les installations
	  de tests, on peut utiliser les mots de passe
	  par défauts connus (utilisez-en des différents
	  si la sécurité est importante):</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	  <thead>
	  <row>
	    <entry>Question</entry>
	    <entry>Entrée(s) clavier</entry>
	  </row>
	  </thead>
	  <tbody>
	  <row>
	    <entry>Enter Password for sapr3</entry>
	    <entry>sap<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Confirum Password for sapr3</entry>
	    <entry>sap<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Password for sys</entry>
	    <entry>change_on_install<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Confirm Password for sys</entry>
	    <entry>change_on_install<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Enter Password for system</entry>
	    <entry>manager<keycap>Entrée</keycap></entry>
	  </row>
	  <row>
	    <entry>Confirm Password for system</entry>
	    <entry>manager<keycap>Entrée</keycap></entry>
	  </row>
	  </tbody>
	  </tgroup>
	</informaltable>

	<para>A ce point, nous avons eut quelques problèmes
	  avec <command>dipgntab</command> durant l'installation de la
	  version 4.6B.</para>
      </sect3>

      <sect3 id="listener">
	<title>Programme d'écoute</title>

	<para>Démarrer le programme d'écoute
	  (&ldquo;listener&rdquo;) d'<application>&oracle;</application>
	  sous l'utilisateur
	  <username>ora<replaceable>sid</replaceable></username> comme
	  suit:</para>

	<screen>&prompt.user; <userinput>umask 0; lsnrctl start</userinput></screen>

	<para>Sinon vous risquez d'obtenir l'erreur
	  <errorcode>ORA-12546</errorcode> comme les
	  &ldquo;sockets&rdquo; n'auront pas les bonnes permissions.
	  Consultez la note &sap; 072984.</para>
      </sect3>

      <sect3 id="mnlstables">
	<title>Mettre &agrave; jour les tables MNLS</title>

	<para>Si vous projetez d'importer des données utilisant
	  des langues non latin-1 dans le système
	  <application>&sap;</application>, vous devez mettre &agrave;
	  jour les tables de support des langues internationales
	  (&ldquo;Multi National Language Support&rdquo; &mdash;
	  MNLS).  Ceci est décrit dans les notes &sap; OSS 15023
	  et 45619.  Sinon, vous pouvez ignorer cette question lors de
	  l'installation de <application>&sap;</application>.</para>

	<note><para>Si vous n'avez pas besoin des tables MNLS, il est
	  toujours nécessaire de contrôler la table TCPDB
	  et l'initialiser si cela n'a pas déj&agrave;
	  été fait.  Consultez les notes 0015023 et
	  0045619 pour plus d'information.</para></note>
      </sect3>
    </sect2>

    <sect2 id="postinstallationsteps">
      <title>Etapes de post-installation</title>

      <sect3 id="requestsapr3licensekey">
	<title>Demander une clé licence pour &sap.r3;</title>

	<para>Vous devez demander votre clé
	  <application>&sap.r3;</application>.  Cette clé est indispensable
	  étant donné que la licence temporaire qui a
	  été installée lors de l'installation
	  n'est valide que pendant quatre semaines.  Tout d'abord
	  récupérez la clé matérielle.
	  Ouvrez une session sous l'utilisateur
	  <username>idsadm</username> et lancez la commande
	  <command>saplicense</command>:</para>

	<screen>&prompt.root; <userinput>/sapmnt/IDS/exe/saplicense
	-get</userinput></screen>

	<para>Appeler <command>saplicense</command> sans
	  paramètres affiche la liste des options disponibles.
	  Après la réception de la clé, elle peut
	  être installée en utilisant:</para>

	<screen>&prompt.root; <userinput>/sapmnt/IDS/exe/saplicense -install</userinput></screen>

	<para>Vous devez ensuite entrer les valeurs suivantes:</para>

	<programlisting>SAP SYSTEM ID   = <replaceable>SID, 3 chars</replaceable>
CUSTOMER KEY    = <replaceable>hardware key, 11 chars</replaceable>
INSTALLATION NO = <replaceable>installation, 10 digits</replaceable>
EXPIRATION DATE = <replaceable>yyyymmdd, usually "99991231"</replaceable>
LICENSE KEY     = <replaceable>license key, 24 chars</replaceable></programlisting>
      </sect3>

      <sect3 id="creatingusers">
	<title>Créer les utilisateurs</title>

	<para>Créez un utilisateur sous le client 000
	  (certaines tâches doivent être effectuées
	  sous le client 000, mais avec un utilisateur
	  différent de <username>sap*</username> et
	  <username>ddic</username>).  Comme nom d'utilisateur, nous
	  choisissons généralement
	  <username>wartung</username> (ou
	  <username>service</username> en français).  Les
	  profiles nécessaires sont <literal>sap_new</literal>
	  et <literal>sap_all</literal>.  Pour plus de
	  sécurité les mots de passe des utilisateurs
	  par défaut &agrave; l'intérieur de tous les
	  clients devraient être modifiés (cela inclut
	  les utilisateurs <username>sap*</username> et
	  <username>ddic</username>).</para>
      </sect3>

      <sect3 id="configtranssysprofileopermodesetc">
	<title>Configurer le système de transport, les profils,
	  les modes d'opération, etc.</title>

	<para>Dans le client 000, avec un utilisateur autre que
	  <username>ddic</username> et <username>sap*</username>,
	  faire, au moins, ce qui suit:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	  <thead>
	    <row>
	      <entry>Tâche</entry>
	      <entry>Transaction</entry>
	    </row>
	  </thead>
	  <tbody>
	    <row>
	      <entry>Configurez le système de transport, par
		exemple <emphasis>entité autonome de domaine
		de transport</emphasis> (<emphasis>Stand-Alone
		Transport Domain Entity</emphasis>)</entry>
	      <entry>STMS</entry>
	    </row>
	    <row>
	      <entry>Créez / Editez le profil système</entry>
	      <entry>RZ10</entry>
	    </row>
	    <row>
	      <entry>Maintenez les modes d'opération et les
		instances</entry>
	      <entry>RZ04</entry>
	    </row>
	  </tbody>
	  </tgroup>
	</informaltable>

	<para>Cela et toutes les autres étapes de
	  post-installation sont intégralement décrites
	  dans les guides d'installation
	  <application>&sap;</application>.</para>
      </sect3>

      <sect3 id="editintsidsap">
	<title>Editer
	  <filename>init<replaceable>sid</replaceable>.sap</filename>
	  (<filename>initIDS.sap</filename>)</title>

	<para>Le fichier
	  <filename>/oracle/IDS/dbs/initIDS.sap</filename> contient le
	  profil de sauvegarde <application>&sap;</application>.  Ici la
	  taille de la bande &agrave; utiliser, le type de compression
	  et ainsi de suite doivent être définis.  Pour
	  garantir un fonctionnement avec les commandes
	  <command>sapdba</command>/<command>brbackup</command>, nous
	  avons modifié les valeurs suivantes:</para>

	<programlisting>compress = hardware
archive_function = copy_delete_save
cpio_flags = "-ov --format=newc --block-size=128 --quiet"
cpio_in_flags = "-iuv --block-size=128 --quiet"
tape_size = 38000M
tape_address = /dev/nsa0
tape_address_rew = /dev/sa0</programlisting>

	<para>Explications:</para>

	<para><varname>compress</varname>: la bande que nous utilisons
	  est une HP DLT1 qui fournie une compression
	  matérielle.</para>

	<para><varname>archive_function</varname>: définie le
	  comportement par défaut en ce qui concerne
	  l'archivage des fichiers journaux
	  d'<application>&oracle;</application>: les nouveaux journaux
	  sont sauvegardés sur la bande, ceux
	  déj&agrave; sauvegardés le sont &agrave;
	  nouveau et sont ensuite effacés.  Cela évite
	  de nombreux problèmes si vous devez rétablir
	  la base de données, et qu'une des bandes de
	  sauvegarde est endommagée.</para>

	<para><varname>cpio_flags</varname>: l'indicateur par
	  défaut est <option>-B</option> qui fixe la taille
	  d'un bloc &agrave; 5120 octets.  Pour les bande DLT, HP
	  recommande une taille de bloc d'au moins 32Ko, aussi nous
	  avons utilisé <option>--block-size=128</option> pour
	  64Ko.  L'option <option>--format=newc</option> est
	  nécessaire car nous avons un nombre d'inodes
	  supérieur &agrave; 65535.  La dernière option,
	  <option>--quiet</option>, est nécessaire sinon
	  <command>brbackup</command> se plaint dès que
	  <command>cpio</command> donne le nombre de blocs
	  sauvés.</para>

	<para><varname>cpio_in_flags</varname>: indicateurs
	  nécessaires pour charger les données &agrave;
	  partir de bandes.  Le format est reconnu
	  automatiquement.</para>

	<para><varname>tape_size</varname>: cette variable donne la
	  capacité brute de la bande.  Pour des raisons de
	  sécurité (nous utilisons une compression
	  matérielle), la valeur est légèrement
	  inférieure &agrave; la valeur réelle.</para>

	<para><varname>tape_address</varname>: le
	  périphérique non rembobinable devant
	  être utilisé avec
	  <command>cpio</command>.</para>

	<para><varname>tape_address_rew</varname>: le
	  périphérique rembobinable &agrave; utiliser
	  avec <command>cpio</command>.</para>
      </sect3>

      <sect3>
	<title>Problèmes de configuration après
	  l'installation</title>

	<para>Les paramètres <application>&sap;</application>
	  suivants devraient être optimisés après
	  l'installation (exemples pour IDES 46B, 1&nbsp;Go de
	  mémoire):</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	    <thead>
	      <row>
		<entry>Nom</entry>
		<entry>Valeur</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry>ztta/roll_extension</entry>
		<entry>250000000</entry>
	      </row>
	      <row>
		<entry>abap/heap_area_dia</entry>
                <entry>300000000</entry>
	      </row>
	      <row>
		<entry>abap/heap_area_nondia</entry>
		<entry>400000000</entry>
	      </row>
	      <row>
		<entry>em/initial_size_MB</entry>
		<entry>256</entry>
	      </row>
	      <row>
		<entry>em/blocksize_kB</entry>
		<entry>1024</entry>
	      </row>
	      <row>
		<entry>ipc/shm_psize_40</entry>
		<entry>70000000</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

	<para>Note &sap; 0013026:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	    <thead>
	      <row>
		<entry>Nom</entry>
		<entry>Valeur</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry>ztta/dynpro_area</entry>
		<entry>2500000</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

	<para>Note &sap; 0157246:</para>

	<informaltable frame="none" pgwide="1">
	  <tgroup cols="2">
	    <thead>
	      <row>
		<entry>Nom</entry>
		<entry>Valeur</entry>
	      </row>
	    </thead>
	    <tbody>
	      <row>
		<entry>rdisp/ROLL_MAXFS</entry>
		<entry>16000</entry>
	      </row>
	      <row>
		<entry>rdisp/PG_MAXFS</entry>
		<entry>30000</entry>
	      </row>
	    </tbody>
	  </tgroup>
	</informaltable>

	<note>
	  <para>Avec les paramètres donnés ci-dessus,
	  sur un système avec 1Go de mémoire, on pourra
	  avoir une utilisation de la mémoire similaire
	  &agrave;:</para>

	  <programlisting>Mem: 547M Active, 305M Inact, 109M Wired, 40M Cache, 112M Buf, 3492K Free</programlisting>
	</note>
      </sect3>
    </sect2>

    <sect2 id="problemsduringinstallation">
      <title>Problèmes lors de l'installation</title>

      <sect3 id="restartr3setup">
	<title>Relancer <command>R3SETUP</command> après la correction
	  d'un problème</title>

	<para><command>R3SETUP</command> s'arrête s'il rencontre
	  une erreur.  Si vous avez examiné les fichiers
	  journaux correspondants et corrigé l'erreur, vous
	  devez relancer <command>R3SETUP</command> &agrave; nouveau,
	  habituellement en sélectionnant
	  <option>REPEAT</option> comme option de la dernière
	  étape pour laquelle <command>R3SETUP</command> avait
	  rencontré un problème.</para>

	<para>Pour relancer <command>R3SETUP</command>,
	  exécutez-le avec le fichier <filename>R3S</filename>
	  correspondant:</para>

	<screen>&prompt.root; <userinput>./R3SETUP -f CENTRDB.R3S</userinput></screen>
	<para>pour la version 4.6B, ou avec</para>

	<screen>&prompt.root; <userinput>./R3SETUP -f CENTRAL.R3S</userinput></screen>

	<para>pour la version 4.6C, peu importe si l'erreur est
	  apparue avec <filename>CENTRAL.R3S</filename> ou
	  <filename>DATABASE.R3S</filename>.</para>

	<note>
	  <para>A certains points, <command>R3SETUP</command> suppose
	    que la base de données et le processus
	    <application>&sap;</application> sont en fonctionnement (comme
	    s'il avait déj&agrave; complété ces
	    étapes).  Au cas où les erreurs se
	    produiraient et que par exemple la base de données ne
	    peut être lancée, vous devez lancer la base de
	    données et <application>&sap;</application> &agrave; la
	    main après avoir corrigé les erreurs et avant
	    d'exécuter &agrave; nouveau
	    <command>R3SETUP</command>.</para>

	  <para>N'oubliez pas également de démarrer le
	    programme d'écoute
	    d'<application>&oracle;</application> &agrave; nouveau (en
	    tant que
	    <username>ora<replaceable>sid</replaceable></username>
	    avec <command>umask 0; lsnrctl start</command>) s'il a
	    également été stoppé (par
	    exemple en raison d'un redémarrage du
	    système).</para>
	</note>
      </sect3>

      <sect3 id="indoraduringduringr3setup">
	<title>Etape OSUSERSIDADM_IND_ORA lors de l'utilisation de
	  <command>R3SETUP</command></title>

        <para>Si <command>R3SETUP</command> se plaint &agrave; ce stade,
	  éditez le fichier modèle utilisé par
	  <command>R3SETUP</command> &agrave; ce moment
	  (<filename>CENTRDB.R3S</filename> (4.6B) ou
	  <filename>CENTRAL.R3S</filename> ou
	  <filename>DATABASE.R3S</filename> (4.6C)).  Localisez la
	  ligne <literal>[OSUSERSIDADM_IND_ORA]</literal> ou cherchez
	  l'unique entrée <literal>STATUS=ERROR</literal> et
	  éditez les valeurs suivantes:</para>

	<programlisting>HOME=/home/<replaceable>sid</replaceable>adm (was empty)
STATUS=OK (had status ERROR)</programlisting>

	<para>Vous pouvez ensuite relancer
	  <command>R3SETUP</command>.</para>
      </sect3>

      <sect3 id="indoraduringr3setup">
	<title>Etape OSUSERDBSID_IND_ORA lors de l'utilisation de
	  <command>R3SETUP</command></title>

	<para>Il est possible que <command>R3SETUP</command> se
	  plaigne également &agrave; ce stade.  L'erreur ici
	  est similaire &agrave; celle durant la phase
	  OSUSERSIDADM_IND_ORA.  Editez juste le fichier modèle
	  utilisé par <command>R3SETUP</command> &agrave; ce
	  moment (<filename>CENTRDB.R3S</filename> (4.6B) ou
	  <filename>CENTRAL.R3S</filename> ou
	  <filename>DATABASE.R3S</filename> (4.6C)).  Localisez la
	  ligne <literal>[OSUSERDBSID_IND_ORA]</literal> ou cherchez
	  l'unique entrée <literal>STATUS=ERROR</literal> et
	  éditez la valeur suivante dans la section:</para>

	<programlisting>STATUS=OK</programlisting>

	<para>Puis relancez <command>R3SETUP</command>.</para>
      </sect3>

      <sect3 id="oraviewvrffilenotfound">
	<title>Erreur <errorname>oraview.vrf FILE NOT FOUND</errorname>
	  lors de l'installation d'&oracle;</title>

	<para>Vous n'avez pas désélectionné la
	  <emphasis>visionneuse de texte en ligne d'&oracle;</emphasis>
	  avant de débuter l'installation.  Elle est
	  sélectionnée par défaut même si
	  cette option n'est actuellement pas disponible pour Linux.
	  Désélectionnez cet élément dans
	  le menu d'installation d'<application>&oracle;</application>
	  et relancez l'installation.</para>
      </sect3>

      <sect3 id="textenvincalid">
	<title>Erreur <errorname>TEXTENV_INVALID</errorname> lors du
	  lancement de <command>R3SETUP</command>, RFC ou SAPgui</title>

	<para>Si cette erreur apparaît, la &ldquo;locale&rdquo;
	  correcte n'est pas présente.  La note &sap; 0171356
	  liste les RPMs nécessaires (e.g.
	  <filename>saplocales-1.0-3</filename>,
	  <filename>saposcheck-1.0-1</filename> pour RedHat 6.1).
	  Dans le cas où vous avez ignoré toutes les
	  erreurs en rapport et modifié la valeur du
	  <literal>STATUS</literal> correspondant de la valeur
	  <literal>ERROR</literal> vers la valeur
	  <literal>OK</literal> (dans
	  <filename>CENTRDB.R3S</filename>) &agrave; chaque fois que
	  <command>R3SETUP</command> s'est plaint et que vous avez
	  relancé <command>R3SETUP</command>, le système
	  <application>&sap;</application> ne sera pas correctement
	  configuré et vous ne serez pas en mesure de vous
	  connecter au système avec
	  <application>SAPgui</application>, même si le
	  système peut être lancé.  Tenter de se
	  connecter avec l'ancien <application>SAPgui</application>
	  Linux donna les messages suivants:</para>

	<programlisting>Sat May 5 14:23:14 2001
*** ERROR => no valid userarea given [trgmsgo. 0401]
Sat May 5 14:23:22 2001
*** ERROR => ERROR NR 24 occured [trgmsgi. 0410]
*** ERROR => Error when generating text environment. [trgmsgi. 0435]
*** ERROR => function failed [trgmsgi. 0447]
*** ERROR => no socket operation allowed [trxio.c 3363]
Speicherzugriffsfehler</programlisting>

	<para>Ce comportement est dû au fait que
	  <application>&sap.r3;</application> est incapable d'assigner
	  correctement une &ldquo;locale&rdquo; et n'est
	  lui-même pas correctement configuré
	  (entrées manquantes dans certaines tables de la base
	  de données).  Pour être en mesure de se
	  connecter &agrave; <application>&sap;</application>, ajoutez
	  les entrées suivantes au fichier
	  <filename>DEFAULT.PFL</filename> (voir la note
	  0043288):</para>

	<programlisting>abap/set_etct_env_at_new_mode = 0
install/collate/active = 0
rscp/TCP0B = TCP0B</programlisting>

	<para>Redémarrer le système
	  <application>&sap;</application>.  Vous pouvez maintenant vous
	  connecter au système, même si les
	  paramétrages spécifiques &agrave; certaines
	  langues peuvent ne pas fonctionner comme attendu.
	  Après la correction des paramétrages de langue
	  (et après avoir fourni les &ldquo;locales&rdquo;
	  correctes), ces entrées peuvent être
	  supprimées du fichier
	  <filename>DEFAULT.PFL</filename> et le système
	  <application>&sap;</application> peut être
	  relancé.</para>
      </sect3>

      <sect3 id="ora-00001">
	<title>Erreur <errorcode>ORA-00001</errorcode></title>

	<para>Cette erreur s'est produite uniquement avec
	  <application>&oracle; 8.1.7</application> sous &os;.
	  La raison était que la base de données
	  <application>&oracle;</application> ne pouvait pas
	  s'initialiser correctement et plantait, laissant des
	  sémaphores et de la mémoire partagée
	  sur le système.  La tentative suivante de
	  démarrer la base de données retourna alors
	  l'erreur <errorcode>ORA-00001</errorcode>.</para>

	<para>Retrouvez-les avec la commande <command>ipcs
	  -a</command> et détruisez-les avec
	  <command>ipcrm</command>.</para>
      </sect3>

      <sect3 id="ora-00445pmon">
	<title>Erreur <errorcode>ORA-00445</errorcode>
	  (le processus en tâche de fond PMON n'a pas
	  démarré &mdash; &ldquo;Background Process PMON Did Not
	  Start&rdquo;)</title>

	<para>Cette erreur s'est produite avec <application>&oracle;
	  8.1.7</application>.  Cette erreur est rapportée si
	  la base de données est démarrée avec la
	  procédure <command>startsap</command> habituelle (par
	  exemple <command>startsap_majestix_00</command>) en tant
	  qu'utilisateur <username>prdadm</username>.</para>

	<para>Une solution possible est de démarrer la base de
	  données sous l'utilisateur
	  <username>oraprd</username> avec la commande
	  <command>svrmgrl</command>:</para>

	<screen>&prompt.user; <userinput>svrmgrl</userinput>
SVRMGR&gt; <userinput>connect internal;</userinput>
SVRMGR&gt; <userinput>startup</userinput>;
SVRMGR&gt; <userinput>exit</userinput></screen>
      </sect3>

      <sect3 id="ora-12546">
	<title>Erreur <errorcode>ORA-12546</errorcode> (Lancez le
	  programme d'écoute avec les droits corrects &mdash;
	  &ldquo;Start Listener with Correct
	  Permissions&rdquo;)</title>

	<para>Démarrez le programme d'écoute
	  (&ldquo;listener&rdquo;) d'<application>&oracle;</application>
	  sous l'utilisateur <username>oraids</username> avec les
	  commandes suivantes:</para>

	<screen>&prompt.root; <userinput>umask 0; lsnrctl start</userinput></screen>

	<para>Sinon vous pourrez obtenir l'erreur
	  <errorcode>ORA-12546</errorcode> étant donné que les
	  &ldquo;sockets&rdquo; n'auront pas les bonnes permissions.
	  Consultez la note &sap; 0072984.</para>
      </sect3>

      <sect3 id="ora-27102">
	<title>Erreur <errorcode>ORA-27102</errorcode> (Mémoire
	  épuisée &mdash; &ldquo;Out of Memory&rdquo;)</title>

	<para>Cette erreur s'est produite quand nous avons essayé
	  des valeurs pour <literal>MAXDSIZ</literal> et
	  <literal>DFLDSIZ</literal> supérieures &agrave; 1&nbsp;Go
	  (1024x1024x1024).  De plus, nous avons eu l'erreur
	  <errorname>Linux Error 12: Cannot allocate
	  memory</errorname>.</para>
      </sect3>

      <sect3 id="dipgntabindind">
	<title>Erreur [DIPGNTAB_IND_IND] lors de l'utilisation de
	  <command>R3SETUP</command></title>

	<para>En général, vous devez consulter la note &sap;
	  0130581 (&ldquo;<command>R3SETUP</command> step
	  <literal>DIPGNTAB</literal> terminates&rdquo;).  Lors de
	  l'installation d'IDES, pour certaines raisons le processus
	  d'installation n'a pas utilisé le nom correct pour le
	  système <application>&sap;</application> &ldquo;IDS&rdquo;,
	  mais la chaîne de caractère <literal>""</literal>
	  &agrave; la place.  Cela conduit &agrave; des problèmes
	  mineurs d'accès aux répertoires, comme les chemins
	  sont générés dynamiquement en utilisant
	  l'identifiant système
	  <replaceable>SID</replaceable> (dans ce cas IDS).  Aussi
	  au lieu d'accéder par:</para>

	<programlisting>/usr/sap/IDS/SYS/...
/usr/sap/IDS/DVMGS00</programlisting>

	<para>les chemins suivants ont été
	  utilisé:</para>

	<programlisting>/usr/sap//SYS/...
/usr/sap/D00</programlisting>

	<para>Afin de poursuivre l'installation, nous avons
	  créé un lien et un répertoire
	  supplémentaire:</para>

	<screen>&prompt.root; <userinput>pwd</userinput>
/compat/linux/usr/sap
&prompt.root; <userinput>ls -l</userinput>
total 4
drwxr-xr-x 3  idsadm sapsys 512 May 5 11:20 D00
drwxr-x--x 5  idsadm sapsys 512 May 5 11:35 IDS
lrwxr-xr-x 1  root   sapsys 7 May 5 11:35 SYS -&gt; IDS/SYS
drwxrwxr-x 2  idsadm sapsys 512 May 5 13:00 tmp
drwxrwxr-x 11 idsadm sapsys 512 May 4 14:20 trans</screen>

	<para>Nous avons également trouvé des notes &sap;
	  (0029227 et 0008401) décrivant ce comportement.  Nous
	  n'avons pas rencontré un seul de ces problèmes
	  lors de l'installation de <application>SAP
	  4.6C</application>.</para>
      </sect3>

      <sect3 id="rfcrswboiniindind">
	<title>Erreur [RFCRSWBOINI_IND_IND] lors de l'utilisation de
	  <command>R3SETUP</command></title>

	<para>Lors de l'installation de
	  <application>SAP 4.6C</application>, cette erreur est juste
	  une conséquence d'une autre erreur survenant plus
	  tôt dans l'installation.  Dans ce cas, vous devez
	  consulter les fichiers journaux correspondant et corriger
	  le véritable problème.</para>

	<para>Si après avoir cherché dans les fichiers
	  journaux cette erreur est confirmée (consultez les
	  notes &sap;), vous pouvez modifier la valeur du
	  <literal>STATUS</literal> de l'étape posant
	  problème de la valeur <literal>ERROR</literal>
	  &agrave; la valeur <literal>OK</literal>.  Après
	  l'installation, vous devez exécuter le report
	  <literal>RSWBOINS</literal> &agrave; partir de la
	  transaction SE38.  Lire la note &sap; 0162266 pour des
	  informations supplémentaires au sujet des phases
	  <literal>RFCRSWBOINI</literal> et
	  <literal>RFCRADDBDIF</literal>.</para>
      </sect3>

      <sect3 id="rfcraddbdifindind">
	<title>Erreur [RFCRADDBDIF_IND_IND] lors de l'utilisation de
	  <command>R3SETUP</command></title>

	<para>Ici les même restrictions s'appliquent:
	  assurez-vous en consultant les fichiers journaux, que cette
	  erreur n'est pas causée par d'autres problèmes
	  apparus précédemment.</para>

	<para>Si vous avez confirmation que la note &sap; 0162266
	  s'applique, modifiez juste la valeur du
	  <literal>STATUS</literal> de l'étape posant
	  problème de la valeur <literal>ERROR</literal>
	  &agrave; la valeur <literal>OK</literal> (fichier
	  <filename>CENTRDB.R3S</filename>) et relancez
	  <command>R3SETUP</command>.  Après l'installation,
	  vous devez exécuter le report
	  <literal>RADDBDIF</literal> &agrave; partir de la
	  transaction SE38.</para>
      </sect3>

      <sect3 id="sigactionsig31">
	<title>Erreur <errorcode>sigaction sig31: File size limit
	  exceeded</errorcode></title>

	<para>Cette erreur s'est produite lors du lancement des
	  processus <application>&sap;</application>
	  <emphasis>disp+work</emphasis>.  Si
	  <application>&sap;</application> est démarré
	  avec la procédure <command>startsap</command>, les
	  sous-processus sont alors lancés, et lancent les
	  autres processus <application>&sap;</application>.  Cela a
	  pour résultat le fait que la procédure ne
	  remarquera pas si quelque chose se passe mal.</para>

	<para>Pour contrôler si les processus
	  <application>&sap;</application> ont démarré
	  correctement, consultez l'état des processus avec la
	  commande <command>ps ax | grep
	  <replaceable>SID</replaceable></command>, qui vous donnera
	  une liste de tous les processus
	  <application>&oracle;</application> et
	  <application>&sap;</application>.  S'il semble que certains
	  processus sont manquant ou que vous ne pouvez pas vous
	  connecter au système <application>&sap;</application>,
	  consultez les fichiers journaux correspondants qui peuvent
	  être trouvés dans le répertoire
	  <filename
	  class='directory'>/usr/sap/<replaceable>SID</replaceable>/DVEBMGS<replaceable>nr</replaceable>/work/</filename>.
	  Les fichiers &agrave; consulter sont
	  <filename>dev_ms</filename> et
	  <filename>dev_disp</filename>.</para>

	<para>Le signal 31 se produit ici si la quantité de
	  mémoire partagée utilisée par
	  <application>&oracle;</application> et
	  <application>&sap;</application> dépasse celle
	  définie dans le fichier de configuration du noyau et
	  ce problème peut être résolu en
	  utilisant une valeur plus grande:</para>

	<programlisting># larger value for 46C production systems:
options SHMMAXPGS=393216
# smaller value sufficient for 46B:
#options SHMMAXPGS=262144</programlisting>
      </sect3>

      <sect3 id="saposcolfails">
	<title>Le lancement de <command>saposcol</command>
	  échoue</title>

	<para>Il y a quelques problèmes avec le programme
	  <command>saposcol</command> (version 4.6D).  Le
	  système &sap; utilise <command>saposcol</command> pour
	  collecter les données concernant les performances du
	  système.  Ce programme n'est pas nécessaire
	  pour utiliser le système &sap;, aussi ce
	  problème peut être considéré
	  comme mineur.  Les anciennes versions (4.6B) fonctionnent,
	  mais ne récupèrent pas toutes les
	  données (nombreux sont les appels qui retournent
	  juste 0, par exemple pour l'utilisation du CPU).</para>
      </sect3>
    </sect2>
  </sect1>

  <sect1 id="linuxemu-advanced">
    <title>Sujets avancés</title>

    <para>Si vous êtes curieux de savoir comment la
      compatibilité binaire avec Linux fonctionne, cette
      section est faite pour vous.  La plupart de ce qui suit est
      principalement basé sur un courrier électronique
      de Terry Lambert <email>tlambert@primenet.com</email>
      envoyé &agrave; la &a.chat; (Message ID:
      <literal>&lt;199906020108.SAA07001@usr09.primenet.com&gt;</literal>).</para>

    <sect2>
      <title>Comme ça marche?</title>

      <indexterm><primary>chargeur de classe d'exécution</primary></indexterm>

      <para>&os; possède une abstraction appelée
	&ldquo;chargeur de classe d'exécution&rdquo;.  C'est
	une portion de l'appel système &man.execve.2;.</para>

      <para>Ce qui se passe est que &os; dispose d'une liste de
	chargeurs, &agrave; la place d'un simple chargeur avec retour
	(&ldquo;fallback&rdquo;) vers le chargeur
	<literal>#!</literal> pour exécuter n'importe quel
	interpréteur de commandes ou procédure.</para>

      <para>Historiquement, l'unique chargeur sur les plate-formes
	&unix; examinait le nombre magique (généralement
	les 4 ou 8 premiers octets du fichier) pour voir si
	c'était un binaire connu par le système, et si
	c'était le cas, invoquait le chargeur binaire.</para>

      <para>Si ce n'était pas le type de binaire du
	système, l'appel &man.execve.2; retournait un
	échec, et l'interpréteur de commandes tentait de
	l'exécuter comme une commande
	d'interpréteur.</para>

      <para>Cette hypothèse est celle par défaut quelque
	soit l'interpréteur de commandes actuel.</para>

      <para>Plus tard, une modification a été faite sur
	&man.sh.1; pour examiner les deux premiers caractères,
	et s'ils étaient <literal>:\n</literal>, alors elle
	invoquait l'interpréteur de commandes &man.csh.1;
	&agrave; la place (nous pensons que l'entreprise SCO fut la
	première &agrave; faire cette modification).</para>

      <para>Ce que fait maintenant &os; est de parcourir une liste de
	chargeurs, avec un chargeur <literal>#!</literal>
	générique qui reconnaît les noms des
	interpréteurs qui se trouvent après le
	caractère espace suivant, puis avec un retour possible
	vers <filename>/bin/sh</filename>.</para>
      <indexterm><primary>ELF</primary></indexterm>

      <para>Pour le support de l'ABI Linux, &os; voit le nombre
	magique comme un binaire ELF (il ne fait pas la
	différence &agrave; ce niveau entre &os;, &solaris;,
	Linux, ou tout autre système d'exploitation qui dispose
	d'un type d'image ELF).</para>
      <indexterm><primary>Solaris</primary></indexterm>

      <para>Le chargeur ELF recherche une <emphasis>marque</emphasis>
	spécifique, qui se trouve dans une section de commentaire
	dans l'image ELF, et qui n'est pas présente dans les
	binaires SVR4/&solaris; ELF.</para>

      <para>Pour que les binaires Linux puissent fonctionner, ils
	doivent être <emphasis>marqués</emphasis> sous le
	type <literal>Linux</literal> avec &man.brandelf.1;:</para>

      <screen>&prompt.root; <userinput>brandelf -t Linux file</userinput></screen>

      <para>Quand cela est fait, le chargeur ELF verra le marquage
	<literal>Linux</literal> sur le fichier.</para>
      <indexterm>
	<primary>ELF</primary>
	<secondary>marquage</secondary>
      </indexterm>

      <para>Lorsque le chargeur ELF voit le marquage
	<literal>Linux</literal>, le chargeur remplace un pointeur
	dans la structure <literal>proc</literal>.  Tous les appels
	système sont indéxés par
	l'intermédiaire de ce pointeur (dans un système
	&unix; traditionnel, cela serait la structure
	<literal>sysent[]</literal>, contenant les appels
	système).  De plus, le processus est marqué pour
	une gestion spéciale du vecteur d'interruption
	(&ldquo;trap&rdquo;) pour le signal de code
	&ldquo;trampoline&rdquo;, et plusieurs autres corrections
	(mineures) qui sont gérées par le noyau
	Linux.</para>

      <para>Le vecteur d'appel système Linux contient, entre
	autres, une liste des entrées
	<literal>sysent[]</literal> dont les adresses résident
	dans le noyau.</para>

      <para>Quand un appel système est effectué par le
	binaire Linux, le code &ldquo;trap&rdquo;
	déréférence de la structure
	<literal>proc</literal> le pointeur de la fonction de l'appel
	système, et utilise les points d'entrée Linux,
	et non pas &os;, de d'appel système.</para>

      <para>De plus, le mode Linux redéfinit dynamiquement
	l'origine des requêtes; c'est, en effet, ce qu'effectue
	l'option <option>union</option> (<emphasis>pas</emphasis> le
	type de système de fichiers
	<literal>unionfs</literal>!) de montage des systèmes de
	fichiers.  Tout d'abord, une tentative est faite pour
	rechercher le fichier dans le répertoire <filename
	class='directory'>/compat/linux/<replaceable>chemin-origine</replaceable></filename>,
	<emphasis>puis</emphasis> uniquement si cela échoue, la
	recherche est effectuée dans le répertoire
	<filename
	class='directory'>/<replaceable>chemin-origine</replaceable></filename>.
	Cela permet de s'assurer que les binaires nécessitant
	d'autres binaires puissent s'exécuter (par exemple,
	l'ensemble des outils Linux peuvent tourner sous l'ABI Linux).
	Cela signifie également que les binaires Linux peuvent
	charger et exécuter les binaires &os;, s'il n'y a pas
	de binaires Linux correspondant présents, et vous
	pourriez placer une commande &man.uname.1; dans l'arborescence
	<filename class='directory'>/compat/linux</filename> pour vous
	assurer que les binaires Linux ne puissent pas dire qu'ils ne
	tournent pas sous Linux.</para>

      <para>En effet, il y a un noyau Linux dans le noyau &os;; les
	diverses fonctions sous-jacentes qui implémentent tous
	les services fournis par le noyau sont identiques entre les
	deux tables d'entrées des appels systèmes &os;
	et Linux: les opérations sur les systèmes de
	fichiers, les opérations sur la mémoire
	virtuelle, la gestion des signaux, l'IPC System V, etc.  La
	seule différence est que les binaires &os; utilisent
	les fonctions <emphasis>glue</emphasis> de &os;, et les
	binaires Linux celles de Linux (les plus anciens
	systèmes d'exploitation avaient uniquement leurs
	propres fonctions de <emphasis>glue</emphasis>: les adresses
	des fonctions dans une structure <literal>sysent[]</literal>
	statique globale, au lieu des adresses des fonctions
	déréférencées d'un pointeur
	initialisé dynamiquement pointant vers la structure
	<literal>proc</literal> du processus faisant l'appel).</para>

      <para>Laquelle est l'ABI native &os;?  Cela n'a pas
	d'importance.  Basiquement, la seule différence est que
	(actuellement, cela pourrait facilement changer dans les
	versions futures, et probablement après cela) les
	fonctions <emphasis>glue</emphasis> de &os; sont liées
	en statique dans le noyau, les fonctions
	<emphasis>glue</emphasis> Linux peuvent être
	liées statiquement, ou l'on peut y accéder via
	un module du noyau.</para>

      <para>Oui, mais est-ce vraiment de l'émulation?  Non.
	C'est l'implémentation d'une interface binaire pour les
	applications (ABI).  Il n'y a pas d'émulateur (ou de
	simulateur, pour couper court aux prochaines questions)
	impliqué.</para>

      <para>Mais pourquoi appelle-t-on parfois cela
	&ldquo;émulation Linux&rdquo;?  Pour rendre difficile
	la vente des versions de &os;!  Sérieusement, c'est
	dû au fait que l'implémentation historique a
	été faite &agrave; une époque où
	il n'y avait pas vraiment d'autres mots pour décrire ce
	qui était en développement; dire que &os;
	exécutait les binaires Linux n'était pas vrai si
	vous n'aviez pas compilé le code ou chargé un
	module, aussi un terme était nécessaire pour
	qualifier ce qui était chargé &mdash; donc
	l'&ldquo;émulateur Linux&rdquo;.</para>
    </sect2>
  </sect1>
</chapter>
