<?xml version="1.0" encoding="iso-8859-1"?>
<!--
     The FreeBSD Documentation Project
     The FreeBSD French Documentation Project

     $FreeBSD$
     Original revision: 1.291
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.0" xml:id="ports">
  <title>Installer des applications: les logiciels pré-compilés
    et les logiciels portés</title>
    &trans.a.fonvieille;

  <sect1 xml:id="ports-synopsis">
    <title>Synopsis</title>

    <indexterm><primary>logiciels portés</primary></indexterm>
    <indexterm><primary>logiciels pré-compilés</primary></indexterm>
    <para>FreeBSD est livré avec une riche collection d'outils en tant
      que partie du système de base.  Beaucoup de choses
      peuvent être faites avant d'avoir besoin de recourir &agrave;
      l'installation d'une application tiers pour effectuer un travail
      précis.  FreeBSD fournit deux technologies complémentaires
      pour installer des logiciels tiers sur votre système:
      le Catalogue des logiciels portés de FreeBSD (pour une installation &agrave; partir des sources), et les logiciels
      pré-compilés ou <quote>paquetages</quote> (pour installer des binaires pré-compilés).  N'importe laquelle de ces deux méthodes peut
      être utilisée pour installer les nouvelles versions de vos
      applications favorites &agrave; partir d'un
      support local ou directement depuis le réseau.</para>

    <para>Après la lecture de ce chapitre, vous saurez:</para>

    <itemizedlist>
      <listitem>
	<para>Comment installer des logiciels tiers
	  pré-compilés.</para>
      </listitem>
      <listitem>
	<para>Comment compiler des logiciels tiers &agrave; partir des sources en utilisant le catalogue
	  de logiciels portés.</para>
      </listitem>
      <listitem>
	<para>Comment effacer les logiciels pré-compilés ou
	  portés précédemment installés.</para>
      </listitem>
      <listitem>
	<para>Comment modifier les paramètres par défaut
	  utilisés par le catalogue des logiciels
	  portés.</para>
      </listitem>
      <listitem>
	<para>Comment trouver l'application recherchée.</para>
      </listitem>
      <listitem>
	<para>Comment mettre &agrave; jour vos applications.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="ports-overview">
    <title>Généralités sur l'installation de logiciels</title>

    <para>Si vous avez utilisé auparavant un système &unix; vous
      saurez que la procédure typique pour installer les logiciels
      tiers ressemble &agrave; ceci:</para>

    <procedure>
      <step>
	<para>Télécharger le logiciel, qui peut être
	  distribué sous forme de code source, ou sous forme d'un
	  binaire.</para>
      </step>

      <step>
	<para>Extraire le logiciel de son format de distribution
	  (généralement une archive tar compressée
	  soit avec &man.compress.1;, soit avec &man.gzip.1;, ou encore &man.bzip2.1;).</para>
      </step>

      <step>
	<para>Recherchez la documentation (peut être un fichier
	  <filename>INSTALL</filename> ou <filename>README</filename>, ou des fichiers dans un sous
	  répertoire <filename>doc/</filename>) et lisez les
	  informations sur comment installer le logiciel.</para>
      </step>

      <step>
	<para>Si le logiciel était distribué sous forme de
	  sources, compilez-le.  Cela peut impliquer l'édition d'un
	  <filename>Makefile</filename>, ou l'exécution d'une
	  procédure <command>configure</command>, et d'autres
	  activités.</para>
      </step>

      <step>
	<para>Tester et installer le logiciel.</para>
      </step>
    </procedure>

    <para>Et cela si seulement tout se passe bien.  Si vous installez un
      logiciel qui n'a pas été spécialement porté
      pour FreeBSD, il se peut que vous deviez éditer le code source
      pour le faire fonctionner correctement.</para>

    <para>Si vous le voulez, vous pouvez continuer d'installer des
      logiciels suivant la méthode &ldquo;traditionnelle&rdquo; sous
      FreeBSD.  Cependant, FreeBSD fournit deux technologies avec
      lesquelles vous pouvez vous économiser beaucoup d'efforts: les
      logiciels pré-compilés et le catalogue des logiciels
      portés.  A l'heure de l'écriture de ces lignes, plus de
      &os.numports; applications tierces sont ainsi mises &agrave;
      disposition.</para>

    <para>Pour n'importe quelle application donnée, le logiciel
      pré-compilé FreeBSD pour cette application est un unique
      fichier &agrave; télécharger.  Il contient les copies
      pré-compilées de toutes les
      commandes de l'application, ainsi que tous fichiers de
      configuration et documentation.  Un logiciel pré-compilé
      téléchargé peut être manipulé avec
      les commandes FreeBSD de gestion des logiciels
      pré-compilés, comme &man.pkg.add.1;,
      &man.pkg.delete.1;, &man.pkg.info.1;, et ainsi de suite.
      L'installation d'une nouvelle application peut être
      effectuée grâce &agrave; une unique commande.</para>

    <para>Un logiciel porté pour FreeBSD est un ensemble de fichiers
      conçus pour automatiser le processus de compilation d'une
      application &agrave; partir du code source.</para>

    <para>Rappelez-vous qu'il y a un certain nombre d'étapes que vous
      effectueriez si vous compiliez un programme vous-même (téléchargement, extraction,
      application de correctifs, compilation, installation).  Les
      fichiers qui composent un logiciel porté contiennent toute
      l'information nécessaire pour permettre au système de faire
      cela pour vous.  Vous lancez une poignée de commandes simples et
      le code source de l'application est automatiquement
      téléchargé, extrait, corrigé, compilé,
      et installé pour vous.</para>

    <para>En fait, le catalogue des logiciels portés peut être
      utilisé pour générer ce qui pourra plus tard
      être manipulé avec <command>pkg_add</command> et d'autres
      commandes de gestion des logiciels pré-compilés qui
      seront présentés sous peu.</para>

    <para>Les logiciels pré-compilés et le catalogue des
      logiciels portés comprennent la notion de
      <emphasis>dépendances</emphasis>.
      Supposez que vous voulez installer une application qui dépend
      de l'installation d'une bibliothèque particulière.
      L'application et la bibliothèque ont été toutes
      deux rendues disponibles sous forme de logiciel porté pour
      FreeBSD ou de logiciel pré-compilé.
      Si vous utilisez la commande <command>pkg_add</command> ou le
      catalogue des logiciels portés pour ajouter l'application, tous
      les deux remarqueront que la bibliothèque n'a pas été
      installée, et installeront automatiquement en premier la
      bibliothèque.</para>

    <para>Etant donné que les deux technologies sont presque semblables,
      vous pourriez vous demander pourquoi FreeBSD s'ennuie avec les
      deux.  Les logiciels pré-compilés et le catalogue de
      logiciels portés ont chacun leurs propres forces, et celle que vous
      emploierez dépendra de votre préférence.</para>

    <itemizedlist>
      <title>Avantages des logiciels pré-compilés</title>

      <listitem>
	<para>L'archive compressée d'un logiciel
	  pré-compilé est généralement plus
	  petite que l'archive compressée contenant le
	  code source de l'application.</para>
      </listitem>

      <listitem>
	<para>Les logiciels pré-compilés ne
	  nécessitent pas de compilation supplémentaire.
	  Pour les grosses applications, comme
	  <application>Mozilla</application>,
	  <application>KDE</application>, ou <application>GNOME</application>
	  cela peut s'avérer important, particulièrement si
	  vous êtes sur un système lent.</para>
      </listitem>

      <listitem>
	<para>Les logiciels pré-compilés ne demandent pas une
	  compréhension du processus impliqué dans la compilation de
	  logiciels sous FreeBSD.</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <title>Avantages du catalogue des logiciels portés</title>

      <listitem>
	<para>Les logiciels pré-compilés sont normalement
	  compilés avec des options conservatrices, parce qu'ils
	  doivent pouvoir tourner sur le plus grand nombre de systèmes.
	  En installant &agrave; partir du catalogue des logiciels
	  portés, vous pouvez ajuster les options de compilation pour
	  (par exemple) générer du code
	  spécifique au Pentium 4 ou &agrave; l'Athlon.</para>
      </listitem>

      <listitem>
	<para>Certaines applications ont des options de compilation
	  concernant ce qu'elles peuvent faire et ne pas faire.  Par
	  exemple, <application>Apache</application> peut être
	  configuré avec une très large variété
	  d'options intégrées différentes.
	  En compilant &agrave; partir du catalogue des logiciels
	  portés vous n'avez pas &agrave; accepter les options par
	  défaut, et vous pouvez
	  les configurez vous-même.</para>

	<para>Dans certains cas, de multiples logiciels
	  pré-compilés existeront pour la même
	  application pour spécifier certaines configurations.
	  Par exemple, <application>Ghostscript</application> est
	  disponible comme logiciel pré-compilé
	  <filename>ghostscript</filename> et
	  <filename>ghostscript-nox11</filename> , en fonction de si
	  vous avez installé ou non un serveur X11.  Ce type
	  d'arrangement est possible avec les logiciels
	  pré-compilés, mais devient rapidement impossible
	  si une application a plus d'une ou deux options de
	  compilation.</para>
      </listitem>

      <listitem>
	<para>Les licences de certains logiciels interdisent les
	  distributions binaires.  Ils doivent être distribués sous
	  forme de code source.</para>
      </listitem>

      <listitem>
	<para>Certaines personnes ne font pas confiance aux
	  distributions binaires.  Au moins avec le code source, vous
	  pouvez (en théorie) le parcourir et chercher les
	  problèmes
	  potentiels par vous-même.</para>
      </listitem>

      <listitem>
	<para>Si vous avez des correctifs locaux, vous aurez besoin du
	  code source afin de les appliquer.</para>
      </listitem>

      <listitem>
	<para>Certaines personnes aiment avoir le code source &agrave;
	  portée de main, ainsi elles peuvent le lire si elles
	  s'ennuient, le
	  modifier, y faire des emprunts (si la licence le permet bien
	  sûr), etc...</para>
      </listitem>
    </itemizedlist>

    <para>Pour suivre les mises &agrave; jour du catalogue des logiciels
      portés, inscrivez-vous &agrave; la &a.ports; et la &a.ports-bugs;.</para>

    <warning>
      <para>Avant d'installer une application, vous devriez consulter
	<uri xlink:href="http://vuxml.freebsd.org/">http://vuxml.freebsd.org/</uri> &agrave; la
	recherche de problème de sécurité
	concernant votre application.</para>

      <para>Vous pouvez également installer <package>ports-mgmt/portaudit</package> qui
	contrôlera automatiquement toutes les applications
	installées &agrave; la recherche de
	vulnérabilités connues, un contrôle sera
	également effectué avant toute compilation de
	logiciel porté.  De même, vous pouvez utiliser la
	commande <command>portaudit -F -a</command> après avoir
	installé des logiciels
	pré-compilés.</para>
    </warning>

    <para>Le reste de ce chapitre expliquera comment utiliser les
      logiciels pré-compilés et le catalogue des logiciels
      portés et la
      gestion des logiciels tiers sous FreeBSD.</para>
  </sect1>

  <sect1 xml:id="ports-finding-applications">
    <title>Trouver votre application</title>

    <para>Avant que vous puissiez installer des applications
      vous devez savoir ce que vous voulez, et comment se nomment les
      applications.</para>

    <para>La liste des applications disponibles pour FreeBSD augmente de
      jours en jours.  Heureusement, il y a plusieurs façons de trouver
      ce que vous désirez:</para>

    <itemizedlist>
      <listitem>
	<para>Le site web de FreeBSD maintient &agrave; jour une liste, dans
	  laquelle on peut effectuer des recherches, de toutes les
	  applications disponibles &agrave; l'adresse
	  <link xlink:href="&url.base;/ports/index.html">http://www.FreeBSD.org/ports/</link>.
	  Le catalogue des logiciels portés est divisé en catégories, et vous pouvez soit
	  chercher une application par son nom (si vous le connaissez),
	  soit lister toutes les applications disponibles dans une
	  catégorie.</para>
      </listitem>

      <listitem>
	<indexterm><primary>FreshPorts</primary></indexterm>

	<para>Dan Langille maintient FreshPorts, &agrave; l'adresse
	  <uri xlink:href="http://www.FreshPorts.org/">http://www.FreshPorts.org/</uri>.
	  FreshPorts suit les modifications des applications dans le
	  catalogue des logiciels portés, vous permet de
	  &ldquo;surveiller&rdquo; un ou plusieurs logiciels portés, et
	  peut vous envoyer un courrier électronique quand ils sont mis
	  &agrave; jour.</para>
      </listitem>

      <listitem>
	<indexterm><primary>FreshMeat</primary></indexterm>

	<para>Si vous ne connaissez pas le nom de l'application que vous
	  voulez, essayez d'utiliser un site comme FreshMeat
	  (<uri xlink:href="http://www.freshmeat.net/">http://www.freshmeat.net/</uri>)
	  pour trouver une application, ensuite vérifiez sur le site de
	  FreeBSD si l'application a déj&agrave; été
	  portée.</para>
      </listitem>

      <listitem>
	<para>Si vous connaissez le nom exact du logiciel, vous devez
	  juste déterminer dans quelle catégorie il se
	  trouve, vous pouvez utiliser la commande &man.whereis.1; pour
	  cela.  Tapez simplement <command>whereis
	  file</command> où
	  <replaceable>file</replaceable> est le programme que vous
	  voulez installer.  S'il est trouvé sur le
	  système, on vous indiquera où il se trouve, de
	  la manière suivante:</para>

	<screen>&prompt.root; <userinput>whereis lsof</userinput>
lsof: /usr/ports/sysutils/lsof</screen>

	<para>Cela nous indique que <command>lsof</command> (un
	  utilitaire système) peut être trouvé
	  dans le répertoire <filename>/usr/ports/sysutils/lsof</filename>.</para>
      </listitem>

      <listitem>
	<para>Vous pouvez également utiliser une simple
	  commande &man.echo.1; pour déterminer où se
	  trouve un logiciel porté dans le catalogue de
	  logiciels portés.  Par exemple:</para>

	<screen>&prompt.root; <userinput>echo /usr/ports/*/*lsof*</userinput>
/usr/ports/sysutils/lsof</screen>

	<para>Notez que cette commande retournera tout fichier
	  téléchargé du répertoire
	  <filename>/usr/ports/distfiles</filename>
	  correspondant &agrave; ce motif de recherche.</para>
      </listitem>

      <listitem>
	<para>Encore une autre façon de trouver un logiciel
	  porté particulier est d'utiliser le mécanisme de
	  recherche interne du catalogue des logiciels portés.
	  Pour utiliser la fonction de recherche, vous devrez vous
	  trouver dans le répertoire
	  <filename>/usr/ports</filename>.  Une fois dans ce
	  répertoire, lancez <command>make search
	  name=program-name</command>
	  où <replaceable>program-name</replaceable>
	  représente le nom du programme que vous voulez
	  localiser.  Par exemple, si vous recherchiez
	  <command>lsof</command>:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports</userinput>
&prompt.root; <userinput>make search name=lsof</userinput>
Port:   lsof-4.56.4
Path:   /usr/ports/sysutils/lsof
Info:   Lists information about open files (similar to fstat(1))
Maint:  obrien@FreeBSD.org
Index:  sysutils
B-deps:
R-deps: </screen>

	<para>La partie du message de sortie &agrave; laquelle vous
	  devez prêter attention est la ligne
	  &ldquo;Path:&rdquo;, car cela vous indique où trouver
	  le logiciel porté.  Les autres informations ne sont
	  pas nécessaires afin d'installer le logiciel
	  porté, aussi on en parlera pas ici.</para>

	<para>Pour une recherche plus en profondeur vous pouvez
	  également utiliser <command>make search
	  key=string</command> où
	  <replaceable>string</replaceable> est le texte &agrave;
	  rechercher.  Cela recherche les noms de logiciels
	  portés, les commentaires, les descriptions et les
	  dépendances et peut être utilisé pour
	  trouver des logiciels portés se rapportant &agrave;
	  un sujet particulier si vous ne connaissez pas le nom du
	  programme que vous cherchez.</para>

	<para>Dans les deux cas, la chaîne de caractère
	  de recherche n'est pas sensible &agrave; la casse des
	  caractères.  Rechercher &ldquo;LSOF&rdquo;
	  mènera aux même résultats que la
	  recherche de &ldquo;lsof&rdquo;.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="packages-using">
    <info><title>Utiliser le système des logiciels
      pré-compilés</title>
      <authorgroup>
        <author><personname><firstname>Chern</firstname><surname>Lee</surname></personname><contrib>Contribution de </contrib></author>
      </authorgroup>
    
    </info>

    

    <para>Il existe plusieurs outils utilisés pour la gestion
      des logiciels pré-compilés sur &os;</para>
    
    <itemizedlist>
<!--      <listitem>
	<para>L'utilitaire <command>sysinstall</command> peut
	  être invoqué &agrave; partir d'un
	  système en fonctionnement pour installer, supprimer
	  et afficher les logiciels disponibles et installés.
	  Pour plus d'information, consultez la <xref linkend="packages"/>.</para>
      </listitem>
-->
      <listitem>
	<para>Les outils de gestion en ligne de commande des logiciels
	  pré-compilés, qui sont le sujet de la suite de
	  cette section.</para>
      </listitem>
    </itemizedlist>

    <sect2>
      <title>Installation d'un logiciel pré-compilé</title>
      <indexterm>
        <primary>logiciels pré-compilés</primary>
        <secondary>installation</secondary>
      </indexterm>

      <indexterm>
        <primary><command>pkg_add</command></primary>
      </indexterm>
      <para>Vous pouvez utiliser l'utilitaire &man.pkg.add.1; pour
	installer un logiciel pré-compilé FreeBSD &agrave;
	partir d'un fichier
	local ou d'un serveur sur le réseau.</para>

      <example>
        <title>Télécharger un logiciel pré-compilé
	  &agrave; la main puis l'installer localement</title>

        <screen>&prompt.root; <userinput>ftp -a ftp2.FreeBSD.org</userinput>
Connected to ftp2.FreeBSD.org.
220 ftp2.FreeBSD.org FTP server (Version 6.00LS) ready.
331 Guest login ok, send your email address as password.
230-
230-     This machine is in Vienna, VA, USA, hosted by Verio.
230-         Questions? E-mail freebsd@vienna.verio.net.
230-
230-
230 Guest login ok, access restrictions apply.
Remote system type is UNIX.
Using binary mode to transfer files.
<prompt>ftp&gt;</prompt> <userinput>cd /pub/FreeBSD/ports/packages/sysutils/</userinput>
250 CWD command successful.
<prompt>ftp&gt;</prompt> <userinput>get lsof-4.56.4.tgz</userinput>
local: lsof-4.56.4.tgz remote: lsof-4.56.4.tgz
200 PORT command successful.
150 Opening BINARY mode data connection for 'lsof-4.56.4.tgz' (92375 bytes).
100% |**************************************************| 92375       00:00 ETA
226 Transfer complete.
92375 bytes received in 5.60 seconds (16.11 KB/s)
<prompt>ftp&gt;</prompt> <userinput>exit</userinput>
&prompt.root; <userinput>pkg_add lsof-4.56.4.tgz</userinput></screen>
      </example>

      <para>Si vous ne disposez pas d'une source locale de logiciels
	pré-compilés (comme l'ensemble de CDROM de FreeBSD)
	alors il sera probablement plus facile d'utiliser l'option
	<option>-r</option> de &man.pkg.add.1;.  Cela fera déterminer
	automatiquement &agrave; l'utilitaire le format objet et la version
	corrects et ensuite récupérer et installer le logiciel
	pré-compilé &agrave; partir d'un site FTP.</para>

      <indexterm>
        <primary><command>pkg_add</command></primary></indexterm>
      <screen>&prompt.root; <userinput>pkg_add -r lsof</userinput></screen>

      <para>L'exemple ci-dessus téléchargera le logiciel
	pré-compilé
	correct sans plus d'intervention de l'utilisateur.
	Si vous désirez indiquer un autre miroir &os; pour les
	logiciels pré-compilés &agrave; la place du site
	de distribution principal, vous devez positionner en
	conséquence la variable d'environnement
	<envar>PACKAGESITE</envar>, pour remplacer les
	paramètres par défaut.
	&man.pkg.add.1; utilise &man.fetch.3; pour télécharger les
	fichiers, qui respecte diverses variables d'environnement, dont
	<envar>FTP_PASSIVE_MODE</envar>, <envar>FTP_PROXY</envar>, et
	<envar>FTP_PASSWORD</envar>.  Il se peut que vous ayez besoin de
	configurer une ou plusieurs de ces dernières si vous êtes
	derrière un coupe-feu, ou devez utiliser un proxy FTP/HTTP.
	Consultez la page de manuel &man.fetch.3; pour la liste complète
	des variables.  Vous pouvez également remarquer que dans
	l'exemple ci-dessus <literal>lsof</literal> est utilisé au lieu
	de <literal>lsof-4.56.4</literal>.  Quand la fonction de
	récupération &agrave; distance est utilisée,
	le numéro de version doit être retiré.
	&man.pkg.add.1; téléchargera automatiquement la
	toute dernière version de l'application.</para>

      <note>
	<para>&man.pkg.add.1; téléchargera la
	  dernière version de votre application si vous êtes
	  sous &os.current; ou &os.stable;.  Si vous utilisez une version
	  -RELEASE, il récupérera la version compilée
	  avec votre version lors de sa publication.  Il est possible de
	  modifier ce comportement en surchargeant la variable
	  d'environnement <envar>PACKAGESITE</envar>.  Par exemple,
	  si vous utilisez un système &os;&nbsp;8.1-RELEASE,
	  par défaut &man.pkg.add.1; tentera de
	  récupérer les applications
	  pré-compilées &agrave; partir de
	  <literal>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-8.1-release/Latest/</literal>.
	  Si vous désirez forcer &man.pkg.add.1; &agrave;
	  télécharger les versions des logiciels
	  pré-compilés pour &os;&nbsp;8-STABLE,
	  positionnez la variable <envar>PACKAGESITE</envar> &agrave;
	  <literal>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-8-stable/Latest/</literal>.
	</para>
      </note>

      <para>Les logiciels pré-compilés sont distribués
	dans les formats <filename>.tgz</filename> et <filename>.tbz</filename>.  Vous pouvez les trouver
	sur <uri xlink:href="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/">ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/</uri>, ou
	sur le CDROM de distribution de FreeBSD.  Chaque CD de
	l'ensemble de 4-CD de FreeBSD (et le PowerPak, etc...) contient
	des logiciels pré-compilés dans le répertoire
	<filename>/packages</filename>.  L'organisation des logiciels
	pré-compilés est semblable &agrave; celle de
	l'arborescence <filename>/usr/ports</filename>.  Chaque
	catégorie possède son propre répertoire, et
	chaque logiciel pré-compilé peut être
	trouvé dans le répertoire <filename>All</filename>.</para>

      <para>La structure de répertoires du système de logiciels
	pré-compilés correspond &agrave; celle du catalogue
	des logiciels portés; ils travaillent ensemble pour former
	l'intégralité du système de logiciels
	pré-compilés/portés.</para>

    </sect2>

    <sect2>
      <title>Gestion des logiciels pré-compilés</title>

      <indexterm>
        <primary>logiciels pré-compilés</primary>
        <secondary>gestion</secondary>
      </indexterm>
      <para>&man.pkg.info.1; est un utilitaire qui liste et décrit les
	divers logiciels pré-compilés installés.
      </para>

      <indexterm>
        <primary><command>pkg_info</command></primary>
      </indexterm>
      <screen>&prompt.root; <userinput>pkg_info</userinput>
cvsup-16.1          A general network file distribution system optimized for CV
docbook-1.2         Meta-port for the different versions of the DocBook DTD
...</screen>
      <para>&man.pkg.version.1; est un utilitaire qui récapitule les
	versions de tous les logiciels pré-compilés
	installés.  Il compare la version du logiciel
	pré-compilé avec la version
	actuelle trouvée dans le catalogue des logiciels portés.
      </para>
      <indexterm>
        <primary><command>pkg_version</command></primary>
      </indexterm>
        <screen>&prompt.root; <userinput>pkg_version</userinput>
cvsup                       =
docbook                     =
...</screen>

      <para>Les symboles dans la seconde colonne indiquent l'âge relatif
	de la version installée et de la version disponible dans le
	catalogue des logiciels portés local.</para>

      <informaltable frame="none" pgwide="1">
        <tgroup cols="2">
	  <thead>
            <row>
              <entry>Symbole</entry>
              <entry>Signification</entry>
            </row>
          </thead>

 	  <tbody>
  	    <row>
	    <entry>=</entry> <entry>La version du logiciel
	      pré-compilé installée est équivalente
	      &agrave; celle de celui trouvé dans le
	      catalogue des logiciels portés local.</entry>
  	    </row>

        <row><entry>&lt;</entry>
	<entry>La version installée est plus ancienne que celle
	  disponible dans le catalogue des logiciels portés.</entry>
	</row>

        <row><entry>&gt;</entry><entry>La version installée est plus
	  récente que celle trouvée dans le catalogue local des
	  logiciels portés. (le catalogue local des logiciels
	  portés est probablement ancien)</entry></row>

        <row><entry>?</entry><entry>Le logiciel pré-compilé
	  ne peut être
	  trouvé dans l'index du catalogue des logiciels
	  portés.  (Cela peut se produire quand, par exemple,
	  un logiciel installé est supprimé du catalogue des logiciels
	  portés ou renommé.)</entry></row>

        <row><entry>*</entry><entry>Il y a de multiples versions de ce
	  logiciel pré-compilé.</entry></row>

	    <row><entry>!</entry><entry>Le logiciel installé
	      existe dans l'index mais pour une raison inconnue,
	      <command>pkg_version</command> a été
	      incapable de comparer le numéro de version du
	      paquetage installé avec l'entrée
	      correspondante dans l'index.</entry></row>
	</tbody>
	</tgroup>
    </informaltable>
    </sect2>

    <sect2>
      <title>Effacer un logiciel pré-compilé</title>
      <indexterm>
        <primary><command>pkg_delete</command></primary>
      </indexterm>
      <indexterm>
        <primary>logiciels pré-compilés</primary>
        <secondary>effacer</secondary>
      </indexterm>
      <para>Pour désinstaller un logiciel pré-compilé
	précédemment installé, utilisez l'utilitaire
	&man.pkg.delete.1;.</para>

      <screen>&prompt.root; <userinput>pkg_delete xchat-1.7.1</userinput></screen>

      <para>Notez que &man.pkg.delete.1; a besoin du nom complet du
	paquetage et du numéro de version; la commande
	précédente n'aurait pas fonctionné avec
	<replaceable>xchat</replaceable> &agrave; la place de
	<replaceable>xchat-1.7.1</replaceable>.  It est cependant
	facile de retrouver la version du paquetage installé
	&agrave; l'aide de la commande &man.pkg.version.1;.  Vous
	pouvez &agrave; la place simplement utiliser un joker:</para>

      <screen>&prompt.root; <userinput>pkg_delete xchat\*</userinput></screen>

      <para>dans ce cas, tous les logiciels dont le nom commence par
	<literal>xchat</literal> seront supprimés.</para>
    </sect2>

    <sect2>
      <title>Divers</title>
      <para>Toute l'information sur les logiciels pré-compilés
	est stockée dans le répertoire
	<filename>/var/db/pkg</filename>.  La liste des fichiers
	installés pour chaque logiciel pré-compilé
	peut être trouvée dans des fichiers de ce
	répertoire.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="ports-using">
    <title>Utiliser le catalogue des logiciels portés</title>

    <para>Les sections suivantes fournissent des instructions de base
      sur l'utilisation du catalogue des logiciels portés pour installer
      et désinstaller des programmes sur votre système.
      Une description détaillée des cibles <command>make</command> et
      de variables d'environnement est disponible dans la page de
      manuel &man.ports.7;.</para>

    <sect2 xml:id="ports-tree">
      <title>Obtenir le catalogue des logiciels portés</title>

      <para>Avant que vous puissiez installer des logiciels portés, vous
	devez d'abord récupérer le catalogue des logiciels
	portés&mdash; qui est essentiellement un ensemble de
	<filename>Makefiles</filename>, de correctifs, et de fichiers de
	description habituellement placés dans
	<filename>/usr/ports</filename>.</para>

      <para>Quand vous avez installé votre système FreeBSD,
	<application>sysinstall</application> vous a demandé si vous
	aimeriez installer le catalogue des logiciels portés.  Si vous
	avez choisi non, vous pouvez suivre ces instructions pour
	obtenir le catalogue des logiciels portés:</para>

      <procedure>
	<title>La méthode CVSup</title>

	<para>C'est une méthode rapide pour récupérer
	  le catalogue des
	  logiciels portés en utilisant le protocole <application>CVSup</application>.
	  Si vous voulez en apprendre
	  plus au sujet de <application>CVSup</application>, lisez la
	  section <link linkend="cvsup">Utiliser CVSup</link>.</para>

	<note>
	  <para>L'implémentation du protocole
	    <application>CVSup</application> présente dans le système
	    de base de &os; se nomme <application>csup</application>.</para>
	</note>

	<para>Assurez-vous que le répertoire <filename>/usr/ports</filename> est vide avant
	  d'utiliser <application>csup</application> pour la
	  première fois.  Si vous avez déj&agrave; un
	  catalogue des logiciels portés, obtenu &agrave; partir
	  d'une autre source, <application>csup</application>
	  n'effacera pas les correctifs qui ont été
	  supprimés.</para>

	<step>
	  <para>Exécuter la commande <command>csup</command>:</para>

	  <screen>&prompt.root; <userinput>csup -L 2 -h cvsup.FreeBSD.org /usr/share/examples/cvsup/ports-supfile</userinput></screen>

	  <para>Remplacez <replaceable>cvsup.FreeBSD.org</replaceable>
	    avec un serveur <application>CVSup</application> proche de
	    vous.  Voir <link linkend="cvsup-mirrors">Sites
	    CVSup</link> (<xref linkend="cvsup-mirrors"/>) pour une
	    liste complète des sites miroirs.</para>

	  <note>
	    <para>Certains peuvent vouloir utiliser leur propre
	      <filename>ports-supfile</filename>, par exemple pour
	      éviter d'avoir &agrave; passer le serveur
	      <application>CVSup</application> sur la ligne de
	      commande.</para>

	    <procedure>
	      <step>
		<para>Dans ce cas, en tant que
		  <systemitem class="username">root</systemitem>, copier
		  <filename>/usr/share/examples/cvsup/ports-supfile</filename>
		  &agrave; un nouvel emplacement, comme
		  <filename>/root</filename> ou votre répertoire
		  d'utilisateur.</para>
	      </step>

	      <step>
		<para>Editez
		  <filename>ports-supfile</filename>.</para>
	      </step>

	      <step>
		<para>Remplacez
		  <replaceable>CHANGE_THIS.FreeBSD.org</replaceable>
		  avec un serveur <application>CVSup</application>
		  proche de vous.  Voir <link linkend="cvsup-mirrors">Sites CVSup</link> (<xref linkend="cvsup-mirrors"/>) pour une liste
		  complète des sites miroirs.</para>
	      </step>

	      <step>
		<para>Maintenant pour lancer <command>csup</command>,
		  utilisez ce qui suit:</para>

		<screen>&prompt.root; <userinput>csup -L 2 /root/ports-supfile</userinput></screen>
	      </step>
	    </procedure>
	  </note>
	</step>

	<step>
	  <para>L'exécution ultérieure de &man.csup.1;
	    téléchargera et appliquera
	    tous les changements récents &agrave;
	    votre catalogue des logiciels portés sans
	    pour autant recompiler vos logiciels.</para>
	</step>
      </procedure>

      <procedure>
	<title>La méthode Portsnap</title>

	<para><application>Portsnap</application> est un
	  système alternatif de distribution du catalogue des
	  logiciels portés.
	  Veuillez vous reporter &agrave; la section
<!-- updating-upgrading-portsnap -->
	  <link linkend="portsnap">Utiliser Portsnap</link> pour une
	  description détaillée de toutes les
	  caractéristiques de
	  <application>Portsnap</application>.</para>

	<step>
	  <para>Téléchargez un instantané
	    compressé du catalogue des logiciels portés
	    dans le répertoire <filename>/var/db/portsnap</filename>.  Vous pouvez
	    vous déconnecter de l'Internet, si vous le
	    désirez, après cette opération:</para>

	  <screen>&prompt.root; <userinput>portsnap fetch</userinput></screen>
	</step>

	<step>
	  <para>Si vous exécutez
	    <application>Portsnap</application> pour la première
	    fois, il faut extraire l'instantané dans le
	    répertoire <filename>/usr/ports</filename>:</para>

	  <screen>&prompt.root; <userinput>portsnap extract</userinput></screen>

	  <para>Si votre répertoire <filename>/usr/ports</filename> contient
	    déj&agrave; une version du catalogue des logiciels
	    portés et que vous désirez juste mettre
	    &agrave; jour, utilisez plutôt la commande:</para>

	  <screen>&prompt.root; <userinput>portsnap update</userinput></screen>
	</step>
      </procedure>

      <procedure>
	<title>La méthode Sysinstall</title>

	<para>Cette méthode implique l'utilisation de
	  <application>sysinstall</application> pour installer le
	  catalogue des logiciels portés &agrave; partir du
	  disque d'installation.  Il faut noter que la version du
	  catalogue qui sera installée est la version datant de
	  la publication de votre disque d'installation.  Si vous
	  disposez d'un accès &agrave; l'Internet, vous devriez
	  toujours utiliser une des méthodes
	  précédemment exposées.</para>

	<step>
	  <para>En tant que <systemitem class="username">root</systemitem>, lancez
	    <command>sysinstall</command>
	    comme montré
	    ci-dessous:</para>

	  <screen>&prompt.root; <userinput>sysinstall</userinput></screen>
	</step>

	<step>
	  <para>Faites défiler l'écran vers le bas et
	    sélectionnez <guimenuitem>Configure</guimenuitem>,
	    appuyez sur <keycap>Entrée</keycap>.</para>
	</step>

	<step>
	  <para>Faites défiler l'écran vers le bas et
	    sélectionnez <guimenuitem>Distributions</guimenuitem>,
	    appuyez sur <keycap>Entrée</keycap>.</para>
	</step>

	<step>
	  <para>Faites défiler l'écran vers le bas jusqu'&agrave;
	    <guimenuitem>ports</guimenuitem>, appuyez sur
	    <keycap>Espace</keycap>.</para>
	</step>

	<step>
	  <para>Remontez jusqu'&agrave; <guimenuitem>Exit</guimenuitem>,
	    appuyez sur <keycap>Entrée</keycap>.</para>
	</step>

	<step>
	  <para>Choisissez le support d'installation désiré,
	    comme un CDROM, par FTP, etc.</para>
	</step>

	<step>
	  <para>Remontez jusqu'&agrave; <guimenuitem>Exit</guimenuitem>
	    et appuyez sur <keycap>Enter</keycap>.</para>
	</step>

	<step>
	  <para>Appuyez sur la touche <keycap>X</keycap> pour quitter
	    <application>sysinstall</application>.</para>
	</step>
      </procedure>
    </sect2>

    <sect2 xml:id="ports-skeleton">
      <title>Installation de logiciels portés</title>

      <indexterm>
        <primary>logiciels portés</primary>
        <secondary>installation</secondary>
      </indexterm>
      <para>La première chose qui devrait être expliquée
	quand on aborde le catalogue des logiciels portés est ce que
	l'on entend par &ldquo;squelette&rdquo;.  En bref, un squelette
	est un ensemble minimal de fichiers qui indique &agrave; votre
	système FreeBSD comment compiler et installer proprement un
	programme.  Chaque squelette contient:</para>

      <itemizedlist>
	<listitem>
	  <para>Un fichier <filename>Makefile</filename>.  Le fichier
	    <filename>Makefile</filename> contient les diverses
	    déclarations qui indiquent comment l'application devrait
	    être compilée et où elle devrait être
	    installée sur votre système.</para>
	</listitem>

	<listitem>
	  <para>Un fichier <filename>distinfo</filename>.  Ce fichier
	    contient l'information &agrave; propos des fichiers qui doivent
	    être téléchargés pour compiler le
	    logiciel, et leurs sommes de contrôle (en utilisant &man.sha256.1;), pour s'assurer que
	    ces fichiers n'ont pas été
	    corrompus durant le téléchargement.</para>
	</listitem>

	<listitem>
	  <para>Un répertoire <filename>files</filename>.
	    Ce répertoire
	    contient les correctifs pour permettre la compilation et
	    l'installation du programme sur votre système FreeBSD.  Les
	    correctifs sont &agrave; la base de petits fichiers qui indiquent
	    des modifications sur des fichiers particuliers.  Ils sont
	    sous forme de fichiers texte, qui disent &ldquo;Effacer la
	    ligne 10&rdquo; ou &ldquo;Modifier la ligne 26
	    par...&rdquo;.  Les correctifs sont également connus sous le
	    nom de &ldquo;diffs&rdquo; car ils sont
	    générés par le programme &man.diff.1;.</para>

	  <para>Ce répertoire peut également contenir d'autres
	    fichiers utilisés pour la compilation du logiciel
	    porté.</para>
	</listitem>

	<listitem>
	  <para>Un fichier <filename>pkg-descr</filename>.  C'est une
	    description plus détaillée du programme, souvent en
	    plusieurs lignes.</para>
	</listitem>

	<listitem>
	  <para>Un fichier <filename>pkg-plist</filename>.  C'est une
	    liste de tous les fichiers qui seront installés par le
	    logiciel porté.  Il indique également au
	    système des logiciels portés quels fichiers
	    sont &agrave; effacer lors d'une désinstallation.</para>
	</listitem>
      </itemizedlist>

      <para>Certains logiciels portés utilisent d'autres fichiers,
	comme <filename>pkg-message</filename>.  Le catalogue des
	logiciels portés utilise ces fichiers pour faire face &agrave;
	certaines situations spéciales.  Si vous désirez plus
	de détails
	au sujet de ces fichiers, et sur les logiciels portés en
	général, consultez le <link xlink:href="&url.books.porters-handbook;/index.html">Manuel du développeur de
	logiciels portés</link>.</para>

      <para>Le logiciel porté contient les instructions pour
	compiler le code source, mais ne contient pas le code source.
	Vous pouvez obtenir le code source &agrave; partie d'un CDROM ou de
	l'Internet.  Le code source est distribué de la façon dont
	l'auteur le désire.  Fréquemment c'est une archive tar
	compressée avec gzip, mais elle pourra être
	compressée avec un
	autre outil ou même non compressée.  Le code source d'un
	programme, peu importe la forme sous laquelle il est distribué,
	est appelé un fichier &ldquo;distfile&rdquo;.  Les deux
	méthodes pour l'installation d'un logiciel porté
	pour &os; sont décrites ci-dessous.</para>

      <note>
	<para>Vous devez avoir ouvert une session sous l'utilisateur
	  <systemitem class="username">root</systemitem> pour installer des logiciels
	  portés.</para>
      </note>

      <warning>
	<para>Avant d'installer un logiciel porté, vous devez
	  vous assurer d'avoir un catalogue des logiciels portés
	  &agrave; jour et vous devez consulter <uri xlink:href="http://vuxml.freebsd.org/">http://vuxml.freebsd.org/</uri> pour les
	  problèmes de sécurité relatifs &agrave;
	  votre logiciel.</para>

	<para>Un contrôle des problèmes de
	  sécurité peut être effectué
	  automatiquement par <application>portaudit</application>
	  avant toute nouvelle installation d'application.  Cet outil
	  peut être trouvé dans le catalogue des
	  logiciels porté (<package>security/portaudit</package>).  Vous pouvez
	  lancer <command>portaudit -F</command> avant l'installation
	  d'un nouveau logiciel porté, pour
	  télécharger la base de données
	  actualisée des vulnérabilités.  Un
	  audit de sécurité et une mise &agrave; jour de
	  la base de données sera effectuée lors du
	  contrôle quotidien de sécurité de la
	  machine.  Pour plus d'informations, lisez les pages de
	  manuel &man.portaudit.1; et &man.periodic.8;.</para>
      </warning>

	<para>Le catalogue des logiciels portés suppose que vous
	  disposez d'une connection active &agrave; l'Internet.  Si ce n'est
	  pas le cas, vous devez placer manuellement une copie
	  du distfile dans le répertoire <filename>/usr/ports/distfiles</filename>.</para>

	<para>Pour commencer, rendez-vous dans le répertoire du logiciel
	  porté que vous voulez installer:</para>

        <screen>&prompt.root; <userinput>cd /usr/ports/sysutils/lsof</userinput></screen>

        <para>Une fois &agrave; l'intérieur du répertoire
	  <filename>lsof</filename> vous verrez le squelette du logiciel
	  porté.  L'étape suivante est de compiler
	  (également appelé la
	  &ldquo;construction&rdquo;) le logiciel porté.  Cela est fait en tapant
	  simplement <command>make</command> &agrave; l'invite.  Une fois que
	  c'est fait, vous devriez voir quelque chose comme ceci:</para>

        <screen>&prompt.root; <userinput>make</userinput>
&gt;&gt; lsof_4.57D.freebsd.tar.gz doesn't seem to exist in /usr/ports/distfiles/.
&gt;&gt; Attempting to fetch from ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/.
===&gt;  Extracting for lsof-4.57
...
[extraction output snipped]
...
&gt;&gt; Checksum OK for lsof_4.57D.freebsd.tar.gz.
===&gt;  Patching for lsof-4.57
===&gt;  Applying FreeBSD patches for lsof-4.57
===&gt;  Configuring for lsof-4.57
...
[configure output snipped]
...
===&gt;  Building for lsof-4.57
...
[compilation output snipped]
...
&prompt.root;</screen>

        <para>Notez qu'une fois la compilation terminée, vous vous
	  retrouvez face &agrave; l'invite.  L'étape suivante est
	  d'installer
	  le logiciel porté.  Afin de l'installer, vous devez juste
	  ajouter un mot &agrave; la commande <command>make</command>, et ce
	  mot est <buildtarget>install</buildtarget>:</para>

        <screen>&prompt.root; <userinput>make install</userinput>
===&gt;  Installing for lsof-4.57
...
[installation output snipped]
...
===&gt;   Generating temporary packing list
===&gt;   Compressing manual pages for lsof-4.57
===&gt;   Registering installation for lsof-4.57
===&gt;  SECURITY NOTE:
      This port has installed the following binaries which execute with
      increased privileges.
&prompt.root;</screen>

        <para>Une fois de retour &agrave; l'invite, vous devriez être
	  en mesure d'exécuter l'application que vous venez juste
	  d'installer.
	  Comme <command>lsof</command> est un programme qui tourne avec
	  des privilèges accrus, un avertissement sur la
	  sécurité est affiché.  Durant la compilation
	  et l'installation de logiciels portés, vous devriez faire
	  attention &agrave; tout avertissement qui
	  pourrait apparaître.</para>

	<para>Il est conseillé de supprimer le sous-répertoire de
	  travail, qui contient tous les fichiers temporaires utilisés
	  lors de la compilation.  Non seulement cela consomme de
	  l'espace disque, mais cela posera problème plus tard lors de
	  la mise &agrave; jour vers une nouvelle version du logiciel
	  porté.</para>

	<screen>&prompt.root; <userinput>make clean</userinput>
===&gt;  Cleaning for lsof-4.57
&prompt.root;</screen>

        <note>
          <para>Vous pouvez vous économiser deux étapes
	    supplémentaires en lançant juste
	    <command>make install clean</command> &agrave; la place de
	    <command>make</command>, <command>make install</command>
	    et <command>make clean</command>
	    sous la forme de trois étapes séparées.</para>
	</note>

	<note>
	  <para>Certains interpréteurs de commandes maintiennent un
	    cache des commandes qui sont disponibles dans les
	    répertoires listés dans la variable d'environnement
	    <envar>PATH</envar>, pour accélérer les
	    opérations de
	    recherche des fichiers exécutables de ces commandes.  Si
	    vous utilisez un de ces interpréteurs de commandes, vous
	    pourrez avoir &agrave; utiliser la commande
	    <command>rehash</command> après l'installation d'un logiciel
	    porté, avant que la commande fraîchement
	    installée ne puisse être utilisée.
	    Cette commande fonctionnera pour les interpréteurs
	    de commandes comme <command>tcsh</command>.  Utilisez la
	    commande <command>hash -r</command> pour les
	    interpréteurs tels que <command>sh</command>.
	    Consultez la documentation de votre interpréteur de
	    commandes pour plus d'information.</para>
	</note>

	<para>Certains DVD-ROMs comme le &os; Toolkit de <link xlink:href="http://www.freebsdmall.com/">FreeBSD Mall</link>
	  contiennent des distfiles.
	  Ils peuvent être utilisés avec le catalogue des logiciels
	  portés.
	  Montez le DVD-ROM sous <filename>/cdrom</filename>.  Si vous
	  utilisez un point de montage différent, positionnez la
	  variable &man.make.1; <varname>CD_MOUNTPTS</varname>.  Les
	  distfiles nécessaires seront automatiquement utilisés s'ils
	  sont présent sur le disque.</para>

	<note>
	  <para>Soyez conscient que les licences de quelques logiciels
	    portés n'autorisent pas leur présence sur le
	    CD-ROM.  Cela peut être dû &agrave; la
	    nécessité de remplir un formulaire
	    d'enregistrement avant le téléchargement, ou
	    que la redistribution n'est pas permise, ou toute autre
	    raison.  Si vous désirez installer un logiciel
	    porté qui n'est pas disponible sur le CD-ROM, vous
	    devrez vous connecter afin de récupérer les
	    fichiers nécessaires.</para>
	</note>

	<para>Le catalogue des logiciels portés utilise &man.fetch.1;
	  pour télécharger les fichiers, qui respecte diverses
	  variables d'environnement, dont <envar>FTP_PASSIVE_MODE</envar>,
	  <envar>FTP_PROXY</envar>, et <envar>FTP_PASSWORD</envar>.  Il
	  se peut que vous ayez besoin de configurer une ou plusieurs
	  de ces dernières si vous êtes derrière un
	  coupe-feu, ou devez utiliser un proxy FTP/HTTP.
	  Consultez la page de manuel &man.fetch.3; pour la liste
	  complète des variables.</para>

	<para>Pour les utilisateurs qui ne peuvent rester
	  connectés &agrave; l'Internet indéfiniment, il
	  existe la commande <command>make
	  fetch</command>.  Exécutez
	  cette commande &agrave; la base du catalogue des logiciels
	  portés (<filename>/usr/ports</filename>) et les fichiers
	  nécessaires seront téléchargés.
	  Cette commande fonctionnera également dans les
	  sous-répertoires du catalogue, par exemple: <filename>/usr/ports/net</filename>.  Notez que si un
	  logiciel porté dépend de bibliothèques
	  particulières ou d'autres logiciels portés,
	  cette commande de récupérera
	  <emphasis>pas</emphasis> les sources de ces logiciels.
	  Remplacez <buildtarget>fetch</buildtarget> par
	  <buildtarget>fetch-recursive</buildtarget> si vous voulez
	  récupérer également les sources des
	  logiciels dont dépend un logiciel
	  porté.</para>

	<note>
	  <para>Vous pouvez compiler tous les logiciels d'une
	    catégorie ou de l'ensemble du catalogue en
	    exécutant la commande <command>make</command> dans un
	    répertoire de base, juste comme la commande
	    <command>make fetch</command>
	    précédente.  C'est, cependant, une idée
	    dangereuse étant donné que certains logiciels
	    portés ne peuvent coexister.  Dans d'autres cas,
	    certains logiciels portés peuvent installer des
	    fichiers différents ayant le même
	    nom.</para></note>

	<para>Dans de rares cas les utilisateurs peuvent vouloir
	  récupérer les archives &agrave; partir d'un
	  site différent du <varname>MASTER_SITES</varname> par
	  défaut (l'emplacement par défaut &agrave;
	  partir duquel les fichiers sont
	  téléchargés).  Vous pouvez surcharger
	  l'option <varname>MASTER_SITES</varname> avec la commande
	  suivante:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/répertoire</userinput>
&prompt.root; <userinput>make MASTER_SITE_OVERRIDE= \
ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/ fetch</userinput></screen>

	<para>Dans cet exemple nous modifions la valeur par
	  défaut de l'option <varname>MASTER_SITES</varname>
	  pour <systemitem class="fqdomainname">ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</systemitem>.</para>

	<note>
	  <para>Certains logiciels portés autorisent (ou
	    même nécessitent) des options de compilation
	    qui permettent l'activation/désactivation de parties
	    de l'application qui ne sont pas nécessaires, de
	    certaines options de sécurité, et autres
	    personnalisations.  Quelques noms de logiciels viennent
	    immédiatement &agrave; l'esprit: <package>www/mozilla</package>, <package>security/gpgme</package>, et <package>mail/sylpheed-claws</package>.  Un message
	    sera affiché quand de telles options sont
	    disponibles.</para></note>

      <sect3>
	<title>Modifier les répertoires par défaut des
	  logiciels portés</title>

	<para>Il est parfois utile (ou obligatoire) d'utiliser des
	  répertoires de travail ou cible différents.
	  Les variables
	  <varname>WRKDIRPREFIX</varname> et <varname>PREFIX</varname>
	  permettent de modifier les répertoires par
	  défaut.  Par exemple:</para>

	<screen>&prompt.root; <userinput>make WRKDIRPREFIX=/usr/home/example/ports install</userinput></screen>

	<para>compilera le logiciel dans le répertoire
	  <filename>/usr/home/example/ports</filename> et
	  installera tout dans <filename>/usr/local</filename>.</para>

	<screen>&prompt.root; <userinput>make PREFIX=/usr/home/example/local install</userinput></screen>

	<para>le compilera dans <filename>/usr/ports</filename> et l'installera dans
	  <filename>/usr/home/example/local</filename>.</para>

	<para>Et bien sûr</para>

	<screen>&prompt.root; <userinput>make WRKDIRPREFIX=../ports PREFIX=../local install</userinput></screen>

	<para>combinera les deux (c'est trop long pour tenir sur cette
	  page, mais cela devrait vous donner une idée
	  générale).</para>

	<para>Alternativement, ces variables peuvent également
	  être configurées dans votre environnement.
	  Consultez la page de manuel de votre interpréteur de
	  commandes pour des instructions sur la procédure
	  &agrave; suivre.</para>
      </sect3>

      <sect3>
	<title>Travailler avec <command>imake</command></title>

	<para>Certains logiciels portés qui utilisent
	  <command>imake</command> (une partie du système X
	  Window) ne fonctionnent pas correctement avec la variable
	  <varname>PREFIX</varname>, et insisteront pour s'installer
	  sous <filename>/usr/X11R6</filename>.  De
	  façon similaire, certains logiciels Perl ignorent
	  <varname>PREFIX</varname> et s'installent dans
	  l'arborescence Perl.  Faire en sorte que ces logiciels
	  portés respectent <varname>PREFIX</varname> est une
	  tâche difficile voire impossible.</para>
      </sect3>

      <sect3>
	<title>Reconfigurer les logiciels portés</title>

	<para>Lors de la compilation de certains logiciels
	  portés, un menu &man.ncurses.3; pourra s'afficher et
	  &agrave; partir de celui-ci vous pourrez sélectionner
	  certaines options de compilation.  Il n'est pas inhabituel
	  pour les utilisateurs de vouloir revoir ce menu pour
	  ajouter, supprimer, ou modifier ces options après la
	  compilation d'un logiciel.  Il y a plusieurs manières
	  pour y parvenir.  Une possibilité est de se rendre
	  dans le répertoire contenant le logiciel porté
	  et de taper <command>make
	  config</command>, qui affichera
	  &agrave; nouveau le menu avec les mêmes options
	  sélectionnées.  Une autre possibilité
	  est d'utiliser <command>make
	  showconfig</command> qui vous
	  affichera toutes les options de configuration pour le
	  logiciel porté.  Enfin, une autre possibilité
	  est d'exécuter <command>make
	  rmconfig</command> qui supprimera
	  toutes les options sélectionnées et permettra
	  donc de repartir &agrave; zéro.  Toutes ces options,
	  et bien d'autres, sont détaillées dans la page
	  de manuel &man.ports.7;.</para>
      </sect3>
    </sect2>

    <sect2 xml:id="ports-removing">
      <title>Supprimer des logiciels portés installés</title>

      <indexterm>
	<primary>logiciels portés</primary>
	<secondary>désinstallation</secondary>
      </indexterm>
      <para>Maintenant que vous savez comment installer des logiciels
	portés, vous vous demandez probablement comment les effacer,
	juste au cas où vous en installez un et plus tard vous vous
	apercevez que vous n'avez pas installé le bon logiciel
	porté.  Nous désinstallerons notre exemple
	précédent (qui était
	<command>lsof</command> pour ceux d'entre vous qui n'ont pas
	suivi).  Les logiciels portés sont supprimés de
	la même manière que pour les logiciels
	pré-compilés (comme décrit dans la
	section <link linkend="packages-using">Utiliser le
	système des logiciels
	pré-compilés</link>) en utilisant la commande
	&man.pkg.delete.1;:</para>

	<screen>&prompt.root; <userinput>pkg_delete lsof-4.57</userinput></screen>
    </sect2>

    <sect2 xml:id="ports-upgrading">
      <title>Mise &agrave; jour des logiciels portés</title>

      <indexterm>
	<primary>logiciels portés</primary>
	<secondary>mise &agrave; jour</secondary>
      </indexterm>
      <para>Tout d'abord, listez les logiciels portés
	périmés dont une nouvelle version est disponible
	dans le catalogue des logiciels portés &agrave; l'aide de
	la commande &man.pkg.version.1;:</para>

      <screen>&prompt.root; <userinput>pkg_version -v</userinput></screen>

      <sect3 xml:id="ports-file-updating">
	<title><filename>/usr/ports/UPDATING</filename></title>

	<para>Une fois que vous avez mis &agrave; jour le catalogue
	  des logiciels portés, avant de tenter la mise &agrave;
	  jour d'un logiciel porté, vous devrez consulter le
	  fichier <filename>/usr/ports/UPDATING</filename>.  Ce fichier
	  décrit les divers problèmes et les étapes
	  supplémentaires que les utilisateurs pourront
	  rencontrer ou devront effectuer lors de la mise
	  &agrave; jour un logiciel porté, comme la
	  modification de format de fichiers, le changement des
	  emplacements des fichiers de configuration, ou des
	  incompatibilités avec les versions
	  antérieures.</para>

	<para>Si le contenu du fichier <filename>UPDATING</filename>
	  prime même s'il est en est en contradiction avec des
	  informations présentées ici.</para>
      </sect3>

      <sect3 xml:id="portupgrade">
	<title>Mise &agrave; jour des logiciels portés &agrave;
	  l'aide de portupgrade</title>
	<indexterm>
	  <primary>portupgrade</primary>
	</indexterm>

      <para>Le logiciel <application>portupgrade</application> a
	été conçu pour une mise &agrave; jour
	aisée des logiciels portés installés.  Il
	est disponible via le logiciel porté <package>ports-mgmt/portupgrade</package>.  Installez-le
	de la même manière que pour n'importe quel autre
	logiciel en employant la commande <command>make
	install clean</command>:</para>

      <screen>&prompt.root; <userinput>cd /usr/ports/ports-mgmt/portupgrade</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

      <para>Ensuite, parcourez la liste des logiciels installés
	avec la commande <command>pkgdb -F</command> et corrigez
	toutes les inconsistances qu'il signale.  C'est une bonne
	idée d'effectuer ce contrôle
	régulièrement avant chaque mise &agrave;
	jour.</para>

      <para>En lançant <command>portupgrade -a</command>,
	<application>portupgrade</application> mettra &agrave; jour
	tous les logiciels portés périmés
	installés sur votre système.  Ajoutez
	l'indicateur <option>-i</option> si vous voulez être
	consulté pour confirmer chaque mise &agrave; jour
	individuelle.</para>

      <screen>&prompt.root; <userinput>portupgrade -ai</userinput></screen>

      <para>Si vous désirez mettre &agrave; jour qu'une seule
	application bien particulière et non pas
	l'intégralité des applications, utilisez la
	commande: <command>portupgrade
	nom_du_logiciel_porté</command>.
	Ajoutez l'option <option>-R</option> si
	<application>portupgrade</application> doit mettre &agrave;
	jour en premier lieu tous les logiciels portés
	nécessaires &agrave; l'application.</para>

      <screen>&prompt.root; <userinput>portupgrade -R firefox</userinput></screen>

      <para>Pour utiliser les versions pré-compilées
	plutôt que les logiciels portés pour
	l'installation, utilisez l'option <option>-P</option>.  Avec
	cette option <application>portupgrade</application> cherche
	les répertoires locaux listé dans la variable
	<envar>PKG_PATH</envar>, ou récupère les
	paquetages &agrave; partir d'un site distant s'ils ne sont pas
	trouvés localement.  Si les paquetages ne peuvent pas
	être trouvés localement ou
	récupérés &agrave; distance,
	<application>portupgrade</application> utilisera les logiciels
	portés.  Pour éviter l'usage des logiciels
	portés, spécifiez l'option
	<option>-PP</option>.</para>

      <screen>&prompt.root; <userinput>portupgrade -PP gnome2</userinput></screen>

      <para>Pour juste récupérer les sources (ou les
	paquetages, si l'option <option>-P</option> est
	utilisée) sans compiler ni installer quelque chose,
	utilisez <option>-F</option>.  Pour plus d'informations
	consultez la page de manuel &man.portupgrade.1;.</para>
      </sect3>

      <sect3 xml:id="portmanager">
	<title>Mise &agrave; jour des logiciels portés &agrave;
	  l'aide de Portmanager</title>

	<indexterm>
	  <primary>portmanager</primary>
	</indexterm>

	<para><application>Portmanager</application> est un autre
	  utilitaire de mise &agrave; jour aisée des logiciels
	  portés installés.  Il est disponible via le
	  logiciel portés <package>ports-mgmt/portmanager</package>:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/ports-mgmt/portmanager</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

	<para>Tous les logiciels portés installés
	  peuvent être mis &agrave; jour en utilisant cette
	  simple commande:</para>

	<screen>&prompt.root; <userinput>portmanager -u</userinput></screen>

	<para>Vous pouvez ajouter l'option <option>-ui</option> pour
	  être sollicité pour une confirmation &agrave;
	  chaque opération qu'effectuera
	  <application>Portmanager</application>.
	  <application>Portmanager</application> peut également
	  être employé pour installer de nouveaux
	  logiciels portés sur le système.
	  Contrairement &agrave; la commande <command>make install
	  clean</command> habituelle, il mettra &agrave; jour toutes
	  les dépendances avant de compiler et d'installer le
	  logiciel sélectionné.</para>

	<screen>&prompt.root; <userinput>portmanager x11/gnome2</userinput></screen>

	<para>Si des problèmes concernant les
	  dépendances du logiciel porté
	  sélectionné apparaissent, vous pouvez utiliser
	  <application>Portmanager</application> pour toutes les
	  recompiler dans le bon ordre.  Cette recompilation
	  achevée, le logiciel porté en question peut
	  alors être &agrave; son tour recompilé.</para>

	<screen>&prompt.root; <userinput>portmanager graphics/gimp -f</userinput></screen>

	<para>Pour plus d'information, consultez la page de manuel
	  de <application>Portmanager</application>.</para>
      </sect3>

      <sect3 xml:id="portmaster">
	<title>Mise &agrave; jour des logiciels portés &agrave;
	  l'aide de Portmaster</title>

	<indexterm>
	  <primary>portmaster</primary>
	</indexterm>

	<para><application>Portmaster</application> est un autre
	  utilitaire destiné &agrave; la mise &agrave; jour des
	  logiciels installés.
	  <application>Portmaster</application> a été
	  conçu pour utiliser les outils présents dans
	  le système de <quote>base</quote> (il ne
	  dépend pas d'un autre logiciel porté) et
	  utilise les informations contenues dans le répertoire
	  <filename>/var/db/pkg/</filename> pour
	  déterminer quel logiciel doit être mis &agrave;
	  jour.  Il est disponible &agrave; partir du logiciel
	  porté <package>ports-mgmt/portmaster</package>:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/ports-mgmt/portmaster</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

	<para><application>Portmaster</application> répartit
	  les logiciels portés en quatre
	  catégories:</para>

	<itemizedlist>
	  <listitem>
	    <para>logiciels dits <quote>Root</quote> (pas de
	      dépendance, aucun logiciel n'en
	      dépend);</para>
	  </listitem>
	  <listitem>
	    <para>logiciels dits <quote>Trunk</quote> (pas de
	      dépendance, d'autres logiciels en
	      dépendent);</para>
	  </listitem>
	  <listitem>
	    <para>logiciels dits <quote>Branch</quote> (ont des
	      dépendances, d'autres logiciels en
	      dépendent);</para>
	  </listitem>
	  <listitem>
	    <para>logiciels dits <quote>Leaf</quote> (ont des
	      dépendances, aucun logiciel n'en
	      dépend).</para>
	  </listitem>
	</itemizedlist>

	<para>Vous pouvez lister tous les logiciels installés
	  et rechercher les mises &agrave; jour en utilisant l'option
	  <option>-L</option>:</para>

<screen>&prompt.root; <userinput>portmaster -L</userinput>
===&gt;&gt;&gt; Root ports (No dependencies, not depended on)
===&gt;&gt;&gt; ispell-3.2.06_18
===&gt;&gt;&gt; screen-4.0.3
        ===&gt;&gt;&gt; New version available: screen-4.0.3_1
===&gt;&gt;&gt; tcpflow-0.21_1
===&gt;&gt;&gt; 7 root ports
...
===&gt;&gt;&gt; Branch ports (Have dependencies, are depended on)
===&gt;&gt;&gt; apache-2.2.3
        ===&gt;&gt;&gt; New version available: apache-2.2.8
...
===&gt;&gt;&gt; Leaf ports (Have dependencies, not depended on)
===&gt;&gt;&gt; automake-1.9.6_2
===&gt;&gt;&gt; bash-3.1.17
        ===&gt;&gt;&gt; New version available: bash-3.2.33
...
===&gt;&gt;&gt; 32 leaf ports

===&gt;&gt;&gt; 137 total installed ports
        ===&gt;&gt;&gt; 83 have new versions available
</screen>

	<para>L'ensemble des logiciels portés installés
	  peut être mis &agrave; jour en utilisant cette simple
	  commande:</para>

	<screen>&prompt.root; <userinput>portmaster -a</userinput></screen>

	<note>
	  <para>Par défaut
	    <application>Portmaster</application> fera une sauvegarde
	    avant la suppression d'un logiciel porté.  Si
	    l'installation de la nouvelle version se passe
	    correctement, <application>Portmaster</application>
	    supprimera la sauvegarde.  L'option <option>-b</option>
	    demandera &agrave; <application>Portmaster</application>
	    de ne pas supprimer automatiquement la sauvegarde.
	    L'ajout de l'option <option>-i</option> lancera
	    <application>Portmaster</application> en mode interactif,
	    vous serez alors sollicité avant la mise &agrave;
	    jour de chaque logiciel.</para>
	</note>

	<para>Si vous rencontrez des erreurs lors du processus de mise
	  &agrave; jour, vous pouvez utiliser l'option
	  <option>-f</option> pour mettre &agrave; jour ou recompiler
	  tous les logiciels installés:</para>

	<screen>&prompt.root; <userinput>portmaster -af</userinput></screen>

	<para>Vous pouvez également employer
	  <application>Portmaster</application> pour installer de
	  nouveaux logiciels portés en mettant &agrave; jour
	  toutes les dépendances avant la compilation et
	  l'installation du nouveau logiciel:</para>

	<screen>&prompt.root; <userinput>portmaster shells/bash</userinput></screen>

	<para>Pour plus d'information veuillez consulter la page de
	  manuel &man.portmaster.8;.</para>
      </sect3>
    </sect2>

    <sect2 xml:id="ports-disk-space">
      <title>Logiciels portés et espace disque</title>

      <indexterm>
	<primary>logiciels portés</primary>
	<secondary>espace disque</secondary>
      </indexterm>
      <para>A la longue, l'utilisation du catalogue des logiciels
	portés consommera rapidement votre espace disque.
	Après la compilation et l'installation de logiciels
	&agrave; partir du catalogue des logiciels portés, vous
	devriez toujours penser &agrave; supprimer
	les répertoires de travail temporaires, <filename>work</filename>, en utilisant la commande
	<command>make clean</command>.  Vous pouvez
	balayer l'intégralité du catalogue des logiciels
	portés pour supprimer tous les répertoires
	temporaires oubliés précédement, employez
	alors la commande suivante:</para>

      <screen>&prompt.root; <userinput>portsclean -C</userinput></screen>

      <para>Avec le temps, vous accumulerez beaucoup de fichiers
	sources obsolètes dans le répertoire <filename>distfiles</filename>.  Vous pouvez les
	supprimer manuellement, ou vous pouvez utiliser la commande
	suivante pour effacer toutes les sources qui ne correspondent
	plus &agrave; des logiciels portés
	d'actualité:</para>

      <screen>&prompt.root; <userinput>portsclean -D</userinput></screen>

      <para>Ou pour supprimer les fichiers sources ne correspondant
	&agrave; aucun logiciel installé sur votre
	systèmes.</para>

      <note>
	<para>L'utilitaire <command>portsclean</command> fait partie
	  de la suite <application>portupgrade</application>.</para>
      </note>

      <para>Pensez &agrave; supprimer les logiciels portés
	installés que vous n'utilisez plus.  Un outil qui
	permet d'automatiser cette tâche est disponible via le
	logiciel porté <package>ports-mgmt/pkg_cutleaves</package>.</para>
    </sect2>
  </sect1>

  <sect1 xml:id="ports-nextsteps">
    <title>Activités de post-installation</title>

    <para>Après l'installation d'une nouvelle application vous voudrez
      normalement lire la documentation qui a pu être également
      installée, éditer les fichiers de configuration
      nécessaires, vérifier que l'application est
      lancée au démarrage (si c'est un
      daemon), et ainsi de suite.</para>

    <para>Les étapes que vous devez suivre pour configurer
      chaque application seront bien évidemment différentes.
      Cependant, si vous venez juste d'installer une nouvelle application
      et que vous vous demandez &ldquo;Et maintenant?&rdquo; les astuces
      suivantes pourront vous aider:</para>

    <itemizedlist>
      <listitem>
	<para>Utilisez &man.pkg.info.1; pour déterminer quels fichiers
	  ont été installés et &agrave; quel endroit.
	  Par exemple, si vous
	  venez juste d'installer FooPackage version 1.0.0, alors la
	  commande</para>

	<screen>&prompt.root; <userinput>pkg_info -L foopackage-1.0.0 | less</userinput></screen>

	<para>affichera tous les fichiers installés par le logiciel
	  pré-compilé.  Portez une attention toute
	  particulière aux
	  fichiers dans les répertoires <filename>man/</filename>, qui
	  seront des pages de manuel, dans les répertoires
	  <filename>etc/</filename> , qui seront des fichiers de
	  configuration, et dans <filename>doc/</filename> qui seront de
	  la documentation plus complète.</para>

	<para>Si vous n'êtes pas sûr de la version de
	  l'application qui vient juste d'être installée,
	  une commande comme</para>

	<screen>&prompt.root; <userinput>pkg_info | grep -i foopackage</userinput></screen>

	<para>déterminera tous les logiciels
	  pré-compilés installés qui
	  ont <replaceable>foopackage</replaceable> dans leur nom.
	  Remplacez <replaceable>foopackage</replaceable> dans votre
	  ligne de commande par ce qui convient.</para>
      </listitem>

      <listitem>
	<para>Une fois que vous avez identifié où les
	  pages de manuel de l'application ont été
	  installées, consultez-les en utilisant
	  la commande  &man.man.1;.  De même, jetez un coup d'oeil
	  aux exemples de fichiers de configuration, et toute autre
	  documentation additionnelle qui peut avoir été
	  fournie.</para>
      </listitem>

      <listitem>
	<para>Si l'application a un site web, consultez-le pour de la
	  documentation supplémentaire, des listes de questions
	  fréquemment posées, etc.  Si vous n'êtes
	  pas sûr de
	  l'adresse du site web, elle peut être affichée dans le
	  résultat de la commande:</para>

	<screen>&prompt.root; <userinput>pkg_info foopackage-1.0.0</userinput></screen>

	<para>La ligne <literal>WWW:</literal>, si elle est présente,
	  devrait donner l'URL du site web de l'application.</para>
      </listitem>

      <listitem>
	<para>Les logiciels qui doivent être lancés au
	  démarrage (comme les serveurs Internet) installent
	  généralement un exemple de procédure de
	  lancement dans le répertoire <filename>/usr/local/etc/rc.d</filename>.  Vous devriez
	  contrôler si ce fichier est correct et l'éditer
	  ou le renommer si nécessaire.  Consultez la section
	  <link linkend="configtuning-starting-services">Démarrer
	  des services</link> pour plus d'informations.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 xml:id="ports-broken">
    <title>Que faire avec les logiciels portés ne fonctionnant
      pas?</title>

      <para>Si vous rencontrez un portage qui ne fonctionne pas, il y a
	certaines choses que vous pouvez faire:</para>

      <orderedlist>
	<listitem>
	  <para>Vérifiez s'il n'y a pas de correctif en attente
	    pour le logiciel porté dans la <link xlink:href="&url.base;/support.html#gnats">base des rapports de
	    bogue</link>.  Si c'est le cas, il se peut que vous
	    puissiez utiliser le correctif proposé.</para>
	</listitem>

	<listitem>
	  <para>Demandez l'aide du responsable du logiciel porté.
	    Tapez la
	    commande <command>make maintainer</command> ou lisez le
	    fichier <filename>Makefile</filename> pour trouver l'adresse
	    électronique du responsable.  Pensez &agrave;
	    préciser le nom et la
	    version du logiciel porté (envoyer la ligne
	    <literal>&dollar;FreeBSD:</literal> du fichier
	    <filename>Makefile</filename>) et les messages d'erreurs
	    quand vous écrivez au responsable.</para>

	  <note>
	    <para>Certains logiciels portés ne sont pas
	      maintenus par une personne mais par une <link xlink:href="&url.articles.mailing-list-faq;/article.html">liste
	      de diffusion</link>.  Plusieurs, si ce n'est toutes, les
	      adresses de ces listes ressemblent &agrave; <email role="nolink">freebsd-listname@FreeBSD.org</email>.
	      Veuillez prendre cela en compte en rédigeant vos
	      questions.</para>

	    <para>En particulier, les logiciels portés
	      apparaissant comme maintenus par <email role="nolink">ports@FreeBSD.org</email> ne sont
	      en fait maintenus par personne.  Correctifs et aide,
	      s'ils y en a, provient de la communauté qui est
	      abonnée &agrave; cette liste de diffusion.  Des
	      volontaires supplémentaires sont toujours les
	      bienvenus!</para>
	  </note>

	  <para>Si vous n'obtenez pas de réponse, vous pouvez
	    utiliser &man.send-pr.1; pour soumettre un rapport de
	    bogue (consultez <link xlink:href="&url.articles.problem-reports;/article.html">Ecrire
	    des rapports de bogue pour &os;</link>).</para>
	</listitem>

        <listitem>
	  <para>Corrigez le problème!  Le <link xlink:href="&url.books.porters-handbook;/index.html">Manuel du développeur
	    de logiciels portés</link> inclut des informations
	    détaillées sur l'infrastructure des logiciels
	    portés vous permettant de corriger le portage
	    éventuellement défectueux
	    ou même soumettre le votre!</para>
	</listitem>

	<listitem>
	  <para>Récupérez la version pré-compilée
	    sur un serveur FTP proche de vous.  Le catalogue de
	    &ldquo;référence&rdquo; des logiciels
	    pré-compilés se trouve
	    sur <systemitem class="fqdomainname">ftp.FreeBSD.org</systemitem> dans le
	    répertoire
	    <link xlink:href="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/">packages</link>,
	    mais vérifiez <emphasis>d'abord</emphasis> votre <link xlink:href="http://mirrorlist.FreeBSD.org/">miroir
	    local</link>!  Il y a globalement plus de chances que cela marche,
	    que d'essayez de compiler &agrave; partir des sources, et cela va
	    également beaucoup plus vite.  Utilisez le programme
	    &man.pkg.add.1; pour installer le logiciel
	    pré-compilé sur votre système.</para>
	</listitem>
      </orderedlist>
  </sect1>

</chapter>
