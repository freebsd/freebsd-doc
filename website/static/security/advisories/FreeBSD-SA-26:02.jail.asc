-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

=============================================================================
FreeBSD-SA-26:02.jail                                       Security Advisory
                                                          The FreeBSD Project

Topic:          Jail escape by a privileged user via nullfs

Category:       core
Module:         jail
Announced:      2026-01-27
Affects:        FreeBSD 14.3 and 13.5
Corrected:      2025-06-30 14:21:28 UTC (stable/14, 14.3-STABLE)
                2026-01-27 19:16:15 UTC (releng/14.3, 14.3-RELEASE-p8)
                2026-01-26 15:51:19 UTC (stable/13, 13.4-STABLE)
                2026-01-27 19:16:37 UTC (releng/13.5, 13.5-RELEASE-p9)
CVE Name:       CVE-2025-15547

For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit <URL:https://security.FreeBSD.org/>.

I.   Background

Jails are an operating system virtualization technology which allow
administrators to confine processes within an environment with limited ability
to affect the system outside of that environment.  In particular, jailed
processes typically have their filesystem access confined by a chroot-like
mechanism.

nullfs(4) is a pseudo-filesystem which allows a directory to be mounted at
another point in the filesystem hierarchy.

II.  Problem Description

By default, jailed processes cannot mount filesystems, including nullfs(4).
However, the allow.mount.nullfs option enables mounting nullfs filesystems,
subject to privilege checks.

If a privileged user within a jail is able to nullfs-mount directories, a
limitation of the kernel's path lookup logic allows that user to escape the
jail's chroot, yielding access to the full filesystem of the host or parent
jail.

III. Impact

In a jail configured to allow nullfs(4) mounts from within the jail, the jailed
root user can escape the jail's filesystem root. 

IV.  Workaround

No workaround is available.  Jails not created with the allow.mount.nullfs option
are unaffected.

V.   Solution

Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.

Perform one of the following:

1) To update your vulnerable system via a binary patch:

Systems running a RELEASE version of FreeBSD on the amd64 or arm64 platforms,
or the i386 platform on FreeBSD 13, can be updated via the freebsd-update(8)
utility:

# freebsd-update fetch
# freebsd-update install
# shutdown -r +10min "Rebooting for a security update"

2) To update your vulnerable system via a source code patch:

The following patches have been verified to apply to the applicable
FreeBSD release branches.

a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.

[FreeBSD 14.3]
# fetch https://security.FreeBSD.org/patches/SA-26:02/jail-14.patch
# fetch https://security.FreeBSD.org/patches/SA-26:02/jail-14.patch.asc
# gpg --verify jail-14.patch.asc

[FreeBSD 13.5]
# fetch https://security.FreeBSD.org/patches/SA-26:02/jail-13.patch
# fetch https://security.FreeBSD.org/patches/SA-26:02/jail-13.patch.asc
# gpg --verify jail-13.patch.asc

b) Apply the patch.  Execute the following commands as root:

# cd /usr/src
# patch < /path/to/patch

c) Recompile your kernel as described in
<URL:https://www.FreeBSD.org/handbook/kernelconfig.html> and reboot the
system.

VI.  Correction details

This issue is corrected as of the corresponding Git commit hash in the
following stable and release branches:

Branch/path                             Hash                     Revision
- -------------------------------------------------------------------------
stable/14/                              53963866f708    stable/14-n271804
releng/14.3/                            193ae464aa36  releng/14.3-n271460
stable/13/                              f0fbaa71a5a2    stable/13-n259726
releng/13.5/                            e87a5dd8054a  releng/13.5-n259191
- -------------------------------------------------------------------------

Run the following command to see which files were modified by a
particular commit:

# git show --stat <commit hash>

Or visit the following URL, replacing NNNNNN with the hash:

<URL:https://cgit.freebsd.org/src/commit/?id=NNNNNN>

To determine the commit count in a working tree (for comparison against
nNNNNNN in the table above), run:

# git rev-list --count --first-parent HEAD

VII. References

<URL:https://bugs.freebsd.org/bugzilla/show_bug.cgi?id=262180>

<URL:https://www.cve.org/CVERecord?id=CVE-2025-15547>

The latest revision of this advisory is available at
<URL:https://security.FreeBSD.org/advisories/FreeBSD-SA-26:02.jail.asc>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCgAdFiEEthUnfoEIffdcgYM7bljekB8AGu8FAml5NVcACgkQbljekB8A
Gu/70A//VWtonOhQP9CeZPUOL41yHUYKOOm9Wf6DkbWqq7aqxcpM5FiGn3Wq84ql
Qy0qpLIXg4KpHD8qjARqQDg2A3J60O1yW2X7WWLRCCDVMsPRe5sNCuwPH88Mzu+x
1VsE9qne25CKJrLcvFsMoO6XfCx6yQ4Qw6uZjyk1DPPIjZfaZYaM9ysAswAo8tsi
7/s+NsFImjN9S6S7q7Z3E+222pOmEkhUKPNaCXoCXTeutiMd+18oxL290xzXs/49
0NpdOQcX9R+AiA3hJYkrg6YwoxJASc4aXUv7/SKNRdyL9eRiRkt0ta5jsCup3CXw
SIovbhzauXTbv+AliUoAVSXnEK7S0MyUoMM6RG6OPH7JoKf83Sx61P+D8Y1fMYs1
Gd+g5Nw00Xk3/8hQUSo91K3+A0Lb88QLt+Wc8pzaj7QYfaaYb9DSfyx3U/cjbYiv
sovFZ7D3r0EH5P3n1jkWHQWrV1/u4I7nd/URC0Lz4WUhEfM3X0abaq5q939fpvJU
y37vBlbfw5d139S3C2frPR2sPX6e6K+jXZzjnpLtYF6CsIjfcfWRCRu3pBvWJ24X
/KCJ2AlhGRDcTbYjafzUQMcni4lw5uZ/gpl5SGfbcOTaM1yC0HWmG8W9NaYR79Gn
QtZ+RgQm5wJJAzHX9wQbVTaMoWW5/AbQy2dhDZBjx2rbZmOGBNc=
=SqAm
-----END PGP SIGNATURE-----
