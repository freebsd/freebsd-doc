---
title: "FreeBSD 6.1 Open Issues"
sidenav: download
---

++++


<p>This is a list of open issues that need to be resolved for FreeBSD
  6.1.  If you have any updates for this list, please e-mail
  re@FreeBSD.org.</p>

<ul>
  <li><a href="#showstopper" shape="rect">Show stopper defects</a></li>
  <li><a href="#required" shape="rect">Required features</a></li>
  <li><a href="#desired" shape="rect">Desired features</a></li>
  <li><a href="#docs" shape="rect">Documentation Items</a></li>
  <li><a href="#testing" shape="rect">Testing foci</a></li>
  <li><a href="#stresstest" shape="rect">Problems Discovered by Kernel Stress Test Suite</a></li>
  <li><a href="#sparc64" shape="rect">Problems specific to the sparc64 architecture</a></li>
</ul>

<h3>Show stopper defects for 6.1-RELEASE</h3>

<a name="showstopper" shape="rect" id="showstopper"></a>
<table class="tblbasic">
  <tr class="heading">
    <th rowspan="1" colspan="1">Issue</th>
    <th rowspan="1" colspan="1">Status</th>
    <th rowspan="1" colspan="1">Responsible</th>
    <th rowspan="1" colspan="1">Description</th>
  </tr>

  <tr><td colspan="4" rowspan="1">No pending issue.</td></tr>
</table>

<h3>Required features for 6.1-RELEASE</h3>

<a name="required" shape="rect" id="required"></a>
<table class="tblbasic">
  <tr class="heading">
    <th rowspan="1" colspan="1">Issue</th>
    <th rowspan="1" colspan="1">Status</th>
    <th rowspan="1" colspan="1">Responsible</th>
    <th rowspan="1" colspan="1">Description</th>
  </tr>

  <tr><td colspan="4" rowspan="1">No pending issue.</td></tr>
</table>

<h3>Desired features for 6.1-RELEASE</h3>

<a name="desired" shape="rect" id="desired"></a>
<table class="tblbasic">
  <tr class="heading">
    <th rowspan="1" colspan="1">Issue</th>
    <th rowspan="1" colspan="1">Status</th>
    <th rowspan="1" colspan="1">Responsible</th>
    <th rowspan="1" colspan="1">Description</th>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">devfs locking problem</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">Jeff Roberson</td>
    <td rowspan="1" colspan="1">It is trivial to deadlock it on an SMP system, and
      there are other panics with device removal.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">pty leak</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">Olivier Houchard</td>
    <td rowspan="1" colspan="1">Since 6.x has a hard-coded limit, once all ptys are
      leaked things like ssh and login no longer work.
      This seems devfs-related, and occurs only under extreme stress
      testing, not normal use.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">swap_pager warnings</td>
    <td rowspan="1" colspan="1"><font color="red">Unknown</font></td>
    <td rowspan="1" colspan="1">Don &#8220;Truck&#8221; Lewis?</td>
    <td rowspan="1" colspan="1">When swapfiles are in use, there are often warnings printed:
<tt>swap_pager: indefinite wait buffer: bufobj: 0, blkno: 889347, size: 8192</tt>.  There is also the possibility of deadlock.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">unmount pending error</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">Suleiman Souhlal</td>
    <td rowspan="1" colspan="1">When unmounting filesystems Kris Kennaway reports seeing this warning: <tt>/c: unmount pending error: blocks -68512 files 0</tt>.  This dates back at least to 5.3.  It might be associated with
filesystem corruption reported by many users in which the 'used' space
on a filesystem is negative; fsck -f is needed to correct this.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">"calcru: runtime went backwards" problem for threaded program</td>
    <td rowspan="1" colspan="1"><font color="red">Unknown</font></td>
    <td rowspan="1" colspan="1">&nbsp;</td>
    <td rowspan="1" colspan="1">stress2 thr1 test can trigger "calcru: runtime went backwards" problem
      and there are also many similar reports on -stable and -current.
      Poul-Henning Kamp committed a possible fix (src/sys/kern/kern_tc.c rev.1.169) to
      update the calibration code to be more precise on 2 March.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">NFS data corruption between two 7.0 machines</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">Mohan Srinivasan</td>
    <td rowspan="1" colspan="1">Running fsx between a 7.0 NFS client and server
       detects data corruption.  This problem can also be reproduced
       by using 6.1 NFS server.  The problem seems to be avoidable by
       turning off the attribute cache on the NFS client.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">sort(1) does not work with some locales</td>
    <td rowspan="1" colspan="1"><font color="red">Not&nbsp;done</font></td>
    <td rowspan="1" colspan="1">&nbsp;</td>
    <td rowspan="1" colspan="1">sort(1) can cause a coredump with some locales.
       See also gnu/93629.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">unreliable serial console</td>
    <td rowspan="1" colspan="1"><font color="red">Unknown</font></td>
    <td rowspan="1" colspan="1"></td>
    <td rowspan="1" colspan="1">At the manual 'root mount' prompt, the serial console is very
      unreliable and drops most characters.  This appears to be caused
      by cngetc() polling the sio driver for input, and the sio driver
      resetting the chip on every poll iteration.  That results in a very
      small window for it to accept input.  Fixing this requires a
      large review of the operation of the sio driver.  The uart driver
      looks to handle this better and might be a suitable replacement.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">fix ntpdate(1) bogus output on amd64.</td>
    <td rowspan="1" colspan="1"><font color="red">Unknown</font></td>
    <td rowspan="1" colspan="1">Ollivier Robert</td>
    <td rowspan="1" colspan="1"></td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">make -jN</td>
    <td rowspan="1" colspan="1"><font color="red">Not&nbsp;done</font></td>
    <td rowspan="1" colspan="1">&nbsp;</td>
    <td rowspan="1" colspan="1">Doing 'make -jN', then suspending/resuming it may result in make
      reporting it lost child process(es).</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">update sysinstall disk labeling</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">Craig Rodrigues</td>
    <td rowspan="1" colspan="1">Sysinstall could use the same fixes recently made to fdisk so it
      plays nice with GEOM and disk labeling.  This does not cause problems
      during install because nothing on the disk is mounted when its label
      is being manipulated but it can cause problems if sysinstall gets
      used on a live system to adjust labels on existing disks which
      sys-admins tend to do.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">i386 deadlocks with &gt;16GB swap</td>
    <td rowspan="1" colspan="1"><font color="gray">Deferred for future release</font></td>
    <td rowspan="1" colspan="1">Alan L. Cox</td>
    <td rowspan="1" colspan="1">i386 deadlocks if more than 16GB of swap is in use.
      Increasing the kern.maxswzone tunable would be a workaround
      this.  Although a patch from Alan L. Cox is needed to allow this variable to
      be increased, this is not suitable for 6.1R.  This limitation should
      be documented in the Release Notes.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">panic in bpf</td>
    <td rowspan="1" colspan="1"><font color="gray">Deferred for future release</font></td>
    <td rowspan="1" colspan="1">Sam Leffler</td>
    <td rowspan="1" colspan="1">killing tcpdump (e.g. with ^C) can cause panics in bpf.
       To fix this problem, some architectural changes are needed.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">OpenBSM</td>
    <td rowspan="1" colspan="1"><font color="gray">Deferred for future release</font></td>
    <td rowspan="1" colspan="1">Robert Watson</td>
    <td rowspan="1" colspan="1">The integration of OpenBSM is waiting on some final licensing hurdles.
      It is expected to be available in the next release.</td>
  </tr>
</table>

<h3>Documentation items that must be resolved for 6.1</h3>

<a name="docs" shape="rect" id="docs"></a>
<table class="tblbasic">
  <tr class="heading">
    <th rowspan="1" colspan="1">Issue</th>
    <th rowspan="1" colspan="1">Status</th>
    <th rowspan="1" colspan="1">Responsible</th>
    <th rowspan="1" colspan="1">Description</th>
  </tr>

  <tr><td colspan="4" rowspan="1">No pending issue.</td></tr>
</table>

<h3>Testing foci for 6.1-RELEASE</h3>

<a name="testing" shape="rect" id="testing"></a>
<table class="tblbasic">
  <tr class="heading">
    <th rowspan="1" colspan="1">Issue</th>
    <th rowspan="1" colspan="1">Status</th>
    <th rowspan="1" colspan="1">Responsible</th>
    <th rowspan="1" colspan="1">Description</th>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">manual root mount lockmgr panics</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Suleiman Souhlal</td>
    <td rowspan="1" colspan="1">Specifying a manual root mount location causes lockmgr panics.
      Suleiman Souhlal has committed a patch for this.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">dhclient causes ipv6 panics.</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Doug Barton</td>
    <td rowspan="1" colspan="1">Doug Barton has more details about this.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">amd64 panics in ipv6 with date(1)</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Hajimu UMEMOTO</td>
    <td rowspan="1" colspan="1">amd64 panics in ipv6 when the date is changed using date(1) or
	ntpdate(1).  This may be a MI issue.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">grep(1) -w does not work with multibyte locales</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Tim J. Robbins</td>
    <td rowspan="1" colspan="1">grep(1) -w generates wrong results with non-UTF-8
       multibyte locales.  Tim J. Robbins has committed a patch
       to -HEAD.  See also gnu/91909.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">Improve kbdmux</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Maksim Yevmenkin</td>
    <td rowspan="1" colspan="1"><em>From the <a href="http://www.freebsd.org/projects/ideas/" shape="rect">ideas
      page</a>.</em> We need this for the growing number of systems
      that assume that USB is the primary keyboard. Current status
      appears to be that the kbdmux driver breaks very easily. We need
      this working well enough where it can be enabled by default, and
      all attached keyboards Just Work. Maksim Yevmenkin commit kbdmux and
      rc.d/syscons patches in HEAD and RELENG_6. It is not yet enabled
      by default. See kbdmux(4) and contact Maksim Yevmenkin if you have
      problems.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">umount -f panics</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Jeff Roberson, Suleiman Souhlal</td>
    <td rowspan="1" colspan="1">panics from race conditions.
      A patch from Jeff Roberson seems to fix some of them.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">quota deadlocks</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Jeff Roberson</td>
    <td rowspan="1" colspan="1">Quota support is not locked properly and causes deadlocks.
      A patch from Jeff Roberson seems to fix some of them.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">ifconfig regression on 6.x</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Yar Tikhiy</td>
    <td rowspan="1" colspan="1">ifconfig cannot handle vlan and mtu parameters at the same time
      after rev.1.7.2.3 of sbin/ifconfig/ifvlan.c commit.
      For more information and a proposed patch, see
      <a href="http://www.freebsd.org/cgi/query-pr.cgi?pr=bin/94028" shape="rect">bin/94028</a>.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">SMP kernels for install</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Sam Leffler</td>
    <td rowspan="1" colspan="1"><em>From the <a href="http://www.freebsd.org/projects/ideas/" shape="rect">ideas
      page</a>.</em>  Right now we only install a UP kernel, for performance
      reasons. We should be able to package both a UP and SMP kernel
      into the release bits, and have sysinstall install both. It
      should also select the correct one for the target system and
      make that the default on boot. The easiest way to do this would
      be to have sysinstall boot an SMP kernel and then look at the
      hw.ncpu sysctl. The only problem is being able to have
      sysinstall fall back to booting a UP kernel for itself if the
      SMP one fails. This can probably be 'faked' by setting one of
      the SMP-disabling variables in the loader. But in any case, the
      point is to make the process Just Work for the user, without the
      user needing to know arcane loader/sysctl knobs. SMP laptops are
      here, and we should be ready to support SMP out-of-the-box.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">dup(2) regression on 6.x</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Christian S.J. Peron</td>
    <td rowspan="1" colspan="1">Simple "close(0); dup(fd)" does not return descriptor "0" in some cases.
      This problem has been reported in
      <a href="http://www.freebsd.org/cgi/query-pr.cgi?pr=kern/87208" shape="rect">kern/87208</a>,
      and there is a proposed patch in the PR, too.  Christian S.J. Peron has committed a
      fix for this.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">cpu_ipi_selected() can cause a trap on FreeBSD/sparc64</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Marius Strobl</td>
    <td rowspan="1" colspan="1">On sparc64, cpu_ipi_selected() can cause a trap (which is bad since
      it appears in the trap code path).</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">UFS deadlocks on amd64</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Tor Egge</td>
    <td rowspan="1" colspan="1">Seen by Kris Kennaway.  This problem seems MI.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">UFS deadlocks</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Tor Egge</td>
    <td rowspan="1" colspan="1">Seen by Peter Jeremy.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">panic in fxp driver</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Andre Oppermann</td>
    <td rowspan="1" colspan="1">See <a href="http://people.freebsd.org/~pho/stress/log/cons186.html" shape="rect">http://people.freebsd.org/~pho/stress/log/cons186.html</a>.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">exec_map depletion</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Stephan Uphoff</td>
    <td rowspan="1" colspan="1">The exec_map is regularly running out of space
       on machines running 7.0.  Stephan Uphoff has a committed a
       patch that seems to fix this problem.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">/dev/mem instability</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Marius Strobl, Stephan Uphoff</td>
    <td rowspan="1" colspan="1">Instability when accessing /dev/mem.  A fix was committed
      for i386.  amd64 does not seem to have the problem.  A sparc64
      fix is still in progress.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">deadlock in vn_start_write() consumers</td>
    <td rowspan="1" colspan="1"><font color="orange">Needs&nbsp;testing</font></td>
    <td rowspan="1" colspan="1">Tor Egge</td>
    <td rowspan="1" colspan="1">Many potential deadlocks have been fixed.</td>
  </tr>

</table>

<h3>Stress Test Panics</h3>

<a name="stresstest" shape="rect" id="stresstest"></a>
<p>The system is continuously being subjected to Peter Holm's <a href="http://www.holm.cc/stress/" shape="rect">Kernel Stress Test Suite</a>.  The
  following issues have recently been discovered from this test
  suite.</p>

<h3>sparc64 problems</h3>
<a name="sparc64" shape="rect" id="sparc64"></a>
<p>These are problems that range in severity for FreeBSD/sparc64.  They
will not hold up the release, but they will still be tracked for future
releases.</p>

<table class="tblbasic">
  <tr class="heading">
    <th rowspan="1" colspan="1">Issue</th>
    <th rowspan="1" colspan="1">Status</th>
    <th rowspan="1" colspan="1">Responsible</th>
    <th rowspan="1" colspan="1">Description</th>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">sparc64 frequent hangs</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">Marius Strobl</td>
    <td rowspan="1" colspan="1">Some of the more serious hangs on sparc64 have been fixed, but more
      remain.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">serious sparc64 IPv6 panic</td>
    <td rowspan="1" colspan="1"><font color="blue">In&nbsp;progress</font></td>
    <td rowspan="1" colspan="1">George V. Neville-Neil</td>
    <td rowspan="1" colspan="1">Triggered by just ping6'ing the box.  It may even be a MI
      issue, the reporter of this bug only uses IPv6 with
      sparc64.  This problem seems to be triggered even when debug.mpsafenet="0".</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">swap panic on sparc64</td>
    <td rowspan="1" colspan="1"><font color="red">Unknown</font></td>
    <td rowspan="1" colspan="1">Kris Kennaway has panic info</td>

    <td rowspan="1" colspan="1">Kris Kennaway reports configuring a 74GB swap-backed md on sparc64 that
      caused a panic after a week or two of load (during which time
      swap was slowly filling as more of the md was dirtied).</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">KLDs on sparc64</td>
    <td rowspan="1" colspan="1"><font color="red">Not&nbsp;done</font></td>
    <td rowspan="1" colspan="1">&nbsp;</td>
    <td rowspan="1" colspan="1">On sparc64 machines with more than 4Gb memory KLDs are not usable
      and will panic the system.  The problem is reportedly with how the
      KLDs are compiled, it only works if the code ends up below 4G.</td>
  </tr>

  <tr>
    <td rowspan="1" colspan="1">Max RAM on sparc64</td>
    <td rowspan="1" colspan="1"><font color="red">Not&nbsp;done</font></td>
    <td rowspan="1" colspan="1">&nbsp;</td>
    <td rowspan="1" colspan="1">Maximum RAM on sparc64 appears to be limited to 16Gb.</td>
  </tr>
</table>


  </div>
          <br class="clearboth" />
        </div>
        
++++

