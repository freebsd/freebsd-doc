<!--
     The FreeBSD Polish Documentation Project

     $FreeBSD$
     Original revision: 1.260
-->

<chapter id="ports">
  <chapterinfo>
    <authorgroup>
      <author>
        <firstname>Cezary</firstname>
        <surname>Morga</surname>
        <contrib>T³umaczy³ </contrib>
      </author>
    </authorgroup>
  </chapterinfo>

  <title>Instalacja programów: pakiety i porty</title>

  <sect1 id="ports-synopsis">
    <title>Streszczenie</title>

    <indexterm><primary>porty</primary></indexterm>
    <indexterm><primary>pakiety</primary></indexterm>
    <para>System FreeBSD rozprowadzany jest wraz z bogat± kolekcj±
      narzêdzi systemowych. Tym nie mniej, stanowi to absolutne minimum.
      Szybko pojawia siê bowiem potrzeba zainstalowania dodatkowego
      oprogramowania, by móc rozpocz±æ prawdziw± pracê z systemem.
      FreeBSD dostarcza dwóch dope³niaj±cych siê metod instalacji
      oprogramowania: kolekcjê portów FreeBSD (kompilacja programów
      ze ¼róde³) i system pakietów (instalacja z gotowych binariów).
      Ka¿da z tych metod mo¿e zostaæ wykorzystana do instalacji najnowszych
      wersji ulubionego oprogramowania z lokalnych no¶ników b±d¼
      bezpo¶rednio z sieci.</para>

    <para>Przeczytawszy ten rozdzia³ dowiemy siê:</para>

    <itemizedlist>
      <listitem>
        <para>Jak instalowaæ oprogramowanie innych producentów
          dostarczane w postaci binarnej.</para>
      </listitem>
      <listitem>
        <para>Jak kompilowaæ oprogramowanie innych producentów
          z wykorzystaniem kolekcji portów.</para>
      </listitem>
      <listitem>
        <para>Jak usun±æ poprzednio zainstalowane pakiety b±d¼
          porty.</para>
      </listitem>
      <listitem>
        <para>Jak zmieniæ domy¶lne warto¶ci wykorzystywane
          przy kompilacji portów.</para>
      </listitem>
      <listitem>
	<para>Jak odnale¼æ w³a¶ciwe oprogramowanie.</para>
      </listitem>
      <listitem>
        <para>Jak zaktualizowaæ wykorzystywane aplikacje.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="ports-overview">
    <title>Omówienie instalacji oprogramowania</title>

    <para>Osoby, które ju¿ wcze¶niej pracowa³y z systemami &unix;
      wiedz±, ¿e typowy proces instalacji oprogramowania sprowadza
      siê mniej wiêcej do nastêpuj±cych punktów:</para>

    <procedure>
      <step>
        <para>Pobranie programu, który mo¿e byæ rozprowadzany
          w postaci kodu ¼ród³owego b±d¼ binarnej.</para>
      </step>

      <step>
        <para>Rozpakowania programu z formatu w jakim jest
          rozprowadzany (najczê¶ciej jest to plik tar skompresowany
          za pomoc± &man.compress.1;, &man.gzip.1; lub
          &man.bzip2.1;).</para>
      </step>

      <step>
        <para>Odnalezienie dokumentacji (najczê¶ciej plik
          <filename>INSTALL</filename> lub <filename>README</filename>
          b±d¼ pliki w podkatalogu <filename>doc/</filename>)
          i zapoznanie siê z instrukcjami instalacji programu.</para>
      </step>

      <step>
        <para>Kompilacja programu, je¶li rozprowadzany jest w postaci
          ¼ród³owej. Mo¿e to wymagaæ równie¿ wykonania dodatkowych
          czynno¶ci, jak np. edycji pliku <filename>Makefile</filename>
          b±d¼ uruchomienia skryptu <command>configure</command>.</para>
      </step>

      <step>
        <para>Weryfikacja i instalacja aplikacji.</para>
      </step>
    </procedure>

    <para>Wszystko to przy za³o¿eniu, ¿e w miêdzy czasie nie pojawi³y
      siê ¿adne trudno¶ci. Instalacja oprogramowania, które nie by³o
      przygotowywane z my¶l± o FreeBSD mo¿e wymagaæ nawet modyfikacji
      kodu ¼ród³owego nim zacznie poprawnie funkcjonowaæ.</para>

    <para>Oczywi¶cie, we FreeBSD mo¿na instalowaæ oprogramowanie
      <quote>tradycyjnym</quote> sposobem. Jednak¿e system ten
      posiada dwa rozwi±zania, które potrafi± zaoszczêdziæ mnóstwo
      czasu i trudu: pakiety i porty. W chwili pisania tego tekstu,
      dostêpnych za pomoc± tych systemów jest przesz³o &os.numports;
      aplikacji.</para>

    <para>Dla ka¿dego programu dostêpny jest do pobrania pojedynczy
      pakiet, który zawiera skompilowane kopie plików aplikacji,
      zarówno plików uruchomieniowych jak i konfiguracyjnych czy
      dokumentacji. Pobranym plikiem mo¿na manipulowaæ za pomoc±
      poleceñ &man.pkg.add.1;, &man.pkg.delete.1;, &man.pkg.info.1;,
      itp. Nowe programy mo¿na instalowaæ za pomoc± zaledwie
      jednego polecenia.</para>

    <para>Port natomiast, jest zbiorem plików maj±cych za zadanie
      zautomatyzowaæ proces kompilacji danego programu z kodu
      ¼ród³owego.</para>

    <para>O ile typowa kompilacja programu sk³ada siê z wielu czynno¶ci
      wykonywanych przez u¿ytkownika, o tyle pliki sk³adaj±ce siê na
      port zawieraj± dostateczn± ilo¶æ informacji aby pozwoliæ
      systemowi zrobiæ to za nas. Wystarczy wprowadziæ kilka prostych
      poleceñ a system automatycznie pobierze kod ¼ród³owy programu,
      rozpakuje, na³o¿y ³atki, skompiluje i zainstaluje za nas.</para>

    <para>Ponadto system portów mo¿e równie¿ pos³u¿yæ do przygotowania
      pakietów, którymi nastêpnie mo¿na manipulowaæ za pomoc±
      <command>pkg_add</command> i innymi poleceniami
      zarz±dzaj±cych pakietami.</para>

    <para>Obydwa systemy potrafi± analizowaæ <emphasis>zale¿no¶ci</emphasis>
      wystêpuj±ce pomiêdzy aplikacjami. Za³ó¿my, ¿e chcemy zainstalowaæ
      program, który zale¿y od pewnej biblioteki. Zarówno program jak
      i biblioteka dostêpne s± w systemach portów i pakietów FreeBSD.
      Niezale¿nie od tego czy wykorzystamy polecenie <command>pkg_add</command>
      czy porty, by zainstalowaæ program, to obydwa systemy spostrzeg±,
      ¿e biblioteka nie zosta³a zainstalowana i automatycznie zainstaluj±
      najpierw bibliotekê.</para>

    <para>Mo¿na by siê zastanawiaæ dlaczego FreeBSD wykorzystuje obydwa
      systemy, skoro ich dzia³anie jest tak bardzo podobne. Tak pakiety
      jak i porty posiadaj± pewne zalety. Który system wykorzystamy zale¿y
      od naszych w³asnych upodobañ.</para>

    <itemizedlist>
      <title>Zalety pakietów</title>
      
      <listitem>
        <para>Skompresowany plik pakietu zajmuje z regu³y mniej miejsca
          ni¿ skompresowany plik zawieraj±cy kod ¼ród³owy.</para>
      </listitem>

      <listitem>
        <para>Instalacja pakietów nie wymaga dodatkowej kompilacji.
          W przypadku du¿ych aplikacji, jak np. <application>Mozilla</application>,
          <application>KDE</application> czy <application>GNOME</application>
          mo¿e to byæ istotne. Szczególnie gdy pracuje siê na do¶æ wolnej
          maszynie.</para>
      </listitem>

      <listitem>
        <para>Stosowanie pakietów nie wymaga ¿adnej wiedzy o procesie
          kompilowania oprogramowania w systemie FreeBSD.</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <title>Zalety portów</title>
      
      <listitem>
        <para>Pakiety s± z regu³y kompilowane z do¶æ typowymi opcjami,
          poniewa¿ powinny byæ przydatne do wykorzystania na maksymalnej
          liczbie komputerów. Instaluj±c programy z portów mamy mo¿liwo¶æ
          <quote>podkrêcenia</quote> opcji kompilacji, by (przyk³adowo)
          skompilowaæ program zoptymalizowany dla procesorów Pentium IV
          lub Athlon.</para>
      </listitem>

      <listitem>
        <para>Niektóre aplikacje posiadaj± pewne opcje kompilacji
          zwi±zane z zadaniami, które maja realizowaæ. Przyk³adowo
          <application>Apache</application> mo¿e zostaæ skompilowany
          z wieloma ró¿norodnymi opcjami. Kompiluj±c go z portów nie
          musimy zgadzaæ siê na domy¶lne opcje mog±c samemu dokonaæ
          wyboru.</para>

        <para>W niektórych przypadkach dostêpnych jest kilka pakietów
          tej samej aplikacji skompilowanych z ró¿nymi parametrami.
          Na przyk³ad program <application>Ghostscript</application>
          dostêpny jest jako pakiet <filename>ghostscript</filename>
          oraz <filename>ghostscript-nox11</filename>, zale¿nie od
          tego czy mamy zainstalowany serwer X11. O ile tego typu
          rozwi±zania s± teoretycznie mo¿liwe do zrealizowania w
          systemie pakietów, o tyle staje siê to praktycznie niemo¿liwe
          gdy aplikacja posiada wiêcej ni¿ kilka ró¿nych opcji
          kompilacji.</para>
      </listitem>

      <listitem>
        <para>Warunki licencji niektórych aplikacji zabraniaj±
          rozprowadzania w postaci binarnej. Musz± byæ zatem rozprowadzane
          jako kod ¼ród³owy.</para>
      </listitem>

      <listitem>
        <para>Niektórzy nie ufaj± pakietom binarnym. W przypadku
          kodu ¼ród³owego mo¿na (przynajmniej w teorii) przejrzeæ
          go i samemu poszukaæ potencjalnych luk.</para>
      </listitem>

      <listitem>
        <para>Je¶li posiadamy w³asne ³aty bêdziemy potrzebowali
          kodu ¼ród³owego aby je nanie¶æ do programu.</para>
      </listitem>

      <listitem>
        <para>Jeszcze inni po prostu lubi± mieæ pod rêk± kod ¼ród³owy,
          by móc go poczytaæ gdy siê nudz±, zmodyfikowaæ czy zapo¿yczyæ
          pewne rozwi±zania (o ile pozwala na to licencja), itd.</para>
      </listitem>
    </itemizedlist>

    <para>Najlepszym sposobem ¶ledzenia zmian dokonywanych w systemie
      portów jest zapisanie siê na &a.pl.ports.b; oraz
      &a.pl.ports-bugs.b;.</para>

    <warning>
      <para> Przed instalacj± jakiejkolwiek aplikacji nale¿y sprawdziæ
        na stronie <ulink url="http://vuxml.freebsd.org/"></ulink>
        czy w danym programie istniej± luki zwi±zane bezpieczeñstwem.</para>

      <para>Alternatywnie mo¿emy zainstalowaæ <filename
	role="package">security/portaudit</filename>, który automatycznie
        sprawdza wszystkie instalowane programy pod wzglêdem znanych
        luk bezpieczeñstwa; weryfikowane s± równie¿ porty przed kompilacj±.
        W miêdzy czasie mo¿na wykorzystaæ polecenie <command>portaudit
	-F -a</command>, by sprawdziæ zainstalowane ju¿ pakiety.</para>
    </warning>

    <para>Pozosta³a czê¶æ niniejszego rozdzia³u ma za zadanie wyja¶niæ
      jak z wykorzystaniem systemu pakietów i portów instalowaæ w systemie
      FreeBSD oprogramowanie innych producentów.</para>
  </sect1>

  <sect1 id="ports-finding-applications">
    <title>Odnalezienie programu dla siebie</title>

    <para>Nim przyst±pimy do instalacji programów musimy wiedzieæ
      co chcemy zainstalowaæ i jak siê nazywa.</para>

    <para>Lista dostêpnych we FreeBSD programów ro¶nie ca³y czas.
      Na szczê¶cie jest wiele sposobów na odnalezienie tego czego
      szukamy:</para>

    <itemizedlist>
      <listitem>
        <para>Na stronie internetowej FreeBSD pod adresem <ulink
	  url="&url.base;/ports/index.html">http://www.FreeBSD.org/ports/</ulink>
          znajduje jest aktualna lista dostêpnych programów. Listê mo¿na
          dowolnie przeszukiwaæ wed³ug kilku kryteriów, np. nazwy (je¶li
          j± znamy). Mo¿liwe jest równie¿ przejrzenie spisu wszystkich
          aplikacji znajduj±cych siê w danej kategorii.</para>
      </listitem>

      <indexterm><primary>FreshPorts</primary></indexterm>

      <listitem>
        <para>Dziêki stronie FreshPorts (<ulink
	  url="http://www.FreshPorts.org/"></ulink>) prowadzonej
          przez Dana Langille'a mo¿liwe jest bie¿±ce ¶ledzenie zmian
          aplikacji w drzewie portów. Witryna umo¿liwia otrzymywanie
          informacji drog± emailow± o zmianach w wybranych
          portach.</para>
      </listitem>

      <indexterm><primary>FreshMeat</primary></indexterm>

      <listitem>
        <para>Je¶li nie znamy nazwy programu, który chcemy zainstalowaæ,
          warto poszukaæ go na stronach pokroju FreshMeat (<ulink
	  url="http://www.freshmeat.net/"></ulink>) a nastêpnie
          sprawdziæ na stronie FreeBSD czy zosta³ przygotowany
          odpowiedni port.</para>
      </listitem>

      <listitem>
        <para>Je¶li znamy dok³adn± nazwê portu a chcemy sprawdziæ
          z jakiej pochodzi kategorii, mo¿na skorzystaæ z polecenia
          &man.whereis.1;. Wystarczy wpisaæ <command>whereis
          <replaceable>plik</replaceable></command>, gdzie
          <replaceable>plik</replaceable> jest nazw± programu, którego
          poszukujemy. Otrzymany wynik bêdzie postaci:</para>

      <screen>&prompt.root; <userinput>whereis lsof</userinput>
lsof: /usr/ports/sysutils/lsof</screen>

      <para>Przyk³ad ten informuje nas, ¿e program <command>lsof</command>
        (narzêdzie systemowe) znajduje siê w katalogu
	<filename>/usr/ports/sysutils/lsof</filename>.</para></listitem>

      <listitem>
        <para>Jeszcze innym sposobem na odnalezienie danego portu jest
          wykorzystanie mechanizmu przeszukiwania kolekcji portów.
          By skorzystaæ z tej funkcji nale¿y przej¶æ do katalogu
          <filename>/usr/ports</filename>. Nastêpnie wpisaæ
          <command>make search
            name=<replaceable>nazwa-programu</replaceable></command>,
          gdzie <replaceable>program-name</replaceable> jest nazw±
          poszukiwanej aplikacji. Przyk³adowo, szukaj±c
          <command>lsof</command>:</para>

      <screen>&prompt.root; <userinput>cd /usr/ports</userinput>
&prompt.root; <userinput>make search name=lsof</userinput>
Port:   lsof-4.56.4
Path:   /usr/ports/sysutils/lsof
Info:   Lists information about open files (similar to fstat(1))
Maint:  obrien@FreeBSD.org
Index:  sysutils
B-deps: 
R-deps: </screen>

      <para>Czê¶æ wyniku, która nas interesuje to wiersz zaczynaj±cy
        siê od <quote>Path:</quote>, a okre¶laj±cy lokalizacjê portu.
        Pozosta³e z uzyskanych w ten sposób informacji nie zostan±
        tutaj opisane, gdy¿ nie s± potrzebne do instalacji
        programu.</para>

      <para>Szersze przeszukanie kolekcji portów mo¿liwe jest
        wykorzystuj±c <command>make
        search key=<replaceable>zwrot</replaceable></command>,
        gdzie <replaceable>zwrot</replaceable> jest dowolnym wyrazem.
        Opcja ta przeszukuje nazwy portów, komentarze, opisy i listy
        zale¿no¶ci. Mo¿e byæ wykorzystana do odnalezienia portów
        zwi±zanych z danym zagadnieniem gdy nie znamy nazwy
        poszukiwanego programu.</para>

      <para>W obydwu przypadkach nie s± rozró¿niane ma³e i du¿e
        litery w poszukiwanym ci±gu. Szukaj±c zatem <quote>LSOF</quote>
        oraz <quote>lsof</quote> otrzymamy takie same wyniki.</para>
      </listitem>

    </itemizedlist>
  </sect1>

  <sect1 id="packages-using">
    <sect1info>    
      <authorgroup>
        <author>
          <firstname>Chern</firstname>
	  <surname>Lee</surname>
	  <contrib>Napisa³ </contrib>
        </author>
      </authorgroup>
    <!-- 30 Mar 2001 -->
      <authorgroup>
        <author>
          <firstname>Aleksander</firstname>
          <surname>Fafu³a</surname>
          <contrib>T³umaczy³ </contrib>
        </author>
      </authorgroup>
      <authorgroup>
        <author>
          <firstname>Cezary</firstname>
          <surname>Morga</surname>
          <contrib>Przek³ad uzupe³ni³ </contrib>
        </author>
      </authorgroup>
    </sect1info>

    <title>Korzystanie z systemu pakietów</title>

    <sect2>
      <title>Instalacja pakietów</title>
      <indexterm>
        <primary>pakiety</primary>
        <secondary>instalacja</secondary>
      </indexterm>
    
      <indexterm>
        <primary><command>pkg_add</command></primary>
      </indexterm>
      <para>Programu &man.pkg.add.1; mo¿na u¿yæ do instalacji
        programów zarówno z dysku lokalnego, jak i z sieci.</para>

      <example>
        <title>Rêczne pobranie pakietu i instalacja lokalna</title>

        <screen>&prompt.root; <userinput>ftp -a <replaceable>ftp2.FreeBSD.org</replaceable></userinput>
Connected to ftp2.FreeBSD.org.
220 ftp2.FreeBSD.org FTP server (Version 6.00LS) ready.
331 Guest login ok, send your email address as password.
230-
230-     This machine is in Vienna, VA, USA, hosted by Verio.
230-         Questions? E-mail freebsd@vienna.verio.net.
230-
230-
230 Guest login ok, access restrictions apply.
Remote system type is UNIX.
Using binary mode to transfer files.
<prompt>ftp></prompt> <userinput>cd /pub/FreeBSD/ports/packages/sysutils/</userinput>
250 CWD command successful.
<prompt>ftp></prompt> <userinput>get lsof-4.56.4.tgz</userinput>
local: lsof-4.56.4.tgz remote: lsof-4.56.4.tgz
200 PORT command successful.
150 Opening BINARY mode data connection for 'lsof-4.56.4.tgz' (92375 bytes).
100% |**************************************************| 92375       00:00 ETA
226 Transfer complete.
92375 bytes received in 5.60 seconds (16.11 KB/s)
<prompt>ftp></prompt> <userinput>exit</userinput>
&prompt.root; <userinput>pkg_add <replaceable>lsof-4.56.4.tgz</replaceable></userinput></screen>
      </example>

      <para>Je¶li nie posiadamy lokalnego ¼ród³a programów (np na
        p³ytach CD FreeBSD), bêdzie Ci prawdopodobnie ³atwiej u¿yæ komendy
        &man.pkg.add.1; z opcj± <option>-r</option>. Spowoduje to,
        ¿e program samodzielnie okre¶li odpowiedni± wersjê oprogramowania
        dla naszej wersji systemu. Nastêpnie pobierze odpowiedni plik
        z sieci oraz go zainstaluje.</para>

      <indexterm>
        <primary><command>pkg_add</command></primary></indexterm>
      <screen>&prompt.root; <userinput>pkg_add -r <replaceable>lsof</replaceable></userinput></screen>

      <para>W powy¿szym przyk³adzie program pobierze w³a¶ciwy pakiet
        i zainstaluje go bez jakiejkolwiek dalszej ingerencji u¿ytkownika.
        Je¶li chcemy wskazaæ programowi alternatywny serwer lustrzany,
        nale¿y odpowiednio zdefiniowaæ zmienn± ¶rodowiskow±
        <envar>PACKAGESITE</envar>. Program  &man.pkg.add.1; do pobierania
        plików z serwerów wykorzystuje &man.fetch.3;, który z kolei
        wykorzystuje ró¿norodne zmienne ¶rodowiskowe, m.in.
        <envar>FTP_PASSIVE_MODE</envar>, <envar>FTP_PROXY</envar> oraz
	<envar>FTP_PASSWORD</envar>. Mo¿e siê okazaæ, ¿e bêdziemy musieli
        zdefiniowaæ niektóre z nich je¶li nasz komputer znajduje siê za
        zapor± ogniow±, b±d¼ musi korzystaæ z serwera po¶rednicz±cego
        FTP/HTTP proxy. Wiêcej informacji znale¼æ mo¿na w podrêczniku
        systemowym programu &man.fetch.3;. Warto zauwa¿yæ, i¿ w
        powy¿szym przyk³adzie jako nazwê pakietu podano jedynie
        <literal>lsof</literal> zamiast <literal>lsof-4.56.4</literal>.
        Przy zdalnym pobieraniu pakietów nie nale¿y podawaæ numeru wersji
        pakietu. Program &man.pkg.add.1; automatycznie pobierze najnowsz±
        wersjê aplikacji.</para>

      <note>
        <para>Program &man.pkg.add.1; pobierze najnowsz± wersjê aplikacji
          jedynie, gdy wykorzystujemy &os.current; albo &os.stable;. W przypadku
          -RELEASE pobrana zostanie wersja pakietu zbudowana dla danego wydania.
          Ograniczenie to mo¿na obej¶æ modyfikuj±c zmienn± ¶rodowiskow±
          <envar>PACKAGESITE</envar>. Na przyk³ad, je¶li korzystamy z
          &os;&nbsp;5.4-RELEASE domy¶lnie &man.pkg.add.1; bêdzie pobiera³
          pakiety z
          <literal>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-5.4-release/Latest/</literal>.
          By zmusiæ go do pobierania pakietów zbudowanych dla
          &os;&nbsp;5-STABLE nale¿y zmodyfikowaæ zmienn± <envar>PACKAGESITE</envar>
          by wskazywa³a na
          <literal>ftp://ftp.freebsd.org/pub/FreeBSD/ports/i386/packages-5-stable/Latest/</literal>.</para>
      </note>

      <para>Pakiety rozpowszechniane s± w formacie <filename>.tgz</filename>
        oraz <filename>.tbz</filename>. Mo¿emy je pobraæ z
        <ulink url="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/"></ulink>,
        w Polsce z <ulink
          url="ftp://ftp.pl.FreeBSD.org/pub/FreeBSD/ports/packages/"></ulink>,
        b±d¼ odnale¼æ na p³ytach CDROM FreeBSD. Ka¿da p³yta z cztero p³ytowej
        dystrybucji (tak¿e PowerPak'a itp) zawiera pakiety w katalogu
        <filename>/packages</filename>. Struktura katalogu podobna jest
        do drzewa portów <filename>/usr/ports</filename>. Ka¿da kategoria ma
        swój w³asny katalog, ponadto ka¿dy pakiet mo¿e zostaæ odnaleziony
        w katalogu <filename>All</filename> (Wszystkie).</para>

      <para>Struktura katalogów pakietów jest identyczna wzglêdem
        struktury katalogów portów. Porty i pakiety kooperuj± za sob±,
        tworz±c wspólnie ca³y system pakietów/portów.</para>

    </sect2>

    <sect2>
      <title>Zarz±dzanie pakietami</title>

      <indexterm>
        <primary>pakiety</primary>
        <secondary>zarz±dzanie</secondary>
      </indexterm>
      <para>Narzêdziem s³u¿±cym do przedstawienia informacji
        o zainstalowanych pakietach oraz wy¶wietlaj±cym ich krótki
        opis jest &man.pkg.info.1;.</para>

      <indexterm>
        <primary><command>pkg_info</command></primary>
      </indexterm>
      <screen>&prompt.root; <userinput>pkg_info</userinput>
cvsup-16.1          A general network file distribution system optimized for CV
docbook-1.2         Meta-port for the different versions of the DocBook DTD
...</screen>
      <para>Program &man.pkg.version.1; jest natomiast narzêdziem,
        które podsumowuje wersje wszystkich zainstalowanych pakietów.
        Porównuje je nastêpnie z tymi które znajduj± siê w drzewie portów.</para>
      <indexterm>
        <primary><command>pkg_version</command></primary>
      </indexterm>
        <screen>&prompt.root; <userinput>pkg_version</userinput>
cvsup                       =
docbook                     =
...</screen>

      <para>Symbol w drugiej kolumnie okre¶la wiek zainstalowanej wersji
        oprogramowania wzglêdem wersji odnalezionej w portach.</para>

      <informaltable frame="none" pgwide="1">
        <tgroup cols="2">
	  <thead>
            <row>
              <entry>Symbol</entry>
              <entry>Znaczenie</entry>
            </row>
          </thead>

 	  <tbody>
  	    <row>
	    <entry>=</entry> <entry>Wersja odnaleziona w portach jest
              identyczna./entry>
  	    </row>
 
        <row><entry>&lt;</entry>
	<entry>Wersja jest starsza, ni¿ ta odnaleziona w portach.</entry>
	</row>

        <row><entry>&gt;</entry><entry>Zainstalowana wersja jest nowsza,
            ni¿ znaleziona w portach. (Prawdopodobnie lokalne drzewo portów
            nie zosta³o zaktualizowane.)</entry></row>

        <row><entry>?</entry><entry>Zainstalowany pakiet nie mo¿e zostaæ
            odnaleziony w drzewie portów. (Mo¿e to mieæ miejsce np. w sytuacji
            gdy zainstalowany port zosta³ usuniêty z kolekcji portów, b±d¼
            zmieni³ nazwê.)</entry></row>

        <row><entry>*</entry><entry>Istnieje wiele wersji tego programu.</entry></row>

	</tbody>
	</tgroup>
    </informaltable>
    </sect2>

    <sect2>
      <title>Usuwanie pakietów</title>
      <indexterm>
        <primary><command>pkg_delete</command></primary>
      </indexterm>
      <indexterm>
        <primary>pakiety</primary>
        <secondary>usuwanie</secondary>
      </indexterm>
      <para>Aby usun±æ uprzednio zainstalowane oprogramowanie u¿yj &man.pkg.delete.1;.</para>

      <screen>&prompt.root; <userinput>pkg_delete <replaceable>xchat-1.7.1</replaceable></userinput></screen>
    </sect2>

    <sect2>
      <title>Dodatkowe informacje</title>
      <para>Wszystkie informacje o pakietach znajduj± siê w katalogu
        <filename>/var/db/pkg</filename>. Lista zainstalowanych plików,
        a tak¿e opis ka¿dej paczki mo¿na odnale¼æ w³a¶nie w tym katalogu.
      </para>
    </sect2>
  </sect1>
  
  <sect1 id="ports-using">
    <sect1info>
      <authorgroup>
        <author>
          <firstname>Aleksander</firstname>
          <surname>Fafu³a</surname>
          <contrib>T³umaczy³ </contrib>
        </author>
      </authorgroup>
      <authorgroup>
        <author>
          <firstname>Cezary</firstname>
          <surname>Morga</surname>
          <contrib>Przek³ad uzupe³ni³ </contrib>
        </author>
      </authorgroup>
    </sect1info>

    <title>Korzystanie z kolekcji portów</title>

    <para>Poni¿szy podrozdzia³ dostarcza podstawowych informacji
      z zakresu u¿ywania kolekcji portów, w stopniu umo¿liwiaj±cym
      instalowanie lub odinstalowywanie programów z w³asnego systemu.
      Szczegó³owy opis parametrów polecenia <command>make</command>
      i zmiennych ¶rodowiskowych dostêpny jest w podrêczniku
      systemowym &man.ports.7;.</para>

    <sect2 id="ports-tree">
      <title>Pozyskanie kolekcji portów</title>

      <para>Zanim zainstalujemy jakikolwiek port, musimy pobraæ
        kolekcjê portów, która w zasadzie jest zestawem plików
        <filename>Makefiles</filename>, ³at i opisowych. Kolekcja
        znajduje siê w katalogu <filename>/usr/ports</filename>.</para>

      <para>W trakcie instalacji FreeBSD, <application>sysinstall</application>
        zapyta³ czy chcemy zainstalowaæ kolekcjê portów. Je¶li wybrali¶my
        nie, poni¿sze instrukcje pomog± nam w³asnorêcznie zainstalowaæ
        kolekcjê portów:</para>

      <procedure>
        <title>Metoda CVSup</title>

        <para>Jest to prosta i szybka metoda pobrania kolekcji portów
          wykorzystuj±ca system <application>CVSup</application>.
          Wiêcej informacji o <application>CVSup</application> dostêpnych
          jest w podrozdziale <link linkend="cvsup">Korzystanie z
          CVSup</link>.</para>

	<para>Bardzo wa¿nym jest, aby upewniæ siê, ¿e katalog
          <filename role="directory">/usr/ports</filename> jest pusty
          nim po raz pierwszy uruchomimy <application>CVSup</application>!
          Je¶li posiadamy ju¿ kolekcjê portów pozyskan± z innego ¼ród³a
          <application>CVSup</application> nie usunie nieu¿ywanych
          plików ³at.</para>

	<step>
          <para>Zainstaluj pakiet <filename
	    role="package">net/cvsup-without-gui</filename>:</para>

	  <screen>&prompt.root; <userinput>pkg_add -r cvsup-without-gui</userinput></screen>

          <para>Wiêcej informacji w podrozdziale <link
	      linkend="cvsup-install">Instalacja CVSup</link> (<xref
	      linkend="cvsup-install">).</para>
	</step>

	<step>
          <para>Uruchom <command>cvsup</command>:</para>

	  <screen>&prompt.root; <userinput>cvsup -L 2 -h <replaceable>cvsup.FreeBSD.org</replaceable> /usr/share/examples/cvsup/ports-supfile</userinput></screen>

	  <para>Warto zast±piæ <replaceable>cvsup.FreeBSD.org</replaceable>
		  adresem serwera CVSup zlokalizowanego bli¿ej nas. Kompletna lista
		  serwerów lustrzanych dostêpna jest w podrozdziale
		  <link linkend="cvsup-mirrors">Serwery lustrzane CVSup</link>
		  (<xref linkend="cvsup-mirrors">).</para>

	  <note>
		  <para>Mo¿na wykorzystaæ w³asny plik  <filename>ports-supfile</filename>,
			  by np. unikn±æ konieczno¶ci podawania adresu serwera
			  <application>CVSup</application> z linii poleceñ.</para>

	    <procedure>
	      <step>
                <para>W takim wypadku, jako u¿ytkownik <username>root</username>,
                  skopiuj plik
                  <filename>/usr/share/examples/cvsup/ports-supfile</filename>
                  do innego katalogu, np. <filename>/root</filename> b±d¼ w³asnego
                  katalogu domowego.</para>
	      </step>

	      <step>
                <para>Zmodyfikuj plik <filename>ports-supfile</filename>.</para>
	      </step>

	      <step>
                <para>Zmieñ wpis
                  <replaceable>CHANGE_THIS.FreeBSD.org</replaceable>na adres
                  wybranego serwera lustrzanego <application>CVSup</application>.
                  Kompletna lista serwerów lustrzanych dostêpna jest w podrozdziale
                  <link linkend="cvsup-mirrors">Serwery lustrzane
                    CVSup</link> (<xref linkend="cvsup-mirrors">).</para>
	      </step>

	      <step>
                <para>Teraz uruchom <command>cvsup</command> u¿ywaj±c
                  polecenia::</para>

		<screen>&prompt.root; <userinput>cvsup -L 2 <replaceable>/root/ports-supfile</replaceable></userinput></screen>
	      </step>
	    </procedure>
	  </note>
	</step>

	<step>
          <para>Pó¼niejsze wpisanie polecenia &man.cvsup.1; spowoduje
            sprawdzenie zmian dokonanych w kolekcji portów i aktualizacjê
            lokalnej wersji. Nie spowoduje to natomiast automatycznie ponownego
            skompilowania wykorzystywanych przez nas portów.</para>
	</step>
      </procedure>

      <procedure>
        <title>Metoda Portsnap</title>

        <para><application>Portsnap</application> jest alternatywnym
          systemem dystrybucji kolekcji portów. Po raz pierwszy zosta³
            do³±czony do FreeBSD&nbsp;6.0. W starszych wersjach mo¿e zostaæ
            zainstalowany z pakietu <filename
	  role="package">sysutils/portsnap</filename>:</para>

	<screen>&prompt.root; <userinput>pkg_add -r portsnap</userinput></screen>

        <para>Szczegó³owe informacje o mo¿liwo¶ciach programu dostêpne
          s± w podrozdziale <link linkend="portsnap">Korzystanie z
            Portsnap</link>.</para>

	<step>
          <para>Ten punkt mo¿emy pomin±æ je¶li posiadamy &os;&nbsp;6.1-RELEASE
            b±d¼ najnowsz± wersjê programu <application>Portsnap</application>.
            Przy pierwszym uruchomieniu programu &man.portsnap.8;  zostanie
            automatycznie utworzony katalog <filename
	    role="directory">/usr/ports</filename>. W starszych wersjach programu
            wymagane jest w³asnorêczne utworzenie katalogu:</para>

	  <screen>&prompt.root; <userinput>mkdir /usr/ports</userinput></screen>
	</step>

	<step>
          <para>Pobierz skompresowan± migawkê kolekcji portów do katalogu
            <filename role="directory">/var/db/portsnap</filename>. Mo¿na nastêpnie
            zakoñczyæ po³±czenie z Internetem, je¶li jest taka potrzeba.</para>

	  <screen>&prompt.root; <userinput>portsnap fetch</userinput></screen>
	</step>

	<step>
          <para>Je¶li uruchamiany <application>Portsnap</application> po raz
            pierwszy nale¿y rozpakowaæ migawkê do katalogu
            <filename role="directory">/usr/ports</filename>:
	  </para>

	  <screen>&prompt.root; <userinput>portsnap extract</userinput></screen>

          <para>Je¶li posiadamy ju¿ kolekcjê portów w <filename
	    role="directory">/usr/ports</filename> i jedynie j± aktualizujemy,
            wpisujemy polecenie:</para>

	  <screen>&prompt.root; <userinput>portsnap update</userinput></screen>
	</step>

      </procedure>

      <procedure>
        <title>Metoda sysinstall</title>

        <para>Metoda ta instaluje kolekcjê portów z lokalnego no¶nika pos³uguj±c
          siê programem <application>sysinstall</application>. Zainstalowana
          zostanie kopia kolekcji z dnia, w którym przygotowana zosta³a dana wersja
          FreeBSD. Je¶li dysponujemy po³±czeniem z Internetem powinni¶my zawsze
          stosowaæ jedn± z metod opisanych powy¿ej.</para>

	<step>
          <para>Uruchom  <command>sysinstall</command> jako u¿ytkownik
            <username>root</username> (<command>/stand/sysinstall</command>
            w wersjach &os; starszych ni¿ 5.2):</para>

	  <screen>&prompt.root; <userinput>sysinstall</userinput></screen>
	</step>

	<step>
          <para>Przejd¼ w dó³, wybierz <guimenuitem>Configure</guimenuitem>,
            i naci¶nij <keycap>Enter</keycap>.</para>
	</step>

	<step>
          <para>Przejd¼ w dó³, wybierz
            <guimenuitem>Distributions</guimenuitem> i naci¶nij
	    <keycap>Enter</keycap>.</para>
	</step>

	<step>
          <para>Przejd¼ w dó³ do opcji <guimenuitem>ports</guimenuitem> i naci¶nij
	    <keycap>Spacjê</keycap>.</para>
	</step>

	<step>
          <para>Przejd¼ do góry do opcji <guimenuitem>Exit</guimenuitem> i naci¶nij
	    <keycap>Enter</keycap>.</para>
	</step>

	<step>
          <para>Ustaw wybrany przez siebie typ medium instalacji, jak np. p³ytê CDROM,
            serwer FTP, itd.</para>
	</step>

	<step>
          <para>Przejd¼ do góry do opcji <guimenuitem>Exit</guimenuitem> i naci¶nij
	    <keycap>Enter</keycap>.</para>
	</step>

	<step>
          <para>Naci¶ni <keycap>X</keycap> by wyj¶æ z programu
	    <application>sysinstall</application>.</para>
	</step>
      </procedure>
    </sect2>

    <sect2 id="ports-skeleton">
      <title>Instalacja Portów</title>

      <indexterm>
        <primary>porty</primary>
        <secondary>instalacja</secondary>
      </indexterm>
      <para>Pierwsza rzecz o jakiej nale¿y wspomnieæ omawiaj±c
        kolekcjê portów, jest <quote>szkielet</quote>. Mówi±c w
        skrócie, szkielet portu jest minimalnym zestawem plików,
        które informuj± FreeBSD, jak poprawnie skompilowaæ i
        zainstalowaæ program. Ka¿dy szkielet portu zawiera:</para>

      <itemizedlist>
	<listitem>
          <para>Plik <filename>Makefile</filename>.  Plik ten zawiera
            ró¿ne dane okre¶laj±ce jak skompilowaæ aplikacjê oraz gdzie
            j± zainstalowaæ w systemie.</para>
	</listitem>

	<listitem>
          <para>Plik <filename>distinfo</filename> Plik ten zawiera informacje
            dotycz±ce plików, które musz± zostaæ pobrane, by skompilowaæ
            port. Ponadto zawiera sumy kontrolne, na podstawie których
            &man.md5.1; potrafi sprawdziæ, czy pliki nie uleg³y uszkodzeniu
            w trakcie pobierania z sieci.</para>
	</listitem>
	
	<listitem>
          <para>Katalog <filename>files</filename>, który zawiera ³aty
            pozwalaj±ce skompilowaæ i zainstalowaæ program w naszym
            systemie FreeBSD. £aty s± ma³ymi plikami, w których okre¶lone
            s± zmiany dotycz±ce konkretnych plików. S± to pliki tekstowe i po
            prostu mówi± <quote>Usuñ liniê 10</quote> lub <quote>Zmieñ liniê
              26 na to: ...</quote>. £atki s± tak¿e znane jako <quote>diffs</quote>
            (ang. skrót od ró¿nice) poniewa¿ s± generowane przez program
            &man.diff.1;.</para>

          <para>Ten katalog mo¿e zawieraæ tak¿e inne pliki u¿ywane do
            kompilacji portu.</para>
	</listitem>

	<listitem>
          <para>Plik opisu <filename>pkg-descr</filename>. Jest to bardziej
            szczegó³owy, nierzadko wieloliniowy opis programu.</para>
	</listitem>
	
	<listitem>
          <para>Plik listy <filename>pkg-plist</filename>.  Jest to lista wszystkich
            plików, które zostan± zainstalowane przez port. Jest to tak¿e lista plików,
            które nale¿y usun±æ w przypadku odinstalowywania.</para>
	</listitem>
      </itemizedlist>

      <para>Niekiedy porty zawieraj± równie¿ inne pliki, jak na przyk³ad
        <filename>pkg-message</filename> (message-wiadomo¶æ).
        System portów u¿ywa tych plików w specjalnych sytuacjach. Je¶li potrzebujesz
        wiêcej informacji na temat tych plików i portów w ogóle, zajrzyj do podrêcznika
        <ulink url="&url.books.porters-handbook;/index.html">FreeBSD
          Porter's Handbook</ulink>.</para>

      <para>Jak ju¿ raz powiedziano, porty zawieraj± instrukcje odno¶nie
        kompilacji programów z kodu ¼ród³owego. Jednak¿e nie zawieraj±
        one samego kodu. Kod pobraæ mo¿na z p³yty CD b±d¼ z Internetu.
        Rozprowadzany mo¿e byæ w dowolnej postaci jak± wybierze sobie
        jego producent, przy czym najczê¶ciej jest to spakowany plik tar
        skompresowany dodatkowo gzipem. Kod ¼ród³owy programu nazywany
        jest <quote>distfile</quote>. Poni¿ej przedstawione zosta³y dwie
        metody instalacji portów we &os;.</para>

      <note>
        <para> By móc zainstalowaæ port musimy byæ zalogowania jako
          u¿ytkownik <username>root</username>.</para>
      </note>

      <warning>
        <para> Przed instalacj± jakiegokolwiek portu nale¿y upewniæ siê,
          ¿e dysponujemy aktualn± kolekcj± portów oraz sprawdziæ potencjalne
          luki bezpieczeñstwa zwi±zane z danym portem na stronie <ulink
	  url="http://vuxml.freebsd.org/"></ulink>.</para>

        <para>Istnieje mo¿liwo¶æ zautomatyzowania procesu weryfikacji
          potencjalnych luk bezpieczeñstwa przed instalacj± portu. Do tego
          celu mo¿na wykorzystaæ program <application>portaudit</application>,
          dostêpny równie¿ w kolekcji portów (<filename
	  role="package">security/portaudit</filename>). Wydanie polecenia
          <command>portaudit -F</command> przed instalacj± nowego portu
          spowoduje pobranie aktualnej bazy luk bezpieczeñstwa. Mo¿liwe jest
          równie¿ wykonywanie regularnych aktualizacji bazy i rewizji
          zainstalowanego oprogramowania w trakcie codziennego przegl±du
          bezpieczeñstwa systemu. Wiêcej informacji dostêpnych jest na stronach
          podrêcznika systemowego &man.portaudit.1; i &man.periodic.8;.</para>
      </warning>

      <para>Sposób funkcjonowania kolekcji portów wi±¿e siê z za³o¿eniem,
        ¿e posiadamy po³±czenie z Internetem. Je¶li nie, bêdziemy musieli
        rêcznie pobieraæ kod ¼ród³owy <quote>distfile</quote> i umieszczaæ
        w katalogu <filename>/usr/ports/distfiles</filename> dla ka¿dego
        instalowanego portu.</para>

	<para>By rozpocz±æ instalacjê nale¿y przej¶æ do katalogu
          wybranego portu:</para>

        <screen>&prompt.root; <userinput>cd /usr/ports/sysutils/lsof</userinput></screen>

        <para>Wewn±trz katalogu <filename>lsof</filename> znajduje siê
          szkielet portu. Nastêpnym krokiem jest kompilacja programu, co
          sprowadza siê do wpisania polecenia <command>make</command>.
          Efekt dzia³ania polecenia powinien byæ zbli¿ony do:</para>

        <screen>&prompt.root; <userinput>make</userinput>
&gt;&gt; lsof_4.57D.freebsd.tar.gz doesn't seem to exist in /usr/ports/distfiles/.
&gt;&gt; Attempting to fetch from ftp://lsof.itap.purdue.edu/pub/tools/unix/lsof/.
===&gt;  Extracting for lsof-4.57
...
[extraction output snipped]
...
&gt;&gt; Checksum OK for lsof_4.57D.freebsd.tar.gz.
===&gt;  Patching for lsof-4.57
===&gt;  Applying FreeBSD patches for lsof-4.57
===&gt;  Configuring for lsof-4.57
...
[configure output snipped]
...
===&gt;  Building for lsof-4.57
...
[compilation output snipped]
...
&prompt.root;</screen>

        <para>Po skoñczeniu kompilacji powracamy do linii poleceñ.
          Kolejnym krokiem jest instalacja portu poprzez wpisanie polecenia
          <command>make</command> wraz ze s³owem
          <command>install</command>:</para>

        <screen>&prompt.root; <userinput>make install</userinput>
===&gt;  Installing for lsof-4.57
...
[installation output snipped]
...
===&gt;   Generating temporary packing list
===&gt;   Compressing manual pages for lsof-4.57
===&gt;   Registering installation for lsof-4.57
===&gt;  SECURITY NOTE: 
      This port has installed the following binaries which execute with
      increased privileges.
&prompt.root;</screen>

        <para>Gdy ponownie powrócimy do linii poleceñ, powinni¶my
          byæ ju¿ w stanie uruchomiæ w³a¶nie zainstalowan± aplikacjê.
          Ostrze¿enie jakie pojawi siê na ekranie zwi±zane jest z faktem,
          ¿e lsof jest programem pracuj±cym ze zwiêkszonymi przywilejami.
          W trakcie kompilacji i instalacji portów powinni¶my zwracaæ uwagê
          na wszystkie pojawiaj±ce siê ostrze¿enia.</para>

        <para>Dobrym pomys³em, jest równie¿ usuniêcie podkatalogu
          zawieraj±cego wszystkie tymczasowe pliki wykorzystywane
          w trakcie kompilacji. Nie tylko dlatego, ¿e niepotrzebnie zajmuje
          miejsce na dysku, ale równie¿ dlatego, ¿e mo¿e byæ przyczyn±
          problemów podczas aktualizacji programu do nowszej wersji.</para>

	<screen>&prompt.root; <userinput>make clean</userinput>
===&gt;  Cleaning for lsof-4.57
&prompt.root;</screen>

        <note>
          <para>Mo¿na sobie oszczêdziæ dwóch naddatkowych kroków wpisuj±c
            od razu <command>make install clean</command> zamiast trzech
            osobnych poleceñ <command>make</command>,
	    <command>make install</command> oraz
            <command>make clean</command>.</para>
	</note>

	<note>
          <para>Niektóre pow³oki utrzymuj± bufor listy poleceñ
            z katalogów znajduj±cych siê w zmiennej ¶rodowiskowej
            <envar>PATH</envar>. Ma to za zadanie przy¶pieszyæ
            wyszukiwanie plików binarnych tych¿e poleceñ.
            Je¶li korzystamy z jednej z takich w³a¶nie pow³ok
            mo¿e okazaæ siê niezbêdnym wydaæ polecenie
            <command>rehash</command> po instalacji portu,
            nim bêdziemy mogli wykorzystaæ nowo zainstalowany
            program. Polecenie to dostêpne jest przy wykorzystaniu
            pow³oki typu <command>tcsh</command>. Natomiast
            dla pow³oki typu <command>sh</command> odpowiednikiem
            jest <command>hash -r</command>. Wiêcej informacji
            dostêpnych jest w dokumentacji pow³oki.</para>
	</note>

        <para>Niektóre wydawnictwa na p³ytach DVD-ROM, jak np. FreeBSD
          Toolkit z <ulink url="http://www.freebsdmall.com/">FreeBSD
	  Mall</ulink>, zawieraj± ¼ród³a distfile. Mog± byæ one
          wykorzystane z kolekcj± portów. Wystarczy zamontowaæ p³ytê
          DVD w <filename>/cdrom</filename>. Je¶li natomiast u¿ywamy
          innego punktu montowania dla p³yt musimy zmodyfikowaæ zmienn±
          <makevar>CD_MOUNTPTS</makevar> by wskazywa³a na w³a¶ciwe
          miejsce. Niezbêdne ¼ród³a distfile zostan± automatycznie
          wykorzystane je¶li znajduj± siê na p³ycie.</para>

	<note>
          <para>Mimo wszystko nale¿y mieæ w pamiêci, ¿e licencje
            nielicznych portów nie zezwalaj± na za³±czenie ich na
            p³ycie CD-ROM. Mo¿e to byæ np. z powodu konieczno¶ci
            wcze¶niejszej rejestracji przed pobraniem ¼róde³ b±d¼
            ich redystrybucja nie jest dozwolona. Je¶li chcemy
            zainstalowaæ port, który nie znajduje siê na p³ycie
            CD musimy mieæ po³±czenie z Internetem.</para>
	</note>

        <para>System portów do pobierania plików wykorzystuje
          program &man.fetch.1;, który z kolei potrafi korzystaæ
          z wielu zmiennych ¶rodowiskowych, m.in.
          <envar>FTP_PASSIVE_MODE</envar>, <envar>FTP_PROXY</envar>
	  czy <envar>FTP_PASSWORD</envar>. Je¶li znajdujemy siê
          za zapor± ogniow±, b±d¼ musimy korzystaæ z serwera
          po¶rednicz±cego FTP/HTTP proxy, mo¿e siê okazaæ,
          ¿e bêdziemy musieli ustawiæ niektóre z tych zmiennych.
          Kompletna lista wykorzystywanych zmiennych dostêpna
          jest w podrêczniku systemowym &man.fetch.3;.</para>

        <para>Dla u¿ytkowników nie mog±cych byæ ca³y czas po³±czonych
          z Internetem dostêpne jest polecenie
          <command>make <maketarget>fetch</maketarget></command>.
          Wystarczy wpisaæ to polecenie znajduj±c siê w g³ównym
          katalogu drzewa portów (<filename>/usr/ports</filename>)
          a wymagane pliki zostan± automatycznie pobrane. Polecenie
          to bêdzie równie¿ funkcjonowaæ w podkatalogach, np.
          <filename>/usr/ports/net</filename>. Jednak¿e, w takiej
          sytuacji <emphasis>nie</emphasis> zostan± automatycznie
          pobrane ¼ród³a bibliotek, od których zale¿y dany port.
          Zamieniaj±c parametr <maketarget>fetch</maketarget> na
          <maketarget>fetch-recursive</maketarget> spowodujemy
          pobranie równie¿ ¼róde³ wszystkich portów, od których
          zale¿y instalowany program.</para>

        <note><para>Mo¿liwe jest kompilowanie ka¿dego portu z osobna
          w danej kategorii, b±d¼ wszystkich na raz poprzez polecenie
          <command>make</command> wykonane, analogicznie do
          <command>make <makevar>fetch</makevar></command>,
          w g³ównym katalogu kategorii. Jednak¿e jest to niebezpieczna
          metoda, gdy¿ niektóre porty nie mog± jednocze¶nie funkcjonowaæ
          w systemie, b±d¼ mog± zainstalowaæ ró¿ne pliki o tej samej
          nazwie.</para></note>

	<para>W naprawdê ¿adkich przypadkach, u¿ytkownicy mog± pozyskaæ
          pliki distfile z innego ¼ród³a ni¿ <makevar>MASTER_SITES</makevar>
          (miejsce sk±d je pobiera system portów). Opcjê
          <makevar>MASTER_SITES</makevar> mo¿na zast±piæ za
          pomoc± nastêpuj±cego polecenia:</para>

	<screen>&prompt.root; <userinput>cd /usr/ports/<replaceable>directory</replaceable></userinput>
&prompt.root; <userinput>make MASTER_SITE_OVERRIDE= \
ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/ fetch</userinput></screen>

	<para>W tym przyk³adzie zast±pili¶my opcjê
          <makevar>MASTER_SITES</makevar> adresem <hostid
	  role="fqdn">ftp.FreeBSD.org/pub/FreeBSD/ports/distfiles/</hostid>.</para>

        <note><para>Niektóre porty umo¿liwiaj± (a nawet wymagaj±)
          podanie pewnych opcji kompilacji, które mog± w³±czyæ
          b±d¼ wy³±czyæ nie potrzebne czê¶ci aplikacji, pewne
          opcje bezpieczeñstwa i inne parametry. Z przychodz±cych
          na my¶l tego typu programów to
          <filename role="package">www/mozilla</filename>, <filename
          role="package">security/gpgme</filename> oraz <filename
	  role="package">mail/sylpheed-claws</filename>. Za ka¿dym
          razem gdy dostêpne bêd± tego typu opcje wy¶wietlony
          zostanie komunikat.</para></note>

      <sect3>
        <title>Ignorowanie domy¶lnych katalogów portów</title>

        <para>Czasami okazuje siê byæ przydatne (a nawet wymagane)
          by skorzystaæ z innych katalogów tymczasowych i docelowych.
          Domy¶lne katalogi mo¿na zast±piæ wykorzystuj±c zmienne
          <makevar>WRKDIRPREFIX</makevar> i <makevar>PREFIX</makevar>.
          Na przyk³ad:</para>

	<screen>&prompt.root; <userinput>make WRKDIRPREFIX=/usr/home/example/ports install</userinput></screen>

        <para>spowoduje skompilowanie portu w katalogu
          <filename>/usr/home/example/ports</filename> i instalacjê
          w podkatalogach <filename>/usr/local</filename>.</para>

	<screen>&prompt.root; <userinput>make PREFIX=/usr/home/example/local install</userinput></screen>

        <para>spowoduje natomiast kompilacjê w katalogu
          <filename>/usr/ports</filename> oraz instalacjê
          w podkatalogach
	  <filename>/usr/home/example/local</filename>.</para>

        <para>I oczywi¶cie,</para>

	<screen>&prompt.root; <userinput>make WRKDIRPREFIX=../ports PREFIX=../local install</userinput></screen>

        <para>spowoduje po³±cznie obydwu powy¿szych
          ustawieñ (jest to za d³ugie by ca³kowicie zmie¶ci³o
          siê na stronie, ale powinno daæ ogólne wyobra¿enie).</para>

        <para>Alternatywnie, obydwie zmienne mog± byæ
          równie¿ okre¶lone jako zmienne ¶rodowiskowe.
          Informacje o definiowaniu zmiennych ¶rodowiskowych
          dostêpne s± w podrêczniku systemowym naszej
          pow³oki.</para>
      </sect3>

      <sect3>
        <title>Jak poradziæ sobie z <command>imake</command></title>

        <para>Niektóre porty wykorzystuj±ce <command>imake</command>
          (czê¶æ Systemu okien X) nie wspó³pracuj± ze zmienn±
          <makevar>PREFIX</makevar> i mimo wszystko bêd±
          instalowa³y programy w <filename>/usr/X11R6</filename>.
          Podobnie niektóre z portów napisanych w jêzyku Perl
          ignoruj± zmienn± <makevar>PREFIX</makevar>
          i instaluj± programy w g³ównym drzewie Perla.
          Zmuszenie tych portów do wspó³pracy ze zmienn±
          <makevar>PREFIX</makevar> jest niezmiernie trudne,
          albo wrêcz niemo¿liwe.</para>

      </sect3>
    </sect2>

    <sect2 id="ports-removing">
      <title>Usuwanie zainstalowanych portów</title>

      <indexterm>
        <primary>porty</primary>
        <secondary>usuwanie</secondary>
      </indexterm>
      <para>Teraz, gdy wiesz ju¿ jak instalowaæ porty,
        zastanawiasz siê prawdopodobnie jak je usuwaæ,
        na przyk³ad w wypadku, gdy zainstalowali¶my port,
        ale okaza³o siê jednak, ¿e to nie by³ ten którego
        szukali¶my. W ramach przyk³adu usuniemy port,
        który instalowali¶my poprzednio (dla tych którzy
        nie uwa¿aj±, by³ to <command>lsof</command>).
        Podobnie jak w przypadku pakietów (szerzej opisane
        w podrozdziale traktuj±cym o <link
	linkend="packages-using">pakietach</link>),
        równie¿ porty usuwane s± za pomoc± polecenia
        &man.pkg.delete.1;:</para>

      <screen>&prompt.root; <userinput>pkg_delete lsof-4.57</userinput></screen>

    </sect2>

    <sect2 id="ports-upgrading">
      <title>Aktualizacja portów</title>

      <indexterm>
	<primary>porty</primary>
	<secondary>aktualizacja</secondary>
      </indexterm>
      <para>Na wstêpie musimy wy¶wietliæ zdezaktualizowane porty w kolekcji.
        Wykorzystamy do tego polecenie &man.pkg.version.1;:</para>

      <screen>&prompt.root; <userinput>pkg_version -v</userinput></screen>

      <sect3 id="ports-file-updating">
	<title><filename>/usr/ports/UPDATING</filename></title>

        <para>Po zaktualizowaniu kolekcji, a przed prób± aktualizacji
          jakichkolwiek portów, nale¿y zapoznaæ siê z zawarto¶ci± pliku
          <filename>/usr/ports/UPDATING</filename>. Plik ten opisuje
          ró¿ne zagadnienia i dodatkowe kroki, na które mo¿na natkn±æ
          siê i bêdzie trzeba wykonaæ podczas aktualizacji, np.
          zmiany formatu plików czy zmiany w lokalizacji plików
          konfiguracyjnych.</para>

	<para>Je¶li opis w pliku <filename>UPDATING</filename> mówi co¶ innego
          ni¿ ten tekst, nale¿y zastosowaæ siê do opisu.</para>
      </sect3>

      <sect3 id="portupgrade">
        <title>Aktualizacja portów z wykorzystaniem programu Portupgrade</title>

	<indexterm>
	  <primary>portupgrade</primary>
	</indexterm>

        <para>Program <application>portupgrade</application> zosta³
          zaprojektowany by u³atwiæ aktualizacjê zainstalowanych w
          systemie portów. Dostêpny jest z portu <filename
	  role="package">sysutils/portupgrade</filename>.
          Jego instalacja przebiega dok³adnie tak samo, jak ka¿dego
          innego portu, wykorzystuj±c polecenie
          <command>make <makevar>install
          clean</makevar></command> command:</para>

      <screen>&prompt.root; <userinput>cd /usr/ports/sysutils/portupgrade</userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

      <para>Przeskanujmy nastêpnie listê zainstalowanych portów
        za pomoc± polecenia <command>pkgdb -F</command> i usuñmy
        wszystkie niezgodno¶ci jakie nam zwróci skanowanie.
        Regularne skanowanie przed ka¿d± aktualizacj± jest
        zdecydowanie dobrym pomys³em.</para>

      <para>Wydanie polecenia <command>portupgrade -a</command>
        spowoduje, ¿e program <application>portupgrade</application>
        rozpocznie aktualizacjê wszystkich przedawnionych portów
        zainstalowanych w naszym systemie. Parametr <option>-i</option>
        pozwoli przej¶æ w tryb interaktywny, gdzie bêdziemy musieli
        potwierdziæ aktualizacjê ka¿dego portu.</para>

      <screen>&prompt.root; <userinput>portupgrade -ai</userinput></screen>

      <para>By zaktualizowaæ jedynie wybran± aplikacjê zamiast wszystkich
        portów nale¿y wykorzystaæ polecenie <command>portupgrade
	<replaceable>nazwa_programu</replaceable></command>.
        Opcja <option>-R</option> oznacza, ¿e portupgrade powinien
        najpierw zaktualizowaæ wszystkie porty, od których
        zale¿y dany program.</para>

      <screen>&prompt.root; <userinput>portupgrade -R firefox</userinput></screen>

      <para>By do instalacji wykorzystaæ pakiety zamiast portów
        nale¿y dodaæ parametr <option>-P</option>. Wówczas
        <application>portupgrade</application> przeszuka katalogi
        zawarte w zmiennej <envar>PKG_PATH</envar>. Je¶li pakiet
        nie zostanie odnaleziony lokalnie zostanie pobrany z Internetu.
        Je¶li nie bêdzie mo¿liwe ¿adne z powy¿szych, wówczas
        <application>portupgrade</application> wykorzysta do
        aktualizacji porty. By temu zapobiec nale¿y zastosowaæ
        parametr <option>-PP</option>.</para>

      <screen>&prompt.root; <userinput>portupgrade -PR gnome2</userinput></screen>

      <para>Aby pobraæ jedynie pliki ¼ród³owe distfiles
        (b±d¼ pakiety, gdy wykorzystamy opcjê <option>-P</option>)
        bez kompilacji czy instalacji czegokolwiek nale¿y u¿yæ
        parametru <option>-F</option>. Wiêcej informacji
        dostêpnych jest w &man.portupgrade.1;.</para>
      </sect3>

      <sect3 id="portmanager">
        <title>Aktualizacja portów z wykorzystaniem programu Portmanager</title>

	<indexterm>
	  <primary>portmanager</primary>
	</indexterm>

        <para>Kolejnym narzêdziem u³atwiaj±cym aktualizacjê zainstalowanych
          portów jest <application>Portmanager</application>, dostêpny z portu
	  <filename role="package">sysutils/portmanager</filename>:</para>

	<screen>&prompt.root; <userinput>cd <filename role="directory">/usr/ports/sysutils/portmanager</filename></userinput>
&prompt.root; <userinput>make install clean</userinput></screen>

	<para>Wszystkie zainstalowane porty mog± zostaæ zaktualizowane
          za pomoc± polecenia:</para>

	<screen>&prompt.root; <userinput>portmanager -u</userinput></screen>

        <para>Wykorzystuj±c parametr <option>-ui</option> przechodzimy w tryb
          interaktywny, gdzie bêdziemy pytani o potwierdzenie ka¿dej operacji
          wykonywanej przez <application>Portmanager</application>.
          Program ten mo¿e byæ z równym powodzeniem wykorzystywany do instalacji
          nowych portów w systemie. W przeciwieñstwie do polecenia
          <command>make install clean</command> program
          <application>Portmanager</application> zaktualizuje wszystkie
          zale¿no¶ci nim skompiluje i zainstaluje wybrany port.</para>

	<screen>&prompt.root; <userinput>portmanager <replaceable>x11/gnome2</replaceable></userinput></screen>

        <para>Gdy wyst±pi± problemy z zale¿no¶ciami wybranego portu
          mo¿na wykorzystaæ <application>Portmanager</application>a,
          by ponownie skompilowa³ je we w³a¶ciwej kolejno¶ci. Na
          koniec zostanie równie¿ ponownie skompilowany port
          stwarzaj±cy problemy.</para>

	<screen>&prompt.root; <userinput>portmanager <replaceable>graphics/gimp</replaceable> -f</userinput></screen>

        <para>Wiêcej informacji dostêpnych jest na stronach podrêcznika
          systemowego <application>Portmanager</application>a.</para>
      </sect3>
    </sect2>

    <sect2 id="ports-disk-space">
      <title>Porty i przestrzeñ na dysku</title>

      <indexterm>
	<primary>porty</primary>
	<secondary>przestrzeñ na dysku</secondary>
      </indexterm>
      <para>Korzystanie z kolekcji portów z czasem odbije siê na
        wolnym miejscu na dysku. Dlatego te¿ zawsze po skompilowaniu
        i zainstalowaniu programu z portu powinni¶my pamiêtaæ
        o usuniêciu tymczasowych katalogów roboczych (ang.
        <filename class="directory">work</filename> directories)
        wykorzystuj±c do tego polecenie <command>make
	<makevar>clean</makevar></command>. Ca³± kolekcjê natomiast
        mo¿na oczy¶ciæ wpisuj±ce polecenie:</para>

      <screen>&prompt.root; <userinput>portsclean -C</userinput></screen>

      <para>Z czasem uzbiera nam siê wiele katalogów
        <filename class="directory">distfiles</filename>, które
        bêd± jedynie zajmowaæ przestrzeñ na dysku. Mo¿emy je rêcznie
        usuwaæ b±d¼ pos³u¿yæ siê nastêpuj±cym poleceniem, by usun±æ
        wszystkie katalogi distfiles nie powi±zane aktualnie z
        ¿adnym portem:</para>

      <screen>&prompt.root; <userinput>portsclean -D</userinput></screen>

      <para>Bad¼, by usun±æ wszystkie katalogi disftiles, do których nie odnosi siê
        ¿aden z aktualnie zainstalowanych portów w naszym systemie:</para>

      <screen>&prompt.root; <userinput>portsclean -DD</userinput></screen>

      <note>
        <para>Program <command>portsclean</command> jest czê¶ci± pakietu
          <application>portupgrade</application>.</para>
      </note>

      <para>Pamiêtajmy równie¿ o usuwaniu instalowanych portów gdy
        ju¿ ich nie potrzebujemy. Przydatne narzêdzie pozwalaj±ce
        zautomatyzowaæ te czynno¶ci znajduje siê w
	<filename role="package">sysutils/pkg_cutleaves</filename>.</para>
    </sect2>

  </sect1>

  <sect1 id="ports-nextsteps">
    <title>Czynno¶ci po-instalacyjne</title>

    <para>Po zainstalowaniu nowego programu z regu³y chcemy
      zapoznaæ siê z dostarczon± z nim dokumentacj±, zmodyfikowaæ
      wymagane pliki konfiguracyjne, upewniæ siê, ¿e program
      (je¶li jest to demon) bêdzie uruchamiany w trakcie
      ³adowania systemu, itp.</para>

    <para>Oczywi¶cie, szczegó³owe kroki jakie nale¿y podj±æ
      konfiguruj±c ka¿d± aplikacjê bêd± ró¿ne. Tym nie mniej,
      je¶li w³a¶nie zainstalowali¶my nowy program i zastanawiamy
      siê <quote>Co dalej?</quote> poni¿sze uwagi mog±
      okazaæ siê pomocne:</para>

    <itemizedlist>
      <listitem>
        <para>Za pomoc± &man.pkg.info.1; mo¿emy sprawdziæ gdzie
          i jakie pliki zosta³y zainstalowane. Na przyk³ad, je¶li
          zainstalowali¶my wersjê 1.0.0 pakietu FooPackage,
          polecenie</para>

	<screen>&prompt.root; <userinput>pkg_info -L foopackage-1.0.0 | less</userinput></screen>

        <para>wy¶wietli nam wszystkie pliki zainstalowane
          z pakietu. Szczególn± uwagê warto zwróciæ na pliki
          zainstalowane w katalogach: <filename>man/</filename>
          zawieraj±cym strony podrêcznika systemowego,
          <filename>etc/</filename>  zawieraj±cym pliki
          konfiguracyjne, oraz <filename>doc/</filename>,
          gdzie znajdowaæ siê bêdzie du¿o obszerniejsza
          dokumentacja.</para>

        <para>Je¶li nie jeste¶my pewni, któr± wersj± programu
          zainstalowali¶my, polecenie</para>

	<screen>&prompt.root; <userinput>pkg_info | grep -i <replaceable>foopackage</replaceable></userinput></screen>

        <para>wy¶wietli wszystkie zainstalowane pakiety
          zawieraj±ce <replaceable>foopackage</replaceable>
          w nazwie. Oczywi¶cie <replaceable>foopackage</replaceable>
          nale¿y zast±piæ nazw± poszukiwanego pakietu.</para>
      </listitem>

      <listitem>
        <para>Gdy ju¿ uda³o siê ustaliæ jakie strony podrêcznika
          systemowego zosta³y zainstalowane przez dany pakiet,
          mo¿na je przeczytaæ za pomoc± polecenia &man.man.1;.
          Warto równie¿ obejrzeæ przyk³adowe pliki konfiguracyjne
          i wszelk± dodatkow± dokumentacjê.</para>
      </listitem>

      <listitem>
        <para>Je¶li dana aplikacja posiada w³asn± witrynê internetow±
          warto jest równie¿ tam poszukaæ dodatkowej dokumentacji
          czy odpowiedzi na czêsto zadawane pytania (FAQ). Je¶li nie
          znamy w³a¶ciwego adresu internetowego mo¿e byæ on podany
          w wyniku polecenia</para>

	<screen>&prompt.root; <userinput>pkg_info <replaceable>foopackage-1.0.0</replaceable></userinput></screen>
	
        <para>Wiersz <literal>WWW:</literal>, je¶li w ogóle jest
          podany, powinien zawieraæ informacje o adresie witryny.</para>
      </listitem>

      <listitem>
        <para>Programy, które powinny byæ uruchamiane podczas
          ³adowania systemu (np. serwery internetowe) z regu³y
          instaluj± przyk³adowy skrypt w
          <filename>/usr/local/etc/rc.d</filename>. Powinni¶my
          sprawdziæ zawarto¶æ tego skryptu oraz w razie potrzeby
          zmodyfikowaæ go b±d¼ zmieniæ nazwê. Szczegó³owe informacje
          dostêpne s± w podrozdziale <link
	  linkend="configtuning-starting-services">Uruchamianie
            us³ug</link>.</para>
      </listitem>
    </itemizedlist>
  </sect1>

  <sect1 id="ports-broken">
    <title>Jak radziæ sobie ze ¼le przygotowanymi portami</title>

    <para>Je¶li natknêli¶my siê na port, który z jakich¶
      powodów nie dzia³a na naszym komputerze, mo¿emy zrobiæ
      kilka nastêpuj±cych rzeczy:</para>

      <orderedlist>
	<listitem>
          <para>Sprawdziæ w <ulink url="&url.base;/support.html#gnats">bazie
              danych zg³oszonych problemów</ulink> czy jest przygotowywana
            poprawka dla danego portu. Je¶li tak, mo¿e uda siê nam
            zastosowaæ tê poprawkê.</para>
	</listitem>

	<listitem>
          <para>Poprosiæ o pomoc opiekuna danego portu. Adres
            email opiekuna mo¿na znale¼æ przegl±daj±æ plik
            <filename>Makefile</filename> w katalogu portu b±d¼
            wpisuj±æ polecenie <command>make maintainer</command>.
            Wysy³aj±c wiadomo¶æ pamiêtajmy o zawarciu informacji
            o nazwie i wersji portu (najlepiej jest zawrzeæ ca³y
            wiersz z pliku <filename>Makefile</filename> zaczynaj±cy
            siê od <literal>&dollar;FreeBSD:</literal>), oraz opis
            b³êdu i wynik dzia³ania programu w momencie
            zaistnienia b³êdu.</para>

	  <note>
            <para>Niektóre porty nie s± przygotowywane przez pojedyncze
              osoby, ale raczej przez <ulink
	      url="&url.articles.mailing-list-faq;/article.html">grupy
                dyskusyjne</ulink>. Wiele adresów takich grup, choæ nie
              wszystkie, ma postaæ
              <email role="nolink">freebsd-listname@FreeBSD.org</email>.
              Nale¿y mieæ równie¿ to na uwadze formu³uj±c swoje pytania.</para>

            <para>Porty przygotowywane przez
              <email role="nolink">freebsd-ports@FreeBSD.org</email>
              w rzeczywisto¶ci nie posiadaj± ¿adnego konkretnego opiekuna,
              ani grupy opiekunów. Poprawki i pomoc dla takich portów
              przygotowuj± osoby zapisane na tê listê dyskusyjn±. Nowi
              ochotnicy s± zawsze mile widziani!</para>
	  </note>

          <para>W przypadku braku odpowiedzi mo¿na równie¿ przes³aæ
            zg³oszenie b³êdu poprzez &man.send-pr.1; (szczegó³y w artykule
            <ulink
	    url="&url.articles.problem-reports;/article.html">Writing
	    FreeBSD Problem Reports</ulink>).</para>
	</listitem>

        <listitem>
          <para>Naprawiæ b³±d samemu! Podrêcznik <ulink
            url="&url.books.porters-handbook;/index.html">Porter's
	    Handbook</ulink> (ang.) zawiera szczegó³owe informacje
            o strukturze <quote>Portów</quote>, dziêki czemu mo¿na samemu
            naprawiæ b³±d lub przygotowaæ w³asny port!</para>
	</listitem>

	<listitem>
          <para>Pobraæ pakiet z najbli¿szego serwera FTP.
            <quote>G³ówne</quote> repozytorium pakietów znajduje
            siê na serwerze <hostid
	    role="fqdn">ftp.FreeBSD.org</hostid> w katalogu <ulink
	    url="ftp://ftp.FreeBSD.org/pub/FreeBSD/ports/packages/">packages</ulink>.
            Tym nie mniej warto jest najpierw odszukaæ <ulink
	    url="http://mirrorlist.FreeBSD.org/">lokalny serwer
            lustrzany</ulink>. Szanse na to, ¿e gotowe pakiety
            bêd± dzia³aæ poprawnie s± wiêksze ni¿ w przypadku
            kompilowania programów. Pakiety mo¿na zainstalowaæ
            za pomoc± programu &man.pkg.add.1;.</para>
	</listitem>
      </orderedlist>
  </sect1>

</chapter>

<!--
     Local Variables:
     mode: sgml
     sgml-declaration: "../chapter.decl"
     sgml-indent-data: t
     sgml-omittag: nil
     sgml-always-quote-attributes: t
     sgml-parent-document: ("../book.sgml" "part" "chapter")
     End:
-->
