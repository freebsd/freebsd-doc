<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org" />
<title>FreeBSD/amd64 5.4-RELEASE 发行说明</title>
<meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79" />
<link rel="STYLESHEET" type="text/css" href="docbook.css" />
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
</head>
<body class="ARTICLE" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084"
alink="#0000FF">
<div class="ARTICLE">
<div class="TITLEPAGE">
<h1 class="TITLE"><a id="AEN2" name="AEN2">FreeBSD/amd64 5.4-RELEASE 发行说明</a></h1>

<h3 class="CORPAUTHOR">The FreeBSD Project</h3>

<p class="COPYRIGHT">版权 &copy; 2000, 2001, 2002, 2003, 2004, 2005 The FreeBSD
Documentation Project</p>

<p class="PUBDATE">$FreeBSD: src/release/doc/zh_CN.GB2312/relnotes/common/new.sgml,v
1.1.2.4.2.5 2005/05/05 18:33:08 delphij Exp $<br />
</p>

<div class="LEGALNOTICE"><a id="TRADEMARKS" name="TRADEMARKS"></a>
<p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p>

<p>IBM, AIX, EtherJet, Netfinity, OS/2, PowerPC, PS/2, S/390, and ThinkPad are trademarks
of International Business Machines Corporation in the United States, other countries, or
both.</p>

<p>IEEE, POSIX, and 802 are registered trademarks of Institute of Electrical and
Electronics Engineers, Inc. in the United States.</p>

<p>Intel, Celeron, EtherExpress, i386, i486, Itanium, Pentium, and Xeon are trademarks or
registered trademarks of Intel Corporation or its subsidiaries in the United States and
other countries.</p>

<p>Sparc, Sparc64, SPARCEngine, and UltraSPARC are trademarks of SPARC International, Inc
in the United States and other countries. Products bearing SPARC trademarks are based
upon architecture developed by Sun Microsystems, Inc.</p>

<p>Many of the designations used by manufacturers and sellers to distinguish their
products are claimed as trademarks. Where those designations appear in this document, and
the FreeBSD Project was aware of the trademark claim, the designations have been followed
by the ``&trade;'' or the ``&reg;'' symbol.</p>
</div>

<div>
<div class="ABSTRACT"><a id="AEN23" name="AEN23"></a>
<p>这份 FreeBSD 5.4-RELEASE 的发行说明， 概括了 FreeBSD 基本系统自 5.3-RELEASE
以来所做的改动。 本文档同时列举了自前一发行版发布以来所有适用的安全公告， 以及对于
FreeBSD 内核以及系统附带的应用程序所做的重要修改。 在升级时所需要注意的一些问题，
也进行了简略的介绍。</p>
</div>
</div>

<hr />
</div>

<div class="TOC">
<dl>
<dt><b>目录</b></dt>

<dt>第1节 <a href="#INTRO">简介</a></dt>

<dt>第2节 <a href="#NEW">最新变动</a></dt>

<dd>
<dl>
<dt>第2.1节 <a href="#SECURITY">安全公告</a></dt>

<dt>第2.2节 <a href="#KERNEL">对于内核的改动</a></dt>

<dd>
<dl>
<dt>第2.2.1节 <a href="#BOOT">引导区和 loader 的变化</a></dt>

<dt>第2.2.2节 <a href="#PROC">硬件支持</a></dt>

<dt>第2.2.3节 <a href="#NET-PROTO">网络协议</a></dt>

<dt>第2.2.4节 <a href="#DISKS">磁盘及存储</a></dt>

<dt>第2.2.5节 <a href="#FS">文件系统</a></dt>

<dt>第2.2.6节 <a href="#AEN303">基本系统附带的第三方软件</a></dt>
</dl>
</dd>

<dt>第2.3节 <a href="#USERLAND">应用程序变动</a></dt>

<dd>
<dl>
<dt>第2.3.1节 <a href="#RC-SCRIPTS"><tt class="FILENAME">/etc/rc.d</tt> 脚本</a></dt>
</dl>
</dd>

<dt>第2.4节 <a href="#CONTRIB">基本系统包含的第三方软件</a></dt>

<dt>第2.5节 <a href="#PORTS">Ports/Packages Collection 基础结构</a></dt>

<dt>第2.6节 <a href="#RELENG">发行版建造工程和功能集成</a></dt>

<dt>第2.7节 <a href="#DOC">文档</a></dt>
</dl>
</dd>

<dt>第3节 <a href="#UPGRADE">从先前版本的 FreeBSD 升级</a></dt>
</dl>
</div>

<div class="SECT1">
<h2 class="SECT1"><a id="INTRO" name="INTRO">1 简介</a></h2>

<p>这篇文档包括了在 AMD64 硬件平台上 FreeBSD 5.4-RELEASE 的发行说明。
它描述了最近刚刚加入、修改或删除了的 FreeBSD 特性的说明。 同时，它也将给出如何从先前的
FreeBSD 版本完成升级的说明。</p>

<p>这是一份 FreeBSD 5.4-RELEASE 的 release 发布包。 您可以从 <a
href="ftp://ftp.FreeBSD.org/" target="_top">ftp://ftp.FreeBSD.org/</a>
或其他镜像那里得到它的副本。 关于这个 (或其他) release 发布包的更多信息，可以在 <a
href="http://www.FreeBSD.org/doc/en_US.ISO8859-1/books/handbook/" target="_top">FreeBSD
手册</a> 中的 <a
href="http://www.FreeBSD.org/doc/en_US.ISO8859-1/books/handbook/mirrors.html"
target="_top">``Obtaining FreeBSD''附录</a> 中找到。</p>

<p>我们鼓励所有的用户在开始安装 FreeBSD 之前首先参考这一版本所对应的勘误信息。
勘误文档将随时更新，以便为用户提供在发布工程后期或该版本发布之后 ``新发现的''
问题和相关信息。 通常，这包括已知的 bug，安全公告，以及对于文档的修订内容。 最新的
FreeBSD 5.4-RELEASE 勘误信息可以从 FreeBSD 网站获得。</p>
</div>

<div class="SECT1">
<hr />
<h2 class="SECT1"><a id="NEW" name="NEW">2 最新变动</a></h2>

<p>这一节描述了 FreeBSD 自 5.3-RELEASE 以来最明显的新功能和变化。 一般说来， 没有注明
[已合并] 的那些新特性是 5-STABLE 所独有的。</p>

<p>发行说明中的绝大多数条目是在说明自从 5.3-RELEASE
以来的安全公告、新的驱动程序或硬件支持、新的命令或是选项、
重要的错误修补，以及基本系统中来自第三方的软件升级。 重要的 ports 和 packages
变动，或关于交付工程的变动也会在这份文档中体现。 显而易见地，发行说明不可能涵盖 FreeBSD
版本之间的每一个微小变动； 这篇文档主要关注的，仍然是安全公告，用户可以察觉的修改，
以及重要的架构改良。</p>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="SECURITY" name="SECURITY">2.1 安全公告</a></h3>

<p>在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=fetch&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">fetch</span>(1)</span></a>
工具中发现了一处问题， 它可能导致恶意的 HTTP 服务器覆盖客户程序任意部分的内存，
这一问题已经得到修复。 要了解更多信息， 请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-04:16.fetch.asc"
target="_top">FreeBSD-SA-04:16.fetch</a>。</p>

<p>在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=procfs&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">procfs</span>(5)</span></a> 和 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=linprocfs&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">linprocfs</span>(5)</span></a>
中发现了一处问题， 它能够允许恶意的本地用户读取部分内核内存， 或通过造成系统 panic
来实施本地拒绝服务攻击， 这一问题已经得到修复。 要了解更多信息， 请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-04:17.procfs.asc"
target="_top">FreeBSD-SA-04:17.procfs</a>。</p>

<p>修正了 TELNET 客户端程序中的两处缓冲区溢出问题。 这些问题可以导致恶意的 TELNET
服务器或网络上的主动攻击者， 使 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=telnet&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">telnet</span>(1)</span></a>
以运行它的用户的身份执行任意的代码。 要了解更多信息， 请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-05:01.telnet.asc"
target="_top">FreeBSD-SA-05:01.telnet</a>。</p>

<p>修正了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=sendfile&sektion=2&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">sendfile</span>(2)</span></a>
系统调用中的一处信息泄露问题， 这一问题可能导致内核中的一段随机的部分被传递出去。
要了解更多信息， 请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-05:02.sendfile.asc"
target="_top">FreeBSD-SA-05:02.sendfile</a>。</p>

<p>修正了在 FreeBSD/amd64 中的一处特权提升问题。
这一问题可能导致没有特权的用户访问某些在没有特权时无法访问的硬件。 要了解更多信息，
请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-05:03.amd64.asc"
target="_top">FreeBSD-SA-05:03.amd64</a>。</p>

<p>修正了 <tt class="LITERAL">SIOCGIFCONF</tt> <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ioctl&sektion=2&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ioctl</span>(2)</span></a>
的一个信息泄露问题， 这一问题可能导致 12 字节的内核内存被泄露。 要了解更多信息，
请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-05:04.ifconf.asc"
target="_top">FreeBSD-SA-05:04.ifconf</a>。</p>

<p>修正了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cvs&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">cvs</span>(1)</span></a>
中的多处程序设计问题， 这些问题可能导致在 CVS 服务器上执行任意代码。 要了解更多信息，
请参见安全公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-05:05.cvs.asc"
target="_top">FreeBSD-SA-05:05.cvs</a>。</p>
</div>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="KERNEL" name="KERNEL">2.2 对于内核的改动</a></h3>

<p>内核调试器 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ddb&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ddb</span>(4)</span></a>
现在支持用于显示持有休眠互斥体 (以及当前线程所持有的自旋互斥体) 的情况的 <tt
class="COMMAND">show alllocks</tt> 命令了。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=jail&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">jail</span>(8)</span></a>
功能支持一个新的 sysctl <code class="VARNAME">security.jail.chflags_allowed</code>，
用于控制 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=chflags&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">chflags</span>(1)</span></a> 在
jail 中的行为。 如果设置为 <tt class="LITERAL">0</tt> (默认值)， jail 中的 <tt
class="USERNAME">root</tt> 用户将被认为是非特权用户； 如果设置为 <tt
class="LITERAL">1</tt>， 则 jail 中的 root 用户会被视为与未 jail 的 <tt
class="USERNAME">root</tt> 用户一样。</p>

<p>加载器变量 <code class="VARNAME">debug.mpsafevm</code> 默认置为启用了。</p>

<p>一系列 ULE 的问题得到了修正。</p>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="BOOT" name="BOOT">2.2.1 引导区和 loader 的变化</a></h4>
</div>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="PROC" name="PROC">2.2.2 硬件支持</a></h4>

<p>加入了用于灵活控制处理器速度的框架。 这为许多驱动程序通过调整 CPU
的速度来控制功耗提供了手段。 更多细节， 可以在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cpufreq&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">cpufreq</span>(4)</span></a>
联机手册中找到。</p>

<p>加入了用于支持 GPIB-PCIIA IEEE-488 卡的 pcii 驱动。</p>

<div class="SECT4">
<hr />
<h5 class="SECT4"><a id="MM" name="MM">2.2.2.1 多媒体支持</a></h5>
</div>

<div class="SECT4">
<hr />
<h5 class="SECT4"><a id="NET-IF" name="NET-IF">2.2.2.2 网络接口设备支持</a></h5>

<p>加入了用于支持 USB 以太网通讯设备一类的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cdce&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">cdce</span>(4)</span></a>
驱动。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cp&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">cp</span>(4)</span></a> 驱动现在是
MPSAFE 的了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ctau&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ctau</span>(4)</span></a>
驱动现在是 MPSAFE 的了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cx&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">cx</span>(4)</span></a> 驱动现在是
MPSAFE 的了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ed&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">ed</span>(4)</span></a> 驱动现在支持 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">altq</span>(4)</span></a>
框架了。</p>

<p>在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=em&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">em</span>(4)</span></a> 驱动程序中，
默认禁用了对 VLAN 标记 (tagging) 的硬件支持，
因为这个功能与混杂模式之间存在一些冲突。</p>

<p>默认地禁用了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=fxp&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">fxp</span>(4)</span></a>
驱动的以太网流控制功能， 以避免系统崩溃或进入内核调试器。</p>

<p>The <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=hme&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">hme</span>(4)</span></a>
驱动现在是 MPSAFE 的了。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ndis&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ndis</span>(4)</span></a> 设备驱动
wrapper 在 amd64 系统上能够支持 <span class="TRADEMARK">Windows</span>&reg;/x86-64
的二进制驱动了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=re&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">re</span>(4)</span></a> 驱动支持 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">altq</span>(4)</span></a>
框架了。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=sf&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">sf</span>(4)</span></a>
驱动支持设备混合轮询 (device polling) 和 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">altq</span>(4)</span></a> 了。</p>

<p>修正了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=sk&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">sk</span>(4)</span></a>
驱动中的多处程序设计错误。 这些问题主要影响 SMP 系统， 可能导致系统崩溃、 内核缺页、 SSH
连接中断， 或文件传输问题。 更多细节， 可以在勘误公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/ERRATA/notices/FreeBSD-EN-05:02.sk.asc"
target="_top">FreeBSD-EN-05:02.sk</a> 上找到。</p>

<p>现在， <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=sk&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">sk</span>(4)</span></a> 驱动支持 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=altq&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">altq</span>(4)</span></a> 了。
同时， 此驱动支持基于 Yukon 的网卡的巨型帧能力了。</p>
</div>
</div>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="NET-PROTO" name="NET-PROTO">2.2.3 网络协议</a></h4>

<p>当发送方写的数据必须分片时， 关闭了 IPv6 中的 MTU 反馈。</p>

<p>实现了共用地址冗余协议 (CARP)。 CARP 来自 OpenBSD， 允许多个主机共享同一个 IP 地址，
从而提供了高可用性和负载均衡。 要了解更多细节， 请参考 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=carp&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">carp</span>(4)</span></a>
联机手册。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 可以与
<code class="VARNAME">debug.mpsafenet</code>=<tt class="LITERAL">1</tt> (默认情况下是 <tt
class="LITERAL">1</tt>)， 当使用了 <tt class="LITERAL">gid</tt>, <tt
class="LITERAL">jail</tt>, 和/或 <tt class="LITERAL">uid</tt> 规则选项时正常工作了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(8)</span></a> <tt
class="LITERAL">ipfw fwd</tt> 规则现在支持完整的包目的地管理了， 其前提是启用了内核选项
<tt class="LITERAL">options IPFIREWALL_FORWARD</tt> 的基础上打开了 <tt
class="LITERAL">options IPFIREWALL_FORWARD_EXTENDED</tt>。 这个内核选项将禁用所有的限制，
以保证本地生成的包， 和发到配置在本地的 IP 地址的包能够正常地发出和转发。 请注意，
必须细心地编写 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(8)</span></a> 规则，
以确保类似 PMTU 发现这类应用不致发生异常。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipnat&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipnat</span>(8)</span></a>
允许在非 TCP/UDP 包上使用重定向规则了。</p>

<p>目前正在进行的工作， 在逐步去掉网络协议栈中的全局锁， 并改进锁的策略。</p>

<p>新的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ng_netflow&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ng_netflow</span>(4)</span></a>
NetGraph 节点， 使得采用 FreeBSD 的路由器能够运行 NetFlow version 5 的导出。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=sppp&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">sppp</span>(4)</span></a>
驱动程序包含了帧转发 (Frame Relay) 支持。</p>

<p>修正了 TCP 的一处问题， 这一问题有时会导致当接收窗口大小为零时， RST
包被忽略的问题。</p>

<p>改进了 FreeBSD TCP 协议栈中对 <tt class="LITERAL">RST</tt> 的处理，
使得这类攻击变得尽可能地困难， 同时最大限度地保障了和其他 TCP 协议栈的兼容性。 算法如下：
对于所有在 <tt class="LITERAL">ESTABLISHED</tt> 状态的连接， 只有当包的顺序号与 <code
class="VARNAME">last_ack_sent</code> 精确匹配时才将连接复位；
所有不符合的分片都将被直接丢弃。 对于所有其他状态的连接， 则对窗口内的复位请求进行处理。
其它的复位分片则被直接丢弃。 需要说明的是， 这一行为和 RFC 793 标准抵触， 传统的
(但安全性较差) 行为， 可以通过将新增的 sysctl <code
class="VARNAME">net.inet.tcp.insecure_rst</code> 设置为 <tt class="LITERAL">1</tt>
来还原。</p>

<p>在 TCP SACK 实现中的许多错误得到了修正。</p>

<p>将 KAME IPv4 IPsec 实现集成到了 FreeBSD 中， 现在支持 TCP-MD5 了。</p>

<p>短期使用端口的随机分配导致了在高连接速率时的端口重用问题。
这一功能现在在短期内发生大量连接， 即新端口的创建速率快于每秒 <code
class="VARNAME">net.inet.ip.portrange.randomcps</code> 时， 被自动禁用 <code
class="VARNAME">net.inet.ip.portrange.randomtime</code> 秒。 这两个 sysctl 变量的默认值，
分别是 <tt class="LITERAL">10</tt> 和 <tt class="LITERAL">45</tt>。</p>
</div>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="DISKS" name="DISKS">2.2.4 磁盘及存储</a></h4>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=amr&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">amr</span>(4)</span></a>
可以安全地在使用了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=pae&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">pae</span>(4)</span></a>
的系统上使用了。</p>

<p>加入了 SHSEC GEOM 类。 它提供了在多个 GEOM 提供者之间实现秘密分享的能力。
所有提供者必须都存在， 才能够解开保存的秘密信息。 这一特性可以通过 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=gshsec&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">gshsec</span>(8)</span></a>
工具来控制。</p>

<p>加入了用于支持 HighPoint RocketRAID 182x 系列硬件的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=hptmv&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">hptmv</span>(4)</span></a>
驱动。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ips&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ips</span>(4)</span></a>
驱动在较新的 ServeRAID 型号上， 能够支持内核崩溃的转储操作了。</p>

<p>删去了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=matcd&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">matcd</span>(4)</span></a>
驱动。</p>

<p>关于新挂接的 cd9660 文件系统的信息 (例如， 存在 RockRidge 扩展) 现在只有在内核以详细
(verbose) 模式启动时才会显示了。 这一修改主要是减少 (一般来说不必要的)
内核日志消息的数量。</p>
</div>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="FS" name="FS">2.2.5 文件系统</a></h4>

<p>原先在挂接时进行的， 重新计算 ``脏'' (即， 上次停机时没有正常卸下) 的 UFS 和 UFS2
文件系统摘要信息的工作， 现在转由后台 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=fsck&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">fsck</span>(8)</span></a> 进行。
这一修改将极大地改善系统崩溃后挂接大文件系统时的速度。 如果希望还原原先的行为，
可以通过将 <code class="VARNAME">vfs.ffs.compute_summary_at_mount</code> sysctl
变量设置为非零值来实现。</p>

<p>修正了由于 NFS 服务器可能导致的一个内核崩溃。 更多细节， 可以在勘误公告 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/ERRATA/notices/FreeBSD-EN-05:01.nfs.asc"
target="_top">FreeBSD-EN-05:01.nfs</a>. 中找到。</p>
</div>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="AEN303" name="AEN303">2.2.6 基本系统附带的第三方软件</a></h4>

<p><b class="APPLICATION">ACPI-CA</b> 由 20040527 更新到了 20041119。</p>
</div>
</div>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="USERLAND" name="USERLAND">2.3 应用程序变动</a></h3>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ftpd&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ftpd</span>(8)</span></a>
程序会正确地为目录和文件的状态使用 <tt class="LITERAL">212</tt> 和 <tt
class="LITERAL">213</tt> 状态代码了 (过去的版本， 曾经长期使用 <tt
class="LITERAL">211</tt>)。 这一行为在 RFC 959 中进行了描述。</p>

<p>如果指定了 <tt class="LITERAL">AF_UNSPEC</tt>， 现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=getaddrinfo&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">getaddrinfo</span>(3)</span></a>
函数会在查询 <tt class="LITERAL">AAAA</tt> 记录之前， 首先查询 <tt class="LITERAL">A</tt>
DNS 资源记录。 一些有问题的 DNS 服务器会在 <tt class="LITERAL">AAAA</tt> 记录不存在时返回
<tt class="LITERAL">NXDOMAIN</tt>， 而根据标准， 它应该返回 <tt
class="LITERAL">NOERROR</tt> 和一条空记录。 这类服务器会在 IPv4/IPv6
双栈节点上导致查询停止， 因为对于 <tt class="LITERAL">AAAA</tt> 的查询时返回的 <tt
class="LITERAL">NXDOMAIN</tt> 会导致服务器停止解析 <tt class="LITERAL">A</tt>
记录的尝试。 另外， 这一行为也被视为一种潜在的拒绝服务攻击 (参见 <a
href="http://www.kb.cert.org/vuls/id/714121"
target="_top">http://www.kb.cert.org/vuls/id/714121</a> 以了解更多细节)。 请注意，
虽然改变了查询顺序， 返回的结果仍然是 <tt class="LITERAL">AF_INET6</tt> 记录先于 <tt
class="LITERAL">AF_INET</tt> 记录。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=gpt&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">gpt</span>(8)</span></a> 的 <tt
class="LITERAL">create</tt> 命令， 现在支持一个 <code class="OPTION">-f</code>
命令行标志， 以强制创建 GPT， 即使磁盘上原先已经存在了 MBR 记录。</p>

<p>gvinum(8) 工具现在支持 <tt class="COMMAND">checkparity</tt>、 <tt
class="COMMAND">rebuildparity</tt>， 以及 <tt class="COMMAND">setstate</tt>
这三个子命令了。</p>

<p><tt class="FILENAME">libarchive</tt> 库 (以及使用它的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=tar&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">tar</span>(1)</span></a> 命令)
现在能够读取 ISO 镜像文件 (包括可选的 RockRidge 扩展) 和 ZIP 压缩文件 (采用 <tt
class="LITERAL">deflate</tt> 和 <tt class="LITERAL">none</tt> 的压缩) 了。</p>

<p>加入了用于访问 GPIB 设备 (通过使用 pcii 驱动程序) 的 <code class="FUNCTION">ib<tt
class="REPLACEABLE"><i>foo</i></tt></code> API 的 <tt class="FILENAME">libgpib</tt>
库。</p>

<p>从 HEAD 合并了一系列 <tt class="FILENAME">libpthread</tt> 的错误修正。</p>

<p>为 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=math&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">math</span>(3)</span></a>
函数库实现了一系列新的函数。 其中包括 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ceill&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ceill</span>(3)</span></a>、 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=floorl&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">floorl</span>(3)</span></a>、 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ilogbl&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ilogbl</span>(3)</span></a>、 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=fma&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">fma</span>(3)</span></a>
及其变体， <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lrint&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">lrint</span>(3)</span></a>
及其变体， 以及 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=lround&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">lround</span>(3)</span></a>
及其变体。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=moused&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">moused</span>(8)</span></a>
服务能够支持 ``虚拟滚轮'' 了， 这一模式下， 按住鼠标中键时移动鼠标将被解释为滚轮操作。
这一功能可以通过 <code class="OPTION">-V</code> 标志来启用。</p>

<p>为 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=named&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">named</span>(8)</span></a>
加入了属主为 <tt class="USERNAME">bind</tt> 用户 (用于创建区域的日志文件)
的用于动态域的隔离目录。 要了解进一步的情况， 请参见示范的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=named.conf&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">named.conf</span>(5)</span></a>
中动态域的例子。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ncal&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ncal</span>(1)</span></a>
工具提供了一个 <code class="OPTION">-m</code> 选项， 用以生成当前年份指定月份的日历。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">newfs</span>(8)</span></a>
提供了一个 <code class="OPTION">-n</code> 标志， 来禁止在新文件系统上创建 <tt
class="FILENAME">.snap</tt> 目录。 这一特性主要是为那些不需要快照支持的文件系统，
如内存或 vnode 文件系统准备的。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=newfs&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">newfs</span>(8)</span></a>
会在创建 UFS 或 UFS2 文件系统， 而无法在其上产生快照时给出警告。
这一情况会在很大的文件系统使用很小尺寸的块时发生。</p>

<p>加入了编译用户应用时的 <tt class="LITERAL">NO_NIS</tt> 开关。 如其名称所暗示的，
启用这个 <tt class="FILENAME">Makefile</tt> 变量将使许多程序中不再包含 NIS 支持，
并不再勾践 NIS 工具。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=periodic&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">periodic</span>(8)</span></a>
安全检查输出， 能够支持显示由 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">pf</span>(4)</span></a>
所阻止的包的统计数据了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ppp</span>(8)</span></a>
程序实现了 <code class="OPTION">echo</code> 参数， 这使得分别地启用 LCP ECHO 和 LQR
报告成为可能。 较早版本的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ppp&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ppp</span>(8)</span></a>
会在协商失败时返回到 LCP ECHO 模式。 现在需要指定 <tt class="COMMAND">enable echo</tt>
来获得这一行为。</p>

<p>在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=pppd&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">pppd</span>(8)</span></a>
程序中的两个问题得以修正。 这些错误可能会导致不正确的 CBCP 响应， 而违反了 微软 PPP
回呼控制协议的 3.2 节。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=restore&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">restore</span>(8)</span></a>
工具又能够处理 FreeBSD 版本 1 的转储磁带了。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=rm&sektion=1&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">rm</span>(1)</span></a> 工具提供了一个
<code class="OPTION">-I</code> 选项。 如果选择递归地删除目录，
或者在命令行上指定一次删除超过 3 个文件， 这个选项会提供一次确认的机会。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=rtld&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">rtld</span>(1)</span></a>
动态连接器现在支持通过 <code class="VARNAME">LD_LIBMAP</code>
环境变量来指定库映射关系了。 这一选项能够覆盖 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=libmap.conf&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">libmap.conf</span>(5)</span></a>
的设置。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=syslog&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">syslog</span>(3)</span></a>
函数现在是线程安全的了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">syslogd</span>(8)</span></a>
工具现在会打开一个额外的域 socket (默认为 <tt class="FILENAME">/var/run/logpriv</tt>)，
其权限是 <tt class="LITERAL">0600</tt>， 作为和特权程序的接口。
者避免了发生本地的拒绝服务攻击时， 特权程序由于域 socket 的缓冲区耗尽而死锁。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">syslogd</span>(8)</span></a>
新增了 <code class="OPTION">-S</code> 选项， 用以改变特权 socket 的路径名。
如果您不希望服务接受来自本地 socket 的消息 (默认使用的是 <tt
class="FILENAME">/var/run/log</tt> 和 <tt class="FILENAME">/var/run/logpriv</tt>) 时，
这个选项就很有用了。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=syslogd&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">syslogd</span>(8)</span></a>
工具现在允许在主机名标识符中使用 <tt class="LITERAL">:</tt> 和 <tt class="LITERAL">%</tt>
这两个字符了。 这些字符被 IPv6 地址和 scope ID 使用。</p>

<p>现在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=systat&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">systat</span>(1)</span></a> <code
class="OPTION">-netstat</code> 的显示也包括了 IPv6 的数据。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=tail&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">tail</span>(1)</span></a> 的 <code
class="OPTION">-f</code> 选项能够支持同时查看多个文件了。</p>

<p>增加了用于关闭选定的 TCp 连接的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=tcpdrop&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">tcpdrop</span>(8)</span></a>
命令。 它来自 OpenBSD。</p>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=whois&sektion=1&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">whois</span>(1)</span></a>
现在支持 <code class="OPTION">-k</code> 标志， 用以查询 <tt
class="HOSTID">whois.krnic.net</tt> (韩国国家 Internet 开发局)， 它提供了在韩国境内的 IP
地址分配的详细资料。</p>

<p>修正了一个可能导致 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=hosts&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">hosts</span>(5)</span></a>、 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=services&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">services</span>(5)</span></a>，
以及其他一些配置文件， 在其最后一行不是空行时被忽略的问题。</p>

<div class="SECT3">
<hr />
<h4 class="SECT3"><a id="RC-SCRIPTS" name="RC-SCRIPTS">2.3.1 <tt
class="FILENAME">/etc/rc.d</tt> 脚本</a></h4>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">rc.conf</span>(5)</span></a>
现在支持在引导时修改网络接口的名字了。 例如：</p>

<pre class="PROGRAMLISTING">
ifconfig_fxp0_name="net0"
ifconfig_net0="inet 10.0.0.1/16"
</pre>

<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=rc.conf&sektion=5&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">rc.conf</span>(5)</span></a>
现在支持 <code class="VARNAME">tmpmfs_flags</code> 和 <code
class="VARNAME">varmfs_flags</code> 两个变量了。 这些变量， 可以用来向 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=mdmfs&sektion=8&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">mdmfs</span>(8)</span></a>
工具提供额外的选项， 从而更好地定制 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=md&sektion=4&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">md</span>(4)</span></a>
文件系统的创建过程， 包括是否打开 softupdates， 指定文件系统的默认属主， 等等。</p>
</div>
</div>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="CONTRIB" name="CONTRIB">2.4 基本系统包含的第三方软件</a></h3>

<p><b class="APPLICATION">BIND</b> 从 9.3.0 升级到了 9.3.1。</p>

<p><b class="APPLICATION">Heimdal</b> 从 0.6.1 升级到了 0.6.3。</p>

<p>引入了来自 OpenBSD 的 2005 年 2 月 4 日快照的 <b class="APPLICATION">netcat</b>。
更多信息， 可以在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=nc&sektion=1&manpath=FreeBSD+5.4-RELEASE"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">nc</span>(1)</span></a>
联机手册中找到。</p>

<p><b class="APPLICATION">OpenSSL</b> 从 0.9.7d 升级到了 0.9.7e。</p>

<p><b class="APPLICATION">sendmail</b> 从 8.13.1 升级到了 version 8.13.3。</p>

<p>时区数据库从 <b class="APPLICATION">tzdata2004e</b> 版升级到了 <b
class="APPLICATION">tzdata2004g</b> 版。</p>
</div>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="PORTS" name="PORTS">2.5 Ports/Packages Collection
基础结构</a></h3>

<p>从 CVS 库中删去了用于保存 Ports Collection 中所有项的 <tt
class="FILENAME">ports/INDEX<tt class="REPLACEABLE"><i>*</i></tt></tt>。
这些文件过去并不经常性地重新生成， 因此可能会过时和不再准确。 需要使用 INDEX 文件的用户
(例如用于 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=portupgrade&sektion=1&manpath=FreeBSD+Ports">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">portupgrade</span>(1)</span></a>)
可以使用两种方法来获取一份副本：</p>

<ul>
<li>
<p>使用 <tt class="COMMAND">make index</tt> 在 <tt class="FILENAME">ports/</tt> tree
的顶部构建一份当前 ports tree 的索引。</p>
</li>

<li>
<p>在 <tt class="FILENAME">ports/</tt> tree 顶部执行 <tt class="COMMAND">make
fetchindex</tt> 来从网上下载。 这个索引文件 (通常) 在一天之内是准确的。</p>
</li>
</ul>
</div>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="RELENG" name="RELENG">2.6 发行版建造工程和功能集成</a></h3>

<p>在先前的 FreeBSD 版本中， <tt class="FILENAME">disc1</tt> CD-ROM (或 ISO 镜像文件)
是一张包含基本系统、 ports tree 和常用 package 的可以引导的光盘。 而 <tt
class="FILENAME">disc2</tt> CD-ROM (或 ISO 镜像文件) 则是可以引导的 ``fix it'' 盘，
它提供了现场 (live) 文件系统， 用于进行紧急修复操作。 这一格局发生了变化。 对于除了 ia64
以外的所有平台， 现在 <tt class="FILENAME">disc1</tt> 包含了基本系统的安装包文件、 ports
tree， 以及现场文件系统， 使得它适合于初始安装， 以及修复工作。 (在 ia64 上，
由于现场文件系统的尺寸太大， 以至于不得不将其放到另一张盘上。) 第三方 package
都在另一张盘上。 特别地， <tt class="FILENAME">disc2</tt> 上包含了常用的预编译软件包，
例如桌面环境软件等。 来自 FreeBSD 文档计划的各类文档， 也被置于 <tt
class="FILENAME">disc2</tt>。</p>

<p>支持的 <b class="APPLICATION">GNOME</b> 桌面环境的版本， 由 2.6.2 升级到了 2.10。
更多关于在 FreeBSD 上运行 <b class="APPLICATION">GNOME</b> 的详细资料， 可以在 <a
href="http://www.FreeBSD.org/gnome/" target="_top">FreeBSD GNOME Project</a> Web
页面上找到。</p>

<div class="NOTE">
<blockquote class="NOTE">
<p><b>注意:</b> 使用较早版本的 <b class="APPLICATION">GNOME</b> 桌面 (<a
href="http://www.FreeBSD.org/cgi/url.cgi?ports/x11/gnome2/pkg-descr"><tt
class="FILENAME">x11/gnome2</tt></a>) 的用户在升级时需要特别小心。 简单地使用 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=portupgrade&sektion=1&manpath=FreeBSD+Ports">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">portupgrade</span>(1)</span></a>
(<a href="http://www.FreeBSD.org/cgi/url.cgi?ports/sysutils/portupgrade/pkg-descr"><tt
class="FILENAME">sysutils/portupgrade</tt></a>) 配合 FreeBSD Ports Collection
进行升级可能会造成严重的问题。 <b class="APPLICATION">GNOME</b> 桌面的用户， 应仔细阅读
<a href="http://www.FreeBSD.org/gnome/docs/faq210.html"
target="_top">http://www.FreeBSD.org/gnome/docs/faq210.html</a> 给出的说明， 并使用 <a
href="http://www.FreeBSD.org/gnome/gnome_upgrade.sh" target="_top"><tt
class="FILENAME">gnome_upgrade.sh</tt></a> 脚本来正确地升级到 <b
class="APPLICATION">GNOME</b> 2.10。</p>
</blockquote>
</div>

<br />
<br />
<p>支持的 <b class="APPLICATION">KDE</b> 桌面环境的版本， 从 3.3.0 升级到了 3.4.0。
更多关于在 FreeBSD 上运行 <b class="APPLICATION">KDE</b> 的信息， 可以在 <a
href="http://freebsd.kde.org/" target="_top">FreeBSD 上的 KDE</a> Web 页面上找到。</p>

<div class="NOTE">
<blockquote class="NOTE">
<p><b>注意:</b> 使用较早版本的 <b class="APPLICATION">KDE</b> 的用户， 应使用 <a
href="http://freebsd.kde.org/" target="_top">FreeBSD 上的 KDE</a> Web 页面或 <tt
class="FILENAME">ports/UPDATING</tt> 中给出的方法升级。</p>
</blockquote>
</div>

<br />
<br />
<p>支持的 <b class="APPLICATION">Xorg</b> 从 6.7.0 升级到了 6.8.2。</p>
</div>

<div class="SECT2">
<hr />
<h3 class="SECT2"><a id="DOC" name="DOC">2.7 文档</a></h3>

<p>以下联机手册先前的版本中曾包含来自 RFC 的内容， 为了避免对 IETF 的侵权，
已经重新编写： <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=gai_strerror&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">gai_strerror</span>(3)</span></a>,
<a
href="http://www.FreeBSD.org/cgi/man.cgi?query=getaddrinfo&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">getaddrinfo</span>(3)</span></a>,
<a
href="http://www.FreeBSD.org/cgi/man.cgi?query=getnameinfo&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">getnameinfo</span>(3)</span></a>,
<a
href="http://www.FreeBSD.org/cgi/man.cgi?query=inet6_opt_init&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span
class="REFENTRYTITLE">inet6_opt_init</span>(3)</span></a>, <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=inet6_option_space&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span
class="REFENTRYTITLE">inet6_option_space</span>(3)</span></a>, <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=inet6_rth_space&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span
class="REFENTRYTITLE">inet6_rth_space</span>(3)</span></a>, <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=inet6_rthdr_space&sektion=3&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span
class="REFENTRYTITLE">inet6_rthdr_space</span>(3)</span></a>, <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=icmp6&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">icmp6</span>(4)</span></a>, 和 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ip6&sektion=4&manpath=FreeBSD+5.4-RELEASE">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ip6</span>(4)</span></a>。</p>
</div>
</div>

<div class="SECT1">
<hr />
<h2 class="SECT1"><a id="UPGRADE" name="UPGRADE">3 从先前版本的 FreeBSD 升级</a></h2>

<p>使用现有的 FreeBSD 系统的用户 <span class="emphasis"><i
class="EMPHASIS">强烈</i></span> 推荐首先阅读 ``到 FreeBSD 5.4-RELEASE 的迁移指南''。
这份文档应该可以在光盘或这份发行版本说明所在的地方找到， 其文件名为 <tt
class="FILENAME">MIGRATE5.TXT</tt>。 它提供了一些关于升级的说明， 更重要的是， 升级到
FreeBSD 5.<tt class="REPLACEABLE"><i>X</i></tt> 和继续运行 FreeBSD 4.<tt
class="REPLACEABLE"><i>X</i></tt> 的优缺点对比。</p>

<div class="IMPORTANT">
<blockquote class="IMPORTANT">
<p><b>重要:</b> 很显然，升级 FreeBSD 时，应该首先备份 <span class="emphasis"><i
class="EMPHASIS">所有</i></span> 数据和配置文件。</p>
</blockquote>
</div>
</div>
</div>

<hr />
<p align="center"><small>这份文档，以及其他与FreeBSD发行版本有关的文档，都可以在 <a
href="ftp://ftp.FreeBSD.org/">ftp://ftp.FreeBSD.org/</a>下载。</small></p>

<p align="center"><small>在遇到关于FreeBSD的技术问题时，请首先阅读 <a
href="http://www.FreeBSD.org/docs.html">文档</a> 之后再考虑联系 &#60;<a
href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&#62;。</small></p>

<p align="center"><small>所有 FreeBSD 5-STABLE 的用户都应该订阅 &#60;<a
href="mailto:stable@FreeBSD.org">stable@FreeBSD.org</a>&#62; 邮件列表。</small></p>

<p align="center"><small>关于这份文档的任何问题，请致信 &#60;<a
href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&#62;。</small></p>
</body>
</html>

