<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="generator" content="HTML Tidy, see www.w3.org" />
<title>FreeBSD 6.0-RELEASE 发行版勘误</title>
<meta name="GENERATOR" content="Modular DocBook HTML Stylesheet Version 1.79" />
<link rel="STYLESHEET" type="text/css" href="docbook.css" />
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
</head>
<body class="ARTICLE" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#840084"
alink="#0000FF">
<div class="ARTICLE">
<div class="TITLEPAGE">
<h1 class="TITLE"><a id="AEN2" name="AEN2">FreeBSD 6.0-RELEASE 发行版勘误</a></h1>

<h3 class="CORPAUTHOR">The FreeBSD Project</h3>

<p class="COPYRIGHT">版权 &copy; 2000, 2001, 2002, 2003, 2004, 2005, 2006 The FreeBSD
Documentation Project</p>

<p class="PUBDATE">$FreeBSD: src/release/doc/zh_CN.GB2312/errata/article.sgml,v 1.2.2.2
2006/03/07 05:06:25 delphij Exp $<br />
</p>

<div class="LEGALNOTICE"><a id="TRADEMARKS" name="TRADEMARKS"></a>
<p>FreeBSD is a registered trademark of the FreeBSD Foundation.</p>

<p>Intel, Celeron, EtherExpress, i386, i486, Itanium, Pentium, and Xeon are trademarks or
registered trademarks of Intel Corporation or its subsidiaries in the United States and
other countries.</p>

<p>Sparc, Sparc64, SPARCEngine, and UltraSPARC are trademarks of SPARC International, Inc
in the United States and other countries. Products bearing SPARC trademarks are based
upon architecture developed by Sun Microsystems, Inc.</p>

<p>Many of the designations used by manufacturers and sellers to distinguish their
products are claimed as trademarks. Where those designations appear in this document, and
the FreeBSD Project was aware of the trademark claim, the designations have been followed
by the “&trade;” or the “&reg;” symbol.</p>
</div>

<hr />
</div>

<blockquote class="ABSTRACT">
<div class="ABSTRACT"><a id="AEN22" name="AEN22"></a>
<p>这份文档列出了 FreeBSD 6.0-RELEASE 的勘误内容，
其中包括在发行版发布之后发现的重大问题， 以及在发行版的交付工程后期本应写进发行版文档，
而没有来得及加入的重要信息。 这些信息可能包括安全公告，
以及关于可能影响软件和文档的操作或可用性的新闻。 在安装此版本的 FreeBSD 之前，
应首先阅读此文档的最新版本。</p>

<p>这份 FreeBSD 6.0-RELEASE 的勘误文档将持续地维护， 直到 FreeBSD 6.1-RELEASE
发布为止。</p>
</div>
</blockquote>

<div class="SECT1">
<hr />
<h2 class="SECT1"><a id="INTRO" name="INTRO">1 介绍</a></h2>

<p>这份勘误文档包含了关于 FreeBSD 6.0-RELEASE 的 “最新重大新闻”。 在安装这一版本之前，
通过参考这份文档来了解在发布之后， 可能已经发现并修正的问题非常重要。</p>

<p>随发行版本而发布的这份文档 (例如， 在 CDROM 上附带的) 一般来说已经过时了， 但在
Internet 上的其他副本会被持续更新， 因此应作为这一发行版的 “最新勘误” 来看待。
这些勘误文档的副本， 可以在 <a href="http://www.FreeBSD.org/releases/"
target="_top">http://www.FreeBSD.org/releases/</a>，
以及所有其他保持与其同步的镜像上找到。</p>

<p>FreeBSD 6-STABLE 的源代码和预编译形式的快照中， 也会包含本文档 (在制作快照时)
的最新版本。</p>

<p>全部 FreeBSD CERT 安全公告的列表， 可以在 <a href="http://www.FreeBSD.org/security/"
target="_top">http://www.FreeBSD.org/security/</a> 或 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/"
target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/</a> 找到。</p>
</div>

<div class="SECT1">
<hr />
<h2 class="SECT1"><a id="LATE-NEWS" name="LATE-NEWS">2 更新信息</a></h2>

<p>无新闻。</p>
</div>

<div class="SECT1">
<hr />
<h2 class="SECT1"><a id="SECURITY" name="SECURITY">3 安全公告</a></h2>

<p>下列安全公告与 FreeBSD 6.0-RELEASE 有关。 要了解进一步的信息， 请从 <a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/"
target="_top">ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/</a>
下载并阅读安全公告。</p>

<div class="INFORMALTABLE"><a id="AEN43" name="AEN43"></a>
<table border="0" frame="void" class="CALSTABLE">
<col width="1*" />
<col width="1*" />
<col width="3*" />
<thead>
<tr>
<th>安全公告</th>
<th>日期</th>
<th>主题</th>
</tr>
</thead>

<tbody>
<tr>
<td><a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:10.nfs.asc"
target="_top">06:10.nfs</a></td>
<td>2006&nbsp;年&nbsp;3&nbsp;月&nbsp;1&nbsp;日</td>
<td>
<p>针对 NFS 服务器的远程拒绝服务攻击</p>
</td>
</tr>

<tr>
<td><a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:07.pf.asc"
target="_top">06:07.pf</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;25&nbsp;日</td>
<td>
<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&sektion=4&manpath=FreeBSD+6.0-stable"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">pf</span>(4)</span></a> 中 IP
分片处理导致的 panic</p>
</td>
</tr>

<tr>
<td><a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:06.kmem.asc"
target="_top">06:06.kmem</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;25&nbsp;日</td>
<td>
<p>本地内核内存内容泄露</p>
</td>
</tr>

<tr>
<td><a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:05.80211.asc"
target="_top">06:05.80211</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;18日</td>
<td>
<p>IEEE 802.11 缓冲区溢出</p>
</td>
</tr>

<tr>
<td><a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:04.ipfw.asc"
target="_top">06:04.ipfw</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;11日</td>
<td>
<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> IP
分片拒绝服务攻击</p>
</td>
</tr>

<tr>
<td><a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:03.cpio.asc"
target="_top">06:03.cpio</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;11日</td>
<td>
<p>在 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=cpio&sektion=1&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">cpio</span>(1)</span></a>
中存在多处漏洞</p>
</td>
</tr>

<tr>
<td><a href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:02.ee.asc"
target="_top">06:02.eex</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;11日</td>
<td>
<p><a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ee&sektion=1&manpath=FreeBSD+6.0-stable"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">ee</span>(1)</span></a>
临时文件特权提升</p>
</td>
</tr>

<tr>
<td><a
href="ftp://ftp.FreeBSD.org/pub/FreeBSD/CERT/advisories/FreeBSD-SA-06:01.texindex.asc"
target="_top">06:01.texindex</a></td>
<td>2006&nbsp;年&nbsp;1&nbsp;月&nbsp;11日</td>
<td>
<p>Texindex 临时文件特权提升</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="SECT1">
<hr />
<h2 class="SECT1"><a id="KNOWN-PROBLEMS" name="KNOWN-PROBLEMS">4
已知问题和解决方法</a></h2>

<p>(2005/11/26) 在 6.0-RELEASE 上， 以下 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a>
规则会以与先前版本不同的方式处理：</p>

<pre class="PROGRAMLISTING">
allow ipv6 from 192.168.0.2 to me
</pre>

<p>当 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 不支持
IPv6 时 (具体细节请参见下一个问题)， <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=8&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(8)</span></a>
会接受这个规则， 并阻止源地址为 <tt class="LITERAL">192.168.0.2</tt> 的、 封装到 IPv4
包中的 IPv6 包 (IPv4-之上的-IPv6 隧道， 协议编号 41)。 如果它支持 IPv6，
则这表示一条允许来自 <tt class="LITERAL">192.168.0.2</tt> 的 IPv6 包的规则， 而实际上 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=8&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(8)</span></a>
会拒绝这一规则， 因为其语法是错误的 (“来自 IPv4 地址的 IPv6 包” 不能存在)。 不幸的是，
并没有简单的办法来绕过这一问题。</p>

<p>目前 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 的 IPv6
支持仍然有很多不甚完善的地方， 由于两者之间的不兼容， 还存在许多其他问题。
要绕过这些问题， 您可以同时使用仅支持 IPv4 的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 和 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ip6fw&sektion=8&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ip6fw</span>(8)</span></a>，
而不是包含 IPv6 支持的 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a>，
这样能够最大限度地与先前的版本兼容。 要禁用 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 的 IPv6
支持， 您应使用 <tt class="FILENAME">ipfw.ko</tt> 内核模块， 而不应使用内核编译配置选项
<tt class="LITERAL">IPFIREWALL</tt>。</p>

<p>(2005/11/19) 尽管 FreeBSD 6.0-RELEASE 的发行版说明表示 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a>
子系统已经能够支持 IPv6， 但同时使用 <tt class="FILENAME">GENERIC</tt> 内核，
以及内核模块 <tt class="FILENAME">ipfw.ko</tt> 时， 并不能在包过滤规则中支持 <tt
class="LITERAL">ip6</tt> 协议关键字。 这是因为内核编译配置文件中的选项 <tt
class="LITERAL">INET6</tt> 并不能为 <tt class="FILENAME">ipfw.ko</tt> 的构建过程所识别。
要启用 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 的 IPv6
支持， 您需要将内核以同时包含选项 <tt class="LITERAL">INET6</tt> 和 <tt
class="LITERAL">IPFIREWALL</tt> 的方式重新构建， 而不是使用 <tt
class="FILENAME">ipfw.ko</tt> 模块。</p>

<p>(2005/11/16) 使用 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=if_bridge&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">if_bridge</span>(4)</span></a>
配合包过滤器， 如 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> 以及 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=pf&sektion=4&manpath=FreeBSD+6.0-stable"><span
 class="CITEREFENTRY"><span class="REFENTRYTITLE">pf</span>(4)</span></a>
可能会使网络协议栈停止工作， 甚至导致系统在一段时间之后发生 panic。
这是由于它会为网络数据包分配 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=mbuf&sektion=9&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">mbuf</span>(9)</span></a> 缓冲区，
但一直不释放它们， 这将最终耗竭全部的缓冲内存。 这一问题已经在 HEAD 以及 10:17:15
2005/11/16 UTC 之后的 RELENG_6 中修正。</p>

<p>(2005/11/16， 更新于 2005/11/19) 当 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(4)</span></a> <tt
class="LITERAL">divert</tt> 规则与协议关键字 <tt class="LITERAL">ip</tt> 或 <tt
class="LITERAL">all</tt> 联用时， IPv6 会在这一规则处被直接丢弃， 因为 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=divert&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">divert</span>(4)</span></a> socket
并不支持 IPv6。 对于一台拥有 IPv4 和 IPv6 双协议栈， 并启用了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=natd&sektion=8&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">natd</span>(8)</span></a>
的机器而言这可能是一个严重的问题。 <span class="bold"><b class="EMPHASIS">请注意内核模块
<tt class="FILENAME">ipfw.ko</tt> 并没有这个问题， 因为它并不支持 IPv6。</b></span>
要避免这一问题， 应使用专用于 IPv4 的 divert (转向) 规则， 例如 <tt
class="LITERAL">divert natd ipv4</tt> 来代替 <tt class="LITERAL">divert natd
all</tt>。</p>

<p>(2005/11/6) FreeBSD 6.0-RELEASE 的发行版说明错误地说明了与 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=ipfw&sektion=8&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">ipfw</span>(8)</span></a>
有关的一个内核选项为 <tt class="LITERAL">IPFIRWALL_FORWARD</tt>。 正确的关键字应该是 <tt
class="LITERAL">IPFIREWALL_FORWARD</tt>。</p>

<p>(2005/11/5) FreeBSD 6.0-RELEASE 的发行版说明错误地说明了集成到 FreeBSD 中的 OpenSSH 和
IPFilter 的版本分别是 4.1p1 和 4.1.18。 正确的版本应该是 4.2p1 和 4.1.8。</p>

<p>(2005/11/5) 在 6.0-RELEASE 的安装文件中提供了 <tt class="FILENAME">CHECKSUM.MD5</tt>
和 <tt class="FILENAME">CHECKSUM.SHA256</tt> 来帮助验证数据完整性。 但是， 在 6.0-RELEASE
中的这些文件错误地包含了校验和文件本身的校验和。 尽管这种校验和看起来是不正确的，
但可以安全地忽略它们， 因为校验和文件的校验和与其所包含的其他的文件内容并不相关。
这一问题将在未来的发行版中修正。</p>

<p>(2005/11/5， 仅限于 FreeBSD/amd64) 在将 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=hwpmc&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">hwpmc</span>(4)</span></a>
日志文件转换为 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=gprof&sektion=1&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">gprof</span>(1)</span></a>
格式时， <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=pmcstat&sektion=8&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">pmcstat</span>(8)</span></a>
工具尚无法处理 32-位 的可执行文件。</p>

<p>(2005/11/5， 仅限于 FreeBSD/powerpc) 下列 panic 可能在某些较早的 PowerMac G4
系统启动时发生：</p>

<pre class="SCREEN">
...
KDB: current backend: ddb
panic: Assertion curthread != NULL failed at
/usr/src/sys/kern/kern_mutex.c:268
KDB: enter panic
</pre>

<p>这是一个已知但没有缓解方法的问题， 它将在下一个版本中修正。</p>

<p>(2005/11/5) 由于在 6.0-RELEASE 上 <tt class="FILENAME">/usr/share/locale/*/LC_*</tt>
文件保存在磁盘上的格式发生了变化， 使用了 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=setlocale&sektion=3&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">setlocale</span>(3)</span></a>
的第三方软件的本地化功能， 在从 5.x 系统上升级之后会无法再正常工作。
这包括那些在系统在运行 5.x 时通过 FreeBSD Ports 套件， 以及其他方式安装的软件。
要解决这个问题， 需要执行下列操作之一：</p>

<ul>
<li>
<p>将 misc/compat5x package 安装到升级后的 6.0 系统。 这个包会安装一个 <tt
class="FILENAME">lib/compat/libc.so.5</tt> 库， 它使得在 5.x
系统上编译的可执行文件使用旧的 locale 文件， 以保持兼容性。 请注意您需要在升级前删除 <tt
class="FILENAME">/lib/libc.so.5</tt>。</p>

<p>这个 package 只对 Tier-1 级别的平台可用。</p>
</li>

<li>
<p>在 6.0 系统中重新编译并安装所有软件。</p>
</li>
</ul>

<p>(2005/10/3) 如果机器没有 framebuffer， 在引导时 FreeBSD/sparc64 GENERIC
内核可能输出下列消息：</p>

<pre class="SCREEN">
Aug 26 19:31:27 hostname getty[429]: open /dev/ttyv1: No such file or directory
</pre>

<p>这是因为没有提供支持的图形硬件的机器无法识别 <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=syscons&sektion=4&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">syscons</span>(4)</span></a>，
因此也就无法建立 <tt class="FILENAME">/dev/ttyv*</tt> 设备节点。 这并不是一个致命的错误，
通过在 <tt class="FILENAME">/etc/ttys</tt> 中禁用 <tt class="FILENAME">/dev/ttyv*</tt>
项就可以阻止它们出现。</p>

<p>(2005/10/3) 在 FreeBSD/sparc64 上， 如果机器有超过 4GB 的内存， 就无法使用内核模块了。
除了事先将模块静态联编到内核中之外， 没有其他办法能够绕过这个问题。</p>

<p>(2005/10/3) <a
href="http://www.FreeBSD.org/cgi/man.cgi?query=kgdb&sektion=1&manpath=FreeBSD+6.0-stable">
<span class="CITEREFENTRY"><span class="REFENTRYTITLE">kgdb</span>(1)</span></a> 工具在
FreeBSD/sparc64 上无法正确地对包含 trap 的 panic 进行调试。 要绕过这个问题您可以先安装
<tt class="FILENAME">devel/gdb53</tt>。</p>
</div>
</div>

<hr />
<p align="center"><small>这份文档，以及其他与FreeBSD发行版本有关的文档，都可以在 <a
href="http://www.FreeBSD.org/snapshots/">http://www.FreeBSD.org/snapshots/</a>下载。</small></p>

<p align="center"><small>在遇到关于FreeBSD的技术问题时，请首先阅读 <a
href="http://www.FreeBSD.org/docs.html">文档</a> 之后再考虑联系 &#60;<a
href="mailto:questions@FreeBSD.org">questions@FreeBSD.org</a>&#62;。</small></p>

<p align="center"><small>所有 FreeBSD 6-STABLE 的用户都应该订阅 &#60;<a
href="mailto:stable@FreeBSD.org">stable@FreeBSD.org</a>&#62; 邮件列表。</small></p>

<p align="center"><small>关于这份文档的任何问题，请致信 &#60;<a
href="mailto:doc@FreeBSD.org">doc@FreeBSD.org</a>&#62;。</small></p>
</body>
</html>

